(function(){
shadow$provide[629]=function(xa,Z,Ya,O){function y(Xa){for(var yb="https://reactjs.org/docs/error-decoder.html?invariant\x3d"+Xa,qb=1;qb<arguments.length;qb++)yb+="\x26args[]\x3d"+encodeURIComponent(arguments[qb]);return"Minified React error #"+Xa+"; visit "+yb+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function W(Xa){if(null==Xa)return null;if("function"===typeof Xa)return Xa.displayName||Xa.name||null;if("string"===typeof Xa)return Xa;
switch(Xa){case t:return"Fragment";case C:return"Portal";case J:return"Profiler";case L:return"StrictMode";case ja:return"Suspense";case X:return"SuspenseList"}if("object"===typeof Xa)switch(Xa.$$typeof){case S:return(Xa.displayName||"Context")+".Consumer";case T:return(Xa._context.displayName||"Context")+".Provider";case P:var yb=Xa.render;yb=yb.displayName||yb.name||"";return Xa.displayName||(""!==yb?"ForwardRef("+yb+")":"ForwardRef");case aa:return W(Xa.type);case Y:return W(Xa._render);case ba:yb=
Xa._payload;Xa=Xa._init;try{return W(Xa(yb))}catch(qb){}}return null}function B(Xa,yb){for(var qb=Xa._threadCount|0;qb<=yb;qb++)Xa[qb]=Xa._currentValue2,Xa._threadCount=qb+1}function p(Xa,yb,qb,$b){if($b&&($b=Xa.contextType,"object"===typeof $b&&null!==$b))return B($b,qb),$b[qb];if(Xa=Xa.contextTypes){qb={};for(var ic in Xa)qb[ic]=yb[ic];yb=qb}else yb=wa;return yb}function b(Xa){if(Ja.call(db,Xa))return!0;if(Ja.call(Qa,Xa))return!1;if(ya.test(Xa))return db[Xa]=!0;Qa[Xa]=!0;return!1}function q(Xa,
yb,qb,$b){if(null!==qb&&0===qb.type)return!1;switch(typeof yb){case "function":case "symbol":return!0;case "boolean":if($b)return!1;if(null!==qb)return!qb.acceptsBooleans;Xa=Xa.toLowerCase().slice(0,5);return"data-"!==Xa&&"aria-"!==Xa;default:return!1}}function D(Xa,yb,qb,$b){if(null===yb||"undefined"===typeof yb||q(Xa,yb,qb,$b))return!0;if($b)return!1;if(null!==qb)switch(qb.type){case 3:return!yb;case 4:return!1===yb;case 5:return isNaN(yb);case 6:return isNaN(yb)||1>yb}return!1}function E(Xa,yb,
qb,$b,ic,Ab,Nb){this.acceptsBooleans=2===yb||3===yb||4===yb;this.attributeName=$b;this.attributeNamespace=ic;this.mustUseProperty=qb;this.propertyName=Xa;this.type=yb;this.sanitizeURL=Ab;this.removeEmptyString=Nb}function G(Xa){return Xa[1].toUpperCase()}function Q(Xa){if("boolean"===typeof Xa||"number"===typeof Xa)return""+Xa;Xa=""+Xa;var yb=Ea.exec(Xa);if(yb){var qb="",$b,ic=0;for($b=yb.index;$b<Xa.length;$b++){switch(Xa.charCodeAt($b)){case 34:yb="\x26quot;";break;case 38:yb="\x26amp;";break;case 39:yb=
"\x26#x27;";break;case 60:yb="\x26lt;";break;case 62:yb="\x26gt;";break;default:continue}ic!==$b&&(qb+=Xa.substring(ic,$b));ic=$b+1;qb+=yb}Xa=ic!==$b?qb+Xa.substring(ic,$b):qb}return Xa}function h(Xa,yb){var qb=Ca.hasOwnProperty(Xa)?Ca[Xa]:null,$b;if($b="style"!==Xa)$b=null!==qb?0===qb.type:!(2<Xa.length)||"o"!==Xa[0]&&"O"!==Xa[0]||"n"!==Xa[1]&&"N"!==Xa[1]?!1:!0;if($b||D(Xa,yb,qb,!1))return"";if(null!==qb){Xa=qb.attributeName;$b=qb.type;if(3===$b||4===$b&&!0===yb)return Xa+'\x3d""';qb.sanitizeURL&&
(yb=""+yb);return Xa+'\x3d"'+(Q(yb)+'"')}return b(Xa)?Xa+'\x3d"'+(Q(yb)+'"'):""}function k(Xa,yb){return Xa===yb&&(0!==Xa||1/Xa===1/yb)||Xa!==Xa&&yb!==yb}function a(){if(null===la)throw Error(y(321));return la}function l(){if(0<Va)throw Error(y(312));return{memoizedState:null,queue:null,next:null}}function m(){null===ta?null===va?(oa=!1,va=ta=l()):(oa=!0,ta=va):null===ta.next?(oa=!1,ta=ta.next=l()):(oa=!0,ta=ta.next);return ta}function r(Xa,yb,qb,$b){for(;La;)La=!1,Va+=1,ta=null,qb=Xa(yb,$b);I();
return qb}function I(){la=null;La=!1;va=null;Va=0;ta=Ta=null}function A(Xa,yb){return"function"===typeof yb?yb(Xa):yb}function w(Xa,yb,qb){la=a();ta=m();if(oa){var $b=ta.queue;yb=$b.dispatch;if(null!==Ta&&(qb=Ta.get($b),void 0!==qb)){Ta.delete($b);$b=ta.memoizedState;do $b=Xa($b,qb.action),qb=qb.next;while(null!==qb);ta.memoizedState=$b;return[$b,yb]}return[ta.memoizedState,yb]}Xa=Xa===A?"function"===typeof yb?yb():yb:void 0!==qb?qb(yb):yb;ta.memoizedState=Xa;Xa=ta.queue={last:null,dispatch:null};
Xa=Xa.dispatch=d.bind(null,la,Xa);return[ta.memoizedState,Xa]}function g(Xa,yb){la=a();ta=m();yb=void 0===yb?null:yb;if(null!==ta){var qb=ta.memoizedState;if(null!==qb&&null!==yb){var $b=qb[1];a:if(null===$b)$b=!1;else{for(var ic=0;ic<$b.length&&ic<yb.length;ic++)if(!ka(yb[ic],$b[ic])){$b=!1;break a}$b=!0}if($b)return qb[0]}}Xa=Xa();ta.memoizedState=[Xa,yb];return Xa}function d(Xa,yb,qb){if(!(25>Va))throw Error(y(301));if(Xa===la)if(La=!0,Xa={action:qb,next:null},null===Ta&&(Ta=new Map),qb=Ta.get(yb),
void 0===qb)Ta.set(yb,Xa);else{for(yb=qb;null!==yb.next;)yb=yb.next;yb.next=Xa}}function H(){}function x(Xa){switch(Xa){case "svg":return"http://www.w3.org/2000/svg";case "math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function K(Xa){if(void 0===Xa||null===Xa)return Xa;var yb="";M.Children.forEach(Xa,function(qb){null!=qb&&(yb+=qb)});return yb}function V(Xa,yb){if(void 0===Xa)throw Error(y(152,W(yb)||"Component"));}function z(Xa,yb,qb){function $b(Nb,
Db){var kb=Db.prototype&&Db.prototype.isReactComponent,ub=p(Db,yb,qb,kb),zb=[],ib=!1,rb={isMounted:function(){return!1},enqueueForceUpdate:function(){if(null===zb)return null},enqueueReplaceState:function(Nc,pd){ib=!0;zb=[pd]},enqueueSetState:function(Nc,pd){if(null===zb)return null;zb.push(pd)}};if(kb){if(kb=new Db(Nb.props,ub,rb),"function"===typeof Db.getDerivedStateFromProps){var Eb=Db.getDerivedStateFromProps.call(null,Nb.props,kb.state);null!=Eb&&(kb.state=R({},kb.state,Eb))}}else if(la={},
kb=Db(Nb.props,ub,rb),kb=r(Db,Nb.props,kb,ub),null==kb||null==kb.render){Xa=kb;V(Xa,Db);return}kb.props=Nb.props;kb.context=ub;kb.updater=rb;rb=kb.state;void 0===rb&&(kb.state=rb=null);if("function"===typeof kb.UNSAFE_componentWillMount||"function"===typeof kb.componentWillMount)if("function"===typeof kb.componentWillMount&&"function"!==typeof Db.getDerivedStateFromProps&&kb.componentWillMount(),"function"===typeof kb.UNSAFE_componentWillMount&&"function"!==typeof Db.getDerivedStateFromProps&&kb.UNSAFE_componentWillMount(),
zb.length){rb=zb;var ac=ib;zb=null;ib=!1;if(ac&&1===rb.length)kb.state=rb[0];else{Eb=ac?rb[0]:kb.state;var yc=!0;for(ac=ac?1:0;ac<rb.length;ac++){var Fc=rb[ac];Fc="function"===typeof Fc?Fc.call(kb,Eb,Nb.props,ub):Fc;null!=Fc&&(yc?(yc=!1,Eb=R({},Eb,Fc)):R(Eb,Fc))}kb.state=Eb}}else zb=null;Xa=kb.render();V(Xa,Db);if("function"===typeof kb.getChildContext&&(Nb=Db.childContextTypes,"object"===typeof Nb)){var kc=kb.getChildContext(),Pc;for(Pc in kc)if(!(Pc in Nb))throw Error(y(108,W(Db)||"Unknown",Pc));
}kc&&(yb=R({},yb,kc))}for(;M.isValidElement(Xa);){var ic=Xa,Ab=ic.type;if("function"!==typeof Ab)break;$b(ic,Ab)}return{child:Xa,context:yb}}var R=Z(265),M=Z(69),C=60106,t=60107,L=60108,J=60114,T=60109,S=60110,P=60112,ja=60113,X=60120,aa=60115,ba=60116,Y=60121,ha=60117,ea=60119,fa=60129,ra=60131;"function"===typeof Symbol&&Symbol.for&&(xa=Symbol.for,C=xa("react.portal"),t=xa("react.fragment"),L=xa("react.strict_mode"),J=xa("react.profiler"),T=xa("react.provider"),S=xa("react.context"),P=xa("react.forward_ref"),
ja=xa("react.suspense"),X=xa("react.suspense_list"),aa=xa("react.memo"),ba=xa("react.lazy"),Y=xa("react.block"),ha=xa("react.fundamental"),ea=xa("react.scope"),fa=xa("react.debug_trace_mode"),ra=xa("react.legacy_hidden"));xa=M.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED;var wa={},sa=new Uint16Array(16);for(Z=0;15>Z;Z++)sa[Z]=Z+1;sa[15]=0;var ya=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,
Ja=Object.prototype.hasOwnProperty,Qa={},db={},Ca={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(Xa){Ca[Xa]=new E(Xa,0,!1,Xa,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(Xa){var yb=Xa[0];Ca[yb]=new E(yb,1,!1,Xa[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(Xa){Ca[Xa]=
new E(Xa,2,!1,Xa.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(Xa){Ca[Xa]=new E(Xa,2,!1,Xa,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(Xa){Ca[Xa]=new E(Xa,3,!1,Xa.toLowerCase(),null,!1,!1)});["checked",
"multiple","muted","selected"].forEach(function(Xa){Ca[Xa]=new E(Xa,3,!0,Xa,null,!1,!1)});["capture","download"].forEach(function(Xa){Ca[Xa]=new E(Xa,4,!1,Xa,null,!1,!1)});["cols","rows","size","span"].forEach(function(Xa){Ca[Xa]=new E(Xa,6,!1,Xa,null,!1,!1)});["rowSpan","start"].forEach(function(Xa){Ca[Xa]=new E(Xa,5,!1,Xa.toLowerCase(),null,!1,!1)});var Na=/[\-:]([a-z])/g;"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(Xa){var yb=
Xa.replace(Na,G);Ca[yb]=new E(yb,1,!1,Xa,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(Xa){var yb=Xa.replace(Na,G);Ca[yb]=new E(yb,1,!1,Xa,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(Xa){var yb=Xa.replace(Na,G);Ca[yb]=new E(yb,1,!1,Xa,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(Xa){Ca[Xa]=new E(Xa,1,!1,Xa.toLowerCase(),null,!1,!1)});
Ca.xlinkHref=new E("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(Xa){Ca[Xa]=new E(Xa,1,!1,Xa.toLowerCase(),null,!0,!0)});var Ea=/["'&<>]/,ka="function"===typeof Object.is?Object.is:k,la=null,va=null,ta=null,oa=!1,La=!1,Ta=null,Va=0,Pa=null,cb={readContext:function(Xa){var yb=Pa.threadID;B(Xa,yb);return Xa[yb]},useContext:function(Xa){a();var yb=Pa.threadID;B(Xa,yb);return Xa[yb]},useMemo:g,useReducer:w,useRef:function(Xa){la=
a();ta=m();var yb=ta.memoizedState;return null===yb?(Xa={current:Xa},ta.memoizedState=Xa):yb},useState:function(Xa){return w(A,Xa)},useLayoutEffect:function(){},useCallback:function(Xa,yb){return g(function(){return Xa},yb)},useImperativeHandle:H,useEffect:H,useDebugValue:H,useDeferredValue:function(Xa){a();return Xa},useTransition:function(){a();return[function(Xa){Xa()},!1]},useOpaqueIdentifier:function(){return(Pa.identifierPrefix||"")+"R:"+(Pa.uniqueID++).toString(36)},useMutableSource:function(Xa,
yb){a();return yb(Xa._source)}},gb={area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0},Lb=R({menuitem:!0},gb),Gb={animationIterationCount:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,
gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},Da=["Webkit","ms","Moz","O"];Object.keys(Gb).forEach(function(Xa){Da.forEach(function(yb){yb=yb+Xa.charAt(0).toUpperCase()+Xa.substring(1);Gb[yb]=Gb[Xa]})});var ob=/([A-Z])/g,jb=/^ms-/,$a=M.Children.toArray,
hb=xa.ReactCurrentDispatcher,Za={listing:!0,pre:!0,textarea:!0},cc=/^[a-zA-Z][a-zA-Z:_\.\-\d]*$/,Vc={},Tc={},Ic=Object.prototype.hasOwnProperty,Lc={children:null,dangerouslySetInnerHTML:null,suppressContentEditableWarning:null,suppressHydrationWarning:null},Sa=function(){function Xa(qb,$b,ic){M.isValidElement(qb)?qb.type!==t?qb=[qb]:(qb=qb.props.children,qb=M.isValidElement(qb)?[qb]:$a(qb)):qb=$a(qb);qb={type:null,domNamespace:"http://www.w3.org/1999/xhtml",children:qb,childIndex:0,context:wa,footer:""};
var Ab=sa[0];if(0===Ab){var Nb=sa;Ab=Nb.length;var Db=2*Ab;if(!(65536>=Db))throw Error(y(304));var kb=new Uint16Array(Db);kb.set(Nb);sa=kb;sa[0]=Ab+1;for(Nb=Ab;Nb<Db-1;Nb++)sa[Nb]=Nb+1;sa[Db-1]=0}else sa[0]=sa[Ab];this.threadID=Ab;this.stack=[qb];this.exhausted=!1;this.currentSelectValue=null;this.previousWasTextNode=!1;this.makeStaticMarkup=$b;this.suspenseDepth=0;this.contextIndex=-1;this.contextStack=[];this.contextValueStack=[];this.uniqueID=0;this.identifierPrefix=ic&&ic.identifierPrefix||""}
var yb=Xa.prototype;yb.destroy=function(){if(!this.exhausted){this.exhausted=!0;this.clearProviders();var qb=this.threadID;sa[qb]=sa[0];sa[0]=qb}};yb.pushProvider=function(qb){var $b=++this.contextIndex,ic=qb.type._context,Ab=this.threadID;B(ic,Ab);var Nb=ic[Ab];this.contextStack[$b]=ic;this.contextValueStack[$b]=Nb;ic[Ab]=qb.props.value};yb.popProvider=function(){var qb=this.contextIndex,$b=this.contextStack[qb],ic=this.contextValueStack[qb];this.contextStack[qb]=null;this.contextValueStack[qb]=
null;this.contextIndex--;$b[this.threadID]=ic};yb.clearProviders=function(){for(var qb=this.contextIndex;0<=qb;qb--)this.contextStack[qb][this.threadID]=this.contextValueStack[qb]};yb.read=function(qb){if(this.exhausted)return null;var $b=Pa;Pa=this;var ic=hb.current;hb.current=cb;try{for(var Ab=[""],Nb=!1;Ab[0].length<qb;){if(0===this.stack.length){this.exhausted=!0;var Db=this.threadID;sa[Db]=sa[0];sa[0]=Db;break}var kb=this.stack[this.stack.length-1];if(Nb||kb.childIndex>=kb.children.length){var ub=
kb.footer;""!==ub&&(this.previousWasTextNode=!1);this.stack.pop();if("select"===kb.type)this.currentSelectValue=null;else if(null!=kb.type&&null!=kb.type.type&&kb.type.type.$$typeof===T)this.popProvider(kb.type);else if(kb.type===ja){this.suspenseDepth--;var zb=Ab.pop();if(Nb){Nb=!1;var ib=kb.fallbackFrame;if(!ib)throw Error(y(303));this.stack.push(ib);Ab[this.suspenseDepth]+="\x3c!--$!--\x3e";continue}else Ab[this.suspenseDepth]+=zb}Ab[this.suspenseDepth]+=ub}else{var rb=kb.children[kb.childIndex++],
Eb="";try{Eb+=this.render(rb,kb.context,kb.domNamespace)}catch(ac){if(null!=ac&&"function"===typeof ac.then)throw Error(y(294));throw ac;}finally{}Ab.length<=this.suspenseDepth&&Ab.push("");Ab[this.suspenseDepth]+=Eb}}return Ab[0]}finally{hb.current=ic,Pa=$b,I()}};yb.render=function(qb,$b,ic){if("string"===typeof qb||"number"===typeof qb){ic=""+qb;if(""===ic)return"";if(this.makeStaticMarkup)return Q(ic);if(this.previousWasTextNode)return"\x3c!-- --\x3e"+Q(ic);this.previousWasTextNode=!0;return Q(ic)}$b=
z(qb,$b,this.threadID);qb=$b.child;$b=$b.context;if(null===qb||!1===qb)return"";if(!M.isValidElement(qb)){if(null!=qb&&null!=qb.$$typeof){ic=qb.$$typeof;if(ic===C)throw Error(y(257));throw Error(y(258,ic.toString()));}qb=$a(qb);this.stack.push({type:null,domNamespace:ic,children:qb,childIndex:0,context:$b,footer:""});return""}var Ab=qb.type;if("string"===typeof Ab)return this.renderDOM(qb,$b,ic);switch(Ab){case ra:case fa:case L:case J:case X:case t:return qb=$a(qb.props.children),this.stack.push({type:null,
domNamespace:ic,children:qb,childIndex:0,context:$b,footer:""}),"";case ja:throw Error(y(294));case ea:throw Error(y(343));}if("object"===typeof Ab&&null!==Ab)switch(Ab.$$typeof){case P:la={};var Nb=Ab.render(qb.props,qb.ref);Nb=r(Ab.render,qb.props,Nb,qb.ref);Nb=$a(Nb);this.stack.push({type:null,domNamespace:ic,children:Nb,childIndex:0,context:$b,footer:""});return"";case aa:return qb=[M.createElement(Ab.type,R({ref:qb.ref},qb.props))],this.stack.push({type:null,domNamespace:ic,children:qb,childIndex:0,
context:$b,footer:""}),"";case T:return Ab=$a(qb.props.children),ic={type:qb,domNamespace:ic,children:Ab,childIndex:0,context:$b,footer:""},this.pushProvider(qb),this.stack.push(ic),"";case S:Ab=qb.type;Nb=qb.props;var Db=this.threadID;B(Ab,Db);Ab=$a(Nb.children(Ab[Db]));this.stack.push({type:qb,domNamespace:ic,children:Ab,childIndex:0,context:$b,footer:""});return"";case ha:throw Error(y(338));case ba:return Ab=qb.type,Nb=Ab._init,Ab=Nb(Ab._payload),qb=[M.createElement(Ab,R({ref:qb.ref},qb.props))],
this.stack.push({type:null,domNamespace:ic,children:qb,childIndex:0,context:$b,footer:""}),""}throw Error(y(130,null==Ab?Ab:typeof Ab,""));};yb.renderDOM=function(qb,$b,ic){var Ab=qb.type.toLowerCase();"http://www.w3.org/1999/xhtml"===ic&&x(Ab);if(!Vc.hasOwnProperty(Ab)){if(!cc.test(Ab))throw Error(y(65,Ab));Vc[Ab]=!0}var Nb=qb.props;if("input"===Ab)Nb=R({type:void 0},Nb,{defaultChecked:void 0,defaultValue:void 0,value:null!=Nb.value?Nb.value:Nb.defaultValue,checked:null!=Nb.checked?Nb.checked:Nb.defaultChecked});
else if("textarea"===Ab){var Db=Nb.value;if(null==Db){Db=Nb.defaultValue;var kb=Nb.children;if(null!=kb){if(null!=Db)throw Error(y(92));if(Array.isArray(kb)){if(!(1>=kb.length))throw Error(y(93));kb=kb[0]}Db=""+kb}null==Db&&(Db="")}Nb=R({},Nb,{value:void 0,children:""+Db})}else if("select"===Ab)this.currentSelectValue=null!=Nb.value?Nb.value:Nb.defaultValue,Nb=R({},Nb,{value:void 0});else if("option"===Ab){kb=this.currentSelectValue;var ub=K(Nb.children);if(null!=kb){var zb=null!=Nb.value?Nb.value+
"":ub;Db=!1;if(Array.isArray(kb))for(var ib=0;ib<kb.length;ib++){if(""+kb[ib]===zb){Db=!0;break}}else Db=""+kb===zb;Nb=R({selected:void 0,children:void 0},Nb,{selected:Db,children:ub})}}if(Db=Nb){if(Lb[Ab]&&(null!=Db.children||null!=Db.dangerouslySetInnerHTML))throw Error(y(137,Ab));if(null!=Db.dangerouslySetInnerHTML){if(null!=Db.children)throw Error(y(60));if(!("object"===typeof Db.dangerouslySetInnerHTML&&"__html"in Db.dangerouslySetInnerHTML))throw Error(y(61));}if(null!=Db.style&&"object"!==
typeof Db.style)throw Error(y(62));}Db=Nb;kb=this.makeStaticMarkup;ub=1===this.stack.length;zb="\x3c"+qb.type;a:if(-1===Ab.indexOf("-"))ib="string"===typeof Db.is;else switch(Ab){case "annotation-xml":case "color-profile":case "font-face":case "font-face-src":case "font-face-uri":case "font-face-format":case "font-face-name":case "missing-glyph":ib=!1;break a;default:ib=!0}for(pd in Db)if(Ic.call(Db,pd)){var rb=Db[pd];if(null!=rb){if("style"===pd){var Eb=void 0,ac="",yc="";for(Eb in rb)if(rb.hasOwnProperty(Eb)){var Fc=
0===Eb.indexOf("--"),kc=rb[Eb];if(null!=kc){if(Fc)var Pc=Eb;else if(Pc=Eb,Tc.hasOwnProperty(Pc))Pc=Tc[Pc];else{var Nc=Pc.replace(ob,"-$1").toLowerCase().replace(jb,"-ms-");Pc=Tc[Pc]=Nc}ac+=yc+Pc+":";yc=Eb;Fc=null==kc||"boolean"===typeof kc||""===kc?"":Fc||"number"!==typeof kc||0===kc||Gb.hasOwnProperty(yc)&&Gb[yc]?(""+kc).trim():kc+"px";ac+=Fc;yc=";"}}rb=ac||null}Eb=null;ib?Lc.hasOwnProperty(pd)||(Eb=pd,Eb=b(Eb)&&null!=rb?Eb+'\x3d"'+(Q(rb)+'"'):""):Eb=h(pd,rb);Eb&&(zb+=" "+Eb)}}kb||ub&&(zb+=' data-reactroot\x3d""');
var pd=zb;Db="";gb.hasOwnProperty(Ab)?pd+="/\x3e":(pd+="\x3e",Db="\x3c/"+qb.type+"\x3e");a:{kb=Nb.dangerouslySetInnerHTML;if(null!=kb){if(null!=kb.__html){kb=kb.__html;break a}}else if(kb=Nb.children,"string"===typeof kb||"number"===typeof kb){kb=Q(kb);break a}kb=null}null!=kb?(Nb=[],Za.hasOwnProperty(Ab)&&"\n"===kb.charAt(0)&&(pd+="\n"),pd+=kb):Nb=$a(Nb.children);qb=qb.type;ic=null==ic||"http://www.w3.org/1999/xhtml"===ic?x(qb):"http://www.w3.org/2000/svg"===ic&&"foreignObject"===qb?"http://www.w3.org/1999/xhtml":
ic;this.stack.push({domNamespace:ic,type:Ab,children:Nb,childIndex:0,context:$b,footer:Db});this.previousWasTextNode=!1;return pd};return Xa}();O.renderToNodeStream=function(){throw Error(y(207));};O.renderToStaticMarkup=function(Xa,yb){Xa=new Sa(Xa,!0,yb);try{return Xa.read(Infinity)}finally{Xa.destroy()}};O.renderToStaticNodeStream=function(){throw Error(y(208));};O.renderToString=function(Xa,yb){Xa=new Sa(Xa,!1,yb);try{return Xa.read(Infinity)}finally{Xa.destroy()}};O.version="17.0.2"};
shadow$provide[631]=function(xa,Z,Ya,O){Ya.exports=Z(629)};
shadow$provide[632]=function(xa,Z,Ya,O){function y(){if(!Jb&&(Jb="undefined"!==typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!Jb))throw Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return Jb(Pb)}function W(c,n=0){return(ad[c[n+0]]+ad[c[n+1]]+ad[c[n+2]]+ad[c[n+3]]+"-"+ad[c[n+4]]+ad[c[n+5]]+"-"+ad[c[n+6]]+ad[c[n+7]]+"-"+ad[c[n+8]]+ad[c[n+9]]+"-"+ad[c[n+10]]+ad[c[n+11]]+ad[c[n+12]]+ad[c[n+13]]+ad[c[n+14]]+
ad[c[n+15]]).toLowerCase()}function B(c){let n=0;var N=0;for(var da of c)n+=da.w*da.h,N=Math.max(N,da.w);c.sort((Ma,fb)=>fb.h-Ma.h);N=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(n/.95)),N),h:Infinity}];let ua=da=0;for(const Ma of c)for(c=N.length-1;0<=c;c--){var Ga=N[c];if(!(Ma.w>Ga.w||Ma.h>Ga.h)){Ma.x=Ga.x;Ma.y=Ga.y;ua=Math.max(ua,Ma.y+Ma.h);da=Math.max(da,Ma.x+Ma.w);Ma.w===Ga.w&&Ma.h===Ga.h?(Ga=N.pop(),c<N.length&&(N[c]=Ga)):Ma.h===Ga.h?(Ga.x+=Ma.w,Ga.w-=Ma.w):(Ma.w!==Ga.w&&N.push({x:Ga.x+Ma.w,y:Ga.y,
w:Ga.w-Ma.w,h:Ma.h}),Ga.y+=Ma.h,Ga.h-=Ma.h);break}}return{w:da,h:ua,fill:n/(da*ua)||0}}function p(c,...n){return{didIntersect:0<n.length,message:c,points:n}}function b(c,n,N=0){const da=[c[0]+n[0]/2,c[1]+n[1]/2],ua=Cd.rotWith(c,da,N),Ga=Cd.rotWith(Cd.add(c,[n[0],0]),da,N),Ma=Cd.rotWith(Cd.add(c,n),da,N);c=Cd.rotWith(Cd.add(c,[0,n[1]]),da,N);return[["top",[ua,Ga]],["right",[Ga,Ma]],["bottom",[Ma,c]],["left",[c,ua]]]}function q(c,n,N,da){const [ua,Ga]=c,[Ma,fb]=n,[vb,Wb]=N,[oc,xc]=da;return fb/Ma!==
(xc-Wb)/(oc-vb)&&(n=Ma*(xc-Wb)-fb*(oc-vb),0!==n&&(c=((Ga-Wb)*(oc-vb)-(ua-vb)*(xc-Wb))/n,n=((Ga-Wb)*Ma-(ua-vb)*fb)/n,0<=c&&0<=n&&1>=n))?p("intersection",[ua+c*Ma,Ga+c*fb]):p("no intersection")}function D(c,n,N,da,ua=0){return a(N,da,ua,c,n)}function E(c,n,N,da=0){const {minX:ua,minY:Ga,width:Ma,height:fb}=N;return D(c,n,[ua,Ga],[Ma,fb],da)}function G(c,n,N,da){var ua=Cd.sub(c,N);N=Cd.sub(da,N);n=Cd.sub(n,c);da=N[0]*ua[1]-N[1]*ua[0];ua=n[0]*ua[1]-n[1]*ua[0];N=N[1]*n[0]-N[0]*n[1];return 0===da||0===
ua?p("coincident"):0===N?p("parallel"):0!==N&&(da/=N,ua/=N,0<=da&&1>=da&&0<=ua&&1>=ua)?p("intersection",Cd.add(c,Cd.mul(n,da))):p("no intersection")}function Q(c,n,N,da){var ua=(n[0]-c[0])*(n[0]-c[0])+(n[1]-c[1])*(n[1]-c[1]),Ga=2*((n[0]-c[0])*(c[0]-N[0])+(n[1]-c[1])*(c[1]-N[1]));N=Ga*Ga-4*ua*(N[0]*N[0]+N[1]*N[1]+c[0]*c[0]+c[1]*c[1]-2*(N[0]*c[0]+N[1]*c[1])-da*da);if(0>N)return p("outside");if(0===N)return p("tangent");da=Math.sqrt(N);N=(-Ga+da)/(2*ua);ua=(-Ga-da)/(2*ua);if((0>N||1<N)&&(0>ua||1<ua))return 0>
N&&0>ua||1<N&&1<ua?p("outside"):p("inside");Ga=[];0<=N&&1>=N&&Ga.push(Cd.lrp(c,n,N));0<=ua&&1>=ua&&Ga.push(Cd.lrp(c,n,ua));return p("intersection",...Ga)}function h(c,n,N,da,ua,Ga=0){if(0===da||0===ua||Cd.isEqual(c,n))return p("no intersection");da=0>da?da:-da;ua=0>ua?ua:-ua;c=Cd.sub(Cd.rotWith(c,N,-Ga),N);n=Cd.sub(Cd.rotWith(n,N,-Ga),N);var Ma=Cd.sub(n,c),fb=Ma[0]*Ma[0]/da/da+Ma[1]*Ma[1]/ua/ua;Ma=2*c[0]*Ma[0]/da/da+2*c[1]*Ma[1]/ua/ua;const vb=[];da=Ma*Ma-4*fb*(c[0]*c[0]/da/da+c[1]*c[1]/ua/ua-1);
0===da?vb.push(-Ma/2/fb):0<da&&(da=Math.sqrt(da),vb.push((-Ma+da)/2/fb),vb.push((-Ma-da)/2/fb));fb=vb.filter(Wb=>0<=Wb&&1>=Wb).map(Wb=>Cd.add(N,Cd.add(c,Cd.mul(Cd.sub(n,c),Wb)))).map(Wb=>Cd.rotWith(Wb,N,Ga));return p("intersection",...fb)}function k(c,n,N){const da=[];for(let ua=1;ua<N.length;ua++){const Ga=G(c,n,N[ua-1],N[ua]);Ga&&da.push(...Ga.points)}return 0===da.length?p("no intersection"):p("intersection",...N)}function a(c,n,N,da,ua){return b(c,n,N).reduce((Ga,[Ma,[fb,vb]])=>{(fb=q(da,ua,fb,
vb))&&Ga.push(p(Ma,...fb.points));return Ga},[]).filter(Ga=>Ga.didIntersect)}function l(c,n,N,da){return b(c,n).reduce((ua,[Ga,[Ma,fb]])=>{(Ma=G(N,da,Ma,fb))&&ua.push(p(Ga,...Ma.points));return ua},[]).filter(ua=>ua.didIntersect)}function m(c,n,N,da){return b(c,n).reduce((ua,[Ga,[Ma,fb]])=>{(Ma=Q(Ma,fb,N,da))&&ua.push(kg(Af({},Ma),{message:Ga}));return ua},[]).filter(ua=>ua.didIntersect)}function r(c,n,N,da,ua,Ga=0){return b(c,n).reduce((Ma,[fb,[vb,Wb]])=>{(vb=h(vb,Wb,N,da,ua,Ga))&&Ma.push(kg(Af({},
vb),{message:fb}));return Ma},[]).filter(Ma=>Ma.didIntersect)}function I(c,n,N){return b(c,n).reduce((da,[ua,[Ga,Ma]])=>{Ga=k(Ga,Ma,N);Ga.didIntersect&&da.push(p(ua,...Ga.points));return da},[]).filter(da=>da.didIntersect)}function A(c,n,N){return b(c,n).reduce((da,[ua,[Ga,Ma]])=>{{const fb=[];for(let vb=1;vb<N.length+1;vb++){const Wb=G(Ga,Ma,N[vb-1],N[vb%N.length]);Wb&&fb.push(...Wb.points)}Ga=0===fb.length?p("no intersection"):p("intersection",...N)}Ga.didIntersect&&da.push(p(ua,...Ga.points));
return da},[]).filter(da=>da.didIntersect)}function w(c,n,N,da=0,ua,Ga){return n===N?m(ua,Ga,c,n):r(ua,Ga,c,n,N,da)}function g(c,n,N){const {minX:da,minY:ua,width:Ga,height:Ma}=c;return l([da,ua],[Ga,Ma],n,N)}function d(c){for(var n=arguments.length,N=Array(1<n?n-1:0),da=1;da<n;da++)N[da-1]=arguments[da];throw Error("number"===typeof c?"[MobX] minified error nr: "+c+(N.length?" "+N.map(String).join(","):"")+". Find the full error at: https://github.com/mobxjs/mobx/blob/main/packages/mobx/src/errors.ts":
"[MobX] "+c);}function H(){return"undefined"!==typeof globalThis?globalThis:"undefined"!==typeof window?window:"undefined"!==typeof xa?xa:"undefined"!==typeof self?self:Ck}function x(){Zy||d("Proxy not available")}function K(c){var n=!1;return function(){if(!n)return n=!0,c.apply(this,arguments)}}function V(c){return"function"===typeof c}function z(c){switch(typeof c){case "string":case "symbol":case "number":return!0}return!1}function R(c){return null!==c&&"object"===typeof c}function M(c){if(!R(c))return!1;
c=Object.getPrototypeOf(c);if(null==c)return!0;c=Object.hasOwnProperty.call(c,"constructor")&&c.constructor;return"function"===typeof c&&c.toString()===$y}function C(c){return(c=null==c?void 0:c.constructor)?"GeneratorFunction"===c.name||"GeneratorFunction"===c.displayName?!0:!1:!1}function t(c,n,N){Yk(c,n,{enumerable:!1,writable:!0,configurable:!0,value:N})}function L(c,n,N){Yk(c,n,{enumerable:!1,writable:!1,configurable:!0,value:N})}function J(c,n){var N="isMobX"+c;n.prototype[N]=!0;return function(da){return R(da)&&
!0===da[N]}}function T(c){return c instanceof Map}function S(c){return c instanceof Set}function P(c){var n=Object.keys(c);if(!mv)return n;var N=Object.getOwnPropertySymbols(c);return N.length?[].concat(n,N.filter(function(da){return yq.propertyIsEnumerable.call(c,da)})):n}function ja(c){return null===c?null:"object"===typeof c?""+c:c}function X(c,n){return yq.hasOwnProperty.call(c,n)}function aa(c,n){for(var N=0;N<n.length;N++){var da=n[N];da.enumerable=da.enumerable||!1;da.configurable=!0;"value"in
da&&(da.writable=!0);Object.defineProperty(c,da.key,da)}}function ba(c,n,N){n&&aa(c.prototype,n);N&&aa(c,N);Object.defineProperty(c,"prototype",{writable:!1});return c}function Y(){Y=Object.assign||function(c){for(var n=1;n<arguments.length;n++){var N=arguments[n],da;for(da in N)Object.prototype.hasOwnProperty.call(N,da)&&(c[da]=N[da])}return c};return Y.apply(this,arguments)}function ha(c,n){c.prototype=Object.create(n.prototype);c.prototype.constructor=c;ea(c,n)}function ea(c,n){ea=Object.setPrototypeOf||
function(N,da){N.__proto__=da;return N};return ea(c,n)}function fa(c){if(void 0===c)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return c}function ra(c,n){if(c){if("string"===typeof c)return wa(c,n);var N=Object.prototype.toString.call(c).slice(8,-1);"Object"===N&&c.constructor&&(N=c.constructor.name);if("Map"===N||"Set"===N)return Array.from(c);if("Arguments"===N||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(N))return wa(c,n)}}function wa(c,n){if(null==
n||n>c.length)n=c.length;for(var N=0,da=Array(n);N<n;N++)da[N]=c[N];return da}function sa(c,n){var N="undefined"!==typeof Symbol&&c[Symbol.iterator]||c["@@iterator"];if(N)return(N=N.call(c)).next.bind(N);if(Array.isArray(c)||(N=ra(c))||n&&c&&"number"===typeof c.length){N&&(c=N);var da=0;return function(){return da>=c.length?{done:!0}:{done:!1,value:c[da++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.");
}function ya(c){return Object.assign(function(n,N){Ja(n,N,c)},c)}function Ja(c,n,N){X(c,Ll)||t(c,Ll,Y({},c[Ll]));N.annotationType_!==bz&&(c[Ll][n]=N)}function Qa(c){X(c,Ll)||t(c,Ll,Y({},c[Ll]));return c[Ll]}function db(c,n,N){void 0===n&&(n=hp);void 0===N&&(N=hp);c=new zq(c);n!==hp&&Qc(qz,c,n,void 0);N!==hp&&qd(c,N);return c}function Ca(c,n,N){return gc(c)?c:Array.isArray(c)?Qg.array(c,{name:N}):M(c)?Qg.object(c,void 0,{name:N}):T(c)?Qg.map(c,{name:N}):S(c)?Qg.set(c,{name:N}):"function"!==typeof c||
Fc(c)||uc(c)?c:C(c)?Eq(c):Dq(N,c)}function Na(c){return c}function Ea(c,n){return{annotationType_:c,options_:n,make_:ka,extend_:la}}function ka(c,n,N,da){var ua;if(null!=(ua=this.options_)&&ua.bound)return null===this.extend_(c,n,N,!1)?0:1;if(da===c.target_)return null===this.extend_(c,n,N,!1)?0:2;if(Fc(N.value))return 1;c=va(c,this,n,N,!1);Yk(da,n,c);return 2}function la(c,n,N,da){N=va(c,this,n,N);return c.defineProperty_(n,N,da)}function va(c,n,N,da,ua){var Ga,Ma,fb,vb,Wb,oc,xc;void 0===ua&&(ua=
Xf.safeDescriptors);da=da.value;if(null!=(Ga=n.options_)&&Ga.bound){var Uc;da=da.bind(null!=(Uc=c.proxy_)?Uc:c.target_)}return{value:Za(null!=(Ma=null==(fb=n.options_)?void 0:fb.name)?Ma:N.toString(),da,null!=(vb=null==(Wb=n.options_)?void 0:Wb.autoAction)?vb:!1,null!=(oc=n.options_)&&oc.bound?null!=(xc=c.proxy_)?xc:c.target_:void 0),configurable:ua?c.isPlainObject_:!0,enumerable:!1,writable:ua?!1:!0}}function ta(c,n){return{annotationType_:c,options_:n,make_:oa,extend_:La}}function oa(c,n,N,da){var ua;
if(da===c.target_)return null===this.extend_(c,n,N,!1)?0:2;if(null!=(ua=this.options_)&&ua.bound&&(!X(c.target_,n)||!uc(c.target_[n]))&&null===this.extend_(c,n,N,!1))return 0;if(uc(N.value))return 1;c=Ta(c,this,n,N,!1,!1);Yk(da,n,c);return 2}function La(c,n,N,da){var ua;N=Ta(c,this,n,N,null==(ua=this.options_)?void 0:ua.bound);return c.defineProperty_(n,N,da)}function Ta(c,n,N,da,ua,Ga){void 0===Ga&&(Ga=Xf.safeDescriptors);n=da.value;uc(n)||(n=Eq(n));if(ua){var Ma;n=n.bind(null!=(Ma=c.proxy_)?Ma:
c.target_);n.isMobXFlow=!0}return{value:n,configurable:Ga?c.isPlainObject_:!0,enumerable:!1,writable:Ga?!1:!0}}function Va(c,n){return{annotationType_:c,options_:n,make_:Pa,extend_:cb}}function Pa(c,n,N){return null===this.extend_(c,n,N,!1)?0:1}function cb(c,n,N,da){return c.defineComputedProperty_(n,Y({},this.options_,{get:N.get,set:N.set}),da)}function gb(c,n){return{annotationType_:c,options_:n,make_:Lb,extend_:Gb}}function Lb(c,n,N){return null===this.extend_(c,n,N,!1)?0:1}function Gb(c,n,N,da){var ua,
Ga;return c.defineObservableProperty_(n,N.value,null!=(ua=null==(Ga=this.options_)?void 0:Ga.enhancer)?ua:Ca,da)}function Da(c){return{annotationType_:"true",options_:c,make_:ob,extend_:jb}}function ob(c,n,N,da){var ua,Ga;if(N.get)return Zg.make_(c,n,N,da);if(N.set){N=Za(n.toString(),N.set);if(da===c.target_)return null===c.defineProperty_(n,{configurable:Xf.safeDescriptors?c.isPlainObject_:!0,set:N})?0:2;Yk(da,n,{configurable:!0,set:N});return 2}if(da!==c.target_&&"function"===typeof N.value){var Ma;
if(C(N.value)){var fb;return(null!=(fb=this.options_)&&fb.autoBind?Eq.bound:Eq).make_(c,n,N,da)}return(null!=(Ma=this.options_)&&Ma.autoBind?Dq.bound:Dq).make_(c,n,N,da)}Ma=!1===(null==(ua=this.options_)?void 0:ua.deep)?Qg.ref:Qg;if("function"===typeof N.value&&null!=(Ga=this.options_)&&Ga.autoBind){var vb;N.value=N.value.bind(null!=(vb=c.proxy_)?vb:c.target_)}return Ma.make_(c,n,N,da)}function jb(c,n,N,da){var ua,Ga;if(N.get)return Zg.extend_(c,n,N,da);if(N.set)return c.defineProperty_(n,{configurable:Xf.safeDescriptors?
c.isPlainObject_:!0,set:Za(n.toString(),N.set)},da);if("function"===typeof N.value&&null!=(ua=this.options_)&&ua.autoBind){var Ma;N.value=N.value.bind(null!=(Ma=c.proxy_)?Ma:c.target_)}return(!1===(null==(Ga=this.options_)?void 0:Ga.deep)?Qg.ref:Qg).extend_(c,n,N,da)}function $a(c){if(!0===c.deep)var n=Ca;else{if(!1===c.deep)c=Na;else{c=c.defaultDecorator;var N;c=c?null!=(n=null==(N=c.options_)?void 0:N.enhancer)?n:Ca:Ca}n=c}return n}function hb(c,n,N){if(z(n))Ja(c,n,nv);else return gc(c)?c:M(c)?
Qg.object(c,n,N):Array.isArray(c)?Qg.array(c,n):T(c)?Qg.map(c,n):S(c)?Qg.set(c,n):"object"===typeof c&&null!==c?c:Qg.box(c,n)}function Za(c,n,N,da){function ua(){a:{var Ga=da||this,Ma=arguments,fb=Xf.trackingDerivation,vb=!N||!fb;Nb();var Wb=Xf.allowStateChanges;vb&&(Xa(),Wb=Vc(!0));var oc=yb(!0),xc=iz++,Uc=zr;zr=xc;try{var md=n.apply(Ga,Ma);break a}catch(Bd){var hd=Bd;throw Bd;}finally{zr!==xc&&d(30),zr=Uc,void 0!==hd&&(Xf.suppressReactionErrors=!0),Xf.allowStateChanges=Wb,Xf.allowStateReads=oc,
Db(),vb&&(Xf.trackingDerivation=fb),Xf.suppressReactionErrors=!1}md=void 0}return md}void 0===N&&(N=!1);ua.isMobxAction=!0;jz&&(sv.value=c,Object.defineProperty(ua,"name",sv));return ua}function cc(c,n){c=Vc(c);try{return n()}finally{Xf.allowStateChanges=c}}function Vc(c){var n=Xf.allowStateChanges;Xf.allowStateChanges=c;return n}function Tc(c){switch(c.dependenciesState_){case Hi.UP_TO_DATE_:return!1;case Hi.NOT_TRACKING_:case Hi.STALE_:return!0;case Hi.POSSIBLY_STALE_:for(var n=yb(!0),N=Xa(),da=
c.observing_,ua=da.length,Ga=0;Ga<ua;Ga++){var Ma=da[Ga];if(Cq(Ma)){if(Xf.disableErrorBoundaries)Ma.get();else try{Ma.get()}catch(fb){return Xf.trackingDerivation=N,Xf.allowStateReads=n,!0}if(c.dependenciesState_===Hi.STALE_)return Xf.trackingDerivation=N,Xf.allowStateReads=n,!0}}qb(c);Xf.trackingDerivation=N;Xf.allowStateReads=n;return!1}}function Ic(c,n,N){var da=yb(!0);qb(c);c.newObserving_=Array(c.observing_.length+100);c.unboundDepsCount_=0;c.runId_=++Xf.runId;var ua=Xf.trackingDerivation;Xf.trackingDerivation=
c;Xf.inBatch++;if(!0===Xf.disableErrorBoundaries)var Ga=n.call(N);else try{Ga=n.call(N)}catch(oc){Ga=new qo(oc)}Xf.inBatch--;Xf.trackingDerivation=ua;var Ma=c.observing_;n=c.observing_=c.newObserving_;N=Hi.UP_TO_DATE_;ua=0;for(var fb=c.unboundDepsCount_,vb=0;vb<fb;vb++){var Wb=n[vb];0===Wb.diffValue_&&(Wb.diffValue_=1,ua!==vb&&(n[ua]=Wb),ua++);Wb.dependenciesState_>N&&(N=Wb.dependenciesState_)}n.length=ua;c.newObserving_=null;for(fb=Ma.length;fb--;)vb=Ma[fb],0===vb.diffValue_&&ic(vb,c),vb.diffValue_=
0;for(;ua--;)Ma=n[ua],1===Ma.diffValue_&&(Ma.diffValue_=0,fb=c,Ma.observers_.add(fb),Ma.lowestObserverState_>fb.dependenciesState_&&(Ma.lowestObserverState_=fb.dependenciesState_));N!==Hi.UP_TO_DATE_&&(c.dependenciesState_=N,c.onBecomeStale_());Xf.allowStateReads=da;return Ga}function Lc(c){var n=c.observing_;c.observing_=[];for(var N=n.length;N--;)ic(n[N],c);c.dependenciesState_=Hi.NOT_TRACKING_}function Sa(c){var n=Xa();try{return c()}finally{Xf.trackingDerivation=n}}function Xa(){var c=Xf.trackingDerivation;
Xf.trackingDerivation=null;return c}function yb(c){var n=Xf.allowStateReads;Xf.allowStateReads=c;return n}function qb(c){if(c.dependenciesState_!==Hi.UP_TO_DATE_){c.dependenciesState_=Hi.UP_TO_DATE_;c=c.observing_;for(var n=c.length;n--;)c[n].lowestObserverState_=Hi.UP_TO_DATE_}}function $b(){(Xf.pendingReactions.length||Xf.inBatch||Xf.isRunningReactions)&&d(36);tv=!0;if(Br){var c=H();0===--c.__mobxInstanceCount&&(c.__mobxGlobals=void 0);Xf=new Ar}}function ic(c,n){c.observers_["delete"](n);0===c.observers_.size&&
Ab(c)}function Ab(c){!1===c.isPendingUnobservation_&&(c.isPendingUnobservation_=!0,Xf.pendingUnobservations.push(c))}function Nb(){Xf.inBatch++}function Db(){if(0===--Xf.inBatch){0<Xf.inBatch||Xf.isRunningReactions||Cr(rb);for(var c=Xf.pendingUnobservations,n=0;n<c.length;n++){var N=c[n];N.isPendingUnobservation_=!1;0===N.observers_.size&&(N.isBeingObserved_&&(N.isBeingObserved_=!1,N.onBUO()),N instanceof Bq&&N.suspend_())}Xf.pendingUnobservations=[]}}function kb(c){var n=Xf.trackingDerivation;if(null!==
n)return n.runId_!==c.lastAccessedBy_&&(c.lastAccessedBy_=n.runId_,n.newObserving_[n.unboundDepsCount_++]=c,!c.isBeingObserved_&&Xf.trackingContext&&(c.isBeingObserved_=!0,c.onBO())),c.isBeingObserved_;0===c.observers_.size&&0<Xf.inBatch&&Ab(c);return!1}function ub(c){c.lowestObserverState_!==Hi.STALE_&&(c.lowestObserverState_=Hi.STALE_,c.observers_.forEach(function(n){if(n.dependenciesState_===Hi.UP_TO_DATE_)n.onBecomeStale_();n.dependenciesState_=Hi.STALE_}))}function zb(c){c.lowestObserverState_!==
Hi.STALE_&&(c.lowestObserverState_=Hi.STALE_,c.observers_.forEach(function(n){n.dependenciesState_===Hi.POSSIBLY_STALE_?n.dependenciesState_=Hi.STALE_:n.dependenciesState_===Hi.UP_TO_DATE_&&(c.lowestObserverState_=Hi.UP_TO_DATE_)}))}function ib(c){c.lowestObserverState_===Hi.UP_TO_DATE_&&(c.lowestObserverState_=Hi.POSSIBLY_STALE_,c.observers_.forEach(function(n){n.dependenciesState_===Hi.UP_TO_DATE_&&(n.dependenciesState_=Hi.POSSIBLY_STALE_,n.onBecomeStale_())}))}function rb(){Xf.isRunningReactions=
!0;for(var c=Xf.pendingReactions,n=0;0<c.length;){++n===nz&&(console.error("[mobx] cycle in reaction: "+c[0]),c.splice(0));for(var N=c.splice(0),da=0,ua=N.length;da<ua;da++)N[da].runReaction_()}Xf.isRunningReactions=!1}function Eb(c){var n=Cr;Cr=function(N){return c(function(){return n(N)})}}function ac(c){console.warn("[mobx.spy] Is a no-op in production builds");return function(){}}function yc(c){return function(n,N){if(V(n))return Za(n.name||"\x3cunnamed action\x3e",n,c);if(V(N))return Za(n,N,
c);if(z(N))return Ja(n,N,c?wv:vv);if(z(n))return ya(Ea(c?"autoAction":uv,{name:n,autoAction:c}))}}function Fc(c){return V(c)&&!0===c.isMobxAction}function kc(c,n){function N(){c(vb)}var da,ua;void 0===n&&(n=Ys);var Ga=null!=(da=null==(ua=n)?void 0:ua.name)?da:"Autorun";if(n.scheduler||n.delay){var Ma=Pc(n),fb=!1;var vb=new kp(Ga,function(){fb||(fb=!0,Ma(function(){fb=!1;vb.isDisposed_||vb.track(N)}))},n.onError,n.requiresObservable)}else vb=new kp(Ga,function(){this.track(N)},n.onError,n.requiresObservable);
vb.schedule_();return vb.getDisposer_()}function Pc(c){return c.scheduler?c.scheduler:c.delay?function(n){return setTimeout(n,c.delay)}:pz}function Nc(c,n,N){function da(){oc=!1;if(!hd.isDisposed_){var Bd=!1;hd.track(function(){var Ld=cc(!1,function(){return c(hd)});Bd=Wb||!md(xc,Ld);Uc=xc;xc=Ld});Wb&&N.fireImmediately?Ma(xc,Uc,hd):!Wb&&Bd&&Ma(xc,Uc,hd);Wb=!1}}var ua;void 0===N&&(N=Ys);var Ga=null!=(ua=N.name)?ua:"Reaction",Ma=Cg(Ga,N.onError?pd(N.onError,n):n),fb=!N.scheduler&&!N.delay,vb=Pc(N),
Wb=!0,oc=!1,xc,Uc,md=N.compareStructural?ip.structural:N.equals||ip["default"],hd=new kp(Ga,function(){Wb||fb?da():oc||(oc=!0,vb(da))},N.onError,N.requiresObservable);hd.schedule_();return hd.getDisposer_()}function pd(c,n){return function(){try{return n.apply(this,arguments)}catch(N){c.call(this,N)}}}function qd(c,n,N){return Qc(rz,c,n,N)}function Qc(c,n,N,da){var ua="function"===typeof da?ia(n,N):ia(n),Ga=V(da)?da:N,Ma=c+"L";ua[Ma]?ua[Ma].add(Ga):ua[Ma]=new Set([Ga]);return function(){var fb=ua[Ma];
fb&&(fb["delete"](Ga),0===fb.size&&delete ua[Ma])}}function pb(c){!0===c.isolateGlobalState&&$b();var n=c.useProxies,N=c.enforceActions;void 0!==n&&(Xf.useProxies="always"===n?!0:"never"===n?!1:"undefined"!==typeof Proxy);"ifavailable"===n&&(Xf.verifyProxies=!0);void 0!==N&&(n="always"===N?"always":"observed"===N,Xf.enforceActions=n,Xf.allowStateChanges=!0===n||"always"===n?!1:!0);["computedRequiresReaction","reactionRequiresObservable","observableRequiresReaction","disableErrorBoundaries","safeDescriptors"].forEach(function(da){da in
c&&(Xf[da]=!!c[da])});Xf.allowStateReads=!Xf.observableRequiresReaction;c.reactionScheduler&&Eb(c.reactionScheduler)}function Ac(c,n,N,da){var ua=az(n),Ga=ld(c,da)[Eh];Nb();try{yr(ua).forEach(function(Ma){Ga.extend_(Ma,ua[Ma],N?Ma in N?N[Ma]:!0:!0)})}finally{Db()}return c}function Sb(c){var n={name:c.name_};c.observing_&&0<c.observing_.length&&(n.dependencies=Array.from(new Set(c.observing_)).map(Sb));return n}function Bc(){this.message="FLOW_CANCELLED"}function uc(c){return!0===(null==c?void 0:c.isMobXFlow)}
function gc(c,n){return c?void 0!==n?Kb(c)?c[Eh].values_.has(n):!1:Kb(c)||!!c[Eh]||Zs(c)||Dr(c)||Cq(c):!1}function ec(c){if(Kb(c))return c[Eh].ownKeys_();d(38)}function Xb(c,n,N){c.set(n,N);return N}function nc(c,n){if(null==c||"object"!==typeof c||c instanceof Date||!gc(c))return c;if(lz(c)||Cq(c))return nc(c.get(),n);if(n.has(c))return n.get(c);if(Mc(c)){var N=Xb(n,c,Array(c.length));c.forEach(function(Ma,fb){N[fb]=nc(Ma,n)});return N}if(ro(c)){var da=Xb(n,c,new Set);c.forEach(function(Ma){da.add(nc(Ma,
n))});return da}if(kn(c)){var ua=Xb(n,c,new Map);c.forEach(function(Ma,fb){ua.set(fb,nc(Ma,n))});return ua}var Ga=Xb(n,c,{});ec(c).forEach(function(Ma){yq.propertyIsEnumerable.call(c,Ma)&&(Ga[Ma]=nc(c[Ma],n))});return Ga}function Bb(c,n){return nc(c,new Map)}function Qb(){d("trace() is not available in production builds");for(var c=!1,n=arguments.length,N=Array(n),da=0;da<n;da++)N[da]=arguments[da];"boolean"===typeof N[N.length-1]&&(c=N.pop());a:{switch(N.length){case 0:n=Xf.trackingDerivation;break a;
case 1:n=ia(N[0]);break a;case 2:n=ia(N[0],N[1]);break a}n=void 0}if(!n)return d("'trace(break?)' can only be used inside a tracked computed value or a Reaction. Consider passing in the computed value or reaction explicitly");n.isTracing_===jp.NONE&&console.log("[mobx.trace] '"+n.name_+"' tracing enabled");n.isTracing_=c?jp.BREAK:jp.LOG}function pc(c,n){void 0===n&&(n=void 0);Nb();try{return c.apply(n)}finally{Db()}}function sb(c){return void 0!==c.interceptors_&&0<c.interceptors_.length}function Ib(c,
n){var N=c.interceptors_||(c.interceptors_=[]);N.push(n);return K(function(){var da=N.indexOf(n);-1!==da&&N.splice(da,1)})}function lb(c,n){var N=Xa();try{var da=[].concat(c.interceptors_||[]);c=0;for(var ua=da.length;c<ua&&((n=da[c](n))&&!n.type&&d(14),n);c++);return n}finally{Xf.trackingDerivation=N}}function Mb(c){return void 0!==c.changeListeners_&&0<c.changeListeners_.length}function Fb(c,n){var N=c.changeListeners_||(c.changeListeners_=[]);N.push(n);return K(function(){var da=N.indexOf(n);-1!==
da&&N.splice(da,1)})}function hc(c,n){var N=Xa();if(c=c.changeListeners_){c=c.slice();for(var da=0,ua=c.length;da<ua;da++)c[da](n);Xf.trackingDerivation=N}}function Ec(c,n,N){var da=ld(c,N)[Eh];Nb();try{var ua;null!=(ua=n)?ua:n=Qa(c);yr(n).forEach(function(Ga){return da.make_(Ga,n[Ga])})}finally{Db()}return c}function bb(c,n,N,da){void 0===N&&(N="ObservableArray");void 0===da&&(da=!1);x();n=new $s(N,n,da,!1);L(n.values_,Eh,n);N=new Proxy(n.values_,vz);n.proxy_=N;c&&c.length&&(da=Vc(!0),n.spliceWithArray_(0,
0,c),Xf.allowStateChanges=da);return N}function eb(c,n){"function"===typeof Array.prototype[c]&&(Er[c]=n(c))}function Ua(c){return function(){var n=this[Eh];n.atom_.reportObserved();n=n.dehanceValues_(n.values_);return n[c].apply(n,arguments)}}function mb(c){return function(n,N){var da=this,ua=this[Eh];ua.atom_.reportObserved();return ua.dehanceValues_(ua.values_)[c](function(Ga,Ma){return n.call(N,Ga,Ma,da)})}}function Cb(c){return function(){var n=this,N=this[Eh];N.atom_.reportObserved();N=N.dehanceValues_(N.values_);
var da=arguments[0];arguments[0]=function(ua,Ga,Ma){return da(ua,Ga,Ma,n)};return N[c].apply(N,arguments)}}function Mc(c){return R(c)&&wz(c[Eh])}function dd(c){if(T(c)||kn(c))return c;if(Array.isArray(c))return new Map(c);if(M(c)){var n=new Map,N;for(N in c)n.set(N,c[N]);return n}return d(21,c)}function ld(c,n){var N;if(X(c,Eh))return c;var da=null!=(N=null==n?void 0:n.name)?N:"ObservableObject";N=Cv;var ua=new Map;da=String(da);var Ga;var Ma=n?null!=(Ga=n.defaultDecorator)?Ga:Da(n):void 0;n=new N(c,
ua,da,Ma);t(c,Eh,n);return c}function Nd(c){return Bv[c]||(Bv[c]={get:function(){return this[Eh].getObservablePropValue_(c)},set:function(n){return this[Eh].setObservablePropValue_(c,n)}})}function Kb(c){return R(c)?Dz(c[Eh]):!1}function Aa(c){return{enumerable:!1,configurable:!0,get:function(){return this[Eh].get_(c)},set:function(n){this[Eh].set_(c,n)}}}function qa(c){if(c>at){for(var n=at;n<c+100;n++)Yk(bt.prototype,""+n,Aa(n));at=c}}function f(c,n,N){return new bt(c,n,N)}function ia(c,n){if("object"===
typeof c&&null!==c){if(Mc(c))return void 0!==n&&d(23),c[Eh].atom_;if(ro(c))return c[Eh];if(kn(c)){if(void 0===n)return c.keysAtom_;var N=c.data_.get(n)||c.hasMap_.get(n);N||d(25,n,Ka(c));return N}if(Kb(c)){if(!n)return d(26);(N=c[Eh].values_.get(n))||d(27,n,Ka(c));return N}if(Zs(c)||Cq(c)||Dr(c))return c}else if(V(c)&&Dr(c[Eh]))return c[Eh];d(28)}function Wa(c,n){c||d(29);if(void 0!==n)return Wa(ia(c,n));if(Zs(c)||Cq(c)||Dr(c)||kn(c)||ro(c))return c;if(c[Eh])return c[Eh];d(24,c)}function Ka(c,n){if(void 0!==
n)c=ia(c,n);else{if(Fc(c))return c.name;c=Kb(c)||kn(c)||ro(c)?Wa(c):ia(c)}return c.name_}function ma(c,n,N){void 0===N&&(N=-1);return pa(c,n,N)}function pa(c,n,N,da,ua){if(c===n)return 0!==c||1/c===1/n;if(null==c||null==n)return!1;if(c!==c)return n!==n;var Ga=typeof c;if("function"!==Ga&&"object"!==Ga&&"object"!=typeof n)return!1;Ga=Ev.call(c);if(Ga!==Ev.call(n))return!1;switch(Ga){case "[object RegExp]":case "[object String]":return""+c===""+n;case "[object Number]":return+c!==+c?+n!==+n:0===+c?
1/+c===1/n:+c===+n;case "[object Date]":case "[object Boolean]":return+c===+n;case "[object Symbol]":return"undefined"!==typeof Symbol&&Symbol.valueOf.call(c)===Symbol.valueOf.call(n);case "[object Map]":case "[object Set]":0<=N&&N++}c=Fa(c);n=Fa(n);Ga="[object Array]"===Ga;if(!Ga){if("object"!=typeof c||"object"!=typeof n)return!1;var Ma=c.constructor,fb=n.constructor;if(Ma!==fb&&!(V(Ma)&&Ma instanceof Ma&&V(fb)&&fb instanceof fb)&&"constructor"in c&&"constructor"in n)return!1}if(0===N)return!1;
0>N&&(N=-1);da=da||[];ua=ua||[];for(Ma=da.length;Ma--;)if(da[Ma]===c)return ua[Ma]===n;da.push(c);ua.push(n);if(Ga){Ma=c.length;if(Ma!==n.length)return!1;for(;Ma--;)if(!pa(c[Ma],n[Ma],N-1,da,ua))return!1}else{Ga=Object.keys(c);Ma=Ga.length;if(Object.keys(n).length!==Ma)return!1;for(;Ma--;)if(fb=Ga[Ma],!X(n,fb)||!pa(c[fb],n[fb],N-1,da,ua))return!1}da.pop();ua.pop();return!0}function Fa(c){return Mc(c)?c.slice():T(c)||kn(c)||S(c)||ro(c)?Array.from(c.entries()):c}function ab(c){c[Symbol.iterator]=Ob;
return c}function Ob(){return this}function tc(c,n){const N=new Set(n),da=Object.values(c),ua=new Set(da.filter(Ga=>N.has(Ga.toId)||N.has(Ga.fromId)));c=ua.size;for(n=-1;0!==n;)ua.forEach(Ga=>{Ga=Ga.fromId;for(const Ma of da)Ma.fromId===Ga&&ua.add(Ma),Ma.toId===Ga&&ua.add(Ma)}),n=ua.size-c,c=ua.size;return Array.from(ua.values())}function Yc(c,n,N,da,ua,Ga,Ma,fb){if(ua=n.getBindingPoint(ua,Ga,Ma,fb))return{id:da,type:"line",fromId:c.id,toId:n.id,handleId:N,point:pe.toFixed(ua.point),distance:ua.distance}}
function td(c,n){const N=c.getCenter(),da=n.getCenter();var ua=Me();ua=kg(Af({},Fq.defaultProps),{id:ua,type:Fq.id,parentId:c.props.parentId,point:N});c=Yc(ua,c,"start",Me(),N,N,pe.uni(pe.sub(da,N)),!1);n=Yc(ua,n,"end",Me(),da,da,pe.uni(pe.sub(N,da)),!1);return c&&n?(ua.handles.start.point=[0,0],ua.handles.end.point=pe.sub(da,N),ua.handles.start.bindingId=c.id,ua.handles.end.bindingId=n.id,[ua,[c,n]]):null}function ke(){return new Mz}function Ae(){return new WeakMap}function He(c){if(!c)return jt(null);
var n=c.constructor;if(n===Object)return c===Object.prototype?{}:jt(c);if(~Kz.call(n).indexOf("[native code]"))try{return new n}catch(N){}return jt(c)}function Cf(c){var n="";c.global&&(n+="g");c.ignoreCase&&(n+="i");c.multiline&&(n+="m");c.unicode&&(n+="u");c.sticky&&(n+="y");return n}function lf(c){return c.flags}function Uf(c){c=Lz.call(c);return c.substring(8,c.length-1)}function gf(c){return c[Symbol.toStringTag]||Uf(c)}function sg(c){return qw(c).concat(kt(c))}function Ag(c,n,N){for(var da=
Tz(c),ua=0,Ga=da.length,Ma,fb;ua<Ga;++ua)if(Ma=da[ua],"callee"!==Ma&&"caller"!==Ma)if(fb=Rz(c,Ma)){fb.get||fb.set||(fb.value=N.copier(fb.value,N));try{Qz(n,Ma,fb)}catch(vb){n[Ma]=fb.value}}else n[Ma]=N.copier(c[Ma],N);return n}function Fg(c,n){var N=new n.Constructor;n.cache.set(c,N);c.forEach(function(da,ua){N.set(ua,n.copier(da,n))});return N}function Rf(c,n){var N=He(n.prototype);n.cache.set(c,N);for(var da in c)sw.call(c,da)&&(N[da]=n.copier(c[da],n));return N}function tg(c,n){var N=He(n.prototype);
n.cache.set(c,N);for(var da in c)sw.call(c,da)&&(N[da]=n.copier(c[da],n));da=kt(c);for(var ua=0,Ga=da.length,Ma;ua<Ga;++ua)Ma=da[ua],Sz.call(c,Ma)&&(N[Ma]=n.copier(c[Ma],n));return N}function Hh(c,n){return new n.Constructor(c.valueOf())}function oh(c,n){return c}function $h(c,n){var N=new n.Constructor;n.cache.set(c,N);c.forEach(function(da){N.add(n.copier(da,n))});return N}function qi(c){function n(Ga,Ma){Ma.prototype=Ma.Constructor=void 0;if(!Ga||"object"!==typeof Ga)return Ga;if(Ma.cache.has(Ga))return Ma.cache.get(Ga);
Ma.prototype=Ga.__proto__||Vz(Ga);Ma.Constructor=Ma.prototype&&Ma.prototype.constructor;if(!Ma.Constructor||Ma.Constructor===Object)return ua(Ga,Ma);if(Uz(Ga))return da(Ga,Ma);var fb=N[Pz(Ga)];return fb?fb(Ga,Ma):"function"===typeof Ga.then?Ga:ua(Ga,Ma)}c=lt({},uw,c);var N={Arguments:c.object,Array:c.array,ArrayBuffer:c.arrayBuffer,Blob:c.blob,Boolean:Hh,DataView:c.dataView,Date:c.date,Error:c.error,Float32Array:c.arrayBuffer,Float64Array:c.arrayBuffer,Int8Array:c.arrayBuffer,Int16Array:c.arrayBuffer,
Int32Array:c.arrayBuffer,Map:c.map,Number:Hh,Object:c.object,Promise:oh,RegExp:c.regExp,Set:c.set,String:Hh,WeakMap:oh,WeakSet:oh,Uint8Array:c.arrayBuffer,Uint8ClampedArray:c.arrayBuffer,Uint16Array:c.arrayBuffer,Uint32Array:c.arrayBuffer,Uint64Array:c.arrayBuffer},da=N.Array,ua=N.Object;return function(Ga){return n(Ga,{Constructor:void 0,cache:Nz(),copier:n,prototype:void 0})}}function yi(c,n){return(0,Zz.default)(c,n,{arrayMerge:(N,da,ua)=>da})}function Wi(c,n,N,da=!1){const [ua,Ga]=n,[Ma,fb]=N;
c=Ma+(c-ua)/(Ga-ua)*(fb-Ma);return da?Ma<fb?Math.max(Math.min(c,fb),Ma):Math.max(Math.min(c,Ma),fb):c}function ci(c,n){return new Promise((N,da)=>{if("video"===n){const ua=document.createElement("video");ua.addEventListener("loadedmetadata",function(){N([this.videoWidth,this.videoHeight])},!1);ua.src=c}else if("image"===n){const ua=new Image;ua.onload=()=>N([ua.width,ua.height]);ua.src=c;ua.onerror=Ga=>da(Ga)}else"pdf"===n&&N([595,842])})}function tf(c){return Object.values(Oa).includes(c)}function rf(c,
n){return tf(c)||null==c?`var(--ls-wb-${n}-color-${c?c:"default"})`:c}function hf(){var c;null==(c=document.getElementById("__textLabelMeasure"))?void 0:c.remove();c=document.createElement("pre");c.id="__textLabelMeasure";Object.assign(c.style,{whiteSpace:"pre",width:"auto",borderLeft:"2px solid transparent",borderRight:"1px solid transparent",borderBottom:"2px solid transparent",padding:"0px",margin:"0px",opacity:"0",position:"absolute",top:"-500px",left:"0px",zIndex:"9999",userSelect:"none",pointerEvents:"none",
font:"var(--ls-font-family)"});c.tabIndex=-1;document.body.appendChild(c);return c}function eg(c,n,N=0){var da,ua,Ga;if(!c)return[16,32];let Ma;Ma="string"===typeof n?n:`${null!=(da=n.fontStyle)?da:"normal"} ${null!=(ua=n.fontVariant)?ua:"normal"} ${null!=(Ga=n.fontWeight)?Ga:"normal"} ${n.fontSize}px/${n.fontSize*n.lineHeight}px ${n.fontFamily}`;if(!mt.has(`${c}-${Ma}-${N}`)){if(!on)return[10,10];on.parentNode||document.body.appendChild(on);on.innerHTML=`${c}&#8203;`;on.style.font=Ma;on.style.padding=
N+"px";n=on.getBoundingClientRect();mt.set(`${c}-${Ma}-${N}`,[Math.ceil(n.width||1),Math.ceil(n.height||1)])}return mt.get(`${c}-${Ma}-${N}`)}function og(c){try{if("string"!==typeof c||!vc.test(c))throw TypeError("Invalid UUID");let n;const N=new Uint8Array(16);N[0]=(n=parseInt(c.slice(0,8),16))>>>24;N[1]=n>>>16&255;N[2]=n>>>8&255;N[3]=n&255;N[4]=(n=parseInt(c.slice(9,13),16))>>>8;N[5]=n&255;N[6]=(n=parseInt(c.slice(14,18),16))>>>8;N[7]=n&255;N[8]=(n=parseInt(c.slice(19,23),16))>>>8;N[9]=n&255;N[10]=
(n=parseInt(c.slice(24,36),16))/1099511627776&255;N[11]=n/4294967296&255;N[12]=n>>>24&255;N[13]=n>>>16&255;N[14]=n>>>8&255;N[15]=n&255;return!0}catch(n){return!1}}function lg(c,n=0,N){let da;return function(...ua){null==N?void 0:N(...ua);clearTimeout(da);da=setTimeout(()=>c.apply(ua),n)}}function Ub(){return/Mac|iPod|iPhone|iPad/.test(window.navigator.platform)}function fc(){var c,n,N;return(null==(N=null==(n=null==(c=null==window?void 0:window.logseq)?void 0:c.api)?void 0:n.get_state_from_store)?
void 0:N.call(n,"ui/developer-mode?"))||!1}function Kc(c){return!!c}function Gc(c=0){return new Promise(n=>setTimeout(n,c))}function cd(c="noid"){nt[c]||(nt[c]=xw.createContext({}));return nt[c]}function od(c="noid"){return xw.useContext(cd(c))}function Vd(c){const {callbacks:n}=od(),N=ww.useRef(-1);return ww.useMemo(()=>{const da=ua=>{var Ga,Ma;const {order:fb=0}=ua;if(!fb){var vb=ua.target;vb.removeEventListener("pointerup",da);vb.releasePointerCapture(ua.pointerId);null==(Ga=n.onPointerUp)?void 0:
Ga.call(n,{type:"selection",handle:c,order:fb},ua);Ga=Date.now();vb=Ga-N.current;300<vb?N.current=Ga:300>=vb&&(null==(Ma=n.onDoubleClick)?void 0:Ma.call(n,{type:"selection",handle:c,order:fb},ua),N.current=-1);ua.order=fb+1}};return{onPointerDown:ua=>{var Ga;const {order:Ma=0}=ua;if(!Ma){var fb=ce(ua.currentTarget);fb.setPointerCapture(ua.pointerId);fb.addEventListener("pointerup",da);null==(Ga=n.onPointerDown)?void 0:Ga.call(n,{type:"selection",handle:c,order:Ma},ua);ua.order=Ma+1}},onPointerMove:ua=>
{var Ga;const {order:Ma=0}=ua;Ma||(null==(Ga=n.onPointerMove)?void 0:Ga.call(n,{type:"selection",handle:c,order:Ma},ua),ua.order=Ma+1)},onPointerEnter:ua=>{var Ga;const {order:Ma=0}=ua;Ma||(null==(Ga=n.onPointerEnter)?void 0:Ga.call(n,{type:"selection",handle:c,order:Ma},ua),ua.order=Ma+1)},onPointerLeave:ua=>{var Ga;const {order:Ma=0}=ua;Ma||(null==(Ga=n.onPointerLeave)?void 0:Ga.call(n,{type:"selection",handle:c,order:Ma},ua),ua.order=Ma+1)},onKeyDown:ua=>{var Ga;null==(Ga=n.onKeyDown)?void 0:Ga.call(n,
{type:"selection",handle:c,order:-1},ua)},onKeyUp:ua=>{var Ga;null==(Ga=n.onKeyUp)?void 0:Ga.call(n,{type:"selection",handle:c,order:-1},ua)}}},[n])}function ce(c){var n;if(null==(n=c.namespaceURI)?0:n.endsWith("svg")){if(c.parentElement)return ce(c.parentElement);throw Error("Could not find a parent element of an HTML type!");}return c}function se(c,n,N){const da=Hq.useRef(!1),ua=Hq.useCallback(()=>{var Ga;if(da.current){const Ma=null==(Ga=c.current)?void 0:Ga.getBoundingClientRect();Ma&&(Ga={minX:Ma.left,
maxX:Ma.left+Ma.width,minY:Ma.top,maxY:Ma.top+Ma.height,width:Ma.width,height:Ma.height},n.updateBounds(Ga),null==N?void 0:N(Ga))}else da.current=!0},[c,N]);Hq.useEffect(()=>{const Ga=c.current?bA(c.current):document,Ma=lg(ua,100);Ga.addEventListener("scroll",Ma);window.addEventListener("resize",Ma);return()=>{Ga.removeEventListener("scroll",Ma);window.removeEventListener("resize",Ma)}},[]);Hq.useLayoutEffect(()=>{const Ga=new ResizeObserver(Ma=>{Ma[0].contentRect&&ua()});c.current&&Ga.observe(c.current);
return()=>{Ga.disconnect()}},[c]);Hq.useEffect(()=>{ua();setTimeout(()=>{var Ga,Ma;null==(Ma=null==(Ga=c.current)?void 0:Ga.querySelector(".tl-canvas"))?void 0:Ma.focus()})},[c])}function Qe(c,n){return Object.keys(n).reduce((N,da)=>{const ua=n[da];return ua?N+`${`--${c}-${da}`}: ${ua};
`:N},"")}function Qd(c,n,N=".logseq-tldraw"){ot.useLayoutEffect(()=>{const da=document.createElement("style"),ua=Qe(c,n);da.setAttribute("id",`${c}-theme`);da.setAttribute("data-selector",N);da.innerHTML=`
        ${N} {
          ${ua}
        }
      `;document.head.appendChild(da);return()=>{da&&document.head.contains(da)&&document.head.removeChild(da)}},[c,n,N])}function Se(c,n){ot.useLayoutEffect(()=>{if(pt.get(c))return()=>{};const N=document.createElement("style");N.innerHTML=n;N.setAttribute("id",c);document.head.appendChild(N);pt.set(c,N);return()=>{N&&document.head.contains(N)&&(document.head.removeChild(N),pt.delete(c))}},[c,n])}function le(c,n){const N=ot.useMemo(()=>Af(Af({},cA),c),[c]);Qd("tl",N,n);Se("tl-canvas",dA)}function Ie(c=
"noid"){qt[c]||(qt[c]=zw.createContext({}));return qt[c]}function Te(c="noid"){return zw.useContext(Ie(c))}function $f(){const c=Te(),{callbacks:n}=od(),N=yw.useRef(-1);return yw.useMemo(()=>({onPointerDown:da=>{var ua,Ga,Ma;if(!c.settings.penMode||"pen"===da.pointerType&&da.isPrimary){var {order:fb=0}=da;fb||(null==(ua=da.currentTarget)?void 0:ua.setPointerCapture(da.pointerId));da.isPrimary&&(null==(Ga=n.onPointerDown)?void 0:Ga.call(n,{type:"canvas",order:fb},da),ua=Date.now(),Ga=ua-N.current,
300<Ga?N.current=ua:300>=Ga&&(null==(Ma=n.onDoubleClick)?void 0:Ma.call(n,{type:"canvas",order:fb},da),N.current=-1))}},onPointerMove:da=>{var ua;if(!c.settings.penMode||"pen"===da.pointerType&&da.isPrimary){var {order:Ga=0}=da;null==(ua=n.onPointerMove)?void 0:ua.call(n,{type:"canvas",order:Ga},da)}},onPointerUp:da=>{var ua,Ga;if(!c.settings.penMode||"pen"===da.pointerType&&da.isPrimary){var {order:Ma=0}=da;Ma||(null==(ua=da.currentTarget)?void 0:ua.releasePointerCapture(da.pointerId));null==(Ga=
n.onPointerUp)?void 0:Ga.call(n,{type:"canvas",order:Ma},da)}},onPointerEnter:da=>{var ua;if(!c.settings.penMode||"pen"===da.pointerType&&da.isPrimary){var {order:Ga=0}=da;null==(ua=n.onPointerEnter)?void 0:ua.call(n,{type:"canvas",order:Ga},da)}},onPointerLeave:da=>{var ua;if(!c.settings.penMode||"pen"===da.pointerType&&da.isPrimary){var {order:Ga=0}=da;null==(ua=n.onPointerLeave)?void 0:ua.call(n,{type:"canvas",order:Ga},da)}},onDrop:da=>Zh(this,null,function*(){da.preventDefault();"clientX"in da&&
c.drop(da.dataTransfer,[da.clientX,da.clientY])}),onDragOver:da=>{da.preventDefault()},onTouchEnd:da=>{let ua=c.selectedTool.id;"pencil"!==ua&&"highlighter"!==ua||da.preventDefault()}}),[n])}function we(c,n,N){return 0===n||Infinity===Math.abs(n)?Math.pow(c,5*N):c*n*N/(n+N*c)}function Nf(c,n,N,da=.15){return 0===da?Math.max(n,Math.min(c,N)):c<n?-we(n-c,N-n,da)+n:c>N?+we(c-N,N-n,da)+N:c}function Pf(c,[n,N],[da,ua]){const [[Ga,Ma],[fb,vb]]=c;return[Nf(n,Ga,Ma,da),Nf(N,fb,vb,ua)]}function yf(c,n,N){n in
c?Object.defineProperty(c,n,{value:N,enumerable:!0,configurable:!0,writable:!0}):c[n]=N;return c}function Lg(c,n){var N=Object.keys(c);if(Object.getOwnPropertySymbols){var da=Object.getOwnPropertySymbols(c);n&&(da=da.filter(function(ua){return Object.getOwnPropertyDescriptor(c,ua).enumerable}));N.push.apply(N,da)}return N}function wf(c){for(var n=1;n<arguments.length;n++){var N=null!=arguments[n]?arguments[n]:{};n%2?Lg(Object(N),!0).forEach(function(da){yf(c,da,N[da])}):Object.getOwnPropertyDescriptors?
Object.defineProperties(c,Object.getOwnPropertyDescriptors(N)):Lg(Object(N)).forEach(function(da){Object.defineProperty(c,da,Object.getOwnPropertyDescriptor(N,da))})}return c}function ug(c){return c?c[0].toUpperCase()+c.slice(1):""}function Nh(c=!1,n){return c&&!eA.includes(n)}function vg(c,n="",N=!1){const da=Aw[c];n=da?da[n]||n:n;return"on"+ug(c)+ug(n)+(Nh(N,n)?"Capture":"")}function Sf(c){c=c.substring(2).toLowerCase();const n=!!~c.indexOf("passive");n&&(c=c.replace("passive",""));var N=fA.includes(c)?
"capturecapture":"capture";(N=!!~c.indexOf(N))&&(c=c.replace("capture",""));return{device:c,capture:N,passive:n}}function ni(c,n=""){const N=Aw[c];return c+(N?N[n]||n:n)}function Sg(c){return"touches"in c?"touch":"pointerType"in c?c.pointerType:"mouse"}function di(c){return Array.from(c.touches).filter(n=>{var N,da;return n.target===c.currentTarget||(null===(N=c.currentTarget)||void 0===N?void 0:null===(da=N.contains)||void 0===da?void 0:da.call(N,n.target))})}function th(c){return"touches"in c?("touchend"===
c.type||"touchcancel"===c.type?c.changedTouches:c.targetTouches)[0]:c}function of(c,n){const N=n.clientX-c.clientX,da=n.clientY-c.clientY;return{angle:-(180*Math.atan2(N,da))/Math.PI,distance:Math.hypot(N,da),origin:[(n.clientX+c.clientX)/2,(n.clientY+c.clientY)/2]}}function jf(c){return di(c).map(n=>n.identifier)}function mf(c,n){const [N,da]=Array.from(c.touches).filter(ua=>n.includes(ua.identifier));return of(N,da)}function Gg(c){const n=th(c);return"touches"in c?n.identifier:n.pointerId}function zf(c){c=
th(c);return[c.clientX,c.clientY]}function Oh(c){let {deltaX:n,deltaY:N,deltaMode:da}=c;1===da?(n*=40,N*=40):2===da&&(n*=800,N*=800);return[n,N]}function ih(c,...n){return"function"===typeof c?c(...n):c}function uh(){}function bc(...c){return 0===c.length?uh:1===c.length?c[0]:function(){let n;for(const N of c)n=N.apply(this,arguments)||n;return n}}function rc([c,n],N){c=Math.abs(c);n=Math.abs(n);if(c>n&&c>N)return"x";if(n>c&&n>N)return"y"}function fd(c){const [n,N]=c.overflow,[da,ua]=c._delta,[Ga,
Ma]=c._direction;if(0>n&&0<da&&0>Ga||0<n&&0>da&&0<Ga)c._movement[0]=c._movementBound[0];if(0>N&&0<ua&&0>Ma||0<N&&0>ua&&0<Ma)c._movement[1]=c._movementBound[1]}function sd(c){rt.set(c.key,c.engine);st.set(c.key,c.resolver)}function Od(c={},n){const N={};for(const [da,ua]of Object.entries(n))switch(typeof ua){case "function":N[da]=ua.call(N,c[da],da,c);break;case "object":N[da]=Od(c[da],ua);break;case "boolean":ua&&(N[da]=c[da])}return N}function Xd(c,n,N={}){const {target:da,eventOptions:ua,window:Ga,
enabled:Ma,transform:fb}=c;var vb=CA;if(null==c)c={};else{if(null==c)var Wb={};else{Wb={};var oc=Object.keys(c),xc;for(xc=0;xc<oc.length;xc++){var Uc=oc[xc];0<=vb.indexOf(Uc)||(Wb[Uc]=c[Uc])}}if(Object.getOwnPropertySymbols)for(xc=Object.getOwnPropertySymbols(c),Uc=0;Uc<xc.length;Uc++)oc=xc[Uc],0<=vb.indexOf(oc)||Object.prototype.propertyIsEnumerable.call(c,oc)&&(Wb[oc]=c[oc]);c=Wb}N.shared=Od({target:da,eventOptions:ua,window:Ga,enabled:Ma,transform:fb},BA);if(n){var md=st.get(n);N[n]=Od(wf({shared:N.shared},
c),md)}else for(md in c)(n=st.get(md))&&(N[md]=Od(wf({shared:N.shared},c[md]),n));return N}function fe(c,n){c.gestures.add(n);c.gestureEventStores[n]=new Iw(c,n);c.gestureTimeoutStores[n]=new DA}function je(c,n,N,da,ua,Ga){if(c.has(N)&&rt.has(da)){var Ma=N+"Start",fb=N+"End";ua[da]=vb=>{let Wb=void 0;if(vb.first&&Ma in n)n[Ma](vb);N in n&&(Wb=n[N](vb));if(vb.last&&fb in n)n[fb](vb);return Wb};Ga[da]=Ga[da]||{}}}function zd(c,n={},N,da){const ua=tt.default.useMemo(()=>new EA(c),[]);ua.applyHandlers(c,
da);ua.applyConfig(n,N);tt.default.useEffect(ua.effect.bind(ua));tt.default.useEffect(()=>ua.clean.bind(ua),[]);if(void 0===n.target)return ua.bind.bind(ua)}function ye(c){c.forEach(sd);return function(n,N){N=N||{};const da={},ua={},Ga=new Set;for(let Uc in n)FA.test(Uc)?(Ga.add(RegExp.lastMatch),ua[Uc]=n[Uc]):da[Uc]=n[Uc];const [Ma,fb,vb]=[ua,da,Ga];n={};je(vb,Ma,"onDrag","drag",n,N);je(vb,Ma,"onWheel","wheel",n,N);je(vb,Ma,"onScroll","scroll",n,N);je(vb,Ma,"onPinch","pinch",n,N);je(vb,Ma,"onMove",
"move",n,N);je(vb,Ma,"onHover","hover",n,N);const {handlers:Wb,nativeHandlers:oc,config:xc}={handlers:n,config:N,nativeHandlers:fb};return zd(Wb,xc,void 0,oc)}}function De(c,n){return ye([vA,yA,zA,AA,xA,wA])(c,n||{})}function Ne(c){const {viewport:n,inputs:N,callbacks:da}=od(),ua=Jr.useRef(void 0),Ga=Jr.useRef([0,0]),Ma=Jr.useRef(0),fb=Jr.useMemo(()=>({onWheel:vb=>{var Wb;({event:vb}=vb);vb.preventDefault();const {deltaY:oc,deltaX:xc}=vb;var Uc=0;if(vb.ctrlKey||vb.metaKey){Uc=Math.sign(vb.deltaY);
let Ld=oc;10<Math.abs(vb.deltaY)&&(Ld=10*Uc);Uc=Ld}const [md,hd,Bd]=[xc,oc,Uc];"pinching"===N.state||Ma.current>=vb.timeStamp||(Ma.current=vb.timeStamp,(vb.altKey||vb.ctrlKey||vb.metaKey)&&0===vb.buttons?(Uc=n.bounds,vb=null!=(Wb=N.currentScreenPoint)?Wb:[Uc.width/2,Uc.height/2],Wb=n.camera.zoom,n.onZoom(vb,Wb-Bd/100*Wb)):(Wb=pe.mul(vb.shiftKey&&!Ub()?[hd,0]:[md,hd],.8),pe.isEqual(Wb,[0,0])||n.panCamera(Wb)))},onPinchStart:({event:vb,delta:Wb,offset:oc,origin:xc})=>{var Uc;const md=c.current;vb instanceof
WheelEvent||!(vb.target===md||null!=md&&md.contains(vb.target))||(null==(Uc=da.onPinchStart)?void 0:Uc.call(da,{type:"canvas",order:0,delta:[...Wb,oc[0]],offset:oc,point:pe.sub(xc,N.containerOffset)},vb),ua.current=xc,Ga.current=[0,0])},onPinchEnd:({event:vb,offset:Wb,origin:oc})=>{var xc;const Uc=c.current;vb instanceof WheelEvent||!(vb.target===Uc||null!=Uc&&Uc.contains(vb.target))||"pinching"!==N.state||(null==(xc=da.onPinchEnd)?void 0:xc.call(da,{type:"canvas",order:0,delta:[0,0,Wb[0]],offset:Wb,
point:pe.sub(oc,N.containerOffset)},vb),Ga.current=[0,0])},onPinch:({event:vb,offset:Wb,origin:oc})=>{var xc,Uc=c.current;if(!(vb instanceof WheelEvent)&&(vb.target===Uc||null!=Uc&&Uc.contains(vb.target))){ua.current||(ua.current=oc);Uc=pe.sub(ua.current,oc);var md=pe.sub(Uc,Ga.current);null==(xc=da.onPinch)?void 0:xc.call(da,{type:"canvas",order:0,delta:[...md,Wb[0]],offset:Wb,point:pe.sub(oc,N.containerOffset)},vb);Ga.current=Uc}}}),[da]);De(fb,{target:c,eventOptions:{passive:!1},pinch:{from:[n.camera.zoom,
n.camera.zoom],scaleBounds:()=>({from:n.camera.zoom,max:yl.maxZoom,min:yl.minZoom})}})}function wb(c,n,N,da){ut.useLayoutEffect(()=>{c.current.style.transform=`translate(
        calc(${n.minX}px - var(--tl-padding)),
        calc(${n.minY}px - var(--tl-padding)))
        scale(var(--tl-scale))`},[n.minX,n.minY,N,n.rotation]);ut.useLayoutEffect(()=>{const ua=c.current;ua.style.width=`calc(${Math.floor(n.width)}px + (var(--tl-padding) * 2))`;ua.style.height=`calc(${Math.floor(n.height)}px + (var(--tl-padding) * 2))`},[n.width,n.height]);ut.useLayoutEffect(()=>{const ua=c.current;void 0!==da&&(ua.style.zIndex=da.toString())},[da])}function wc(c,n){const {onPersist:N,onError:da,onMount:ua,onCreateAssets:Ga,onCreateShapes:Ma,onDeleteAssets:fb,onDeleteShapes:vb,
onDrop:Wb,onPaste:oc,onCopy:xc,onCanvasDBClick:Uc}=n;Kw.useLayoutEffect(()=>{const md=[];if(c)return window.tlapps=window.tlapps||{},window.tlapps[c.uuid]=c,ua&&ua(c,null),()=>{md.forEach(hd=>hd());window.tlapps&&delete window.tlapps[c.uuid]}},[c]);Kw.useLayoutEffect(()=>{const md=[];N&&md.push(c.subscribe("persist",N));da&&md.push(c.subscribe("error",da));Ma&&md.push(c.subscribe("create-shapes",Ma));Ga&&md.push(c.subscribe("create-assets",Ga));vb&&md.push(c.subscribe("delete-shapes",vb));fb&&md.push(c.subscribe("delete-assets",
fb));Wb&&md.push(c.subscribe("drop",Wb));oc&&md.push(c.subscribe("paste",oc));xc&&md.push(c.subscribe("copy",xc));Uc&&md.push(c.subscribe("canvas-dbclick",Uc));return()=>md.forEach(hd=>hd())},[c,N,da])}function sc(c){if("app"in c)return c.app;const [n]=Lw.useState(()=>new $z(c.model,c.Shapes,c.Tools,c.readOnly));Lw.useLayoutEffect(()=>()=>{n.dispose()},[n]);return n}function Sc(c,n){GA.useEffect(()=>{"model"in n&&n.model&&c.loadDocumentModel(n.model)},[n.model])}function $c(c){const n=od(),{viewport:{bounds:N}}=
n;HA.useEffect(()=>{const da=Ma=>{Ma.preventDefault()},ua=Ma=>{if(0!==Ma.touches.length){var fb=Ma.touches[0].pageX,vb=Ma.touches[0].radiusX||0;(10>fb-vb||fb+vb>N.width-10)&&Ma.preventDefault()}},Ga=c.current;if(!Ga)return()=>{};Ga.addEventListener("touchstart",da,{passive:!0});Ga.addEventListener("gestureend",da,{passive:!0});Ga.addEventListener("gesturechange",da,{passive:!0});Ga.addEventListener("gesturestart",da,{passive:!0});Ga.addEventListener("touchstart",ua,{passive:!0});return()=>{Ga&&(Ga.removeEventListener("touchstart",
da),Ga.removeEventListener("gestureend",da),Ga.removeEventListener("gesturechange",da),Ga.removeEventListener("gesturestart",da),Ga.removeEventListener("touchstart",ua))}},[c,N.width])}function nd(c,n){const {inputs:N,callbacks:da}=od();return IA.useMemo(()=>({onPointerDown:ua=>{var Ga,Ma;const {order:fb=0}=ua;fb||(null==(Ga=ua.currentTarget)?void 0:Ga.setPointerCapture(ua.pointerId));Ga=c.props.handles[n];null==(Ma=da.onPointerDown)?void 0:Ma.call(da,{type:"handle",shape:c,handle:Ga,id:n,order:fb},
ua);ua.order=fb+1},onPointerMove:ua=>{var Ga;const {order:Ma=0}=ua,fb=c.props.handles[n];null==(Ga=da.onPointerMove)?void 0:Ga.call(da,{type:"handle",shape:c,handle:fb,id:n,order:Ma},ua);ua.order=Ma+1},onPointerUp:ua=>{var Ga,Ma;const {order:fb=0}=ua;fb||(null==(Ga=ua.currentTarget)?void 0:Ga.releasePointerCapture(ua.pointerId));Ga=c.props.handles[n];null==(Ma=da.onPointerUp)?void 0:Ma.call(da,{type:"handle",shape:c,handle:Ga,id:n,order:fb},ua);ua.order=fb+1},onPointerEnter:ua=>{var Ga;const {order:Ma=
0}=ua,fb=c.props.handles[n];null==(Ga=da.onPointerEnter)?void 0:Ga.call(da,{type:"handle",shape:c,handle:fb,id:n,order:Ma},ua);ua.order=Ma+1},onPointerLeave:ua=>{var Ga;const {order:Ma=0}=ua,fb=c.props.handles[n];null==(Ga=da.onPointerLeave)?void 0:Ga.call(da,{type:"handle",shape:c,handle:fb,id:n,order:Ma},ua);ua.order=Ma+1},onKeyUp:ua=>{var Ga;const Ma=c.props.handles[n];null==(Ga=da.onKeyUp)?void 0:Ga.call(da,{type:"handle",shape:c,handle:Ma,id:n,order:-1},ua)},onKeyDown:ua=>{var Ga;const Ma=c.props.handles[n];
null==(Ga=da.onKeyDown)?void 0:Ga.call(da,{type:"handle",shape:c,handle:Ma,id:n,order:-1},ua)}}),[c.id,N,da])}function wd(c,n,N=!1){return`url("data:image/svg+xml,<svg height='32' width='32' viewBox='0 0 35 35' xmlns='http://www.w3.org/2000/svg'><g fill='none' style='transform-origin:center center' transform='rotate(${n})${N?" scale(-1,-1) translate(0, -32)":""}'>`+c.replaceAll('"',"'")+'\x3c/g\x3e\x3c/svg\x3e") 16 16, pointer'}function yd(c,n,N=0){JA.useEffect(()=>{const da=c.current;da&&(da.style.cursor=
KA[n](Dh.radiansToDegrees(N)))},[n,N])}function Jd(c){const {viewport:n}=od(),N=Te();LA.useLayoutEffect(()=>kc(()=>{const da=lg(()=>{var ua;null==(ua=c.current)?void 0:ua.style.setProperty("--tl-zoom",n.camera.zoom.toString())},200);"pinching"!==N.inputs.state&&null!=n.camera.zoom&&da()}),[])}function ae(c,n=0){const [N,da]=(0,Mw.useState)(c);(0,Mw.useEffect)(()=>{let ua=!1;const Ga=setTimeout(()=>{ua||da(c)},n);return()=>{ua=!0;clearTimeout(Ga)}},[c,n]);return N}function be(){const c=Te();Nw.useEffect(()=>
{Nc(()=>Af({},c.viewport.camera),()=>{window.sessionStorage.setItem("logseq.tldraw.camera:"+c.currentPageId,JSON.stringify(c.viewport.camera))})},[c.viewport.camera]);Nw.useEffect(()=>{var n;const N=JSON.parse(null!=(n=window.sessionStorage.getItem("logseq.tldraw.camera:"+c.currentPageId))?n:"null");N?c.viewport.update(N):c.selectedIds.size?c.api.zoomToSelection():c.api.zoomToFit()},[c])}function ne(c){c()}function ze(c){return Sb(ia(c,void 0))}function Ee(c){return{reaction:c,mounted:!1,changedBeforeMount:!1,
cleanAt:Date.now()+NA}}function de(c){var n=new Map,N=1,da=new c(function(ua){var Ga=n.get(ua);Ga&&(Ga.reaction.dispose(),n.delete(ua))});return{addReactionToTrack:function(ua,Ga,Ma){var fb=N++;da.register(Ma,fb,ua);ua.current=Ee(Ga);ua.current.finalizationRegistryCleanupToken=fb;n.set(fb,ua.current);return ua.current},recordReactionAsCommitted:function(ua){da.unregister(ua);ua.current&&ua.current.finalizationRegistryCleanupToken&&n.delete(ua.current.finalizationRegistryCleanupToken)},forceCleanupTimerToRunNowForTests:function(){},
resetCleanupScheduleForTests:function(){}}}function Ge(){function c(){void 0===da&&(da=setTimeout(n,1E4))}function n(){da=void 0;var ua=Date.now();N.forEach(function(Ga){var Ma=Ga.current;Ma&&ua>=Ma.cleanAt&&(Ma.reaction.dispose(),Ga.current=null,N.delete(Ga))});0<N.size&&c()}var N=new Set,da;return{addReactionToTrack:function(ua,Ga,Ma){ua.current=Ee(Ga);N.add(ua);c();return ua.current},recordReactionAsCommitted:function(ua){N.delete(ua)},forceCleanupTimerToRunNowForTests:function(){da&&(clearTimeout(da),
n())},resetCleanupScheduleForTests:function(){var ua;if(0<N.size){try{for(var Ga=OA(N),Ma=Ga.next();!Ma.done;Ma=Ga.next()){var fb=Ma.value,vb=fb.current;vb&&(vb.reaction.dispose(),fb.current=null)}}catch(oc){var Wb={error:oc}}finally{try{Ma&&!Ma.done&&(ua=Ga.return)&&ua.call(Ga)}finally{if(Wb)throw Wb.error;}}N.clear()}da&&(clearTimeout(da),da=void 0)}}}function Ce(){return new RA}function Yf(c,n){void 0===n&&(n="observed");var N=Qw(Kq.default.useState(Ce),1)[0],da=Qw(Kq.default.useState(),2)[1],
ua=Kq.default.useRef(null);if(!ua.current)var Ga=new kp("observer".concat(n),function(){Ma.mounted?da([]):Ma.changedBeforeMount=!0}),Ma=PA(ua,Ga,N);N=ua.current.reaction;Kq.default.useDebugValue(N,ze);Kq.default.useEffect(function(){QA(ua);ua.current?(ua.current.mounted=!0,ua.current.changedBeforeMount&&(ua.current.changedBeforeMount=!1,da([]))):(ua.current={reaction:new kp("observer".concat(n),function(){da([])}),mounted:!0,changedBeforeMount:!1,cleanAt:Infinity},da([]));return function(){ua.current.reaction.dispose();
ua.current=null}},[]);var fb,vb;N.track(function(){try{fb=c()}catch(Wb){vb=Wb}});if(vb)throw vb;return fb}function ue(c,n){var N;if(Tw&&c.$$typeof===Tw)throw Error("[mobx-react-lite] You are trying to use `observer` on a function component wrapped in either another `observer` or `React.memo`. The observer already applies 'React.memo' for you.");n=null!==(N=null===n||void 0===n?void 0:n.forwardRef)&&void 0!==N?N:!1;var da=c,ua=c.displayName||c.name;if(Sw&&c.$$typeof===Sw&&(n=!0,da=c.render,"function"!==
typeof da))throw Error("[mobx-react-lite] `render` property of ForwardRef was not a function");N=function(Ga,Ma){return Yf(function(){return da(Ga,Ma)},ua)};""!==ua&&(N.displayName=ua);c.contextTypes&&(N.contextTypes=c.contextTypes);n&&(N=(0,tp.forwardRef)(N));N=(0,tp.memo)(N);$e(c,N);return N}function $e(c,n){Object.keys(c).forEach(function(N){SA[N]||Object.defineProperty(n,N,Object.getOwnPropertyDescriptor(c,N))})}function Df(c){var n=c.render;c=c.children||n;return"function"!==typeof c?null:Yf(c)}
function pg(c){const n=Te(),{callbacks:N}=od(),da=Uw.useRef(!1);Uw.useEffect(()=>{const ua=vb=>{var Wb,oc;if(null==(Wb=c.current)?0:Wb.contains(document.activeElement))null==(oc=N.onKeyDown)?void 0:oc.call(N,{type:"canvas",order:-1},vb),da.current=vb.shiftKey},Ga=vb=>{var Wb,oc;if(null==(Wb=c.current)?0:Wb.contains(document.activeElement))null==(oc=N.onKeyUp)?void 0:oc.call(N,{type:"canvas",order:-1},vb),da.current=vb.shiftKey},Ma=vb=>{var Wb,oc,xc;!n.editingShape&&(null==(Wb=c.current)?0:Wb.contains(document.activeElement))&&
!["INPUT","TEXTAREA"].includes(null!=(xc=null==(oc=document.activeElement)?void 0:oc.tagName)?xc:"")&&(vb.preventDefault(),n.paste(vb,da.current))},fb=vb=>{var Wb,oc,xc;!n.editingShape&&0<n.selectedShapes.size&&(null==(Wb=c.current)?0:Wb.contains(document.activeElement))&&!["INPUT","TEXTAREA"].includes(null!=(xc=null==(oc=document.activeElement)?void 0:oc.tagName)?xc:"")&&(vb.preventDefault(),n.copy())};window.addEventListener("keydown",ua);window.addEventListener("keyup",Ga);document.addEventListener("paste",
Ma);document.addEventListener("copy",fb);return()=>{window.removeEventListener("keydown",ua);window.removeEventListener("keyup",Ga);document.removeEventListener("paste",Ma);document.removeEventListener("copy",fb)}},[])}function Ig(c){const n=Te(),{inputs:N,callbacks:da}=od(),ua=Zw.useRef(-1);return Zw.useMemo(()=>({onPointerDown:Ga=>{var Ma,fb;if(!n.settings.penMode||"pen"===Ga.pointerType&&Ga.isPrimary){var {order:vb=0}=Ga;vb||(null==(Ma=Ga.currentTarget)?void 0:Ma.setPointerCapture(Ga.pointerId));
null==(fb=da.onPointerDown)?void 0:fb.call(da,{type:"shape",shape:c,order:vb},Ga);Ga.order=vb+1}},onPointerMove:Ga=>{var Ma;if(!n.settings.penMode||"pen"===Ga.pointerType&&Ga.isPrimary){var {order:fb=0}=Ga;null==(Ma=da.onPointerMove)?void 0:Ma.call(da,{type:"shape",shape:c,order:fb},Ga);Ga.order=fb+1}},onPointerUp:Ga=>{var Ma,fb,vb;if(!n.settings.penMode||"pen"===Ga.pointerType&&Ga.isPrimary){var {order:Wb=0}=Ga;Wb||(null==(Ma=Ga.currentTarget)?void 0:Ma.releasePointerCapture(Ga.pointerId));null==
(fb=da.onPointerUp)?void 0:fb.call(da,{type:"shape",shape:c,order:Wb},Ga);Ma=Date.now();fb=Ma-ua.current;300<fb?ua.current=Ma:300>=fb&&(null==(vb=da.onDoubleClick)?void 0:vb.call(da,{type:"shape",shape:c,order:Wb},Ga),ua.current=-1);Ga.order=Wb+1}},onPointerEnter:Ga=>{var Ma;if(!n.settings.penMode||"pen"===Ga.pointerType&&Ga.isPrimary){var {order:fb=0}=Ga;null==(Ma=da.onPointerEnter)?void 0:Ma.call(da,{type:"shape",shape:c,order:fb},Ga);Ga.order=fb+1}},onPointerLeave:Ga=>{var Ma;if(!n.settings.penMode||
"pen"===Ga.pointerType&&Ga.isPrimary){var {order:fb=0}=Ga;null==(Ma=da.onPointerLeave)?void 0:Ma.call(da,{type:"shape",shape:c,order:fb},Ga);Ga.order=fb+1}},onKeyUp:Ga=>{var Ma;null==(Ma=da.onKeyUp)?void 0:Ma.call(da,{type:"shape",shape:c,order:-1},Ga)},onKeyDown:Ga=>{var Ma;null==(Ma=da.onKeyDown)?void 0:Ma.call(da,{type:"shape",shape:c,order:-1},Ga)}}),[c.id,N,da])}function Jg(c){var {viewport:n,inputs:N,callbacks:da,components:ua}=c;c=Zi(c,["viewport","inputs","callbacks","components"]);return(0,qx.jsx)(lB,
{id:c.id,viewport:n,inputs:N,callbacks:da,components:ua,meta:c.meta,children:(0,qx.jsx)(hB,Af({},c))})}function Tg(c){var {side:n,content:N,sideOffset:da=10}=c;c=Zi(c,["side","content","sideOffset"]);return N?(0,wo.jsx)(Mq.TooltipProvider,{delayDuration:300,children:(0,wo.jsxs)(Mq.Tooltip,{children:[(0,wo.jsx)(Mq.TooltipTrigger,{asChild:!0,children:c.children}),(0,wo.jsxs)(Mq.TooltipContent,kg(Af({sideOffset:da,side:n},c),{children:[N,(0,wo.jsx)(Mq.TooltipArrow,{className:"popper-arrow"})]}))]})}):
(0,wo.jsx)(wo.Fragment,{children:c.children})}function kh(c){var {className:n,tooltip:N,tooltipSide:da}=c;c=Zi(c,["className","tooltip","tooltipSide"]);return(0,rx.jsx)(Tg,{content:N,side:da,children:(0,rx.jsx)("button",Af({className:"tl-button "+(null!=n?n:"")},c))})}function xg(c){var {toggle:n=!0,pressed:N,onPressedChange:da,className:ua,tooltip:Ga}=c;c=Zi(c,["toggle","pressed","onPressedChange","className","tooltip"]);return(0,Ft.jsx)(Tg,{content:Ga,children:(0,Ft.jsx)("div",{className:"inline-flex",
children:(0,Ft.jsx)(rB.Toggle,kg(Af({},c),{"data-toggle":n,className:"tl-button"+(ua?" "+ua:""),pressed:N,onPressedChange:da}))})})}function ij(c){var {side:n,align:N,alignOffset:da,label:ua,children:Ga,border:Ma}=c;c=Zi(c,"side align alignOffset label children border".split(" "));return(0,Ur.jsxs)(Vr.Popover,{children:[(0,Ur.jsx)(Vr.PopoverTrigger,kg(Af({},c),{"data-border":Ma,className:"tl-button tl-popover-trigger-button",children:ua})),(0,Ur.jsxs)(Vr.PopoverContent,{className:"w-auto p-1",align:N,
alignOffset:da,side:n,sideOffset:15,collisionBoundary:document.querySelector(".logseq-tldraw"),children:[Ga,(0,Ur.jsx)(Vr.PopoverArrow,{className:"popper-arrow"})]})]})}function qf(c){function n(Wb){return Wb?(0,bk.jsx)("div",{className:"tl-color-bg",style:{backgroundColor:Wb},children:(0,bk.jsx)("div",{className:`w-full h-full bg-${Wb}-500`})}):(0,bk.jsx)("div",{className:"tl-color-bg",children:(0,bk.jsx)(eh,{name:"color-swatch"})})}var {color:N,opacity:da,popoverSide:ua,setColor:Ga,setOpacity:Ma}=
c;c=Zi(c,["color","opacity","popoverSide","setColor","setOpacity"]);const {handlers:{t:fb}}=vx.default.useContext(vi),vb=vx.default.useMemo(()=>{let Wb="";return lg(oc=>{Ga(Wb)},100,oc=>{Wb=oc.target.value})},[]);return(0,bk.jsx)(ij,kg(Af({},c),{border:!0,side:ua,label:(0,bk.jsx)(Tg,{content:fb("whiteboard/color"),side:ua,sideOffset:14,children:n(N)}),children:(0,bk.jsxs)("div",{className:"p-1",children:[(0,bk.jsx)("div",{className:"tl-color-palette",children:Object.values(Oa).map(Wb=>(0,bk.jsx)("button",
{className:`tl-color-drip m-1${Wb===N?" active":""}`,onClick:()=>Ga(Wb),children:n(Wb)},Wb))}),(0,bk.jsxs)("div",{className:"flex items-center tl-custom-color",children:[(0,bk.jsx)("div",{className:`tl-color-drip m-1 mr-3 ${tf(N)?"":"active"}`,children:(0,bk.jsx)("div",{className:"color-input-wrapper tl-color-bg",children:(0,bk.jsx)("input",Af({className:"color-input cursor-pointer",id:"tl-custom-color-input",type:"color",value:/^#(?:[0-9a-f]{3}){1,2}$/i.test(N)?N:"#000000",onChange:vb,style:{opacity:tf(N)?
0:1}},c))})}),(0,bk.jsx)("label",{htmlFor:"tl-custom-color-input",className:"text-xs cursor-pointer",children:fb("whiteboard/select-custom-color")})]}),Ma&&(0,bk.jsx)("div",{className:"mx-1 my-2",children:(0,bk.jsxs)(Wr.Slider,{defaultValue:[null!=da?da:0],onValueCommit:Wb=>Ma(Wb[0]),max:1,step:.1,"aria-label":fb("whiteboard/opacity"),className:"tl-slider-root",children:[(0,bk.jsx)(Wr.SliderTrack,{className:"tl-slider-track",children:(0,bk.jsx)(Wr.SliderRange,{className:"tl-slider-range"})}),(0,bk.jsx)(Wr.SliderThumb,
{className:"tl-slider-thumb"})]})})]})}))}function Qh(c){var {options:n,tooltip:N,popoverSide:da,compact:ua=!1,value:Ga,onValueChange:Ma}=c;c=Zi(c,"options tooltip popoverSide compact value onValueChange".split(" "));const [fb,vb]=zB.useState(!1);return(0,Fm.jsx)("div",kg(Af({},c),{children:(0,Fm.jsxs)(wp.Select,{open:fb,onOpenChange:vb,value:Ga,onValueChange:Ma,children:[(0,Fm.jsx)(Tg,{content:N,side:da,children:(0,Fm.jsxs)(wp.SelectTrigger,{className:`tl-select-trigger ${ua?"compact":""}`,children:[(0,Fm.jsx)(wp.SelectValue,
{}),!ua&&(0,Fm.jsx)(wp.SelectIcon,{asChild:!0,children:(0,Fm.jsx)(BB,{className:"h-4 w-4 opacity-50"})})]})}),(0,Fm.jsx)(wp.SelectContent,{className:"min-w-min",side:da,position:"popper",sideOffset:14,align:"center",onKeyDown:Wb=>Wb.stopPropagation(),children:n.map(Wb=>(0,Fm.jsx)(wp.SelectItem,{value:Wb.value,children:Wb.label},Wb.value))})]})}))}function Si(c){var {scaleLevel:n,compact:N,popoverSide:da}=c;Zi(c,["scaleLevel","compact","popoverSide"]);const ua=Te();({handlers:{t:c}}=CB.default.useContext(vi));
const Ga=[{label:N?"XS":c("whiteboard/extra-small"),value:"xs"},{label:N?"SM":c("whiteboard/small"),value:"sm"},{label:N?"MD":c("whiteboard/medium"),value:"md"},{label:N?"LG":c("whiteboard/large"),value:"lg"},{label:N?"XL":c("whiteboard/extra-large"),value:"xl"},{label:N?"XXL":c("whiteboard/huge"),value:"xxl"}];return(0,DB.jsx)(Qh,{tooltip:c("whiteboard/scale-level"),options:Ga,value:n,popoverSide:da,compact:N,onValueChange:Ma=>{ua.api.setScaleLevel(Ma)}})}function Wh(c,n){return function(N){return c(n(N))}}
function Ej(c,n){return n(c)}function jk(c,n){return function(N){return c(n,N)}}function Pj(c,n){return function(){return c(n)}}function bj(c,n){n(c);return c}function Xh(){for(var c=arguments.length,n=Array(c),N=0;N<c;N++)n[N]=arguments[N];return n}function Qj(c){c()}function Vj(c){return function(){return c}}function Ti(){for(var c=arguments.length,n=Array(c),N=0;N<c;N++)n[N]=arguments[N];return function(){n.map(Qj)}}function Ji(){}function Yh(c,n){return c(1,n)}function Ik(c,n){c(0,n)}function Rj(c){c(2)}
function Wj(c){return c(4)}function Pg(c,n){return Yh(c,jk(n,0))}function kk(c,n){var N=c(1,function(da){N();n(da)});return N}function $g(){var c=[];return function(n,N){switch(n){case 2:c.splice(0,c.length);break;case 1:return c.push(N),function(){var da=c.indexOf(N);-1<da&&c.splice(da,1)};case 0:c.slice().forEach(function(da){da(N)});break;default:throw Error("unrecognized action "+n);}}}function hg(c){var n=c,N=$g();return function(da,ua){switch(da){case 1:ua(n);break;case 0:n=ua;break;case 4:return n}return N(da,
ua)}}function Aj(c){var n,N;return function(da,ua){switch(da){case 1:if(ua){if(N===ua)break;n&&n();N=ua;return n=c(1,ua)}n&&n();return Ji;case 2:n&&n();N=null;break;default:throw Error("unrecognized action "+da);}}}function Yi(c){return bj($g(),function(n){return Pg(c,n)})}function Ui(c,n){return bj(hg(n),function(N){return Pg(c,N)})}function tl(){for(var c=arguments.length,n=Array(c),N=0;N<c;N++)n[N]=arguments[N];return function(da){return n.reduceRight(Ej,da)}}function Kf(c){for(var n=arguments.length,
N=Array(1<n?n-1:0),da=1;da<n;da++)N[da-1]=arguments[da];var ua=tl.apply(void 0,N);return function(Ga,Ma){switch(Ga){case 1:return Yh(c,ua(Ma));case 2:c(2);break;default:throw Error("unrecognized action "+Ga);}}}function Hj(c,n){return c===n}function xh(c){void 0===c&&(c=Hj);var n;return function(N){return function(da){c(n,da)||(n=da,N(da))}}}function Bh(c){return function(n){return function(N){c(N)&&n(N)}}}function Dg(c){return function(n){return Wh(n,c)}}function Kj(c){return function(n){return function(){return n(c)}}}
function zi(c,n){return function(N){return function(da){return N(n=c(n,da))}}}function gk(c){return function(n){return function(N){0<c?c--:n(N)}}}function hk(c){var n,N;return function(da){return function(ua){n=ua;N||=setTimeout(function(){N=void 0;da(n)},c)}}}function Gl(c){var n,N;return function(da){return function(ua){n=ua;N&&clearTimeout(N);N=setTimeout(function(){da(n)},c)}}}function zh(){for(var c=arguments.length,n=Array(c),N=0;N<c;N++)n[N]=arguments[N];var da=Array(n.length),ua=0,Ga=null,
Ma=Math.pow(2,n.length)-1;n.forEach(function(fb,vb){var Wb=Math.pow(2,vb);Yh(fb,function(oc){var xc=ua;ua|=Wb;da[vb]=oc;xc!==Ma&&ua===Ma&&Ga&&(Ga(),Ga=null)})});return function(fb){return function(vb){var Wb=function(){return fb([vb].concat(da))};ua===Ma?Wb():Ga=Wb}}}function Am(){for(var c=arguments.length,n=Array(c),N=0;N<c;N++)n[N]=arguments[N];return function(da,ua){switch(da){case 1:return Ti.apply(void 0,n.map(function(Ga){return Ga(1,ua)}));case 2:break;default:throw Error("unrecognized action "+
da);}}}function Kh(c,n){void 0===n&&(n=Hj);return Kf(c,xh(n))}function Ci(){for(var c=$g(),n=arguments.length,N=Array(n),da=0;da<n;da++)N[da]=arguments[da];var ua=Array(N.length),Ga=0,Ma=Math.pow(2,N.length)-1;N.forEach(function(fb,vb){var Wb=Math.pow(2,vb);Yh(fb,function(oc){ua[vb]=oc;Ga|=Wb;Ga===Ma&&c(0,ua)})});return function(fb,vb){switch(fb){case 1:return Ga===Ma&&vb(ua),c(1,vb);case 2:c(2);break;default:throw Error("unrecognized action "+fb);}}}function rh(c,n,N){void 0===n&&(n=[]);N=(void 0===
N?{singleton:!0}:N).singleton;return{id:Symbol(),constructor:c,dependencies:n,singleton:N}}function Lj(c){var n=new Map;return function ua(da){var Ga=da.id,Ma=da.constructor,fb=da.dependencies;if((da=da.singleton)&&n.has(Ga))return n.get(Ga);Ma=Ma(fb.map(function(vb){return ua(vb)}));da&&n.set(Ga,Ma);return Ma}(c)}function kl(c,n){if(null==c)return{};var N={},da=Object.keys(c),ua;for(ua=0;ua<da.length;ua++){var Ga=da[ua];0<=n.indexOf(Ga)||(N[Ga]=c[Ga])}return N}function ul(c,n){if(c){if("string"===
typeof c)return fn(c,n);var N=Object.prototype.toString.call(c).slice(8,-1);"Object"===N&&c.constructor&&(N=c.constructor.name);if("Map"===N||"Set"===N)return Array.from(c);if("Arguments"===N||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(N))return fn(c,n)}}function fn(c,n){if(null==n||n>c.length)n=c.length;for(var N=0,da=Array(n);N<n;N++)da[N]=c[N];return da}function gm(c,n){var N="undefined"!==typeof Symbol&&c[Symbol.iterator]||c["@@iterator"];if(N)return(N=N.call(c)).next.bind(N);if(Array.isArray(c)||
(N=ul(c))||n&&c&&"number"===typeof c.length){N&&(c=N);var da=0;return function(){return da>=c.length?{done:!0}:{done:!1,value:c[da++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.");}function cp(c,n){for(var N={},da={},ua=0,Ga=c.length;ua<Ga;)da[c[ua]]=1,ua+=1;for(var Ma in n)da.hasOwnProperty(Ma)||(N[Ma]=n[Ma]);return N}function qc(c,n,N){function da(xc,Uc){xc.propsReady&&(0,xc.propsReady)(0,
!1);for(var md=gm(Ma),hd;!(hd=md()).done;)hd=hd.value,(0,xc[n.required[hd]])(0,Uc[hd]);for(md=gm(fb);!(hd=md()).done;)if(hd=hd.value,hd in Uc)(0,xc[n.optional[hd]])(0,Uc[hd]);xc.propsReady&&(0,xc.propsReady)(0,!0)}function ua(xc){return vb.reduce(function(Uc,md){Uc[md]=function(hd){(0,xc[n.methods[md]])(0,hd)};return Uc},{})}function Ga(xc){return Wb.reduce(function(Uc,md){Uc[md]=Aj(xc[n.events[md]]);return Uc},{})}var Ma=Object.keys(n.required||{}),fb=Object.keys(n.optional||{}),vb=Object.keys(n.methods||
{}),Wb=Object.keys(n.events||{}),oc=(0,Kk.createContext)({});return{Component:(0,Kk.forwardRef)(function(xc,Uc){var md=xc.children,hd=kl(xc,IB),Bd=(0,Kk.useState)(function(){return bj(Lj(c),function(bd){return da(bd,hd)})})[0],Ld=(0,Kk.useState)(Pj(Ga,Bd))[0];Xr(function(){for(var bd=gm(Wb),jd;!(jd=bd()).done;)if(jd=jd.value,jd in hd)(0,Ld[jd])(1,hd[jd]);return function(){Object.values(Ld).map(Rj)}},[hd,Ld,Bd]);Xr(function(){da(Bd,hd)});(0,Kk.useImperativeHandle)(Uc,Vj(ua(Bd)));return(0,Kk.createElement)(oc.Provider,
{value:Bd},N?(0,Kk.createElement)(N,cp([].concat(Ma,fb,Wb),hd),md):md)}),usePublisher:function(xc){return(0,Kk.useCallback)(jk(Ik,(0,Kk.useContext)(oc)[xc]),[xc])},useEmitterValue:function(xc){var Uc=(0,Kk.useContext)(oc)[xc];xc=(0,Kk.useState)(Pj(Wj,Uc));var md=xc[0],hd=xc[1];Xr(function(){return Yh(Uc,function(Bd){Bd!==md&&hd(Vj(Bd))})},[Uc,md]);return md},useEmitter:function(xc,Uc){var md=(0,Kk.useContext)(oc)[xc];Xr(function(){return md(1,Uc)},[Uc,md])}}}function Ia(){return Ia=Object.assign||
function(c){for(var n=1;n<arguments.length;n++){var N=arguments[n],da;for(da in N)Object.prototype.hasOwnProperty.call(N,da)&&(c[da]=N[da])}return c},Ia.apply(this,arguments)}function Cc(c,n){if(null==c)return{};var N,da,ua={},Ga=Object.keys(c);for(da=0;da<Ga.length;da++)0<=n.indexOf(N=Ga[da])||(ua[N]=c[N]);return ua}function Dc(c,n){(null==n||n>c.length)&&(n=c.length);for(var N=0,da=Array(n);N<n;N++)da[N]=c[N];return da}function Tb(c,n){var N="undefined"!=typeof Symbol&&c[Symbol.iterator]||c["@@iterator"];
if(N)return(N=N.call(c)).next.bind(N);if(Array.isArray(c)||(N=function(ua,Ga){if(ua){if("string"==typeof ua)return Dc(ua,Ga);var Ma=Object.prototype.toString.call(ua).slice(8,-1);return"Object"===Ma&&ua.constructor&&(Ma=ua.constructor.name),"Map"===Ma||"Set"===Ma?Array.from(ua):"Arguments"===Ma||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(Ma)?Dc(ua,Ga):void 0}}(c))||n&&c&&"number"==typeof c.length){N&&(c=N);var da=0;return function(){return da>=c.length?{done:!0}:{done:!1,value:c[da++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.");
}function Jc(c,n){void 0===n&&(n=!0);var N=(0,Sh.useRef)(null),da=function(Ga){};if("undefined"!=typeof ResizeObserver){var ua=new ResizeObserver(function(Ga){Ga=Ga[0].target;null!==Ga.offsetParent&&c(Ga)});da=function(Ga){Ga&&n?(ua.observe(Ga),N.current=Ga):(N.current&&ua.unobserve(N.current),N.current=null)}}return{ref:N,callbackRef:da}}function mc(c,n){return void 0===n&&(n=!0),Jc(c,n).callbackRef}function Vb(c,n,N,da,ua,Ga,Ma){return Jc(function(fb){for(var vb=function(xc,Uc,md,hd){md=xc.length;
if(0===md)return null;for(var Bd=[],Ld=0;Ld<md;Ld++){var bd=xc.item(Ld);if(bd&&void 0!==bd.dataset.index){var jd=parseInt(bd.dataset.index),rd=parseFloat(bd.dataset.knownSize),Md=Uc(bd,"offsetHeight");if(0===Md&&hd("Zero-sized element, this should not happen",{child:bd},dk.ERROR),Md!==rd)bd=Bd[Bd.length-1],0===Bd.length||bd.size!==Md||bd.endIndex!==jd-1?Bd.push({startIndex:jd,endIndex:jd,size:Md}):Bd[Bd.length-1].endIndex++}}return Bd}(fb.children,n,0,ua),Wb=fb.parentElement;!Wb.dataset.virtuosoScroller;)Wb=
Wb.parentElement;var oc="window"===Wb.firstElementChild.dataset.viewportType;da({scrollTop:Math.max(Ma?Ma.scrollTop:oc?window.pageYOffset||document.documentElement.scrollTop:Wb.scrollTop,0),scrollHeight:Ma?Ma.scrollHeight:oc?document.documentElement.scrollHeight:Wb.scrollHeight,viewportHeight:Ma?Ma.offsetHeight:oc?window.innerHeight:Wb.offsetHeight});null==Ga||Ga(function(xc,Uc,md){return"normal"===Uc||null!=Uc&&Uc.endsWith("px")||md("row-gap was not resolved to pixel value correctly",Uc,dk.WARN),
"normal"===Uc?0:parseInt(null!=Uc?Uc:"0",10)}(0,getComputedStyle(fb).rowGap,ua));null!==vb&&c(vb)},N)}function Rb(c,n){return Math.round(c.getBoundingClientRect()[n])}function Oc(c,n,N,da,ua){void 0===da&&(da=Ji);var Ga=(0,Sh.useRef)(null),Ma=(0,Sh.useRef)(null),fb=(0,Sh.useRef)(null),vb=(0,Sh.useRef)(!1),Wb=(0,Sh.useCallback)(function(oc){oc=oc.target;var xc=oc===window||oc===document,Uc=xc?window.pageYOffset||document.documentElement.scrollTop:oc.scrollTop,md=xc?document.documentElement.scrollHeight:
oc.scrollHeight,hd=xc?window.innerHeight:oc.offsetHeight;oc=function(){c({scrollTop:Math.max(Uc,0),scrollHeight:md,viewportHeight:hd})};vb.current?(0,JB.flushSync)(oc):oc();vb.current=!1;null!==Ma.current&&(Uc===Ma.current||0>=Uc||Uc===md-hd)&&(Ma.current=null,n(!0),fb.current&&(clearTimeout(fb.current),fb.current=null))},[c,n]);return(0,Sh.useEffect)(function(){var oc=ua||Ga.current;return da(ua||Ga.current),Wb({target:oc}),oc.addEventListener("scroll",Wb,{passive:!0}),function(){da(null);oc.removeEventListener("scroll",
Wb)}},[Ga,Wb,N,da,ua]),{scrollerRef:Ga,scrollByCallback:function(oc){vb.current=!0;Ga.current.scrollBy(oc)},scrollToCallback:function(oc){var xc=Ga.current;if(xc&&!("offsetHeight"in xc&&0===xc.offsetHeight)){var Uc,md,hd,Bd="smooth"===oc.behavior;if(xc===window?(md=Math.max(Rb(document.documentElement,"height"),document.documentElement.scrollHeight),Uc=window.innerHeight,hd=document.documentElement.scrollTop):(md=xc.scrollHeight,Uc=Rb(xc,"height"),hd=xc.scrollTop),oc.top=Math.ceil(Math.max(Math.min(md-
Uc,oc.top),0)),1.01>Math.abs(Uc-md)||oc.top===hd)return c({scrollTop:hd,scrollHeight:md,viewportHeight:Uc}),void(Bd&&n(!0));Bd?(Ma.current=oc.top,fb.current&&clearTimeout(fb.current),fb.current=setTimeout(function(){fb.current=null;Ma.current=null;n(!0)},1E3)):Ma.current=null;xc.scrollTo(oc)}}}}function Xc(c,n,N,da,ua){return void 0===da&&(da=oi),void 0===ua&&(ua=oi),{k:c,v:n,lvl:N,l:da,r:ua}}function id(c,n){if(c===oi)return oi;var N=c.k,da=c.l,ua=c.r;if(n===N){if(da===oi)return ua;if(ua===oi)return da;
n=Ke(da);return Kg(Xe(c,{k:n[0],v:n[1],l:sf(da)}))}return Kg(Xe(c,n<N?{l:id(da,n)}:{r:id(ua,n)}))}function Ad(c,n,N){return(void 0===N&&(N="k"),c===oi)?[-Infinity,void 0]:c[N]===n?[c.k,c.v]:c[N]<n?(n=Ad(c.r,n,N),-Infinity===n[0]?[c.k,c.v]:n):Ad(c.l,n,N)}function Gd(c,n,N){return c===oi?Xc(n,N,1):n===c.k?Xe(c,{k:n,v:N}):If(bg(Xe(c,n<c.k?{l:Gd(c.l,n,N)}:{r:Gd(c.r,n,N)})))}function Td(c,n,N){if(c===oi)return[];var da=c.k,ua=c.v,Ga=c.r,Ma=[];return da>n&&(Ma=Ma.concat(Td(c.l,n,N))),da>=n&&da<=N&&Ma.push({k:da,
v:ua}),da<=N&&(Ma=Ma.concat(Td(Ga,n,N))),Ma}function te(c){return c===oi?[]:[].concat(te(c.l),[{k:c.k,v:c.v}],te(c.r))}function Ke(c){return c.r===oi?[c.k,c.v]:Ke(c.r)}function sf(c){return c.r===oi?c.l:Kg(Xe(c,{r:sf(c.r)}))}function Xe(c,n){return Xc(void 0!==n.k?n.k:c.k,void 0!==n.v?n.v:c.v,void 0!==n.lvl?n.lvl:c.lvl,void 0!==n.l?n.l:c.l,void 0!==n.r?n.r:c.r)}function Ng(c){return c===oi||c.lvl>c.r.lvl}function Kg(c){var n=c.l,N=c.r,da=c.lvl;if(N.lvl>=da-1&&n.lvl>=da-1)return c;if(da>N.lvl+1){if(Ng(n))return bg(Xe(c,
{lvl:da-1}));if(n===oi||n.r===oi)throw Error("Unexpected empty nodes");return Xe(n.r,{l:Xe(n,{r:n.r.l}),r:Xe(c,{l:n.r.r,lvl:da-1}),lvl:da})}if(Ng(c))return If(Xe(c,{lvl:da-1}));if(N===oi||N.l===oi)throw Error("Unexpected empty nodes");n=N.l;var ua=Ng(n)?N.lvl-1:N.lvl;return Xe(n,{l:Xe(c,{r:n.l,lvl:da-1}),r:If(Xe(N,{l:n.r,lvl:ua})),lvl:n.lvl+1})}function Ug(c,n,N){return c===oi?[]:Bg(Td(c,Ad(c,n)[0],N),function(da){return{index:da.k,value:da.v}})}function Bg(c,n){var N=c.length;if(0===N)return[];var da=
n(c[0]),ua=da.index;da=da.value;for(var Ga=[],Ma=1;Ma<N;Ma++){var fb=n(c[Ma]),vb=fb.index;fb=fb.value;Ga.push({start:ua,end:vb-1,value:da});ua=vb;da=fb}return Ga.push({start:ua,end:Infinity,value:da}),Ga}function If(c){var n=c.r,N=c.lvl;return n===oi||n.r===oi||n.lvl!==N||n.r.lvl!==N?c:Xe(n,{l:Xe(c,{r:n.l}),lvl:N+1})}function bg(c){var n=c.l;return n===oi||n.lvl!==c.lvl?c:Xe(n,{r:Xe(c,{l:n.r})})}function lh(c,n,N,da){void 0===da&&(da=0);for(var ua=c.length-1;da<=ua;){var Ga=Math.floor((da+ua)/2),
Ma=N(c[Ga],n);if(0===Ma)return Ga;if(-1===Ma){if(2>ua-da)return Ga-1;ua=Ga-1}else{if(ua===da)return Ga;da=Ga+1}}throw Error("Failed binary finding record in array - "+c.join(",")+", searched for "+n);}function ph(c){var n=c.size,N=c.startIndex,da=c.endIndex;return function(ua){return ua.start===N&&(ua.end===da||Infinity===ua.end)&&ua.value===n}}function Ff(c,n){c=c.index;return n===c?0:n<c?-1:1}function ri(c,n){c=c.offset;return n===c?0:n<c?-1:1}function Ch(c){return{index:c.index,value:c}}function ii(c,
n,N,da){var ua=0,Ga=0,Ma=0,fb;0!==n?(Ma=c[fb=lh(c,n-1,Ff)].offset,Ga=Ad(N,n-1),ua=Ga[0],Ga=Ga[1],c.length&&c[fb].size===Ad(N,n)[1]&&--fb,c=c.slice(0,fb+1)):c=[];for(n=Tb(Ug(N,n,Infinity));!(N=n()).done;)fb=N.value,N=fb.start,fb=fb.value,ua=N-ua,Ma=ua*Ga+Ma+ua*da,c.push({offset:Ma,size:fb,index:N}),ua=N,Ga=fb;return{offsetTree:c,lastIndex:ua,lastOffset:Ma,lastSize:Ga}}function vh(c,n){var N=n[0],da=n[1],ua=n[3];0<N.length&&(0,n[2])("received item sizes",N,dk.DEBUG);var Ga=c.sizeTree;n=Ga;var Ma=0;
if(0<da.length&&Ga===oi&&2===N.length){var fb=N[0].size,vb=N[1].size;n=da.reduce(function(oc,xc){return Gd(Gd(oc,xc,fb),xc+1,vb)},n)}else N=function(oc,xc){var Uc,md=oc===oi?0:Infinity;for(xc=Tb(xc);!(Uc=xc()).done;){var hd=Uc.value;Uc=hd.size;var Bd=hd.startIndex,Ld=hd.endIndex;if(md=Math.min(md,Bd),oc===oi)oc=Gd(oc,0,Uc);else{var bd=Ug(oc,Bd-1,Ld+1);if(!bd.some(ph(hd))){var jd,rd=hd=!1;for(bd=Tb(bd);!(jd=bd()).done;){var Md=jd.value;jd=Md.start;var Dd=Md.end;Md=Md.value;hd?(Ld>=jd||Uc===Md)&&(oc=
id(oc,jd)):(rd=Md!==Uc,hd=!0);Dd>Ld&&Ld>=jd&&Md!==Uc&&(oc=Gd(oc,Ld+1,Md))}rd&&(oc=Gd(oc,Bd,Uc))}}}return[oc,md]}(n,N),n=N[0],Ma=N[1];if(n===Ga)return c;c=ii(c.offsetTree,Ma,n,ua);var Wb=c.offsetTree;return{sizeTree:n,offsetTree:Wb,lastIndex:c.lastIndex,lastOffset:c.lastOffset,lastSize:c.lastSize,groupOffsetTree:da.reduce(function(oc,xc){return Gd(oc,xc,$i(xc,Wb,ua))},oi),groupIndices:da}}function $i(c,n,N){if(0===n.length)return 0;n=n[lh(n,c,Ff)];c-=n.index;c=n.size*c+(c-1)*N+n.offset;return 0<c?
c+N:c}function Gh(c,n,N){if(void 0!==c.groupIndex)return n.groupIndices[c.groupIndex]+1;c=Di("LAST"===c.index?N:c.index,n);return Math.max(0,c,Math.min(N,c))}function Di(c,n){if(n.groupOffsetTree===oi)return c;for(var N=0;n.groupIndices[N]<=c+N;)N++;return c+N}function qj(c){c="number"==typeof c?{index:c}:c;return c.align||(c.align="start"),c.behavior&&NB||(c.behavior="auto"),c.offset||(c.offset=0),c}function Qn(c){return!!c&&("smooth"===c?"smooth":"auto")}function ll(c){return c.reduce(function(n,
N){return n.groupIndices.push(n.totalCount),n.totalCount+=N+1,n},{totalCount:0,groupIndices:[]})}function Pm(c,n){return!(!c||c[0]!==n[0]||c[1]!==n[1])}function Fk(c,n){return!(!c||c.startIndex!==n.startIndex||c.endIndex!==n.endIndex)}function Rn(c,n,N){return"number"==typeof c?"up"===N&&"top"===n||"down"===N&&"bottom"===n?c:0:"up"===N?"top"===n?c.main:c.reverse:"bottom"===n?c.main:c.reverse}function qr(c,n,N){if(0===c.length)return[];if(n.groupOffsetTree===oi)return c.map(function(vb){return Ia({},
vb,{index:vb.index+N,originalIndex:vb.index})});var da,ua=[],Ga=Ug(n.groupOffsetTree,c[0].index,c[c.length-1].index),Ma=void 0,fb=0;for(c=Tb(c);!(da=c()).done;)da=da.value,(!Ma||Ma.end<da.index)&&(Ma=Ga.shift(),fb=n.groupIndices.indexOf(Ma.start)),ua.push(Ia({},da.index===Ma.start?{type:"group",index:fb}:{index:da.index-(fb+1)+N,groupIndex:fb},{size:da.size,offset:da.offset,originalIndex:da.index,data:da.data}));return ua}function Lo(c,n,N,da,ua,Ga){var Ma=0,fb=0;0<c.length&&(Ma=c[0].offset,fb=c[c.length-
1],fb=fb.offset+fb.size);var vb=N-ua.lastIndex,Wb=Ma;da=ua.lastOffset+vb*ua.lastSize+(vb-1)*da-fb;return{items:qr(c,ua,Ga),topItems:qr(n,ua,Ga),topListHeight:n.reduce(function(oc,xc){return xc.size+oc},0),offsetTop:Ma,offsetBottom:da,top:Wb,bottom:fb,totalCount:N,firstItemIndex:Ga}}function Qm(c){var n,N=!1;return function(){return N||(N=!0,n=c()),n}}function Rm(c,n){var N=(0,Sh.useRef)(null),da=(0,Sh.useCallback)(function(vb){if(null!==vb&&vb.offsetParent){var Wb=vb.getBoundingClientRect();vb=Wb.width;
if(n){var oc=n.getBoundingClientRect();Wb=Wb.top-oc.top;oc=oc.height-Math.max(0,Wb);Wb+=n.scrollTop}else oc=window.innerHeight-Math.max(0,Wb.top),Wb=Wb.top+window.pageYOffset;N.current={offsetTop:Wb,visibleHeight:oc,visibleWidth:vb};c(N.current)}},[c,n]),ua=Jc(da),Ga=ua.callbackRef,Ma=ua.ref,fb=(0,Sh.useCallback)(function(){da(Ma.current)},[da,Ma]);return(0,Sh.useEffect)(function(){if(n){n.addEventListener("scroll",fb);var vb=new ResizeObserver(fb);return vb.observe(n),function(){n.removeEventListener("scroll",
fb);vb.unobserve(n)}}return window.addEventListener("scroll",fb),window.addEventListener("resize",fb),function(){window.removeEventListener("scroll",fb);window.removeEventListener("resize",fb)}},[fb,n]),Ga}function um(c){return c}function Uj(c,n){var N=$g();return Yh(N,function(){return console.warn("react-virtuoso: You are using a deprecated property. "+n,"color: red;","color: inherit;","color: blue;")}),Pg(N,c),N}function uj(c,n){if("string"!=typeof c)return{context:n}}function vq(c){var n=c.usePublisher,
N=c.useEmitter,da=c.useEmitterValue;return sh.memo(function(ua){var Ga=ua.style,Ma=ua.children;ua=Cc(ua,aC);var fb=n("scrollContainerState"),vb=da("ScrollerComponent"),Wb=n("smoothScrollTargetReached"),oc=da("scrollerRef"),xc=da("context");fb=Oc(fb,Wb,vb,oc);Wb=fb.scrollerRef;oc=fb.scrollByCallback;return N("scrollTo",fb.scrollToCallback),N("scrollBy",oc),(0,Sh.createElement)(vb,Ia({ref:Wb,style:Ia({},hC,Ga),"data-test-id":"virtuoso-scroller","data-virtuoso-scroller":!0,tabIndex:0},ua,uj(vb,xc)),
Ma)})}function fm(c){var n=c.usePublisher,N=c.useEmitter,da=c.useEmitterValue;return sh.memo(function(ua){var Ga=ua.style,Ma=ua.children;ua=Cc(ua,bC);var fb=n("windowScrollContainerState"),vb=da("ScrollerComponent"),Wb=n("smoothScrollTargetReached"),oc=da("totalListHeight"),xc=da("deviation"),Uc=da("customScrollParent"),md=da("context");Wb=Oc(fb,Wb,vb,Ji,Uc);var hd=Wb.scrollerRef;fb=Wb.scrollByCallback;Wb=Wb.scrollToCallback;return KB(function(){return hd.current=Uc||window,function(){hd.current=
null}},[hd,Uc]),N("windowScrollTo",Wb),N("scrollBy",fb),(0,Sh.createElement)(vb,Ia({style:Ia({position:"relative"},Ga,0!==oc?{height:oc+xc}:{}),"data-virtuoso-scroller":!0},ua,uj(vb,md)),Ma)})}function $o(c,n,N){return Array.from({length:n-c+1}).map(function(da,ua){return{index:ua+c,data:null==N?void 0:N[ua+c]}})}function qq(c,n){return c&&c.column===n.column&&c.row===n.row}function em(c,n,N,da){var ua=N.height;return void 0===ua||0===da.length?{top:0,bottom:0}:{top:ym(c,n,N,da[0].index),bottom:ym(c,
n,N,da[da.length-1].index)+ua}}function ym(c,n,N,da){var ua=n.column;c=Ap(1,$r((c.width+ua)/(N.width+ua)));da=$r(da/c);N=da*N.height+Ap(0,da-1)*n.row;return 0<N?N+n.row:N}function Um(c,n,N){return"normal"===n||null!=n&&n.endsWith("px")||N(c+" was not resolved to pixel value correctly",n,dk.WARN),"normal"===n?0:parseInt(null!=n?n:"0",10)}function ml(){ml=Object.assign?Object.assign.bind():function(c){for(var n=1;n<arguments.length;n++){var N=arguments[n],da;for(da in N)Object.prototype.hasOwnProperty.call(N,
da)&&(c[da]=N[da])}return c};return ml.apply(this,arguments)}function Xl(c,n){Xl=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(N,da){N.__proto__=da;return N};return Xl(c,n)}function rl(c,n){c.prototype=Object.create(n.prototype);c.prototype.constructor=c;Xl(c,n)}function go(c){go=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)};return go(c)}function io(){if("undefined"===typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;
if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(c){return!1}}function Tm(c,n,N){Tm=io()?Reflect.construct.bind():function(da,ua,Ga){var Ma=[null];Ma.push.apply(Ma,ua);da=new (Function.bind.apply(da,Ma));Ga&&Xl(da,Ga.prototype);return da};return Tm.apply(null,arguments)}function lq(c){var n="function"===typeof Map?new Map:void 0;lq=function(N){function da(){return Tm(N,arguments,go(this).constructor)}if(null===N||
-1===Function.toString.call(N).indexOf("[native code]"))return N;if("function"!==typeof N)throw new TypeError("Super expression must either be null or a function");if("undefined"!==typeof n){if(n.has(N))return n.get(N);n.set(N,da)}da.prototype=Object.create(N.prototype,{constructor:{value:da,enumerable:!1,writable:!0,configurable:!0}});return Xl(da,N)};return lq(c)}function Ss(c,n,N){return Math.round(255*c)+","+Math.round(255*n)+","+Math.round(255*N)}function Hl(c,n,N,da){void 0===da&&(da=Ss);if(0===
n)return da(N,N,N);c=(c%360+360)%360/60;var ua=(1-Math.abs(2*N-1))*n,Ga=ua*(1-Math.abs(c%2-1)),Ma=n=0,fb=0;0<=c&&1>c?(n=ua,Ma=Ga):1<=c&&2>c?(n=Ga,Ma=ua):2<=c&&3>c?(Ma=ua,fb=Ga):3<=c&&4>c?(Ma=Ga,fb=ua):4<=c&&5>c?(n=Ga,fb=ua):5<=c&&6>c&&(n=ua,fb=Ga);N-=ua/2;return da(n+N,Ma+N,fb+N)}function Ts(c){if("string"!==typeof c)throw new km(3);if("string"===typeof c){var n=c.toLowerCase();c=Mx[n]?"#"+Mx[n]:c}if(c.match(MC))return{red:parseInt(""+c[1]+c[2],16),green:parseInt(""+c[3]+c[4],16),blue:parseInt(""+
c[5]+c[6],16)};if(c.match(NC))return n=parseFloat((parseInt(""+c[7]+c[8],16)/255).toFixed(2)),{red:parseInt(""+c[1]+c[2],16),green:parseInt(""+c[3]+c[4],16),blue:parseInt(""+c[5]+c[6],16),alpha:n};if(c.match(OC))return{red:parseInt(""+c[1]+c[1],16),green:parseInt(""+c[2]+c[2],16),blue:parseInt(""+c[3]+c[3],16)};if(c.match(PC))return n=parseFloat((parseInt(""+c[4]+c[4],16)/255).toFixed(2)),{red:parseInt(""+c[1]+c[1],16),green:parseInt(""+c[2]+c[2],16),blue:parseInt(""+c[3]+c[3],16),alpha:n};if(n=Tt.exec(c))return{red:parseInt(""+
n[1],10),green:parseInt(""+n[2],10),blue:parseInt(""+n[3],10)};if(n=QC.exec(c.substring(0,50)))return{red:parseInt(""+n[1],10),green:parseInt(""+n[2],10),blue:parseInt(""+n[3],10),alpha:1<parseFloat(""+n[4])?parseFloat(""+n[4])/100:parseFloat(""+n[4])};var N=RC.exec(c);if(N){n=parseInt(""+N[1],10);var da=parseInt(""+N[2],10)/100;N=parseInt(""+N[3],10)/100;n="rgb("+Hl(n,da,N)+")";da=Tt.exec(n);if(!da)throw new km(4,c,n);return{red:parseInt(""+da[1],10),green:parseInt(""+da[2],10),blue:parseInt(""+
da[3],10)}}if(n=SC.exec(c.substring(0,50))){da=parseInt(""+n[1],10);N=parseInt(""+n[2],10)/100;var ua=parseInt(""+n[3],10)/100;da="rgb("+Hl(da,N,ua)+")";N=Tt.exec(da);if(!N)throw new km(4,c,da);return{red:parseInt(""+N[1],10),green:parseInt(""+N[2],10),blue:parseInt(""+N[3],10),alpha:1<parseFloat(""+n[4])?parseFloat(""+n[4])/100:parseFloat(""+n[4])}}throw new km(5);}function Hk(c){c=c.toString(16);return 1===c.length?"0"+c:c}function gh(c,n,N){return Ut("#"+Hk(Math.round(255*c))+Hk(Math.round(255*
n))+Hk(Math.round(255*N)))}function rr(c,n,N){if("number"===typeof c&&"number"===typeof n&&"number"===typeof N)return Ut("#"+Hk(c)+Hk(n)+Hk(N));if("object"===typeof c&&void 0===n&&void 0===N)return Ut("#"+Hk(c.red)+Hk(c.green)+Hk(c.blue));throw new km(6);}function rq(c){if("object"!==typeof c)throw new km(8);if("number"===typeof c.red&&"number"===typeof c.green&&"number"===typeof c.blue&&"number"===typeof c.alpha){if("object"===typeof c)c=1<=c.alpha?rr(c.red,c.green,c.blue):"rgba("+c.red+","+c.green+
","+c.blue+","+c.alpha+")";else throw new km(7);return c}if("number"===typeof c.red&&"number"===typeof c.green&&"number"===typeof c.blue&&("number"!==typeof c.alpha||"undefined"===typeof c.alpha))return rr(c);if("number"===typeof c.hue&&"number"===typeof c.saturation&&"number"===typeof c.lightness&&"number"===typeof c.alpha){if("object"===typeof c)c=1<=c.alpha?Hl(c.hue,c.saturation,c.lightness,gh):"rgba("+Hl(c.hue,c.saturation,c.lightness)+","+c.alpha+")";else throw new km(2);return c}if("number"===
typeof c.hue&&"number"===typeof c.saturation&&"number"===typeof c.lightness&&("number"!==typeof c.alpha||"undefined"===typeof c.alpha)){if("object"===typeof c)c=Hl(c.hue,c.saturation,c.lightness,gh);else throw new km(1);return c}throw new km(8);}function Po(c,n,N){return function(){var da=N.concat(Array.prototype.slice.call(arguments));return da.length>=n?c.apply(this,da):Po(c,n,da)}}function ap(c,n){if("transparent"===n)return n;n=Ts(n);var N=n.red/255,da=n.green/255,ua=n.blue/255,Ga=Math.max(N,
da,ua),Ma=Math.min(N,da,ua),fb=(Ga+Ma)/2;if(Ga===Ma)n=void 0!==n.alpha?{hue:0,saturation:0,lightness:fb,alpha:n.alpha}:{hue:0,saturation:0,lightness:fb};else{var vb=Ga-Ma;Ma=.5<fb?vb/(2-Ga-Ma):vb/(Ga+Ma);switch(Ga){case N:N=(da-ua)/vb+(da<ua?6:0);break;case da:N=(ua-N)/vb+2;break;default:N=(N-da)/vb+4}N*=60;n=void 0!==n.alpha?{hue:N,saturation:Ma,lightness:fb,alpha:n.alpha}:{hue:N,saturation:Ma,lightness:fb}}fb=ml;c=n.lightness-parseFloat(c);return rq(fb({},n,{lightness:Math.max(0,Math.min(1,c))}))}
function Vk(c,n){var N;void 0!==n.strokeWidth&&(n.strokeWidth=Math.max(n.strokeWidth,1));void 0!==n.opacity&&(n.opacity=Math.min(1,Math.max(n.opacity,0)));let da=null!=(N=n.fill)?N:c.props.fill;void 0===da||tf(da)||"var(--ls-secondary-background-color)"===da||n.noFill||!Co.includes(c.props.type)||(c=TC(.3,da),n.stroke=c);return n}function sq({strokeWidth:c,size:n,mode:N}){return"svg"===N?(0,Nx.jsx)("rect",{className:"tl-binding-indicator",x:c,y:c,rx:2,ry:2,width:Math.max(0,n[0]-2*c),height:Math.max(0,
n[1]-2*c),strokeWidth:4*c}):(0,Nx.jsx)("div",{className:"tl-binding-indicator",style:{position:"absolute",left:0,top:0,right:0,bottom:0,boxShadow:"0 0 0 4px var(--tl-binding)",borderRadius:4}})}function Sm(){const c=Te();return"panning"===c.inputs.state||"pinching"===c.inputs.state}function No({left:c,middle:n,right:N,stroke:da,strokeWidth:ua}){return(0,$t.jsxs)("g",{children:[(0,$t.jsx)("path",{className:"tl-stroke-hitarea",d:`M ${c} L ${n} ${N}`}),(0,$t.jsx)("path",{d:`M ${c} L ${n} ${N}`,fill:"none",
stroke:da,strokeWidth:ua,strokeLinecap:"round",strokeLinejoin:"round",pointerEvents:"none"})]})}function Wl(c,n,N){n=Q(c,n,c,N).points;if(!n)return console.warn("Could not find an intersection for the arrow head."),{left:c,right:c};n=(N=n[0])?pe.rotWith(N,c,Math.PI/6):c;c=N?pe.rotWith(N,c,-Math.PI/6):c;return{left:n,right:c}}function tm(c,n,N){const {left:da,right:ua}=Wl(c,n,N);return`M ${da} L ${c} ${ua}`}function Bj(c,n,N,da,ua){c=c.strokeWidth;var Ga=pe.dist(n,N);c=Math.min(Ga/3,16*c);Ga=[];Ga.push(`M ${n} L ${N}`);
da&&Ga.push(tm(n,N,c));ua&&Ga.push(tm(N,n,c));return Ga.join(" ")}function bp({id:c,bounds:n,labelSize:N,offset:da,scale:ua=1}){return(0,fs.jsx)("defs",{children:(0,fs.jsxs)("mask",{id:c+"_clip",children:[(0,fs.jsx)("rect",{x:-100,y:-100,width:n.width+200,height:n.height+200,fill:"white"}),(0,fs.jsx)("rect",{x:n.width/2-N[0]/2*ua+((null==da?void 0:da[0])||0),y:n.height/2-N[1]/2*ua+((null==da?void 0:da[1])||0),width:N[0]*ua,height:N[1]*ua,rx:4*ua,ry:4*ua,fill:"black"})]})})}function Wk(c,n,N,da=ua=>
ua){return c*da(.5-n*(.5-N))}function ur(c){return[-c[0],-c[1]]}function Jk(c,n){return[c[0]+n[0],c[1]+n[1]]}function zj(c,n){return[c[0]-n[0],c[1]-n[1]]}function ik(c,n){return[c[0]*n,c[1]*n]}function lo(c){return[c[1],-c[0]]}function Us(c,n){return c[0]===n[0]&&c[1]===n[1]}function zm(c){return c[0]*c[0]+c[1]*c[1]}function dn(c){var n=Math.hypot(c[0],c[1]);return[c[0]/n,c[1]/n]}function sr(c,n){return Math.hypot(c[1]-n[1],c[0]-n[0])}function Ak(c,n,N){let da=Math.sin(N);N=Math.cos(N);let ua=c[0]-
n[0];c=c[1]-n[1];return[ua*N-c*da+n[0],ua*da+c*N+n[1]]}function Kl(c,n,N){return Jk(c,ik(zj(n,c),N))}function en(c,n,N){return Jk(c,ik(n,N))}function uq(c,n={}){let {size:N=16,smoothing:da=.5,thinning:ua=.5,simulatePressure:Ga=!0,easing:Ma=Ef=>Ef,start:fb={},end:vb={},last:Wb=!1}=n,{cap:oc=!0,easing:xc=Ef=>Ef*(2-Ef)}=fb,{cap:Uc=!0,easing:md=Ef=>--Ef*Ef*Ef+1}=vb;if(0===c.length||0>=N)return[];var hd=c[c.length-1].runningLength;let Bd=!1===fb.taper?0:!0===fb.taper?Math.max(N,hd):fb.taper,Ld=!1===vb.taper?
0:!0===vb.taper?Math.max(N,hd):vb.taper;var bd=Math.pow(N*da,2);n=[];let jd=[];var rd=c.slice(0,10).reduce((Ef,xf)=>{var Vf=xf.pressure;Ga&&(xf=Gp(1,xf.distance/N),Vf=Gp(1,1-xf),Vf=Gp(1,Ef+.275*(Vf-Ef)*xf));return(Ef+Vf)/2},c[0].pressure),Md=Wk(N,ua,c[c.length-1].pressure,Ma),Dd;let Oe=c[0].vector;var Pe=c[0].point;let cg=Pe;var cf=Pe;let Of=cg;var Hg=!1;for(var ah=0;ah<c.length;ah++){var {pressure:Eg}=c[ah];let {point:Ef,vector:xf,distance:Vf,runningLength:ch}=c[ah];if(ah<c.length-1&&3>hd-ch)continue;
ua?(Ga&&(Md=Gp(1,Vf/N),Eg=Gp(1,1-Md),Eg=Gp(1,rd+.275*(Eg-rd)*Md)),Md=Wk(N,ua,Eg,Ma)):Md=N/2;void 0===Dd&&(Dd=Md);var bh=ch<Bd?xc(ch/Bd):1,vf=hd-ch<Ld?md((hd-ch)/Ld):1;Md=Math.max(.01,Md*Math.min(bh,vf));vf=(ah<c.length-1?c[ah+1]:c[ah]).vector;let Fh=ah<c.length-1?xf[0]*vf[0]+xf[1]*vf[1]:1;bh=null!==Fh&&0>Fh;if(0>xf[0]*Oe[0]+xf[1]*Oe[1]&&!Hg||bh){Pe=ik(lo(Oe),Md);for(let Vi=1/13,hi=0;1>=hi;hi+=Vi)cf=Ak(zj(Ef,Pe),Ef,Vq*hi),n.push(cf),Of=Ak(Jk(Ef,Pe),Ef,Vq*-hi),jd.push(Of);Pe=cf;cg=Of;bh&&(Hg=!0)}else(Hg=
!1,ah===c.length-1)?(Eg=ik(lo(xf),Md),n.push(zj(Ef,Eg)),jd.push(Jk(Ef,Eg))):(rd=ik(lo(Kl(vf,xf,Fh)),Md),cf=zj(Ef,rd),(1>=ah||zm(zj(Pe,cf))>bd)&&(n.push(cf),Pe=cf),Of=Jk(Ef,rd),(1>=ah||zm(zj(cg,Of))>bd)&&(jd.push(Of),cg=Of),rd=Eg,Oe=xf)}hd=c[0].point.slice(0,2);bd=1<c.length?c[c.length-1].point.slice(0,2):Jk(c[0].point,[1,1]);cf=[];Hg=[];if(1===c.length){if(!Bd&&!Ld||Wb){c=en(hd,dn(lo(zj(hd,bd))),-(Dd||Md));n=[];for(let Ef=1/13,xf=Ef;1>=xf;xf+=Ef)n.push(Ak(c,hd,2*Vq*xf));return n}}else{if(!(Bd||Ld&&
1===c.length))if(oc)for(let Ef=1/13,xf=Ef;1>=xf;xf+=Ef)Dd=Ak(jd[0],hd,Vq*xf),cf.push(Dd);else ah=zj(n[0],jd[0]),Dd=ik(ah,.5),ah=ik(ah,.51),cf.push(zj(hd,Dd),zj(hd,ah),Jk(hd,ah),Jk(hd,Dd));Dd=lo(ur(c[c.length-1].vector));if(Ld||Bd&&1===c.length)Hg.push(bd);else if(Uc){c=en(bd,Dd,Md);for(let Ef=1/29,xf=Ef;1>xf;xf+=Ef)Hg.push(Ak(c,bd,3*Vq*xf))}else Hg.push(Jk(bd,ik(Dd,Md)),Jk(bd,ik(Dd,.99*Md)),zj(bd,ik(Dd,.99*Md)),zj(bd,ik(Dd,Md)))}return n.concat(Hg,jd.reverse(),cf)}function Ws(c,n={}){var N;let {streamline:da=
.5,size:ua=16,last:Ga=!1}=n;if(0===c.length)return[];n=.15+.85*(1-da);c=Array.isArray(c[0])?c:c.map(({x:xc,y:Uc,pressure:md=.5})=>[xc,Uc,md]);if(2===c.length){var Ma=c[1];c=c.slice(0,-1);for(var fb=1;5>fb;fb++)c.push(Kl(c[0],Ma,fb/4))}1===c.length&&(c=[...c,[...Jk(c[0],[1,1]),...c[0].slice(2)]]);Ma=[{point:[c[0][0],c[0][1]],pressure:0<=c[0][2]?c[0][2]:.25,vector:[1,1],distance:0,runningLength:0}];fb=!1;let vb=0,Wb=Ma[0],oc=c.length-1;for(let xc=1;xc<c.length;xc++){let Uc=Ga&&xc===oc?c[xc].slice(0,
2):Kl(Wb.point,c[xc],n);if(Us(Wb.point,Uc))continue;let md=sr(Uc,Wb.point);if(vb+=md,xc<oc&&!fb){if(vb<ua)continue;fb=!0}Wb={point:Uc,pressure:0<=c[xc][2]?c[xc][2]:.5,vector:dn(zj(Wb.point,Uc)),distance:md,runningLength:vb};Ma.push(Wb)}return Ma[0].vector=(null==(N=Ma[1])?void 0:N.vector)||[0,0],Ma}function dp(c,n=4/3){return(new tq(c)).exportAsSVG(n)}function ep(c,n=4/3){return(new tq(c)).generatePreviewJsx(void 0,n)}function vl({id:c,type:n,onRemove:N,showContent:da}){const ua=Te(),{handlers:Ga}=
xx.default.useContext(vi),Ma=Ga.t;return(0,Xi.jsxs)("div",{className:"tl-shape-links-panel-item color-level relative",children:[(0,Xi.jsx)("div",{className:"whitespace-pre break-all overflow-hidden text-ellipsis inline-flex",children:(0,Xi.jsx)(yx,{id:c,showReferenceContent:da})}),(0,Xi.jsx)("div",{className:"flex-1"}),Ga.getBlockPageName(c)!==ua.currentPage.name&&(0,Xi.jsx)(kh,{tooltip:Ma("whiteboard/open-page"),type:"button",onClick:()=>null==Ga?void 0:Ga.redirectToPage(c),children:(0,Xi.jsx)(eh,
{name:"open-as-page"})}),(0,Xi.jsx)(kh,{tooltip:Ma("whiteboard/open-page-in-sidebar"),type:"button",onClick:()=>null==Ga?void 0:Ga.sidebarAddBlock(c,"B"===n?"block":"page"),children:(0,Xi.jsx)(eh,{name:"move-to-sidebar-right"})}),N&&(0,Xi.jsx)(kh,{className:"tl-shape-links-panel-item-remove-button",tooltip:Ma("whiteboard/remove-link"),type:"button",onClick:N,children:(0,Xi.jsx)(eh,{name:"x",className:"!translate-y-0"})})]})}function Bk({options:c,value:n,onValueChange:N}){return(0,yn.jsx)(is.ToggleGroup,
{type:"single",value:n,onValueChange:N,children:c.map(da=>(0,yn.jsx)(Tg,{content:da.tooltip,children:(0,yn.jsx)("div",{className:"inline-flex",children:(0,yn.jsx)(is.ToggleGroupItem,{className:"tl-button",value:da.value,disabled:da.value===n,children:(0,yn.jsx)(eh,{name:da.icon})})})},da.value))})}function ui({options:c,value:n,onValueChange:N}){return(0,yn.jsx)(is.ToggleGroup,{className:"inline-flex",type:"multiple",value:n,onValueChange:N,children:c.map(da=>(0,yn.jsx)(is.ToggleGroupItem,{className:"tl-button",
value:da.value,children:(0,yn.jsx)(eh,{name:da.icon})},da.value))})}function tk(c){return Te().selectedShapesArray.filter(n=>!n.props.isLocked).filter(n=>{var N;return null==(N=rj[n.props.type])?void 0:N.includes(c)})}function wq(c){var n;c=c.match(/\.[0-9a-z]+$/i);if(!c)return"unknown";const N=c[0].toLowerCase();[c]=null!=(n=Object.entries(ps).find(([,da])=>da.includes(N)))?n:["unknown",null];return c}function Xk(...c){return(...n)=>Zh(this,null,function*(){for(const N of c){const da=yield N(...n);
if(da&&0<da.length)return da}return null})}function Bm(c,n){return Zh(this,null,function*(){return c.types.includes(n)?c instanceof DataTransfer?c.getData(n):yield(yield c.getType(n)).text():null})}function vr(){const {handlers:c}=Np.useContext(vi);return Np.useCallback((n,N)=>Zh(this,null,function*(){if(N.shiftKey&&1===n.selectedShapesArray.length){var da=yield navigator.clipboard.read();let ua;0<da.length&&(da=(yield(yield da[0].getType("text/plain")).text()).trim())&&(/^\(\(.*\)\)$/.test(da)&&
40===da.length?(da=da.slice(2,-2),og(da)&&(ua=da)):/^\[\[.*\]\]$/.test(da)&&(ua=da.slice(2,-2)));if(ua){n.selectedShapesArray[0].update({refs:[ua]});n.persist();return}}qs(n,N,c)}),[])}function uk(){const c=vr();return Mp.useCallback((n,N)=>Zh(this,[n,N],function*(da,{dataTransfer:ua,point:Ga}){c(da,{point:Ga,shiftKey:!1,dataTransfer:ua,fromDrop:!0})}),[])}function wr(){const {handlers:c}=ru.useContext(vi);return ru.useCallback((n,{text:N,html:da})=>{c.copyToClipboard(N,da)},[])}function xr(){return rs.default.useCallback(c=>
Zh(this,null,function*(){setTimeout(()=>{c.transition("logseq-portal").selectedTool.transition("creating")},100)}),[])}var hm=Object.create,wl=Object.defineProperty,fp=Object.defineProperties,gn=Object.getOwnPropertyDescriptor,mo=Object.getOwnPropertyDescriptors,hn=Object.getOwnPropertyNames,gp=Object.getOwnPropertySymbols,xq=Object.getPrototypeOf,no=Object.prototype.hasOwnProperty,jn=Object.prototype.propertyIsEnumerable,Cm=(c,n,N)=>n in c?wl(c,n,{enumerable:!0,configurable:!0,writable:!0,value:N}):
c[n]=N,Af=(c,n)=>{for(var N in n||={})no.call(n,N)&&Cm(c,N,n[N]);if(gp)for(N of gp(n))jn.call(n,N)&&Cm(c,N,n[N]);return c},kg=(c,n)=>fp(c,mo(n)),Zi=(c,n)=>{var N={},da;for(da in c)no.call(c,da)&&0>n.indexOf(da)&&(N[da]=c[da]);if(null!=c&&gp)for(da of gp(c))0>n.indexOf(da)&&jn.call(c,da)&&(N[da]=c[da]);return N},oo=(c,n)=>function(){return n||(0,c[hn(c)[0]])((n={exports:{}}).exports,n),n.exports},vk=(c,n,N,da)=>{if(n&&"object"===typeof n||"function"===typeof n)for(let ua of hn(n))no.call(c,ua)||ua===
N||wl(c,ua,{get:()=>n[ua],enumerable:!(da=gn(n,ua))||da.enumerable});return c},Lf=(c,n,N)=>(N=null!=c?hm(xq(c)):{},vk(!n&&c&&c.__esModule?N:wl(N,"default",{value:c,enumerable:!0}),c)),re=(c,n,N,da)=>{for(var ua=1<da?void 0:da?gn(n,N):n,Ga=c.length-1,Ma;0<=Ga;Ga--)if(Ma=c[Ga])ua=(da?Ma(n,N,ua):Ma(ua))||ua;da&&ua&&wl(n,N,ua);return ua},xb=(c,n,N)=>{Cm(c,"symbol"!==typeof n?n+"":n,N);return N},Zh=(c,n,N)=>new Promise((da,ua)=>{var Ga=vb=>{try{fb(N.next(vb))}catch(Wb){ua(Wb)}},Ma=vb=>{try{fb(N.throw(vb))}catch(Wb){ua(Wb)}},
fb=vb=>vb.done?da(vb.value):Promise.resolve(vb.value).then(Ga,Ma);fb((N=N.apply(c,n)).next())}),F=oo({["../../node_modules/rbush/rbush.min.js"](c,n){!function(N,da){"object"==typeof c&&"undefined"!=typeof n?n.exports=da():"function"==typeof define&&define.amd?define(da):(N=N||self).RBush=da()}(c,function(){function N(bd,jd,rd,Md,Dd){!function ah(Pe,cg,cf,Of,Hg){for(;Of>cf;){if(600<Of-cf){var Eg=Of-cf+1,bh=cg-cf+1,vf=Math.log(Eg),Ef=.5*Math.exp(2*vf/3);vf=.5*Math.sqrt(vf*Ef*(Eg-Ef)/Eg)*(0>bh-Eg/2?
-1:1);ah(Pe,cg,Math.max(cf,Math.floor(cg-bh*Ef/Eg+vf)),Math.min(Of,Math.floor(cg+(Eg-bh)*Ef/Eg+vf)),Hg)}Eg=Pe[cg];bh=cf;Ef=Of;da(Pe,cf,cg);for(0<Hg(Pe[Of],Eg)&&da(Pe,cf,Of);bh<Ef;){da(Pe,bh,Ef);bh++;for(Ef--;0>Hg(Pe[bh],Eg);)bh++;for(;0<Hg(Pe[Ef],Eg);)Ef--}0===Hg(Pe[cf],Eg)?da(Pe,cf,Ef):da(Pe,++Ef,Of);Ef<=cg&&(cf=Ef+1);cg<=Ef&&(Of=Ef-1)}}(bd,jd,rd||0,Md||bd.length-1,Dd||ua)}function da(bd,jd,rd){var Md=bd[jd];bd[jd]=bd[rd];bd[rd]=Md}function ua(bd,jd){return bd<jd?-1:bd>jd?1:0}function Ga(bd,jd){Ma(bd,
0,bd.children.length,jd,bd)}function Ma(bd,jd,rd,Md,Dd){Dd||=hd(null);Dd.minX=1/0;Dd.minY=1/0;Dd.maxX=-1/0;for(Dd.maxY=-1/0;jd<rd;jd++){var Oe=bd.children[jd];fb(Dd,bd.leaf?Md(Oe):Oe)}return Dd}function fb(bd,jd){return bd.minX=Math.min(bd.minX,jd.minX),bd.minY=Math.min(bd.minY,jd.minY),bd.maxX=Math.max(bd.maxX,jd.maxX),bd.maxY=Math.max(bd.maxY,jd.maxY),bd}function vb(bd,jd){return bd.minX-jd.minX}function Wb(bd,jd){return bd.minY-jd.minY}function oc(bd){return(bd.maxX-bd.minX)*(bd.maxY-bd.minY)}
function xc(bd){return bd.maxX-bd.minX+(bd.maxY-bd.minY)}function Uc(bd,jd){return bd.minX<=jd.minX&&bd.minY<=jd.minY&&jd.maxX<=bd.maxX&&jd.maxY<=bd.maxY}function md(bd,jd){return jd.minX<=bd.maxX&&jd.minY<=bd.maxY&&jd.maxX>=bd.minX&&jd.maxY>=bd.minY}function hd(bd){return{children:bd,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function Bd(bd,jd,rd,Md,Dd){for(var Oe=[jd,rd];Oe.length;)if(!((rd=Oe.pop())-(jd=Oe.pop())<=Md)){var Pe=jd+Math.ceil((rd-jd)/Md/2)*Md;N(bd,Pe,jd,rd,Dd);Oe.push(jd,
Pe,Pe,rd)}}var Ld=function(bd){void 0===bd&&(bd=9);this._maxEntries=Math.max(4,bd);this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries));this.clear()};return Ld.prototype.all=function(){return this._all(this.data,[])},Ld.prototype.search=function(bd){var jd=this.data,rd=[];if(!md(bd,jd))return rd;for(var Md=this.toBBox,Dd=[];jd;){for(var Oe=0;Oe<jd.children.length;Oe++){var Pe=jd.children[Oe],cg=jd.leaf?Md(Pe):Pe;md(bd,cg)&&(jd.leaf?rd.push(Pe):Uc(bd,cg)?this._all(Pe,rd):Dd.push(Pe))}jd=Dd.pop()}return rd},
Ld.prototype.collides=function(bd){var jd=this.data;if(!md(bd,jd))return!1;for(var rd=[];jd;){for(var Md=0;Md<jd.children.length;Md++){var Dd=jd.children[Md],Oe=jd.leaf?this.toBBox(Dd):Dd;if(md(bd,Oe)){if(jd.leaf||Uc(bd,Oe))return!0;rd.push(Dd)}}jd=rd.pop()}return!1},Ld.prototype.load=function(bd){if(!bd||!bd.length)return this;if(bd.length<this._minEntries){for(var jd=0;jd<bd.length;jd++)this.insert(bd[jd]);return this}bd=this._build(bd.slice(),0,bd.length-1,0);this.data.children.length?this.data.height===
bd.height?this._splitRoot(this.data,bd):(this.data.height<bd.height&&(jd=this.data,this.data=bd,bd=jd),this._insert(bd,this.data.height-bd.height-1,!0)):this.data=bd;return this},Ld.prototype.insert=function(bd){return bd&&this._insert(bd,this.data.height-1),this},Ld.prototype.clear=function(){return this.data=hd([]),this},Ld.prototype.remove=function(bd,jd){if(!bd)return this;for(var rd,Md,Dd,Oe=this.data,Pe=this.toBBox(bd),cg=[],cf=[];Oe||cg.length;){if(Oe||(Oe=cg.pop(),Md=cg[cg.length-1],rd=cf.pop(),
Dd=!0),Oe.leaf){a:{var Of=bd;var Hg=Oe.children,ah=jd;if(ah){for(var Eg=0;Eg<Hg.length;Eg++)if(ah(Of,Hg[Eg])){Of=Eg;break a}Of=-1}else Of=Hg.indexOf(Of)}if(-1!==Of)return Oe.children.splice(Of,1),cg.push(Oe),this._condense(cg),this}Dd||Oe.leaf||!Uc(Oe,Pe)?Md?(rd++,Oe=Md.children[rd],Dd=!1):Oe=null:(cg.push(Oe),cf.push(rd),rd=0,Md=Oe,Oe=Oe.children[0])}return this},Ld.prototype.toBBox=function(bd){return bd},Ld.prototype.compareMinX=function(bd,jd){return bd.minX-jd.minX},Ld.prototype.compareMinY=
function(bd,jd){return bd.minY-jd.minY},Ld.prototype.toJSON=function(){return this.data},Ld.prototype.fromJSON=function(bd){return this.data=bd,this},Ld.prototype._all=function(bd,jd){for(var rd=[];bd;)bd.leaf?jd.push.apply(jd,bd.children):rd.push.apply(rd,bd.children),bd=rd.pop();return jd},Ld.prototype._build=function(bd,jd,rd,Md){var Dd,Oe=rd-jd+1,Pe=this._maxEntries;if(Oe<=Pe)return Ga(Dd=hd(bd.slice(jd,rd+1)),this.toBBox),Dd;Md||(Md=Math.ceil(Math.log(Oe)/Math.log(Pe)),Pe=Math.ceil(Oe/Math.pow(Pe,
Md-1)));(Dd=hd([])).leaf=!1;Dd.height=Md;Oe=Math.ceil(Oe/Pe);Pe=Oe*Math.ceil(Math.sqrt(Pe));for(Bd(bd,jd,rd,Pe,this.compareMinX);jd<=rd;jd+=Pe){var cg=Math.min(jd+Pe-1,rd);Bd(bd,jd,cg,Oe,this.compareMinY);for(var cf=jd;cf<=cg;cf+=Oe)Dd.children.push(this._build(bd,cf,Math.min(cf+Oe-1,cg),Md-1))}return Ga(Dd,this.toBBox),Dd},Ld.prototype._chooseSubtree=function(bd,jd,rd,Md){for(;Md.push(jd),!jd.leaf&&Md.length-1!==rd;){for(var Dd=1/0,Oe=1/0,Pe=void 0,cg=0;cg<jd.children.length;cg++){var cf=jd.children[cg],
Of=oc(cf),Hg=(ah=bd,Eg=cf,(Math.max(Eg.maxX,ah.maxX)-Math.min(Eg.minX,ah.minX))*(Math.max(Eg.maxY,ah.maxY)-Math.min(Eg.minY,ah.minY))-Of);Hg<Oe?(Oe=Hg,Dd=Of<Dd?Of:Dd,Pe=cf):Hg===Oe&&Of<Dd&&(Dd=Of,Pe=cf)}jd=Pe||jd.children[0]}var ah,Eg;return jd},Ld.prototype._insert=function(bd,jd,rd){rd=rd?bd:this.toBBox(bd);var Md=[],Dd=this._chooseSubtree(rd,this.data,jd,Md);Dd.children.push(bd);for(fb(Dd,rd);0<=jd&&Md[jd].children.length>this._maxEntries;)this._split(Md,jd),jd--;this._adjustParentBBoxes(rd,Md,
jd)},Ld.prototype._split=function(bd,jd){var rd=bd[jd],Md=rd.children.length,Dd=this._minEntries;this._chooseSplitAxis(rd,Dd,Md);Md=this._chooseSplitIndex(rd,Dd,Md);Md=hd(rd.children.splice(Md,rd.children.length-Md));Md.height=rd.height;Md.leaf=rd.leaf;Ga(rd,this.toBBox);Ga(Md,this.toBBox);jd?bd[jd-1].children.push(Md):this._splitRoot(rd,Md)},Ld.prototype._splitRoot=function(bd,jd){this.data=hd([bd,jd]);this.data.height=bd.height+1;this.data.leaf=!1;Ga(this.data,this.toBBox)},Ld.prototype._chooseSplitIndex=
function(bd,jd,rd){for(var Md,Dd,Oe,Pe,cg,cf,Of,Hg=1/0,ah=1/0,Eg=jd;Eg<=rd-jd;Eg++){var bh=Ma(bd,0,Eg,this.toBBox),vf=Ma(bd,Eg,rd,this.toBBox),Ef=(Dd=bh,Oe=vf,Pe=void 0,cg=void 0,cf=void 0,Of=void 0,Pe=Math.max(Dd.minX,Oe.minX),cg=Math.max(Dd.minY,Oe.minY),cf=Math.min(Dd.maxX,Oe.maxX),Of=Math.min(Dd.maxY,Oe.maxY),Math.max(0,cf-Pe)*Math.max(0,Of-cg));bh=oc(bh)+oc(vf);Ef<Hg?(Hg=Ef,Md=Eg,ah=bh<ah?bh:ah):Ef===Hg&&bh<ah&&(ah=bh,Md=Eg)}return Md||rd-jd},Ld.prototype._chooseSplitAxis=function(bd,jd,rd){var Md=
bd.leaf?this.compareMinX:vb,Dd=bd.leaf?this.compareMinY:Wb;this._allDistMargin(bd,jd,rd,Md)<this._allDistMargin(bd,jd,rd,Dd)&&bd.children.sort(Md)},Ld.prototype._allDistMargin=function(bd,jd,rd,Md){bd.children.sort(Md);Md=this.toBBox;for(var Dd=Ma(bd,0,jd,Md),Oe=Ma(bd,rd-jd,rd,Md),Pe=xc(Dd)+xc(Oe),cg=jd;cg<rd-jd;cg++){var cf=bd.children[cg];fb(Dd,bd.leaf?Md(cf):cf);Pe+=xc(Dd)}for(rd=rd-jd-1;rd>=jd;rd--)Dd=bd.children[rd],fb(Oe,bd.leaf?Md(Dd):Dd),Pe+=xc(Oe);return Pe},Ld.prototype._adjustParentBBoxes=
function(bd,jd,rd){for(;0<=rd;rd--)fb(jd[rd],bd)},Ld.prototype._condense=function(bd){for(var jd=bd.length-1,rd=void 0;0<=jd;jd--)0===bd[jd].children.length?0<jd?(rd=bd[jd-1].children).splice(rd.indexOf(bd[jd]),1):this.clear():Ga(bd[jd],this.toBBox)},Ld})}}),ca=oo({["../../node_modules/fast-deep-equal/index.js"](c,n){n.exports=function Ga(da,ua){if(da===ua)return!0;if(da&&ua&&"object"==typeof da&&"object"==typeof ua){if(da.constructor!==ua.constructor)return!1;var Ma;if(Array.isArray(da)){var fb=
da.length;if(fb!=ua.length)return!1;for(Ma=fb;0!==Ma--;)if(!Ga(da[Ma],ua[Ma]))return!1;return!0}if(da.constructor===RegExp)return da.source===ua.source&&da.flags===ua.flags;if(da.valueOf!==Object.prototype.valueOf)return da.valueOf()===ua.valueOf();if(da.toString!==Object.prototype.toString)return da.toString()===ua.toString();var vb=Object.keys(da);fb=vb.length;if(fb!==Object.keys(ua).length)return!1;for(Ma=fb;0!==Ma--;)if(!Object.prototype.hasOwnProperty.call(ua,vb[Ma]))return!1;for(Ma=fb;0!==Ma--;)if(fb=
vb[Ma],!Ga(da[fb],ua[fb]))return!1;return!0}return da!==da&&ua!==ua}}}),Ba=oo({["../../../../node_modules/deepmerge/dist/cjs.js"](c,n){function N(xc,Uc){return!1!==Uc.clone&&Uc.isMergeableObject(xc)?vb(Array.isArray(xc)?[]:{},xc,Uc):xc}function da(xc,Uc,md){return xc.concat(Uc).map(function(hd){return N(hd,md)})}function ua(xc){return Object.getOwnPropertySymbols?Object.getOwnPropertySymbols(xc).filter(function(Uc){return Object.propertyIsEnumerable.call(xc,Uc)}):[]}function Ga(xc){return Object.keys(xc).concat(ua(xc))}
function Ma(xc,Uc){try{return Uc in xc}catch(md){return!1}}function fb(xc,Uc,md){var hd={};md.isMergeableObject(xc)&&Ga(xc).forEach(function(Bd){hd[Bd]=N(xc[Bd],md)});Ga(Uc).forEach(function(Bd){if(!Ma(xc,Bd)||Object.hasOwnProperty.call(xc,Bd)&&Object.propertyIsEnumerable.call(xc,Bd))if(Ma(xc,Bd)&&md.isMergeableObject(Uc[Bd])){if(md.customMerge){var Ld=md.customMerge(Bd);Ld="function"===typeof Ld?Ld:vb}else Ld=vb;hd[Bd]=Ld(xc[Bd],Uc[Bd],md)}else hd[Bd]=N(Uc[Bd],md)});return hd}function vb(xc,Uc,md){md=
md||{};md.arrayMerge=md.arrayMerge||da;md.isMergeableObject=md.isMergeableObject||Wb;md.cloneUnlessOtherwiseSpecified=N;var hd=Array.isArray(Uc),Bd=Array.isArray(xc);return hd!==Bd?N(Uc,md):hd?md.arrayMerge(xc,Uc,md):fb(xc,Uc,md)}var Wb=function(xc){var Uc;if(Uc=!!xc&&"object"===typeof xc)Uc=Object.prototype.toString.call(xc),Uc=!("[object RegExp]"===Uc||"[object Date]"===Uc||xc.$$typeof===oc);return Uc},oc="function"===typeof Symbol&&Symbol.for?Symbol.for("react.element"):60103;vb.all=function(xc,
Uc){if(!Array.isArray(xc))throw Error("first argument should be an array");return xc.reduce(function(md,hd){return vb(md,hd,Uc)},{})};n.exports=vb}}),za={};((c,n)=>{for(var N in n)wl(c,N,{get:n[N],enumerable:!0})})(za,{App:()=>br,PreviewManager:()=>tq,generateJSXFromModel:()=>ep,generateSVGFromModel:()=>dp});Ya.exports=(c=>vk(wl({},"__esModule",{value:!0}),c))(za);var Oa=(c=>{c.Yellow="yellow";c.Red="red";c.Pink="pink";c.Green="green";c.Blue="blue";c.Purple="purple";c.Gray="gray";c.Default="";return c})(Oa||
{}),nb=(c=>{c.Box="box";c.Ellipse="ellipse";c.Polygon="polygon";return c})(nb||{}),Jb,Pb=new Uint8Array(16),vc=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i,ad=[];for(let c=0;256>c;++c)ad.push((c+256).toString(16).slice(1));var ud,Wd,$d=0,ge=0,Me=function(c,n,N){N=n&&N||0;const da=n||Array(16);c=c||{};let ua=c.node||ud;var Ga=void 0!==c.clockseq?c.clockseq:Wd;if(null==ua||null==Ga){var Ma=c.random||(c.rng||y)();null==ua&&(ua=
ud=[Ma[0]|1,Ma[1],Ma[2],Ma[3],Ma[4],Ma[5]]);null==Ga&&(Ga=Wd=(Ma[6]<<8|Ma[7])&16383)}Ma=void 0!==c.msecs?c.msecs:Date.now();let fb=void 0!==c.nsecs?c.nsecs:ge+1;const vb=Ma-$d+(fb-ge)/1E4;0>vb&&void 0===c.clockseq&&(Ga=Ga+1&16383);(0>vb||Ma>$d)&&void 0===c.nsecs&&(fb=0);if(1E4<=fb)throw Error("uuid.v1(): Can't create more than 10M uuids/sec");$d=Ma;ge=fb;Wd=Ga;Ma+=122192928E5;c=(1E4*(Ma&268435455)+fb)%4294967296;da[N++]=c>>>24&255;da[N++]=c>>>16&255;da[N++]=c>>>8&255;da[N++]=c&255;c=Ma/4294967296*
1E4&268435455;da[N++]=c>>>8&255;da[N++]=c&255;da[N++]=c>>>24&15|16;da[N++]=c>>>16&255;da[N++]=Ga>>>8|128;da[N++]=Ga&255;for(Ga=0;6>Ga;++Ga)da[N+Ga]=ua[Ga];return n||W(da)},af=class{static clamp(c,n,N){return Math.max(n,"undefined"!==typeof N?Math.min(c,N):c)}static clampV(c,n,N){return c.map(da=>N?af.clamp(da,n,N):af.clamp(da,n))}static cross(c,n,N){return(n[0]-c[0])*(N[1]-c[1])-(N[0]-c[0])*(n[1]-c[1])}static snap(c,n=1){return[Math.round(c[0]/n)*n,Math.round(c[1]/n)*n]}},Cd=af;Cd.neg=c=>[-c[0],-c[1]];
Cd.add=(c,n)=>[c[0]+n[0],c[1]+n[1]];Cd.addScalar=(c,n)=>[c[0]+n,c[1]+n];Cd.sub=(c,n)=>[c[0]-n[0],c[1]-n[1]];Cd.subScalar=(c,n)=>[c[0]-n,c[1]-n];Cd.vec=(c,n)=>[n[0]-c[0],n[1]-c[1]];Cd.mul=(c,n)=>[c[0]*n,c[1]*n];Cd.mulV=(c,n)=>[c[0]*n[0],c[1]*n[1]];Cd.div=(c,n)=>[c[0]/n,c[1]/n];Cd.divV=(c,n)=>[c[0]/n[0],c[1]/n[1]];Cd.per=c=>[c[1],-c[0]];Cd.dpr=(c,n)=>c[0]*n[0]+c[1]*n[1];Cd.cpr=(c,n)=>c[0]*n[1]-n[0]*c[1];Cd.len2=c=>c[0]*c[0]+c[1]*c[1];Cd.len=c=>Math.hypot(c[0],c[1]);Cd.pry=(c,n)=>af.dpr(c,n)/af.len(n);
Cd.uni=c=>af.div(c,af.len(c));Cd.normalize=c=>af.uni(c);Cd.tangent=(c,n)=>af.uni(af.sub(c,n));Cd.dist2=(c,n)=>af.len2(af.sub(c,n));Cd.dist=(c,n)=>Math.hypot(c[1]-n[1],c[0]-n[0]);Cd.fastDist=(c,n)=>{c=[n[0]-c[0],n[1]-c[1]];n=[Math.abs(c[0]),Math.abs(c[1])];let N=1/Math.max(n[0],n[1]);N*=1.29289-(n[0]+n[1])*N*.29289;return[c[0]*N,c[1]*N]};Cd.ang=(c,n)=>Math.atan2(af.cpr(c,n),af.dpr(c,n));Cd.angle=(c,n)=>Math.atan2(n[1]-c[1],n[0]-c[0]);Cd.med=(c,n)=>af.mul(af.add(c,n),.5);Cd.rot=(c,n=0)=>[c[0]*Math.cos(n)-
c[1]*Math.sin(n),c[0]*Math.sin(n)+c[1]*Math.cos(n)];Cd.rotWith=(c,n,N=0)=>{if(0===N)return c;const da=Math.sin(N);N=Math.cos(N);const ua=c[0]-n[0];c=c[1]-n[1];return[ua*N-c*da+n[0],ua*da+c*N+n[1]]};Cd.isEqual=(c,n)=>c[0]===n[0]&&c[1]===n[1];Cd.lrp=(c,n,N)=>af.add(c,af.mul(af.sub(n,c),N));Cd.int=(c,n,N,da,ua=1)=>{N=(af.clamp(N,da)-N)/(da-N);return af.add(af.mul(c,1-N),af.mul(n,ua))};Cd.ang3=(c,n,N)=>{c=af.vec(n,c);n=af.vec(n,N);return af.ang(c,n)};Cd.abs=c=>[Math.abs(c[0]),Math.abs(c[1])];Cd.rescale=
(c,n)=>{const N=af.len(c);return[n*c[0]/N,n*c[1]/N]};Cd.isLeft=(c,n,N)=>(n[0]-c[0])*(N[1]-c[1])-(N[0]-c[0])*(n[1]-c[1]);Cd.clockwise=(c,n,N)=>0<af.isLeft(c,n,N);Cd.toFixed=c=>c.map(n=>Math.round(100*n)/100);Cd.nearestPointOnLineThroughPoint=(c,n,N)=>af.add(c,af.mul(n,af.pry(af.sub(N,c),n)));Cd.distanceToLineThroughPoint=(c,n,N)=>af.dist(N,af.nearestPointOnLineThroughPoint(c,n,N));Cd.nearestPointOnLineSegment=(c,n,N,da=!0)=>{const ua=af.uni(af.sub(n,c));N=af.add(c,af.mul(ua,af.pry(af.sub(N,c),ua)));
if(da){if(N[0]<Math.min(c[0],n[0]))return c[0]<n[0]?c:n;if(N[0]>Math.max(c[0],n[0]))return c[0]>n[0]?c:n;if(N[1]<Math.min(c[1],n[1]))return c[1]<n[1]?c:n;if(N[1]>Math.max(c[1],n[1]))return c[1]>n[1]?c:n}return N};Cd.distanceToLineSegment=(c,n,N,da=!0)=>af.dist(N,af.nearestPointOnLineSegment(c,n,N,da));Cd.nudge=(c,n,N)=>af.isEqual(c,n)?c:af.add(c,af.mul(af.uni(af.sub(n,c)),N));Cd.nudgeAtAngle=(c,n,N)=>[Math.cos(n)*N+c[0],Math.sin(n)*N+c[1]];Cd.toPrecision=(c,n=4)=>[+c[0].toPrecision(n),+c[1].toPrecision(n)];
Cd.pointsBetween=(c,n,N=6)=>Array.from(Array(N)).map((da,ua)=>{da=ua/(N-1);ua=Math.min(1,.5+Math.abs(.5-da));return[...af.lrp(c,n,da),ua]});Cd.slope=(c,n)=>c[0]===n[0]?NaN:(c[1]-n[1])/(c[0]-n[0]);Cd.toAngle=c=>{c=Math.atan2(c[1],c[0]);return 0>c?c+2*Math.PI:c};Cd.max=(...c)=>[Math.max(...c.map(n=>n[0])),Math.max(...c.map(n=>n[1]))];Cd.min=(...c)=>[Math.min(...c.map(n=>n[0])),Math.min(...c.map(n=>n[1]))];var pe=Cd,Je=class{static getRectangleSides(c,n,N=0){const da=[c[0]+n[0]/2,c[1]+n[1]/2],ua=Cd.rotWith(c,
da,N),Ga=Cd.rotWith(Cd.add(c,[n[0],0]),da,N),Ma=Cd.rotWith(Cd.add(c,n),da,N);c=Cd.rotWith(Cd.add(c,[0,n[1]]),da,N);return[["top",[ua,Ga]],["right",[Ga,Ma]],["bottom",[Ma,c]],["left",[c,ua]]]}static getBoundsSides(c){return Je.getRectangleSides([c.minX,c.minY],[c.width,c.height])}static expandBounds(c,n){return{minX:c.minX-n,minY:c.minY-n,maxX:c.maxX+n,maxY:c.maxY+n,width:c.width+2*n,height:c.height+2*n}}static boundsCollide(c,n){return!(c.maxX<n.minX||c.minX>n.maxX||c.maxY<n.minY||c.minY>n.maxY)}static boundsContain(c,
n){return Array.isArray(n)?c.minX<n[0]&&c.minY<n[1]&&c.maxY>n[1]&&c.maxX>n[0]:c.minX<n.minX&&c.minY<n.minY&&c.maxY>n.maxY&&c.maxX>n.maxX}static boundsContained(c,n){return Je.boundsContain(n,c)}static boundsAreEqual(c,n){return!(n.maxX!==c.maxX||n.minX!==c.minX||n.maxY!==c.maxY||n.minY!==c.minY)}static getBoundsFromPoints(c,n=0){let N=Infinity,da=Infinity,ua=-Infinity,Ga=-Infinity;if(2>c.length)da=N=0,Ga=ua=1;else for(const Ma of c)N=Math.min(Ma[0],N),da=Math.min(Ma[1],da),ua=Math.max(Ma[0],ua),Ga=
Math.max(Ma[1],Ga);return 0!==n?Je.getBoundsFromPoints(c.map(Ma=>Cd.rotWith(Ma,[(N+ua)/2,(da+Ga)/2],n))):{minX:N,minY:da,maxX:ua,maxY:Ga,width:Math.max(1,ua-N),height:Math.max(1,Ga-da)}}static centerBounds(c,n){const N=Je.getBoundsCenter(c);return Je.translateBounds(c,[n[0]-N[0],n[1]-N[1]])}static snapBoundsToGrid(c,n){const N=Math.round(c.minX/n)*n,da=Math.round(c.minY/n)*n,ua=Math.round(c.maxX/n)*n;c=Math.round(c.maxY/n)*n;return{minX:N,minY:da,maxX:ua,maxY:c,width:Math.max(1,ua-N),height:Math.max(1,
c-da)}}static translateBounds(c,n){return{minX:c.minX+n[0],minY:c.minY+n[1],maxX:c.maxX+n[0],maxY:c.maxY+n[1],width:c.width,height:c.height}}static multiplyBounds(c,n){const N=Je.getBoundsCenter(c);return Je.centerBounds({minX:c.minX*n,minY:c.minY*n,maxX:c.maxX*n,maxY:c.maxY*n,width:c.width*n,height:c.height*n},[N[0]*n,N[1]*n])}static divideBounds(c,n){const N=Je.getBoundsCenter(c);return Je.centerBounds({minX:c.minX/n,minY:c.minY/n,maxX:c.maxX/n,maxY:c.maxY/n,width:c.width/n,height:c.height/n},[N[0]/
n,N[1]/n])}static getRotatedBounds(c,n=0){c=Je.getRotatedCorners(c,n);let N=n=Infinity,da=-Infinity,ua=-Infinity;for(const Ga of c)n=Math.min(Ga[0],n),N=Math.min(Ga[1],N),da=Math.max(Ga[0],da),ua=Math.max(Ga[1],ua);return{minX:n,minY:N,maxX:da,maxY:ua,width:Math.max(1,da-n),height:Math.max(1,ua-N),rotation:0}}static getRotatedEllipseBounds(c,n,N,da,ua=0){var Ga=Math.cos(ua);const Ma=Math.sin(ua);ua=Math.hypot(N*Ga,da*Ma);Ga=Math.hypot(N*Ma,da*Ga);return{minX:c+N-ua,minY:n+da-Ga,maxX:c+N+ua,maxY:n+
da+Ga,width:2*ua,height:2*Ga}}static getExpandedBounds(c,n){const N=Math.min(c.minX,n.minX),da=Math.min(c.minY,n.minY),ua=Math.max(c.maxX,n.maxX);c=Math.max(c.maxY,n.maxY);return{minX:N,minY:da,maxX:ua,maxY:c,width:Math.abs(ua-N),height:Math.abs(c-da)}}static getCommonBounds(c){if(2>c.length)return c[0];let n=c[0];for(let N=1;N<c.length;N++)n=Je.getExpandedBounds(n,c[N]);return n}static getRotatedCorners(c,n=0){const N=[c.minX+c.width/2,c.minY+c.height/2];c=[[c.minX,c.minY],[c.maxX,c.minY],[c.maxX,
c.maxY],[c.minX,c.maxY]];return n?c.map(da=>Cd.rotWith(da,N,n)):c}static getTransformedBoundingBox(c,n,N,da=0,ua=!1){const [Ga,Ma]=[c.minX,c.minY],[fb,vb]=[c.maxX,c.maxY];let [Wb,oc]=[c.minX,c.minY],[xc,Uc]=[c.maxX,c.maxY];if("center"===n)return{minX:Wb+N[0],minY:oc+N[1],maxX:xc+N[0],maxY:Uc+N[1],width:xc-Wb,height:Uc-oc,scaleX:1,scaleY:1};const [md,hd]=Cd.rot(N,-da);switch(n){case "top_edge":case "top_left_corner":case "top_right_corner":oc+=hd;break;case "bottom_edge":case "bottom_left_corner":case "bottom_right_corner":Uc+=
hd}switch(n){case "left_edge":case "top_left_corner":case "bottom_left_corner":Wb+=md;break;case "right_edge":case "top_right_corner":case "bottom_right_corner":xc+=md}var Bd=fb-Ga;const Ld=vb-Ma;var bd=(xc-Wb)/Bd,jd=(Uc-oc)/Ld;c=0>bd;N=0>jd;var rd=Math.abs(xc-Wb),Md=Math.abs(Uc-oc);if(ua)switch(ua=Bd/Ld,Bd=ua<rd/Md,jd=1/ua*(0>jd?1:-1)*rd,bd=Md*(0>bd?1:-1)*ua,n){case "top_left_corner":Bd?oc=Uc+jd:Wb=xc+bd;break;case "top_right_corner":Bd?oc=Uc+jd:xc=Wb-bd;break;case "bottom_right_corner":Bd?Uc=oc-
jd:xc=Wb-bd;break;case "bottom_left_corner":Bd?Uc=oc-jd:Wb=xc+bd;break;case "bottom_edge":case "top_edge":rd=(Wb+xc)/2;Md*=ua;Wb=rd-Md/2;xc=rd+Md/2;break;case "left_edge":case "right_edge":Md=(oc+Uc)/2,rd/=ua,oc=Md-rd/2,Uc=Md+rd/2}if(0!==da%(2*Math.PI)){rd=[0,0];Md=Cd.med([Ga,Ma],[fb,vb]);bd=Cd.med([Wb,oc],[xc,Uc]);switch(n){case "top_left_corner":rd=Cd.sub(Cd.rotWith([xc,Uc],bd,da),Cd.rotWith([fb,vb],Md,da));break;case "top_right_corner":rd=Cd.sub(Cd.rotWith([Wb,Uc],bd,da),Cd.rotWith([Ga,vb],Md,
da));break;case "bottom_right_corner":rd=Cd.sub(Cd.rotWith([Wb,oc],bd,da),Cd.rotWith([Ga,Ma],Md,da));break;case "bottom_left_corner":rd=Cd.sub(Cd.rotWith([xc,oc],bd,da),Cd.rotWith([fb,Ma],Md,da));break;case "top_edge":rd=Cd.sub(Cd.rotWith(Cd.med([Wb,Uc],[xc,Uc]),bd,da),Cd.rotWith(Cd.med([Ga,vb],[fb,vb]),Md,da));break;case "left_edge":rd=Cd.sub(Cd.rotWith(Cd.med([xc,oc],[xc,Uc]),bd,da),Cd.rotWith(Cd.med([fb,Ma],[fb,vb]),Md,da));break;case "bottom_edge":rd=Cd.sub(Cd.rotWith(Cd.med([Wb,oc],[xc,oc]),
bd,da),Cd.rotWith(Cd.med([Ga,Ma],[fb,Ma]),Md,da));break;case "right_edge":rd=Cd.sub(Cd.rotWith(Cd.med([Wb,oc],[Wb,Uc]),bd,da),Cd.rotWith(Cd.med([Ga,Ma],[Ga,vb]),Md,da))}[Wb,oc]=Cd.sub([Wb,oc],rd);[xc,Uc]=Cd.sub([xc,Uc],rd)}xc<Wb&&([xc,Wb]=[Wb,xc]);Uc<oc&&([Uc,oc]=[oc,Uc]);return{minX:Wb,minY:oc,maxX:xc,maxY:Uc,width:xc-Wb,height:Uc-oc,scaleX:(xc-Wb)/(fb-Ga||1)*(c?-1:1),scaleY:(Uc-oc)/(vb-Ma||1)*(N?-1:1)}}static getTransformAnchor(c,n,N){let da=c;switch(c){case "top_left_corner":da=n&&N?"bottom_right_corner":
n?"top_right_corner":N?"bottom_left_corner":"bottom_right_corner";break;case "top_right_corner":da=n&&N?"bottom_left_corner":n?"top_left_corner":N?"bottom_right_corner":"bottom_left_corner";break;case "bottom_right_corner":da=n&&N?"top_left_corner":n?"bottom_left_corner":N?"top_right_corner":"top_left_corner";break;case "bottom_left_corner":da=n&&N?"top_right_corner":n?"bottom_right_corner":N?"top_left_corner":"top_right_corner"}return da}static getRelativeTransformedBoundingBox(c,n,N,da,ua){da=c.minX+
(da?n.maxX-N.maxX:N.minX-n.minX)/n.width*c.width;ua=c.minY+(ua?n.maxY-N.maxY:N.minY-n.minY)/n.height*c.height;const Ga=N.width/n.width*c.width;c=N.height/n.height*c.height;return{minX:da,minY:ua,maxX:da+Ga,maxY:ua+c,width:Ga,height:c}}static getRotatedSize(c,n){const N=Cd.div(c,2);c=[[0,0],[c[0],0],c,[0,c[1]]].map(da=>Cd.rotWith(da,N,n));c=Je.getBoundsFromPoints(c);return[c.width,c.height]}static getBoundsCenter(c){return[c.minX+c.width/2,c.minY+c.height/2]}static getBoundsWithCenter(c){const n=Je.getBoundsCenter(c);
return kg(Af({},c),{midX:n[0],midY:n[1]})}static getCommonTopLeft(c){const n=[Infinity,Infinity];c.forEach(N=>{n[0]=Math.min(n[0],N[0]);n[1]=Math.min(n[1],N[1])});return n}static getTLSnapPoints(c,n,N){const da=Af({},c);c=[0,0];const ua=[],Ga={minX:{id:"minX",isSnapped:!1},midX:{id:"midX",isSnapped:!1},maxX:{id:"maxX",isSnapped:!1},minY:{id:"minY",isSnapped:!1},midY:{id:"midY",isSnapped:!1},maxY:{id:"maxY",isSnapped:!1}},Ma=["midX","minX","maxX"],fb=["midY","minY","maxY"];n=n.map(Uc=>{const md=Ma.flatMap((Bd,
Ld)=>Ma.map((bd,jd)=>{const rd=da[Bd]-Uc[bd];return{f:Bd,t:bd,gap:rd,distance:Math.abs(rd),isCareful:0===Ld||3===Ld+jd}})),hd=fb.flatMap((Bd,Ld)=>fb.map((bd,jd)=>{const rd=da[Bd]-Uc[bd];return{f:Bd,t:bd,gap:rd,distance:Math.abs(rd),isCareful:0===Ld||3===Ld+jd}}));return[Uc,md,hd]});let vb=Infinity,Wb=Infinity,oc=Infinity,xc=Infinity;n.forEach(([,Uc,md])=>{Uc.forEach(hd=>{hd.distance<N&&hd.distance<oc&&(oc=hd.distance,vb=hd.gap)});md.forEach(hd=>{hd.distance<N&&hd.distance<xc&&(xc=hd.distance,Wb=hd.gap)})});
n.forEach(([Uc,md,hd])=>{Infinity!==vb&&md.forEach(Bd=>{2>Math.abs(Bd.gap-vb)&&(Ga[Bd.f]=kg(Af({},Ga[Bd.f]),{isSnapped:!0,to:Uc[Bd.t],B:Uc,distance:Bd.distance}))});Infinity!==Wb&&hd.forEach(Bd=>{2>Math.abs(Bd.gap-Wb)&&(Ga[Bd.f]=kg(Af({},Ga[Bd.f]),{isSnapped:!0,to:Uc[Bd.t],B:Uc,distance:Bd.distance}))})});c[0]=Infinity===vb?0:vb;c[1]=Infinity===Wb?0:Wb;da.minX-=c[0];da.midX-=c[0];da.maxX-=c[0];da.minY-=c[1];da.midY-=c[1];da.maxY-=c[1];Ma.forEach(Uc=>{Uc=Ga[Uc];if(Uc.isSnapped){var {id:md,B:hd}=Uc;
Uc=da[md];ua.push("minX"===md?[[Uc,da.midY],[Uc,hd.minY],[Uc,hd.maxY]]:[[Uc,da.minY],[Uc,da.maxY],[Uc,hd.minY],[Uc,hd.maxY]])}});fb.forEach(Uc=>{Uc=Ga[Uc];if(Uc.isSnapped){var {id:md,B:hd}=Uc;Uc=da[md];ua.push("midY"===md?[[da.midX,Uc],[hd.minX,Uc],[hd.maxX,Uc]]:[[da.minX,Uc],[da.maxX,Uc],[hd.minX,Uc],[hd.maxX,Uc]])}});return{offset:c,snapLines:ua}}static ensureRatio(c,n){const {width:N,height:da}=c,ua=Af({},c);N/da<n?(ua.width=da*n,ua.maxX+=N-c.width):(ua.height=N/n,ua.maxY+=da-c.height);return ua}static getDistributions(c,
n){var N=c.map(Ga=>{const Ma=Ga.getBounds();return{id:Ga.id,point:[Ma.minX,Ma.minY],bounds:Ma,center:Ga.getCenter()}});c=N.length;var da=Je.getCommonBounds(N.map(({bounds:Ga})=>Ga));const ua=[];switch(n){case "horizontal":n=N.reduce((Ga,Ma)=>Ga+Ma.bounds.width,0);if(n>da.width){const Ga=N.sort((Wb,oc)=>Wb.bounds.minX-oc.bounds.minX)[0],Ma=N.sort((Wb,oc)=>oc.bounds.maxX-Wb.bounds.maxX)[0];da=N.filter(Wb=>Wb!==Ga&&Wb!==Ma).sort((Wb,oc)=>Wb.center[0]-oc.center[0]);const fb=(Ma.center[0]-Ga.center[0])/
(c-1),vb=Ga.center[0]+fb;da.forEach(({id:Wb,point:oc,bounds:xc},Uc)=>{ua.push({id:Wb,prev:oc,next:[vb+fb*Uc-xc.width/2,xc.minY]})})}else{N=N.sort((fb,vb)=>fb.center[0]-vb.center[0]);let Ga=da.minX;const Ma=(da.width-n)/(c-1);N.forEach(({id:fb,point:vb,bounds:Wb})=>{ua.push({id:fb,prev:vb,next:[Ga,Wb.minY]});Ga+=Wb.width+Ma})}break;case "vertical":if(n=N.reduce((Ga,Ma)=>Ga+Ma.bounds.height,0),n>da.height){const Ga=N.sort((Wb,oc)=>Wb.bounds.minY-oc.bounds.minY)[0],Ma=N.sort((Wb,oc)=>oc.bounds.maxY-
Wb.bounds.maxY)[0];da=N.filter(Wb=>Wb!==Ga&&Wb!==Ma).sort((Wb,oc)=>Wb.center[1]-oc.center[1]);const fb=(Ma.center[1]-Ga.center[1])/(c-1),vb=Ga.center[1]+fb;da.forEach(({id:Wb,point:oc,bounds:xc},Uc)=>{ua.push({id:Wb,prev:oc,next:[xc.minX,vb+fb*Uc-xc.height/2]})})}else{N=N.sort((fb,vb)=>fb.center[1]-vb.center[1]);let Ga=da.minY;const Ma=(da.height-n)/(c-1);N.forEach(({id:fb,point:vb,bounds:Wb})=>{ua.push({id:fb,prev:vb,next:[Wb.minX,Ga]});Ga+=Wb.height+Ma})}}return ua}static getPackedDistributions(c){const n=
Je.getCommonBounds(c.map(({bounds:ua})=>ua)),N=[n.minX,n.minY],da=Object.fromEntries(c.map(ua=>[ua.id,[ua.bounds.minX,ua.bounds.minY]]));c=c.filter(ua=>{var Ga,Ma,fb,vb;return!((null==(Ma=null==(Ga=ua.props.handles)?void 0:Ga.start)?0:Ma.bindingId)||(null==(vb=null==(fb=ua.props.handles)?void 0:fb.end)?0:vb.bindingId))}).map(ua=>{const Ga=ua.getBounds();return{id:ua.id,w:Ga.width+16,h:Ga.height+16,x:Ga.minX,y:Ga.minY}});B(c);return c.map(({id:ua,x:Ga,y:Ma})=>({id:ua,prev:da[ua],next:[Ga+N[0],Ma+N[1]]}))}},
li=class{static pointInCircle(c,n,N){return Cd.dist(c,n)<=N}static pointInEllipse(c,n,N,da,ua=0){ua=ua||0;var Ga=Math.cos(ua);ua=Math.sin(ua);n=Cd.sub(c,n);c=Ga*n[0]+ua*n[1];Ga=ua*n[0]-Ga*n[1];return 1>=c*c/(N*N)+Ga*Ga/(da*da)}static pointInRect(c,n){return!(c[0]<n[0]||c[0]>c[0]+n[0]||c[1]<n[1]||c[1]>c[1]+n[1])}static pointInPolygon(c,n){let N=0;n.forEach((da,ua)=>{ua=n[(ua+1)%n.length];da[1]<=c[1]?ua[1]>c[1]&&0<Cd.cross(da,ua,c)&&(N+=1):ua[1]<=c[1]&&0>Cd.cross(da,ua,c)&&--N});return 0!==N}static pointInBounds(c,
n){return!(c[0]<n.minX||c[0]>n.maxX||c[1]<n.minY||c[1]>n.maxY)}static pointInPolyline(c,n,N=3){for(let da=1;da<n.length;da++)if(Cd.distanceToLineSegment(n[da-1],n[da],c)<N)return!0;return!1}static _getSqSegDist(c,n,N){let da=n[0];n=n[1];let ua=N[0]-da,Ga=N[1]-n;if(0!==ua||0!==Ga){const Ma=((c[0]-da)*ua+(c[1]-n)*Ga)/(ua*ua+Ga*Ga);1<Ma?(da=N[0],n=N[1]):0<Ma&&(da+=ua*Ma,n+=Ga*Ma)}ua=c[0]-da;Ga=c[1]-n;return ua*ua+Ga*Ga}static _simplifyStep(c,n,N,da,ua){let Ga=da,Ma=-1;for(let fb=n+1;fb<N;fb++){const vb=
li._getSqSegDist(c[fb],c[n],c[N]);vb>Ga&&(Ma=fb,Ga=vb)}-1<Ma&&Ga>da&&(1<Ma-n&&li._simplifyStep(c,n,Ma,da,ua),ua.push(c[Ma]),1<N-Ma&&li._simplifyStep(c,Ma,N,da,ua))}static simplify2(c,n=1){if(2>=c.length)return c;n*=n;var N=c[0],da=c[1];const ua=[N];for(let Ga=1,Ma=c.length;Ga<Ma;Ga++)da=c[Ga],(da[0]-N[0])*(da[0]-N[0])+(da[1]-N[1])*(da[1]-N[1])>n&&(ua.push(da),N=da);N!==da&&ua.push(da);N=ua.length-1;da=[ua[0]];li._simplifyStep(ua,0,N,n,da);da.push(ua[N],c[c.length-1]);return da}static pointNearToPolyline(c,
n,N=8){const da=n.length;for(let ua=1;ua<da;ua++)if(Cd.distanceToLineSegment(n[ua-1],n[ua],c)<N)return!0;return!1}},wh=li;xb(wh,"simplify",(c,n=1)=>{var N=c.length;const da=c[0],ua=c[N-1],[Ga,Ma]=da,[fb,vb]=ua;if(2<N){let Wb=0,oc=0;const xc=Cd.len2([vb-Ma,fb-Ga]);for(let Uc=1;Uc<N-1;Uc++){const [md,hd]=c[Uc],Bd=Math.pow(md*(vb-Ma)+Ga*(hd-vb)+fb*(Ma-hd),2)/xc;Wb>Bd||(Wb=Bd,oc=Uc)}if(Wb>n)return N=li.simplify(c.slice(0,oc+1),n),c=li.simplify(c.slice(oc+1),n),N.concat(c.slice(1))}return[da,ua]});var Th=
Math.PI,ei=Th/2,Og=2*Th,Ai={},fi={bottom_edge:"ns-resize",top_edge:"ns-resize",left_edge:"ew-resize",right_edge:"ew-resize",bottom_left_corner:"nesw-resize",bottom_right_corner:"nwse-resize",top_left_corner:"nwse-resize",top_right_corner:"nesw-resize",bottom_left_resize_corner:"swne-rotate",bottom_right_resize_corner:"senw-rotate",top_left_resize_corner:"nwse-rotate",top_right_resize_corner:"nesw-rotate",rotate:"rotate",center:"grab",background:"grab"},Dh=class{static circleFromThreePoints(c,n,N){const [da,
ua]=c,[Ga,Ma]=n,[fb,vb]=N;n=da*(Ma-vb)-ua*(Ga-fb)+Ga*vb-fb*Ma;c=-((da*da+ua*ua)*(vb-Ma)+(Ga*Ga+Ma*Ma)*(ua-vb)+(fb*fb+vb*vb)*(Ma-ua))/(2*n);n=-((da*da+ua*ua)*(Ga-fb)+(Ga*Ga+Ma*Ma)*(fb-da)+(fb*fb+vb*vb)*(da-Ga))/(2*n);return[c,n,Math.hypot(c-da,n-ua)]}static perimeterOfEllipse(c,n){const N=Math.pow(c-n,2)/Math.pow(c+n,2);return Th*(c+n)*(1+3*N/(10+Math.sqrt(4-3*N)))}static shortAngleDist(c,n){c=(n-c)%Og;return 2*c%Og-c}static longAngleDist(c,n){return Og-Dh.shortAngleDist(c,n)}static lerpAngles(c,n,
N){return c+Dh.shortAngleDist(c,n)*N}static angleDelta(c,n){return Dh.shortAngleDist(c,n)}static getSweep(c,n,N){return Dh.angleDelta(pe.angle(c,n),pe.angle(c,N))}static clampRadians(c){return(Og+c)%Og}static snapAngleToSegments(c,n){n=Og/n;c=Math.floor((Dh.clampRadians(c)+n/2)/n)*n%Og;c<Th&&(c+=Og);c>Th&&(c-=Og);return c}static isAngleBetween(c,n,N){if(N===c||N===n)return!0;n=(n-c+ei)%ei;return n<=Th!==(N-c+ei)%ei>n}static degreesToRadians(c){return c*Th/180}static radiansToDegrees(c){return 180*
c/Th}static getArcLength(c,n,N,da){c=Dh.getSweep(c,N,da);return c/Og*Og*n}static getSweepFlag(c,n,N){N=pe.angle(c,N);return 0<(pe.angle(c,n)-N+3*Th)%Og-Th?0:1}static getLargeArcFlag(c,n,N){c=pe.angle(N,c);n=(pe.angle(N,n)-c+3*Th)%Og-Th;return Math.abs(n)>ei?0:1}static getArcDashOffset(c,n,N,da,ua){const Ga=Dh.getSweepFlag(c,N,da);n=Dh.getArcLength(c,n,N,da);return-(0>Ga?n:Og*c[2]-n)/2+ua}static getEllipseDashOffset(c,n){return-(Og*c[2])/2+-n}static radiansToCardinalDirection(c){return c<.25*Math.PI?
"north":c<.75*Math.PI?"east":c<1.25*Math.PI?"south":c<1.75*Math.PI?"west":"north"}},mi=class{static getPolygonCentroid(c){var n=c.map(N=>N[0]);c=c.map(N=>N[1]);n=Math.min(...n)+Math.max(...n);c=Math.min(...c)+Math.max(...c);return[n?n/2:0,c?c/2:0]}};xb(mi,"getEdges",c=>{const n=c.length;return c.map((N,da)=>[N,c[(da+1)%n]])});xb(mi,"getEdgeOutwardNormal",(c,n)=>pe.per(pe.uni(pe.sub(n,c))));xb(mi,"getEdgeInwardNormal",(c,n)=>pe.neg(mi.getEdgeOutwardNormal(c,n)));xb(mi,"getOffsetEdge",(c,n,N)=>{N=pe.mul(pe.per(pe.uni(pe.sub(n,
c))),N);return[pe.add(c,N),pe.add(n,N)]});xb(mi,"getOffsetEdges",(c,n)=>c.map(([N,da])=>mi.getOffsetEdge(N,da,n)));xb(mi,"getOffsetPolygon",(c,n)=>{if(1>c.length)throw Error("Expected at least one point.");if(1===c.length)return c=c[0],[pe.add(c,[-n,-n]),pe.add(c,[n,-n]),pe.add(c,[n,n]),pe.add(c,[-n,n])];if(2===c.length){const [N,da]=c;return[...mi.getOffsetEdge(N,da,n),...mi.getOffsetEdge(da,N,n)]}return mi.getOffsetEdges(mi.getEdges(c),n).flatMap((N,da,ua)=>{{da=ua[(da+1)%ua.length];const Ga=Cd.slope(N[0],
N[1]);ua=Cd.slope(da[0],da[1]);Ga!==ua?Number.isNaN(Ga)&&!Number.isNaN(ua)?N=[N[0][0],(N[0][0]-da[0][0])*ua+da[0][1]]:Number.isNaN(ua)&&!Number.isNaN(Ga)?N=[da[0][0],(da[0][0]-N[0][0])*Ga+N[0][1]]:(N=(Ga*N[0][0]-ua*da[0][0]+da[0][1]-N[0][1])/(Ga-ua),N=[N,ua*(N-da[0][0])+da[0][1]]):N=void 0}if(void 0===N)throw Error("Expected an intersection");return N})});xb(mi,"getPolygonVertices",(c,n,N=0,da=1)=>{c=pe.div(c,2);const [ua,Ga]=[Math.max(1,c[0]-N),Math.max(1,c[1]-N)];N=[];for(let Wb=0,oc=Og/n;Wb<n;Wb++){var Ma=
(-ei+Wb*oc)%Og,fb=(-ei+(Wb+1)*oc)%Og;Ma=pe.add(c,[ua*Math.cos(Ma),Ga*Math.sin(Ma)]);fb=pe.add(c,[ua*Math.cos(fb),Ga*Math.sin(fb)]);var vb=pe.med(Ma,fb);vb=pe.nudge(vb,c,pe.dist(c,vb)*(1-da));N.push(Ma,vb,fb)}return N});xb(mi,"getTriangleVertices",(c,n=0,N=1)=>{const [da,ua]=c;var Ga=1-N;c=[da/2,n/2];N=[da-n,ua-n];n=[n/2,ua-n];const Ma=mi.getPolygonCentroid([c,N,n]),fb=pe.med(c,N),vb=pe.med(N,n),Wb=pe.med(n,c),oc=pe.dist(fb,Ma)*Ga,xc=pe.dist(vb,Ma)*Ga;Ga*=pe.dist(Wb,Ma);return[c,oc?pe.nudge(fb,Ma,
oc):fb,N,xc?pe.nudge(vb,Ma,xc):vb,n,Ga?pe.nudge(Wb,Ma,Ga):Wb]});xb(mi,"getStarVertices",(c,n,N,da=1)=>{const ua=pe.div(n,2),Ga=pe.mul(ua,da/2),Ma=Og/N/2;return Array.from(Array(2*N)).map((fb,vb)=>{fb=-ei+vb*Ma;const [Wb,oc]=vb%2?Ga:ua;return pe.add(c,[Wb*Math.cos(fb),oc*Math.sin(fb)])})});var Xj=class{static getCurvedPathForPolygon(c){if(3>c.length)return"M -4, 0\n      a 4,4 0 1,0 8,0\n      a 4,4 0 1,0 -8,0";const n=["M",...c[0].slice(0,2),"Q"],N=c.length;for(let da=1;da<N;da++){const [ua,Ga]=c[da],
[Ma,fb]=c[(da+1)%N];n.push(ua,Ga,(ua+Ma)/2,(Ga+fb)/2)}n.push("Z");return n.join(" ")}static getCurvedPathForPoints(c){if(3>c.length)return"M -4, 0\n      a 4,4 0 1,0 8,0\n      a 4,4 0 1,0 -8,0";const n=["M",...c[0].slice(0,2),"Q"],N=c.length;for(let da=1;da<N-1;da++){const [ua,Ga]=c[da],[Ma,fb]=c[da+1];n.push(ua,Ga,(ua+Ma)/2,(Ga+fb)/2)}return n.join(" ")}static getSvgPathFromStroke(c,n=!0){const N=c.length;if(4>N)return"";let da=c[0],ua=c[1];var Ga=c[2];Ga=`M${da[0].toFixed(2)},${da[1].toFixed(2)} Q${ua[0].toFixed(2)},${ua[1].toFixed(2)} ${((ua[0]+
Ga[0])/2).toFixed(2)},${((ua[1]+Ga[1])/2).toFixed(2)} T`;for(let Ma=2,fb=N-1;Ma<fb;Ma++)da=c[Ma],ua=c[Ma+1],Ga+=`${((da[0]+ua[0])/2).toFixed(2)},${((da[1]+ua[1])/2).toFixed(2)} `;n&&(Ga+="Z");return Ga}static getSvgPathFromStrokePoints(c,n=!1){const N=c.length;if(4>N)return"";let da=c[0].point,ua=c[1].point;var Ga=c[2].point;Ga=`M${da[0].toFixed(2)},${da[1].toFixed(2)} Q${ua[0].toFixed(2)},${ua[1].toFixed(2)} ${((ua[0]+Ga[0])/2).toFixed(2)},${((ua[1]+Ga[1])/2).toFixed(2)} T`;for(let Ma=2,fb=N-1;Ma<
fb;Ma++)da=c[Ma].point,ua=c[Ma+1].point,Ga+=`${((da[0]+ua[0])/2).toFixed(2)},${((da[1]+ua[1])/2).toFixed(2)} `;n&&(Ga+="Z");return Ga}};xb(Xj,"TRIM_NUMBERS",/(\s?[A-Z]?,?-?[0-9]*\.[0-9]{0,2})(([0-9]|e|-)*)/g);var Ck={},Dm=Object.assign,xl=Object.getOwnPropertyDescriptor,Yk=Object.defineProperty,yq=Object.prototype,Xs=[];Object.freeze(Xs);var Ys={};Object.freeze(Ys);var Zy="undefined"!==typeof Proxy,$y=Object.toString(),hp=function(){},mv="undefined"!==typeof Object.getOwnPropertySymbols,yr="undefined"!==
typeof Reflect&&Reflect.ownKeys?Reflect.ownKeys:mv?function(c){return Object.getOwnPropertyNames(c).concat(Object.getOwnPropertySymbols(c))}:Object.getOwnPropertyNames,az=Object.getOwnPropertyDescriptors||function(c){var n={};yr(c).forEach(function(N){n[N]=xl(c,N)});return n},Ll=Symbol("mobx-stored-annotations"),Eh=Symbol("mobx administration"),zq=function(){function c(N){void 0===N&&(N="Atom");this.name_=void 0;this.isBeingObserved_=this.isPendingUnobservation_=!1;this.observers_=new Set;this.lastAccessedBy_=
this.diffValue_=0;this.lowestObserverState_=Hi.NOT_TRACKING_;this.onBUOL=this.onBOL=void 0;this.name_=N}var n=c.prototype;n.onBO=function(){this.onBOL&&this.onBOL.forEach(function(N){return N()})};n.onBUO=function(){this.onBUOL&&this.onBUOL.forEach(function(N){return N()})};n.reportObserved=function(){return kb(this)};n.reportChanged=function(){Nb();ub(this);Db()};n.toString=function(){return this.name_};return c}(),Zs=J("Atom",zq),ip={identity:function(c,n){return c===n},structural:function(c,n){return ma(c,
n)},"default":function(c,n){return Object.is?Object.is(c,n):c===n?0!==c||1/c===1/n:c!==c&&n!==n},shallow:function(c,n){return ma(c,n,1)}},bz="override",cz=Da(),Aq={deep:!0,name:void 0,defaultDecorator:void 0,proxy:!0};Object.freeze(Aq);var nv=gb("observable"),dz=gb("observable.ref",{enhancer:Na}),ez=gb("observable.shallow",{enhancer:function(c,n,N){if(void 0===c||null===c||Kb(c)||Mc(c)||kn(c)||ro(c))return c;if(Array.isArray(c))return Qg.array(c,{name:N,deep:!1});if(M(c))return Qg.object(c,void 0,
{name:N,deep:!1});if(T(c))return Qg.map(c,{name:N,deep:!1});if(S(c))return Qg.set(c,{name:N,deep:!1})}}),fz=gb("observable.struct",{enhancer:function(c,n){return ma(c,n)?n:c}}),ov=ya(nv);Object.assign(hb,ov);var gz={box:function(c,n){n=n||Aq;return new po(c,$a(n),n.name,!0,n.equals)},array:function(c,n){n=n||Aq;return(!1===Xf.useProxies||!1===n.proxy?f:bb)(c,$a(n),n.name)},map:function(c,n){n=n||Aq;return new zv(c,$a(n),n.name)},set:function(c,n){n=n||Aq;return new Av(c,$a(n),n.name)},object:function(c,
n,N){if(!1===Xf.useProxies||!1===(null==N?void 0:N.proxy))N=ld({},N);else{var da={},ua,Ga;x();da=ld(da,N);N=null!=(Ga=(ua=da[Eh]).proxy_)?Ga:ua.proxy_=new Proxy(da,uz)}return Ac(N,c,n)},ref:ya(dz),shallow:ya(ez),deep:ov,struct:ya(fz)},Qg=Dm(hb,gz),pv=Va("computed"),hz=Va("computed.struct",{equals:ip.structural}),Zg=function(c,n){if(z(n))return Ja(c,n,pv);if(M(c))return ya(Va("computed",c));n=M(n)?n:{};n.get=c;n.name||(n.name=c.name||"");return new Bq(n)};Object.assign(Zg,pv);Zg.struct=ya(hz);var qv,
rv,zr=0,iz=1,jz=null!=(qv=null==(rv=xl(function(){},"name"))?void 0:rv.configurable)?qv:!1,sv={value:"action",configurable:!0,writable:!1,enumerable:!1};var kz=Symbol.toPrimitive;var po=function(c){function n(da,ua,Ga,Ma,fb){void 0===Ga&&(Ga="ObservableValue");void 0===fb&&(fb=ip["default"]);Ma=c.call(this,Ga)||this;Ma.enhancer=void 0;Ma.hasUnreportedChange_=!1;Ma.interceptors_=void 0;Ma.changeListeners_=void 0;Ma.value_=void 0;Ma.dehancer=void 0;Ma.enhancer=ua;Ma.name_=Ga;Ma.equals=fb;Ma.value_=
ua(da,void 0,Ga);return Ma}ha(n,c);var N=n.prototype;N.dehanceValue=function(da){return void 0!==this.dehancer?this.dehancer(da):da};N.set=function(da){da=this.prepareNewValue_(da);da!==Xf.UNCHANGED&&this.setNewValue_(da)};N.prepareNewValue_=function(da){if(sb(this)){da=lb(this,{object:this,type:im,newValue:da});if(!da)return Xf.UNCHANGED;da=da.newValue}da=this.enhancer(da,this.value_,this.name_);return this.equals(this.value_,da)?Xf.UNCHANGED:da};N.setNewValue_=function(da){var ua=this.value_;this.value_=
da;this.reportChanged();Mb(this)&&hc(this,{type:im,object:this,newValue:da,oldValue:ua})};N.get=function(){this.reportObserved();return this.dehanceValue(this.value_)};N.intercept_=function(da){return Ib(this,da)};N.observe_=function(da,ua){ua&&da({observableKind:"value",debugObjectName:this.name_,object:this,type:im,newValue:this.value_,oldValue:void 0});return Fb(this,da)};N.raw=function(){return this.value_};N.toJSON=function(){return this.get()};N.toString=function(){return this.name_+"["+this.value_+
"]"};N.valueOf=function(){return ja(this.get())};N[kz]=function(){return this.valueOf()};return n}(zq),lz=J("ObservableValue",po);var mz=Symbol.toPrimitive;var Bq=function(){function c(N){this.dependenciesState_=Hi.NOT_TRACKING_;this.observing_=[];this.newObserving_=null;this.isPendingUnobservation_=this.isBeingObserved_=!1;this.observers_=new Set;this.lastAccessedBy_=this.runId_=this.diffValue_=0;this.lowestObserverState_=Hi.UP_TO_DATE_;this.unboundDepsCount_=0;this.value_=new qo(null);this.triggeredBy_=
this.name_=void 0;this.isRunningSetter_=this.isComputing_=!1;this.setter_=this.derivation=void 0;this.isTracing_=jp.NONE;this.onBUOL=this.onBOL=this.keepAlive_=this.requiresReaction_=this.equals_=this.scope_=void 0;N.get||d(31);this.derivation=N.get;this.name_=N.name||"ComputedValue";N.set&&(this.setter_=Za("ComputedValue-setter",N.set));this.equals_=N.equals||(N.compareStructural||N.struct?ip.structural:ip["default"]);this.scope_=N.context;this.requiresReaction_=N.requiresReaction;this.keepAlive_=
!!N.keepAlive}var n=c.prototype;n.onBecomeStale_=function(){ib(this)};n.onBO=function(){this.onBOL&&this.onBOL.forEach(function(N){return N()})};n.onBUO=function(){this.onBUOL&&this.onBUOL.forEach(function(N){return N()})};n.get=function(){this.isComputing_&&d(32,this.name_,this.derivation);if(0!==Xf.inBatch||0!==this.observers_.size||this.keepAlive_){if(kb(this),Tc(this)){var N=Xf.trackingContext;this.keepAlive_&&!N&&(Xf.trackingContext=this);this.trackAndCompute()&&zb(this);Xf.trackingContext=N}}else Tc(this)&&
(this.warnAboutUntrackedRead_(),Nb(),this.value_=this.computeValue_(!1),Db());N=this.value_;if(N instanceof qo)throw N.cause;return N};n.set=function(N){if(this.setter_){this.isRunningSetter_&&d(33,this.name_);this.isRunningSetter_=!0;try{this.setter_.call(this.scope_,N)}finally{this.isRunningSetter_=!1}}else d(34,this.name_)};n.trackAndCompute=function(){var N=this.value_,da=this.dependenciesState_===Hi.NOT_TRACKING_,ua=this.computeValue_(!0);if(N=da||N instanceof qo||ua instanceof qo||!this.equals_(N,
ua))this.value_=ua;return N};n.computeValue_=function(N){this.isComputing_=!0;var da=Vc(!1);if(N)var ua=Ic(this,this.derivation,this.scope_);else if(!0===Xf.disableErrorBoundaries)ua=this.derivation.call(this.scope_);else try{ua=this.derivation.call(this.scope_)}catch(Ga){ua=new qo(Ga)}Xf.allowStateChanges=da;this.isComputing_=!1;return ua};n.suspend_=function(){this.keepAlive_||(Lc(this),this.value_=void 0)};n.observe_=function(N,da){var ua=this,Ga=!0,Ma=void 0;return kc(function(){var fb=ua.get();
if(!Ga||da){var vb=Xa();N({observableKind:"computed",debugObjectName:ua.name_,type:im,object:ua,newValue:fb,oldValue:Ma});Xf.trackingDerivation=vb}Ga=!1;Ma=fb})};n.warnAboutUntrackedRead_=function(){};n.toString=function(){return this.name_+"["+this.derivation.toString()+"]"};n.valueOf=function(){return ja(this.get())};n[mz]=function(){return this.valueOf()};return c}(),Cq=J("ComputedValue",Bq),Hi;(function(c){c[c.NOT_TRACKING_=-1]="NOT_TRACKING_";c[c.UP_TO_DATE_=0]="UP_TO_DATE_";c[c.POSSIBLY_STALE_=
1]="POSSIBLY_STALE_";c[c.STALE_=2]="STALE_"})(Hi||={});var jp;(function(c){c[c.NONE=0]="NONE";c[c.LOG=1]="LOG";c[c.BREAK=2]="BREAK"})(jp||={});var qo=function(c){this.cause=c},Ar=function(){this.version=6;this.UNCHANGED={};this.trackingContext=this.trackingDerivation=null;this.inBatch=this.mobxGuid=this.runId=0;this.pendingUnobservations=[];this.pendingReactions=[];this.allowStateChanges=this.isRunningReactions=!1;this.enforceActions=this.allowStateReads=!0;this.spyListeners=[];this.globalReactionErrorHandlers=
[];this.suppressReactionErrors=this.disableErrorBoundaries=this.observableRequiresReaction=this.reactionRequiresObservable=this.computedRequiresReaction=!1;this.useProxies=!0;this.verifyProxies=!1;this.safeDescriptors=!0},Br=!0,tv=!1,Xf=function(){var c=H();0<c.__mobxInstanceCount&&!c.__mobxGlobals&&(Br=!1);c.__mobxGlobals&&c.__mobxGlobals.version!==(new Ar).version&&(Br=!1);if(Br){if(c.__mobxGlobals)return c.__mobxInstanceCount+=1,c.__mobxGlobals.UNCHANGED||(c.__mobxGlobals.UNCHANGED={}),c.__mobxGlobals;
c.__mobxInstanceCount=1;return c.__mobxGlobals=new Ar}setTimeout(function(){tv||d(35)},1);return new Ar}(),kp=function(){function c(N,da,ua,Ga){void 0===N&&(N="Reaction");this.requiresObservable_=this.errorHandler_=this.onInvalidate_=this.name_=void 0;this.observing_=[];this.newObserving_=[];this.dependenciesState_=Hi.NOT_TRACKING_;this.unboundDepsCount_=this.runId_=this.diffValue_=0;this.isRunning_=this.isTrackPending_=this.isScheduled_=this.isDisposed_=!1;this.isTracing_=jp.NONE;this.name_=N;this.onInvalidate_=
da;this.errorHandler_=ua;this.requiresObservable_=Ga}var n=c.prototype;n.onBecomeStale_=function(){this.schedule_()};n.schedule_=function(){this.isScheduled_||(this.isScheduled_=!0,Xf.pendingReactions.push(this),0<Xf.inBatch||Xf.isRunningReactions||Cr(rb))};n.isScheduled=function(){return this.isScheduled_};n.runReaction_=function(){if(!this.isDisposed_){Nb();this.isScheduled_=!1;var N=Xf.trackingContext;Xf.trackingContext=this;if(Tc(this)){this.isTrackPending_=!0;try{this.onInvalidate_()}catch(da){this.reportExceptionInDerivation_(da)}}Xf.trackingContext=
N;Db()}};n.track=function(N){if(!this.isDisposed_){Nb();this.isRunning_=!0;var da=Xf.trackingContext;Xf.trackingContext=this;N=Ic(this,N,void 0);Xf.trackingContext=da;this.isTrackPending_=this.isRunning_=!1;this.isDisposed_&&Lc(this);N instanceof qo&&this.reportExceptionInDerivation_(N.cause);Db()}};n.reportExceptionInDerivation_=function(N){var da=this;if(this.errorHandler_)this.errorHandler_(N,this);else{if(Xf.disableErrorBoundaries)throw N;Xf.suppressReactionErrors||console.error("[mobx] uncaught error in '"+
this+"'",N);Xf.globalReactionErrorHandlers.forEach(function(ua){return ua(N,da)})}};n.dispose=function(){this.isDisposed_||(this.isDisposed_=!0,this.isRunning_||(Nb(),Lc(this),Db()))};n.getDisposer_=function(){var N=this.dispose.bind(this);N[Eh]=this;return N};n.toString=function(){return"Reaction["+this.name_+"]"};n.trace=function(N){void 0===N&&(N=!1);Qb(this,N)};return c}(),nz=100,Cr=function(c){return c()},Dr=J("Reaction",kp),uv="action",vv=Ea(uv),oz=Ea("action.bound",{bound:!0}),wv=Ea("autoAction",
{autoAction:!0}),xv=Ea("autoAction.bound",{autoAction:!0,bound:!0}),Cg=yc(!1);Object.assign(Cg,vv);var Dq=yc(!0);Object.assign(Dq,wv);Cg.bound=ya(oz);Dq.bound=ya(xv);var pz=function(c){return c()},qz="onBO",rz="onBUO",sz=0;Bc.prototype=Object.create(Error.prototype);var yv=ta("flow"),tz=ta("flow.bound",{bound:!0}),Eq=Object.assign(function(c,n){if(z(n))return Ja(c,n,yv);var N=c.name||"\x3cunnamed flow\x3e";n=function(){var da=arguments,ua=++sz,Ga=Cg(N+" - runid: "+ua+" - init",c).apply(this,da),Ma,
fb=void 0;da=new Promise(function(vb,Wb){function oc(hd){fb=void 0;try{var Bd=Cg(N+" - runid: "+ua+" - yield "+md++,Ga.next).call(Ga,hd)}catch(Ld){return Wb(Ld)}Uc(Bd)}function xc(hd){fb=void 0;try{var Bd=Cg(N+" - runid: "+ua+" - yield "+md++,Ga["throw"]).call(Ga,hd)}catch(Ld){return Wb(Ld)}Uc(Bd)}function Uc(hd){if(V(null==hd?void 0:hd.then))hd.then(Uc,Wb);else{if(hd.done)return vb(hd.value);fb=Promise.resolve(hd.value);return fb.then(oc,xc)}}var md=0;Ma=Wb;oc(void 0)});da.cancel=Cg(N+" - runid: "+
ua+" - cancel",function(){try{if(fb){var vb=fb;V(vb.cancel)&&vb.cancel()}var Wb=Ga["return"](void 0),oc=Promise.resolve(Wb.value);oc.then(hp,hp);V(oc.cancel)&&oc.cancel();Ma(new Bc)}catch(xc){Ma(xc)}});return da};n.isMobXFlow=!0;return n},yv);Eq.bound=ya(tz);var uz={has:function(c,n){return c[Eh].has_(n)},get:function(c,n){return c[Eh].get_(n)},set:function(c,n,N){var da;return z(n)?null!=(da=c[Eh].set_(n,N,!0))?da:!0:!1},deleteProperty:function(c,n){var N;return z(n)?null!=(N=c[Eh].delete_(n,!0))?
N:!0:!1},defineProperty:function(c,n,N){var da;return null!=(da=c[Eh].defineProperty_(n,N))?da:!0},ownKeys:function(c){return c[Eh].ownKeys_()},preventExtensions:function(c){d(13)}},im="update",vz={get:function(c,n){var N=c[Eh];return n===Eh?N:"length"===n?N.getArrayLength_():"string"!==typeof n||isNaN(n)?X(Er,n)?Er[n]:c[n]:N.get_(parseInt(n))},set:function(c,n,N){var da=c[Eh];"length"===n&&da.setArrayLength_(N);"symbol"===typeof n||isNaN(n)?c[n]=N:da.set_(parseInt(n),N);return!0},preventExtensions:function(){d(15)}},
$s=function(){function c(N,da,ua,Ga){void 0===N&&(N="ObservableArray");this.atom_=this.legacyMode_=this.owned_=void 0;this.values_=[];this.proxy_=this.dehancer=this.enhancer_=this.changeListeners_=this.interceptors_=void 0;this.lastKnownLength_=0;this.owned_=ua;this.legacyMode_=Ga;this.atom_=new zq(N);this.enhancer_=function(Ma,fb){return da(Ma,fb,"ObservableArray[..]")}}var n=c.prototype;n.dehanceValue_=function(N){return void 0!==this.dehancer?this.dehancer(N):N};n.dehanceValues_=function(N){return void 0!==
this.dehancer&&0<N.length?N.map(this.dehancer):N};n.intercept_=function(N){return Ib(this,N)};n.observe_=function(N,da){void 0===da&&(da=!1);da&&N({observableKind:"array",object:this.proxy_,debugObjectName:this.atom_.name_,type:"splice",index:0,added:this.values_.slice(),addedCount:this.values_.length,removed:[],removedCount:0});return Fb(this,N)};n.getArrayLength_=function(){this.atom_.reportObserved();return this.values_.length};n.setArrayLength_=function(N){("number"!==typeof N||isNaN(N)||0>N)&&
d("Out of range: "+N);var da=this.values_.length;if(N!==da)if(N>da){for(var ua=Array(N-da),Ga=0;Ga<N-da;Ga++)ua[Ga]=void 0;this.spliceWithArray_(da,0,ua)}else this.spliceWithArray_(N,da-N)};n.updateArrayLength_=function(N,da){N!==this.lastKnownLength_&&d(16);this.lastKnownLength_+=da;this.legacyMode_&&0<da&&qa(N+da+1)};n.spliceWithArray_=function(N,da,ua){var Ga=this,Ma=this.values_.length;void 0===N?N=0:N>Ma?N=Ma:0>N&&(N=Math.max(0,Ma+N));da=1===arguments.length?Ma-N:void 0===da||null===da?0:Math.max(0,
Math.min(da,Ma-N));void 0===ua&&(ua=Xs);if(sb(this)){var fb=lb(this,{object:this.proxy_,type:"splice",index:N,removedCount:da,added:ua});if(!fb)return Xs;da=fb.removedCount;ua=fb.added}ua=0===ua.length?ua:ua.map(function(vb){return Ga.enhancer_(vb,void 0)});this.legacyMode_&&this.updateArrayLength_(Ma,ua.length-da);Ma=this.spliceItemsIntoValues_(N,da,ua);0===da&&0===ua.length||this.notifyArraySplice_(N,ua,Ma);return this.dehanceValues_(Ma)};n.spliceItemsIntoValues_=function(N,da,ua){if(1E4>ua.length){var Ga;
return(Ga=this.values_).splice.apply(Ga,[N,da].concat(ua))}Ga=this.values_.slice(N,N+da);var Ma=this.values_.slice(N+da);this.values_.length+=ua.length-da;for(da=0;da<ua.length;da++)this.values_[N+da]=ua[da];for(da=0;da<Ma.length;da++)this.values_[N+ua.length+da]=Ma[da];return Ga};n.notifyArrayChildUpdate_=function(N,da,ua){var Ga=!this.owned_&&!1,Ma=Mb(this);N=Ma||Ga?{observableKind:"array",object:this.proxy_,type:im,debugObjectName:this.atom_.name_,index:N,newValue:da,oldValue:ua}:null;this.atom_.reportChanged();
Ma&&hc(this,N)};n.notifyArraySplice_=function(N,da,ua){var Ga=!this.owned_&&!1,Ma=Mb(this);N=Ma||Ga?{observableKind:"array",object:this.proxy_,debugObjectName:this.atom_.name_,type:"splice",index:N,removed:ua,added:da,removedCount:ua.length,addedCount:da.length}:null;this.atom_.reportChanged();Ma&&hc(this,N)};n.get_=function(N){if(this.legacyMode_&&N>=this.values_.length)console.warn("[mobx] Out of bounds read: "+N);else return this.atom_.reportObserved(),this.dehanceValue_(this.values_[N])};n.set_=
function(N,da){var ua=this.values_;this.legacyMode_&&N>ua.length&&d(17,N,ua.length);if(N<ua.length){var Ga=ua[N];if(sb(this)){da=lb(this,{type:im,object:this.proxy_,index:N,newValue:da});if(!da)return;da=da.newValue}da=this.enhancer_(da,Ga);da!==Ga&&(ua[N]=da,this.notifyArrayChildUpdate_(N,da,Ga))}else{N=Array(N+1-ua.length);for(Ga=0;Ga<N.length-1;Ga++)N[Ga]=void 0;N[N.length-1]=da;this.spliceWithArray_(ua.length,0,N)}};return c}(),Er={clear:function(){return this.splice(0)},replace:function(c){var n=
this[Eh];return n.spliceWithArray_(0,n.values_.length,c)},toJSON:function(){return this.slice()},splice:function(c,n){for(var N=arguments.length,da=Array(2<N?N-2:0),ua=2;ua<N;ua++)da[ua-2]=arguments[ua];N=this[Eh];switch(arguments.length){case 0:return[];case 1:return N.spliceWithArray_(c);case 2:return N.spliceWithArray_(c,n)}return N.spliceWithArray_(c,n,da)},spliceWithArray:function(c,n,N){return this[Eh].spliceWithArray_(c,n,N)},push:function(){for(var c=this[Eh],n=arguments.length,N=Array(n),
da=0;da<n;da++)N[da]=arguments[da];c.spliceWithArray_(c.values_.length,0,N);return c.values_.length},pop:function(){return this.splice(Math.max(this[Eh].values_.length-1,0),1)[0]},shift:function(){return this.splice(0,1)[0]},unshift:function(){for(var c=this[Eh],n=arguments.length,N=Array(n),da=0;da<n;da++)N[da]=arguments[da];c.spliceWithArray_(0,0,N);return c.values_.length},reverse:function(){Xf.trackingDerivation&&d(37,"reverse");this.replace(this.slice().reverse());return this},sort:function(){Xf.trackingDerivation&&
d(37,"sort");var c=this.slice();c.sort.apply(c,arguments);this.replace(c);return this},remove:function(c){var n=this[Eh];c=n.dehanceValues_(n.values_).indexOf(c);return-1<c?(this.splice(c,1),!0):!1}};eb("concat",Ua);eb("flat",Ua);eb("includes",Ua);eb("indexOf",Ua);eb("join",Ua);eb("lastIndexOf",Ua);eb("slice",Ua);eb("toString",Ua);eb("toLocaleString",Ua);eb("every",mb);eb("filter",mb);eb("find",mb);eb("findIndex",mb);eb("flatMap",mb);eb("forEach",mb);eb("map",mb);eb("some",mb);eb("reduce",Cb);eb("reduceRight",
Cb);var wz=J("ObservableArrayAdministration",$s),xz={};var yz=Symbol.iterator;var zz=Symbol.toStringTag;var zv=function(){function c(N,da,ua){var Ga=this;void 0===da&&(da=Ca);void 0===ua&&(ua="ObservableMap");this.name_=this.enhancer_=void 0;this[Eh]=xz;this.dehancer=this.changeListeners_=this.interceptors_=this.keysAtom_=this.hasMap_=this.data_=void 0;this.enhancer_=da;this.name_=ua;V(Map)||d(18);this.keysAtom_=db("ObservableMap.keys()");this.data_=new Map;this.hasMap_=new Map;cc(!0,function(){Ga.merge(N)})}
var n=c.prototype;n.has_=function(N){return this.data_.has(N)};n.has=function(N){var da=this;if(!Xf.trackingDerivation)return this.has_(N);var ua=this.hasMap_.get(N);if(!ua){var Ga=ua=new po(this.has_(N),Na,"ObservableMap.key?",!1);this.hasMap_.set(N,Ga);qd(Ga,function(){return da.hasMap_["delete"](N)})}return ua.get()};n.set=function(N,da){var ua=this.has_(N);if(sb(this)){da=lb(this,{type:ua?im:"add",object:this,newValue:da,name:N});if(!da)return this;da=da.newValue}ua?this.updateValue_(N,da):this.addValue_(N,
da);return this};n["delete"]=function(N){var da=this;if(sb(this)&&!lb(this,{type:"delete",object:this,name:N}))return!1;if(this.has_(N)){var ua=Mb(this),Ga=ua?{observableKind:"map",debugObjectName:this.name_,type:"delete",object:this,oldValue:this.data_.get(N).value_,name:N}:null;pc(function(){var Ma;da.keysAtom_.reportChanged();null==(Ma=da.hasMap_.get(N))?void 0:Ma.setNewValue_(!1);da.data_.get(N).setNewValue_(void 0);da.data_["delete"](N)});ua&&hc(this,Ga);return!0}return!1};n.updateValue_=function(N,
da){var ua=this.data_.get(N);da=ua.prepareNewValue_(da);if(da!==Xf.UNCHANGED){var Ga=Mb(this);N=Ga?{observableKind:"map",debugObjectName:this.name_,type:im,object:this,oldValue:ua.value_,name:N,newValue:da}:null;ua.setNewValue_(da);Ga&&hc(this,N)}};n.addValue_=function(N,da){var ua=this;pc(function(){var fb,vb=new po(da,ua.enhancer_,"ObservableMap.key",!1);ua.data_.set(N,vb);da=vb.value_;null==(fb=ua.hasMap_.get(N))?void 0:fb.setNewValue_(!0);ua.keysAtom_.reportChanged()});var Ga=Mb(this),Ma=Ga?{observableKind:"map",
debugObjectName:this.name_,type:"add",object:this,name:N,newValue:da}:null;Ga&&hc(this,Ma)};n.get=function(N){return this.has(N)?this.dehanceValue_(this.data_.get(N).get()):this.dehanceValue_(void 0)};n.dehanceValue_=function(N){return void 0!==this.dehancer?this.dehancer(N):N};n.keys=function(){this.keysAtom_.reportObserved();return this.data_.keys()};n.values=function(){var N=this,da=this.keys();return ab({next:function(){var ua=da.next(),Ga=ua.done;ua=ua.value;return{done:Ga,value:Ga?void 0:N.get(ua)}}})};
n.entries=function(){var N=this,da=this.keys();return ab({next:function(){var ua=da.next(),Ga=ua.done;ua=ua.value;return{done:Ga,value:Ga?void 0:[ua,N.get(ua)]}}})};n[yz]=function(){return this.entries()};n.forEach=function(N,da){for(var ua=sa(this),Ga;!(Ga=ua()).done;)Ga=Ga.value,N.call(da,Ga[1],Ga[0],this)};n.merge=function(N){var da=this;kn(N)&&(N=new Map(N));pc(function(){M(N)?P(N).forEach(function(ua){return da.set(ua,N[ua])}):Array.isArray(N)?N.forEach(function(ua){return da.set(ua[0],ua[1])}):
T(N)?(N.constructor!==Map&&d(19,N),N.forEach(function(ua,Ga){return da.set(Ga,ua)})):null!==N&&void 0!==N&&d(20,N)});return this};n.clear=function(){var N=this;pc(function(){Sa(function(){for(var da=sa(N.keys()),ua;!(ua=da()).done;)N["delete"](ua.value)})})};n.replace=function(N){var da=this;pc(function(){for(var ua=dd(N),Ga=new Map,Ma=!1,fb=sa(da.data_.keys()),vb;!(vb=fb()).done;)if(vb=vb.value,!ua.has(vb))if(da["delete"](vb))Ma=!0;else{var Wb=da.data_.get(vb);Ga.set(vb,Wb)}for(ua=sa(ua.entries());!(fb=
ua()).done;)vb=fb.value,fb=vb[0],Wb=vb[1],vb=da.data_.has(fb),da.set(fb,Wb),da.data_.has(fb)&&(Wb=da.data_.get(fb),Ga.set(fb,Wb),vb||(Ma=!0));if(!Ma)if(da.data_.size!==Ga.size)da.keysAtom_.reportChanged();else for(Ma=da.data_.keys(),ua=Ga.keys(),fb=Ma.next(),vb=ua.next();!fb.done;){if(fb.value!==vb.value){da.keysAtom_.reportChanged();break}fb=Ma.next();vb=ua.next()}da.data_=Ga});return this};n.toString=function(){return"[object ObservableMap]"};n.toJSON=function(){return Array.from(this)};n.observe_=
function(N,da){return Fb(this,N)};n.intercept_=function(N){return Ib(this,N)};ba(c,[{key:"size",get:function(){this.keysAtom_.reportObserved();return this.data_.size}},{key:zz,get:function(){return"Map"}}]);return c}(),kn=J("ObservableMap",zv),Az={};var Bz=Symbol.iterator;var Cz=Symbol.toStringTag;var Av=function(){function c(N,da,ua){void 0===da&&(da=Ca);void 0===ua&&(ua="ObservableSet");this.name_=void 0;this[Eh]=Az;this.data_=new Set;this.enhancer_=this.dehancer=this.interceptors_=this.changeListeners_=
this.atom_=void 0;this.name_=ua;V(Set)||d(22);this.atom_=db(this.name_);this.enhancer_=function(Ga,Ma){return da(Ga,Ma,ua)};N&&this.replace(N)}var n=c.prototype;n.dehanceValue_=function(N){return void 0!==this.dehancer?this.dehancer(N):N};n.clear=function(){var N=this;pc(function(){Sa(function(){for(var da=sa(N.data_.values()),ua;!(ua=da()).done;)N["delete"](ua.value)})})};n.forEach=function(N,da){for(var ua=sa(this),Ga;!(Ga=ua()).done;)Ga=Ga.value,N.call(da,Ga,Ga,this)};n.add=function(N){var da=
this;if(sb(this)&&!lb(this,{type:"add",object:this,newValue:N}))return this;if(!this.has(N)){pc(function(){da.data_.add(da.enhancer_(N,void 0));da.atom_.reportChanged()});var ua=Mb(this),Ga=ua?{observableKind:"set",debugObjectName:this.name_,type:"add",object:this,newValue:N}:null;ua&&hc(this,Ga)}return this};n["delete"]=function(N){var da=this;if(sb(this)&&!lb(this,{type:"delete",object:this,oldValue:N}))return!1;if(this.has(N)){var ua=Mb(this),Ga=ua?{observableKind:"set",debugObjectName:this.name_,
type:"delete",object:this,oldValue:N}:null;pc(function(){da.atom_.reportChanged();da.data_["delete"](N)});ua&&hc(this,Ga);return!0}return!1};n.has=function(N){this.atom_.reportObserved();return this.data_.has(this.dehanceValue_(N))};n.entries=function(){var N=0,da=Array.from(this.keys()),ua=Array.from(this.values());return ab({next:function(){var Ga=N;N+=1;return Ga<ua.length?{value:[da[Ga],ua[Ga]],done:!1}:{done:!0}}})};n.keys=function(){return this.values()};n.values=function(){this.atom_.reportObserved();
var N=this,da=0,ua=Array.from(this.data_.values());return ab({next:function(){return da<ua.length?{value:N.dehanceValue_(ua[da++]),done:!1}:{done:!0}}})};n.replace=function(N){var da=this;ro(N)&&(N=new Set(N));pc(function(){Array.isArray(N)?(da.clear(),N.forEach(function(ua){return da.add(ua)})):S(N)?(da.clear(),N.forEach(function(ua){return da.add(ua)})):null!==N&&void 0!==N&&d("Cannot initialize set from "+N)});return this};n.observe_=function(N,da){return Fb(this,N)};n.intercept_=function(N){return Ib(this,
N)};n.toJSON=function(){return Array.from(this)};n.toString=function(){return"[object ObservableSet]"};n[Bz]=function(){return this.values()};ba(c,[{key:"size",get:function(){this.atom_.reportObserved();return this.data_.size}},{key:Cz,get:function(){return"Set"}}]);return c}(),ro=J("ObservableSet",Av),Bv=Object.create(null),Cv=function(){function c(N,da,ua,Ga){void 0===da&&(da=new Map);void 0===Ga&&(Ga=cz);this.pendingKeys_=this.appliedAnnotations_=this.isPlainObject_=this.proxy_=this.interceptors_=
this.changeListeners_=this.keysAtom_=this.defaultAnnotation_=this.values_=this.target_=void 0;this.target_=N;this.values_=da;this.name_=ua;this.defaultAnnotation_=Ga;this.keysAtom_=new zq("ObservableObject.keys");this.isPlainObject_=M(this.target_)}var n=c.prototype;n.getObservablePropValue_=function(N){return this.values_.get(N).get()};n.setObservablePropValue_=function(N,da){var ua=this.values_.get(N);if(ua instanceof Bq)return ua.set(da),!0;if(sb(this)){da=lb(this,{type:im,object:this.proxy_||
this.target_,name:N,newValue:da});if(!da)return null;da=da.newValue}da=ua.prepareNewValue_(da);if(da!==Xf.UNCHANGED){var Ga=Mb(this);N=Ga?{type:im,observableKind:"object",debugObjectName:this.name_,object:this.proxy_||this.target_,oldValue:ua.value_,name:N,newValue:da}:null;ua.setNewValue_(da);Ga&&hc(this,N)}return!0};n.get_=function(N){Xf.trackingDerivation&&!X(this.target_,N)&&this.has_(N);return this.target_[N]};n.set_=function(N,da,ua){void 0===ua&&(ua=!1);if(X(this.target_,N)){if(this.values_.has(N))return this.setObservablePropValue_(N,
da);if(ua)return Reflect.set(this.target_,N,da);this.target_[N]=da;return!0}return this.extend_(N,{value:da,enumerable:!0,writable:!0,configurable:!0},this.defaultAnnotation_,ua)};n.has_=function(N){if(!Xf.trackingDerivation)return N in this.target_;this.pendingKeys_||(this.pendingKeys_=new Map);var da=this.pendingKeys_.get(N);da||(da=new po(N in this.target_,Na,"ObservableObject.key?",!1),this.pendingKeys_.set(N,da));return da.get()};n.make_=function(N,da){!0===da&&(da=this.defaultAnnotation_);if(!1!==
da){if(!(N in this.target_)){var ua;if(null!=(ua=this.target_[Ll])&&ua[N])return;d(1,da.annotationType_,this.name_+"."+N.toString())}for(ua=this.target_;ua&&ua!==yq;){var Ga=xl(ua,N);if(Ga){Ga=da.make_(this,N,Ga,ua);if(0===Ga)return;if(1===Ga)break}ua=Object.getPrototypeOf(ua)}var Ma;null==(Ma=this.target_[Ll])?!0:delete Ma[N]}};n.extend_=function(N,da,ua,Ga){void 0===Ga&&(Ga=!1);!0===ua&&(ua=this.defaultAnnotation_);if(!1===ua)return this.defineProperty_(N,da,Ga);if(da=ua.extend_(this,N,da,Ga)){var Ma;
null==(Ma=this.target_[Ll])?!0:delete Ma[N]}return da};n.defineProperty_=function(N,da,ua){void 0===ua&&(ua=!1);try{Nb();var Ga=this.delete_(N);if(!Ga)return Ga;if(sb(this)){var Ma=lb(this,{object:this.proxy_||this.target_,name:N,type:"add",newValue:da.value});if(!Ma)return null;var fb=Ma.newValue;da.value!==fb&&(da=Y({},da,{value:fb}))}if(ua){if(!Reflect.defineProperty(this.target_,N,da))return!1}else Yk(this.target_,N,da);this.notifyPropertyAddition_(N,da.value)}finally{Db()}return!0};n.defineObservableProperty_=
function(N,da,ua,Ga){void 0===Ga&&(Ga=!1);try{Nb();var Ma=this.delete_(N);if(!Ma)return Ma;if(sb(this)){var fb=lb(this,{object:this.proxy_||this.target_,name:N,type:"add",newValue:da});if(!fb)return null;da=fb.newValue}var vb=Nd(N),Wb={configurable:Xf.safeDescriptors?this.isPlainObject_:!0,enumerable:!0,get:vb.get,set:vb.set};if(Ga){if(!Reflect.defineProperty(this.target_,N,Wb))return!1}else Yk(this.target_,N,Wb);var oc=new po(da,ua,"ObservableObject.key",!1);this.values_.set(N,oc);this.notifyPropertyAddition_(N,
oc.value_)}finally{Db()}return!0};n.defineComputedProperty_=function(N,da,ua){void 0===ua&&(ua=!1);try{Nb();var Ga=this.delete_(N);if(!Ga)return Ga;if(sb(this)&&!lb(this,{object:this.proxy_||this.target_,name:N,type:"add",newValue:void 0}))return null;da.name||(da.name="ObservableObject.key");da.context=this.proxy_||this.target_;var Ma=Nd(N),fb={configurable:Xf.safeDescriptors?this.isPlainObject_:!0,enumerable:!1,get:Ma.get,set:Ma.set};if(ua){if(!Reflect.defineProperty(this.target_,N,fb))return!1}else Yk(this.target_,
N,fb);this.values_.set(N,new Bq(da));this.notifyPropertyAddition_(N,void 0)}finally{Db()}return!0};n.delete_=function(N,da){void 0===da&&(da=!1);if(!X(this.target_,N))return!0;if(sb(this)&&!lb(this,{object:this.proxy_||this.target_,name:N,type:"remove"}))return null;try{var ua,Ga;Nb();var Ma=Mb(this),fb=this.values_.get(N),vb=void 0;if(!fb&&Ma){var Wb;vb=null==(Wb=xl(this.target_,N))?void 0:Wb.value}if(da){if(!Reflect.deleteProperty(this.target_,N))return!1}else delete this.target_[N];fb&&(this.values_["delete"](N),
fb instanceof po&&(vb=fb.value_),ub(fb));this.keysAtom_.reportChanged();null==(ua=this.pendingKeys_)?void 0:null==(Ga=ua.get(N))?void 0:Ga.set(N in this.target_);if(Ma){var oc={type:"remove",observableKind:"object",object:this.proxy_||this.target_,debugObjectName:this.name_,oldValue:vb,name:N};Ma&&hc(this,oc)}}finally{Db()}return!0};n.observe_=function(N,da){return Fb(this,N)};n.intercept_=function(N){return Ib(this,N)};n.notifyPropertyAddition_=function(N,da){var ua,Ga,Ma=Mb(this);Ma&&(da=Ma?{type:"add",
observableKind:"object",debugObjectName:this.name_,object:this.proxy_||this.target_,name:N,newValue:da}:null,Ma&&hc(this,da));null==(ua=this.pendingKeys_)?void 0:null==(Ga=ua.get(N))?void 0:Ga.set(!0);this.keysAtom_.reportChanged()};n.ownKeys_=function(){this.keysAtom_.reportObserved();return yr(this.target_)};n.keys_=function(){this.keysAtom_.reportObserved();return Object.keys(this.target_)};return c}(),Dz=J("ObservableObjectAdministration",Cv),Ez=Aa(0),at=0,Dv=function(){};(function(c,n){Object.setPrototypeOf?
Object.setPrototypeOf(c.prototype,n):void 0!==c.prototype.__proto__?c.prototype.__proto__=n:c.prototype=n})(Dv,Array.prototype);var bt=function(c,n,N){function da(Ga,Ma,fb,vb){void 0===fb&&(fb="ObservableArray");void 0===vb&&(vb=!1);var Wb=c.call(this)||this;Ma=new $s(fb,Ma,vb,!0);Ma.proxy_=fa(Wb);L(fa(Wb),Eh,Ma);Ga&&Ga.length&&(Ma=Vc(!0),Wb.spliceWithArray(0,0,Ga),Xf.allowStateChanges=Ma);Object.defineProperty(fa(Wb),"0",Ez);return Wb}ha(da,c);var ua=da.prototype;ua.concat=function(){this[Eh].atom_.reportObserved();
for(var Ga=arguments.length,Ma=Array(Ga),fb=0;fb<Ga;fb++)Ma[fb]=arguments[fb];return Array.prototype.concat.apply(this.slice(),Ma.map(function(vb){return Mc(vb)?vb.slice():vb}))};ua[N]=function(){var Ga=this,Ma=0;return ab({next:function(){return Ma<Ga.length?{value:Ga[Ma++],done:!1}:{done:!0,value:void 0}}})};ba(da,[{key:"length",get:function(){return this[Eh].getArrayLength_()},set:function(Ga){this[Eh].setArrayLength_(Ga)}},{key:n,get:function(){return"Array"}}]);return da}(Dv,Symbol.toStringTag,
Symbol.iterator);Object.entries(Er).forEach(function(c){var n=c[0];c=c[1];"concat"!==n&&t(bt.prototype,n,c)});qa(1E3);var Ev=yq.toString;["Symbol","Map","Set"].forEach(function(c){"undefined"===typeof H()[c]&&d("MobX requires global '"+c+"' to be available or polyfilled")});"object"===typeof __MOBX_DEVTOOLS_GLOBAL_HOOK__&&__MOBX_DEVTOOLS_GLOBAL_HOOK__.injectMobx({spy:ac,extras:{getDebugName:Ka},$mobx:Eh});var Fz=Z(288),Yj=class{constructor(c){xb(this,"props");xb(this,"aspectRatio");xb(this,"type");
xb(this,"hideCloneHandles",!1);xb(this,"hideResizeHandles",!1);xb(this,"hideRotateHandle",!1);xb(this,"hideContextBar",!1);xb(this,"hideSelectionDetail",!1);xb(this,"hideSelection",!1);xb(this,"canChangeAspectRatio",!0);xb(this,"canUnmount",!0);xb(this,"canResize",[!0,!0]);xb(this,"canScale",!0);xb(this,"canFlip",!0);xb(this,"canEdit",!1);xb(this,"canBind",!1);xb(this,"nonce");xb(this,"bindingDistance",4);xb(this,"isDirty",!1);xb(this,"lastSerialized");xb(this,"getCenter",()=>Je.getBoundsCenter(this.bounds));
xb(this,"getRotatedBounds",()=>{const {bounds:Ga,props:{rotation:Ma}}=this;return Ma?Je.getBoundsFromPoints(Je.getRotatedCorners(Ga,Ma)):Ga});xb(this,"hitTestPoint",Ga=>{var Ma=this.rotatedBounds;if(!this.props.rotation)return wh.pointInBounds(Ga,Ma);Ma=Je.getRotatedCorners(Ma,this.props.rotation);return wh.pointInPolygon(Ga,Ma)});xb(this,"hitTestLineSegment",(Ga,Ma)=>{const fb=Je.getBoundsFromPoints([Ga,Ma]),{rotatedBounds:vb,props:{rotation:Wb=0}}=this;return Je.boundsContain(vb,fb)||Wb?k(Ga,Ma,
Je.getRotatedCorners(this.bounds)).didIntersect:0<g(vb,Ga,Ma).length});xb(this,"hitTestBounds",Ga=>{const {rotatedBounds:Ma,props:{rotation:fb=0}}=this,vb=Je.getRotatedCorners(this.bounds,fb);return Je.boundsContain(Ga,Ma)||0<A([Ga.minX,Ga.minY],[Ga.width,Ga.height],vb).length});xb(this,"getExpandedBounds",()=>Je.expandBounds(this.getBounds(),this.bindingDistance));xb(this,"getBindingPoint",(Ga,Ma,fb,vb)=>{var Wb=this.getBounds(),oc=this.getExpandedBounds();if(wh.pointInBounds(Ga,oc)){var xc=E(Ma,
fb,oc).filter(Uc=>Uc.didIntersect).map(Uc=>Uc.points[0]);if(xc.length)return fb=this.getCenter(),xc=xc.sort((Uc,md)=>pe.dist(md,Ma)-pe.dist(Uc,Ma))[0],xc=pe.med(Ga,xc),vb?(vb=2>pe.dist(Ga,fb)?fb:Ga,Wb=0):(vb=2>pe.distanceToLineSegment(Ga,xc,fb)?fb:xc,Wb=wh.pointInBounds(Ga,Wb)?this.bindingDistance:Math.max(this.bindingDistance,Je.getBoundsSides(Wb).map(Uc=>pe.distanceToLineSegment(Uc[1][0],Uc[1][1],Ga)).sort((Uc,md)=>Uc-md)[0])),oc=pe.divV(pe.sub(vb,[oc.minX,oc.minY]),[oc.width,oc.height]),{point:pe.clampV(oc,
0,1),distance:Wb}}});xb(this,"getSerialized",()=>Bb(kg(Af({},this.props),{type:this.type,nonce:this.nonce})));xb(this,"getCachedSerialized",()=>{!this.isDirty&&this.lastSerialized||pc(()=>{this.setIsDirty(!1);this.setLastSerialized(this.getSerialized())});if(this.lastSerialized)return this.lastSerialized;throw Error("Should not get here for getCachedSerialized");});xb(this,"validateProps",Ga=>Ga);xb(this,"update",(Ga,Ma=!1,fb=!1)=>{Ma||this.isDirty||this.setIsDirty(!0);Ma||fb||this.incNonce();Object.assign(this.props,
this.validateProps(Ga));return this});xb(this,"clone",()=>new this.constructor(this.serialized));xb(this,"onResetBounds",Ga=>this);xb(this,"scale",[1,1]);xb(this,"onResizeStart",Ga=>{var Ma;this.scale=[...(null!=(Ma=this.props.scale)?Ma:[1,1])];return this});xb(this,"onResize",(Ga,Ma)=>{const {bounds:fb,rotation:vb,scale:[Wb,oc]}=Ma;Ga=[...this.scale];0>Wb&&(Ga[0]*=-1);0>oc&&(Ga[1]*=-1);this.update({point:[fb.minX,fb.minY],scale:Ga,rotation:vb});return this});xb(this,"onHandleChange",(Ga,{id:Ma,delta:fb})=>
{if(void 0!==Ga.handles){var vb=to(Ga.handles);vb[Ma]=kg(Af({},vb[Ma]),{point:pe.add(fb,Ga.handles[Ma].point)});var Wb=Je.getCommonTopLeft(Object.values(vb).map(oc=>oc.point));Object.values(vb).forEach(oc=>{oc.point=pe.sub(oc.point,Wb)});this.update({point:pe.add(Ga.point,Wb),handles:vb})}});var n,N;const da=this.constructor.id,ua=null!=(n=this.constructor.defaultProps)?n:{};this.type=da;this.props=Af(Af({scale:[1,1]},ua),c);this.nonce=null!=(N=c.nonce)?N:Date.now();Ec(this)}get id(){return this.props.id}setNonce(c){this.nonce=
c}incNonce(){this.nonce++}setIsDirty(c){this.isDirty=c}setLastSerialized(c){this.lastSerialized=c}get center(){return this.getCenter()}get bounds(){return this.getBounds()}get rotatedBounds(){return this.getRotatedBounds()}get serialized(){return this.getCachedSerialized()}getShapeSVGJsx(c){c=this.getBounds();const {stroke:n,strokeWidth:N,strokeType:da,opacity:ua,fill:Ga,noFill:Ma,borderRadius:fb}=this.props;return(0,Fz.jsx)("rect",{fill:Ma?"none":rf(Ga,"background"),stroke:rf(n,"stroke"),strokeWidth:null!=
N?N:2,strokeDasharray:"dashed"===da?"8 2":void 0,fillOpacity:null!=ua?ua:.2,width:c.width,height:c.height,rx:fb,ry:fb})}};xb(Yj,"type");re([Qg],Yj.prototype,"props",2);re([Qg],Yj.prototype,"canResize",2);re([Qg],Yj.prototype,"nonce",2);re([Qg],Yj.prototype,"isDirty",2);re([Qg],Yj.prototype,"lastSerialized",2);re([Zg],Yj.prototype,"id",1);re([Cg],Yj.prototype,"setNonce",1);re([Cg],Yj.prototype,"incNonce",1);re([Cg],Yj.prototype,"setIsDirty",1);re([Cg],Yj.prototype,"setLastSerialized",1);re([Zg],Yj.prototype,
"center",1);re([Zg],Yj.prototype,"bounds",1);re([Zg],Yj.prototype,"rotatedBounds",1);re([Zg],Yj.prototype,"serialized",1);re([Cg],Yj.prototype,"update",2);var xk=class extends Yj{constructor(c={}){super(c);xb(this,"canBind",!0);xb(this,"getBounds",()=>{const [n,N]=this.props.point,[da,ua]=this.props.size;return{minX:n,minY:N,maxX:n+da,maxY:N+ua,width:da,height:ua}});xb(this,"getRotatedBounds",()=>Je.getBoundsFromPoints(Je.getRotatedCorners(this.bounds,this.props.rotation)));xb(this,"onResize",(n,
N)=>{const {bounds:da,rotation:ua,scale:[Ga,Ma]}=N;n=[...this.scale];0>Ga&&(n[0]*=-1);0>Ma&&(n[1]*=-1);this.update({point:[da.minX,da.minY],scale:n,rotation:ua});return this.update({rotation:ua,point:[da.minX,da.minY],size:[Math.max(1,da.width),Math.max(1,da.height)],scale:n})});xb(this,"validateProps",n=>{void 0!==n.size&&(n.size[0]=Math.max(n.size[0],1),n.size[1]=Math.max(n.size[1],1));return n});Ec(this)}};xb(xk,"id","box");xb(xk,"defaultProps",{id:"box",type:"box",parentId:"page",point:[0,0],
size:[100,100]});var lp=class extends Yj{constructor(c={}){super(c);xb(this,"getBounds",()=>{const {pointBounds:n,props:{point:N}}=this;return Je.translateBounds(n,N)});xb(this,"getRotatedBounds",()=>{const {props:{rotation:n,point:N},bounds:da,rotatedPoints:ua}=this;return n?Je.translateBounds(Je.getBoundsFromPoints(ua),N):da});xb(this,"normalizedPoints",[]);xb(this,"isResizeFlippedX",!1);xb(this,"isResizeFlippedY",!1);xb(this,"onResizeStart",()=>{var n;const {bounds:N,props:{points:da}}=this;this.scale=
[...(null!=(n=this.props.scale)?n:[1,1])];const ua=[N.width,N.height];this.normalizedPoints=da.map(Ga=>Cd.divV(Ga,ua));return this});xb(this,"onResize",(n,N)=>{const {bounds:da,scale:[ua,Ga]}=N,Ma=[da.width,da.height];n=[...this.scale];0>ua&&(n[0]*=-1);0>Ga&&(n[1]*=-1);return this.update(ua||Ga?{point:[da.minX,da.minY],points:this.normalizedPoints.map(fb=>Cd.mulV(fb,Ma).concat(fb[2])),scale:n}:{point:[da.minX,da.minY],points:this.normalizedPoints.map(fb=>Cd.mulV(fb,Ma).concat(fb[2]))})});xb(this,
"hitTestPoint",n=>{const {props:{points:N,point:da}}=this;return wh.pointNearToPolyline(Cd.sub(n,da),N)});xb(this,"hitTestLineSegment",(n,N)=>{const {bounds:da,props:{points:ua,point:Ga}}=this;if(wh.pointInBounds(n,da)||wh.pointInBounds(N,da)||0<g(da,n,N).length){const Ma=Cd.sub(n,Ga),fb=Cd.sub(N,Ga);return k(Ma,fb,ua).didIntersect||!!ua.find(vb=>5>Cd.dist(Ma,vb)||5>Cd.dist(fb,vb))}return!1});xb(this,"hitTestBounds",n=>{const {rotatedBounds:N,props:{points:da,point:ua}}=this,Ga=Je.translateBounds(n,
Cd.neg(ua));return Je.boundsContain(n,N)||da.every(Ma=>wh.pointInBounds(Ma,Ga))||Je.boundsCollide(n,N)&&0<I([Ga.minX,Ga.minY],[Ga.width,Ga.height],da).length});Ec(this)}get pointBounds(){const {props:{points:c}}=this;return Je.getBoundsFromPoints(c)}get rotatedPoints(){const {props:{point:c,points:n,rotation:N},center:da}=this;if(!N)return n;const ua=Cd.sub(da,c);return n.map(Ga=>Cd.rotWith(Ga,ua,N))}};xb(lp,"id","draw");xb(lp,"defaultProps",{id:"draw",type:"draw",parentId:"page",point:[0,0],points:[],
isComplete:!1});re([Zg],lp.prototype,"pointBounds",1);re([Zg],lp.prototype,"rotatedPoints",1);var ct=class extends xk{constructor(c={}){super(c);xb(this,"getBounds",()=>{const {props:{point:[n,N],size:[da,ua]}}=this;return Je.getRotatedEllipseBounds(n,N,da/2,ua/2,0)});xb(this,"getRotatedBounds",()=>{const {props:{point:[n,N],size:[da,ua],rotation:Ga}}=this;return Je.getRotatedEllipseBounds(n,N,da/2,ua/2,Ga)});xb(this,"hitTestPoint",n=>{const {props:{size:N,rotation:da},center:ua}=this;return wh.pointInEllipse(n,
ua,N[0],N[1],da||0)});xb(this,"hitTestLineSegment",(n,N)=>{const {props:{size:[da,ua],rotation:Ga=0},center:Ma}=this;return h(n,N,Ma,da,ua,Ga).didIntersect});xb(this,"hitTestBounds",n=>{const {props:{size:[N,da],rotation:ua=0},rotatedBounds:Ga}=this;var Ma;if(!(Ma=Je.boundsContain(n,Ga))){const {minX:fb,minY:vb,width:Wb,height:oc}=n;Ma=0<w(this.center,N/2,da/2,ua,[fb,vb],[Wb,oc]).length}return Ma});Ec(this)}};xb(ct,"id","ellipse");xb(ct,"defaultProps",{id:"ellipse",type:"ellipse",parentId:"page",
point:[0,0],size:[100,100]});var dt=class extends xk{constructor(c={}){super(c);xb(this,"onResetBounds",n=>{const {clipping:N,size:da,point:ua}=this.props;if(N){const [Ga,Ma,fb,vb]=Array.isArray(N)?N:[N,N,N,N];return this.update({clipping:0,point:[ua[0]-vb,ua[1]-Ga],size:[da[0]+(vb-Ma),da[1]+(Ga-fb)]})}if(n.asset){const {size:[Ga,Ma]}=n.asset;this.update({clipping:0,point:[ua[0]+da[0]/2-Ga/2,ua[1]+da[1]/2-Ma/2],size:[Ga,Ma]})}return this});xb(this,"onResize",(n,N)=>{const {bounds:da,clip:ua,scale:Ga}=
N;({clipping:N}=this.props);const {clipping:Ma}=n;if(ua){const {point:[fb,vb],size:[Wb,oc]}=n,[xc,Uc,md,hd]=Ma?Array.isArray(Ma)?Ma:[Ma,Ma,Ma,Ma]:[0,0,0,0];N=[xc+(da.minY-vb),Uc+(da.maxX-(fb+Wb)),md+(da.maxY-(vb+oc)),hd+(da.minX-fb)]}else void 0!==Ma&&(N=Array.isArray(Ma)?Ma:[Ma,Ma,Ma,Ma],N=[N[0]*Ga[1],N[1]*Ga[0],N[2]*Ga[1],N[3]*Ga[0]]);if(N&&Array.isArray(N)){const fb=N;fb.every((vb,Wb)=>0===Wb||vb===fb[Wb-1])&&(N=fb[0])}return this.update({point:[da.minX,da.minY],size:[Math.max(1,da.width),Math.max(1,
da.height)],clipping:N})});Ec(this)}};xb(dt,"id","ellipse");xb(dt,"defaultProps",{id:"ellipse",type:"ellipse",parentId:"page",point:[0,0],size:[100,100],clipping:0,objectFit:"none",assetId:""});var Fv=class extends Yj{constructor(c={}){super(c);xb(this,"getBounds",()=>{const {points:n,props:{point:N}}=this;return Je.translateBounds(Je.getBoundsFromPoints(n),N)});xb(this,"getRotatedBounds",()=>{const {rotatedPoints:n,props:{point:N}}=this;return Je.translateBounds(Je.getBoundsFromPoints(n),N)});xb(this,
"normalizedHandles",[]);xb(this,"onResizeStart",()=>{var n;const {props:{handles:N},bounds:da}=this;this.scale=[...(null!=(n=this.props.scale)?n:[1,1])];const ua=[da.width,da.height];this.normalizedHandles=Object.values(N).map(Ga=>Cd.divV(Ga.point,ua));return this});xb(this,"onResize",(n,N)=>{const {bounds:da,scale:[ua,Ga]}=N,{props:{handles:Ma},normalizedHandles:fb}=this,vb=[da.width,da.height];n=[...this.scale];0>ua&&(n[0]*=-1);0>Ga&&(n[1]*=-1);return this.update({point:[da.minX,da.minY],handles:Object.values(Ma).map((Wb,
oc)=>kg(Af({},Wb),{point:Cd.mulV(fb[oc],vb)})),scale:n})});xb(this,"hitTestPoint",n=>{const {points:N}=this;return wh.pointNearToPolyline(Cd.sub(n,this.props.point),N)});xb(this,"hitTestLineSegment",(n,N)=>{const {bounds:da,points:ua,props:{point:Ga}}=this;if(wh.pointInBounds(n,da)||wh.pointInBounds(N,da)||0<g(da,n,N).length){const Ma=Cd.sub(n,Ga),fb=Cd.sub(N,Ga);return k(Ma,fb,ua).didIntersect||!!ua.find(vb=>5>Cd.dist(Ma,vb)||5>Cd.dist(fb,vb))}return!1});xb(this,"hitTestBounds",n=>{const {rotatedBounds:N,
points:da,props:{point:ua}}=this,Ga=Je.translateBounds(n,Cd.neg(ua));return Je.boundsContain(n,N)||da.every(Ma=>wh.pointInBounds(Ma,Ga))||Je.boundsCollide(n,N)&&0<I([Ga.minX,Ga.minY],[Ga.width,Ga.height],da).length});xb(this,"validateProps",n=>{n.point&&(n.point=[0,0]);void 0!==n.handles&&1>Object.values(n.handles).length&&(n.handles=Fv.defaultProps.handles);return n});Ec(this)}get points(){return Object.values(this.props.handles).map(c=>c.point)}get centroid(){const {points:c}=this;return mi.getPolygonCentroid(c)}get rotatedPoints(){const {centroid:c,
props:{handles:n,rotation:N}}=this;return N?Object.values(n).map(da=>Cd.rotWith(da.point,c,N)):this.points}},mp=Fv;xb(mp,"id","polyline");xb(mp,"defaultProps",{id:"polyline",type:"polyline",parentId:"page",point:[0,0],handles:{}});re([Zg],mp.prototype,"points",1);re([Zg],mp.prototype,"centroid",1);re([Zg],mp.prototype,"rotatedPoints",1);var Gv=class extends mp{constructor(c={}){super(c);xb(this,"hideResizeHandles",!0);xb(this,"hideRotateHandle",!0);xb(this,"validateProps",n=>{n.point&&(n.point=[0,
0]);void 0!==n.handles&&1>Object.values(n.handles).length&&(n.handles=Gv.defaultProps.handles);return n});xb(this,"getHandlesChange",(n,N)=>{var da=yi(n.handles,N);da=yi(da,{start:{point:pe.toFixed(da.start.point)},end:{point:pe.toFixed(da.end.point)}});if(!pe.isEqual(da.start.point,da.end.point)){N={point:n.point,handles:to(da)};n=n.point;da=Je.translateBounds(Je.getBoundsFromPoints(Object.values(da).map(Ga=>Ga.point)),N.point);var ua=pe.sub([da.minX,da.minY],n);pe.isEqual(ua,[0,0])||(Object.values(N.handles).forEach(Ga=>
{Ga.point=pe.toFixed(pe.sub(Ga.point,ua))}),N.point=pe.toFixed(pe.add(N.point,ua)));return N}});Ec(this)}},Fq=Gv;xb(Fq,"id","line");xb(Fq,"defaultProps",{id:"line",type:"line",parentId:"page",point:[0,0],handles:{start:{id:"start",canBind:!0,point:[0,0]},end:{id:"end",canBind:!0,point:[1,1]}}});var ln=class extends xk{constructor(c={}){super(c);xb(this,"getRotatedBounds",()=>{const {rotatedVertices:n,props:{point:N},offset:da}=this;return Je.translateBounds(Je.getBoundsFromPoints(n),Cd.add(N,da))});
xb(this,"hitTestPoint",n=>{const {vertices:N}=this;return wh.pointInPolygon(Cd.add(n,this.props.point),N)});xb(this,"hitTestLineSegment",(n,N)=>{const {vertices:da,props:{point:ua}}=this;return k(Cd.sub(n,ua),Cd.sub(N,ua),da).didIntersect});xb(this,"hitTestBounds",n=>{const {rotatedBounds:N,offset:da,rotatedVertices:ua,props:{point:Ga}}=this,Ma=Je.translateBounds(n,Cd.neg(Cd.add(Ga,da)));return Je.boundsContain(n,N)||ua.every(fb=>wh.pointInBounds(fb,Ma))||0<A([Ma.minX,Ma.minY],[Ma.width,Ma.height],
ua).length});xb(this,"validateProps",n=>{n.point&&(n.point=[0,0]);void 0!==n.sides&&3>n.sides&&(n.sides=3);return n});Ec(this)}get vertices(){return this.getVertices()}get pageVertices(){const {props:{point:c},vertices:n}=this;return n.map(N=>Cd.add(N,c))}get centroid(){const {vertices:c}=this;return mi.getPolygonCentroid(c)}get rotatedVertices(){const {vertices:c,centroid:n,props:{rotation:N}}=this;return N?c.map(da=>Cd.rotWith(da,n,N)):c}get offset(){const {props:{size:[c,n]}}=this,N=Je.getBoundsCenter(Je.getBoundsFromPoints(this.vertices));
return Cd.sub(Cd.div([c,n],2),N)}getVertices(c=0){const {ratio:n,sides:N,size:da}=this.props;return 3===N?mi.getTriangleVertices(da,c,n):mi.getPolygonVertices(da,N,c,n)}};xb(ln,"id","polygon");xb(ln,"defaultProps",{id:"polygon",type:"polygon",parentId:"page",point:[0,0],size:[100,100],sides:5,ratio:1,isFlippedY:!1});re([Zg],ln.prototype,"vertices",1);re([Zg],ln.prototype,"pageVertices",1);re([Zg],ln.prototype,"centroid",1);re([Zg],ln.prototype,"rotatedVertices",1);re([Zg],ln.prototype,"offset",1);
var et=class extends xk{constructor(c={}){super(c);xb(this,"canEdit",!0);xb(this,"canFlip",!1);Ec(this)}};xb(et,"id","text");xb(et,"defaultProps",{id:"text",type:"text",parentId:"page",isSizeLocked:!0,point:[0,0],size:[16,32],text:""});var Fr=class extends xk{constructor(c={}){super(c);xb(this,"canEdit",!1);xb(this,"canFlip",!1);xb(this,"getBounds",()=>0===this.shapes.length?(Te().deleteShapes([this.id]),{minX:0,minY:0,maxX:0,maxY:0,width:0,height:0}):Je.getCommonBounds(this.shapes.map(n=>n.getBounds())));
Ec(this);this.canResize=[!1,!1]}getShapes(){throw Error("will be implemented other places");}get shapes(){return this.getShapes()}};xb(Fr,"id","group");xb(Fr,"defaultProps",{id:"group",type:"group",parentId:"page",point:[0,0],size:[0,0],children:[]});re([Zg],Fr.prototype,"shapes",1);var np=class{constructor(){xb(this,"_id");xb(this,"_initial");xb(this,"_states");xb(this,"_isActive",!1);xb(this,"cursor");xb(this,"_disposables",[]);xb(this,"children",new Map([]));xb(this,"registerStates",N=>{N.forEach(da=>
this.children.set(da.id,new da(this,this)));return this});xb(this,"deregisterStates",N=>{N.forEach(da=>{var ua;null==(ua=this.children.get(da.id))?void 0:ua.dispose();this.children.delete(da.id)});return this});xb(this,"currentState",{});xb(this,"transition",(N,da={})=>{if(0===this.children.size)throw Error(`Tool ${this.id} has no states, cannot transition to ${N}.`);const ua=this.children.get(N),Ga=this.currentState;if(!ua)throw Error(`Could not find a state named ${N}.`);pc(()=>{this.currentState?
(Ga._events.onExit(kg(Af({},da),{toId:N})),Ga.dispose(),this.setCurrentState(ua),this._events.onTransition(kg(Af({},da),{fromId:Ga.id,toId:N})),ua._events.onEnter(kg(Af({},da),{fromId:Ga.id}))):(this.currentState=ua,ua._events.onEnter(kg(Af({},da),{fromId:""})))});return this});xb(this,"isIn",N=>{N=N.split(".").reverse();let da=this;for(;0<N.length;){const ua=N.pop();if(!ua)return!0;if(da.currentState.id===ua){if(0===N.length)return!0;da=da.currentState}else break}return!1});xb(this,"isInAny",(...N)=>
N.some(this.isIn));xb(this,"forwardEvent",(N,...da)=>{var ua,Ga;(null==(Ga=null==(ua=this.currentState)?void 0:ua._events)?0:Ga[N])&&pc(()=>{var Ma;return null==(Ma=this.currentState._events)?void 0:Ma[N](...da)})});xb(this,"_events",{onTransition:N=>{var da;null==(da=this.onTransition)?void 0:da.call(this,N)},onEnter:N=>{var da;this._isActive=!0;this.initial&&this.transition(this.initial,N);null==(da=this.onEnter)?void 0:da.call(this,N)},onExit:N=>{var da,ua,Ga;this._isActive=!1;null==(ua=null==
(da=this.currentState)?void 0:da.onExit)?void 0:ua.call(da,{toId:"parent"});null==(Ga=this.onExit)?void 0:Ga.call(this,N)},onPointerDown:(N,da)=>{var ua;null==(ua=this.onPointerDown)?void 0:ua.call(this,N,da);this.forwardEvent("onPointerDown",N,da)},onPointerUp:(N,da)=>{var ua;null==(ua=this.onPointerUp)?void 0:ua.call(this,N,da);this.forwardEvent("onPointerUp",N,da)},onPointerMove:(N,da)=>{var ua;null==(ua=this.onPointerMove)?void 0:ua.call(this,N,da);this.forwardEvent("onPointerMove",N,da)},onPointerEnter:(N,
da)=>{var ua;null==(ua=this.onPointerEnter)?void 0:ua.call(this,N,da);this.forwardEvent("onPointerEnter",N,da)},onPointerLeave:(N,da)=>{var ua;null==(ua=this.onPointerLeave)?void 0:ua.call(this,N,da);this.forwardEvent("onPointerLeave",N,da)},onDoubleClick:(N,da)=>{var ua;null==(ua=this.onDoubleClick)?void 0:ua.call(this,N,da);this.forwardEvent("onDoubleClick",N,da)},onKeyDown:(N,da)=>{var ua;this._events.onModifierKey(N,da);null==(ua=this.onKeyDown)?void 0:ua.call(this,N,da);this.forwardEvent("onKeyDown",
N,da)},onKeyUp:(N,da)=>{var ua;this._events.onModifierKey(N,da);null==(ua=this.onKeyUp)?void 0:ua.call(this,N,da);this.forwardEvent("onKeyUp",N,da)},onPinchStart:(N,da)=>{var ua;null==(ua=this.onPinchStart)?void 0:ua.call(this,N,da);this.forwardEvent("onPinchStart",N,da)},onPinch:(N,da)=>{var ua;null==(ua=this.onPinch)?void 0:ua.call(this,N,da);this.forwardEvent("onPinch",N,da)},onPinchEnd:(N,da)=>{var ua;null==(ua=this.onPinchEnd)?void 0:ua.call(this,N,da);this.forwardEvent("onPinchEnd",N,da)},onModifierKey:(N,
da)=>{switch(da.key){case "Shift":case "Alt":case "Ctrl":case "Meta":this._events.onPointerMove(N,da)}}});xb(this,"onEnter");xb(this,"onExit");xb(this,"onTransition");xb(this,"onPointerDown");xb(this,"onPointerUp");xb(this,"onPointerMove");xb(this,"onPointerEnter");xb(this,"onPointerLeave");xb(this,"onDoubleClick");xb(this,"onKeyDown");xb(this,"onKeyUp");xb(this,"onPinchStart");xb(this,"onPinch");xb(this,"onPinchEnd");const c=this.constructor.initial,n=this.constructor.states;this._id=this.constructor.id;
this._initial=c;this._states=n}dispose(){this._disposables.forEach(c=>c());this._disposables=[];return this}get initial(){return this._initial}get states(){return this._states}get id(){return this._id}get isActive(){return this._isActive}get ascendants(){return[this]}get descendants(){return Array.from(this.children.values()).flatMap(c=>[c,...c.descendants])}setCurrentState(c){this.currentState=c}};xb(np,"id");xb(np,"shortcuts");re([Qg],np.prototype,"currentState",2);re([Cg],np.prototype,"setCurrentState",
1);var ft=class extends np{constructor(c,n){var N,da;super();xb(this,"_root");xb(this,"_parent");xb(this,"children",new Map([]));xb(this,"registerStates",ua=>{ua.forEach(Ga=>this.children.set(Ga.id,new Ga(this,this._root)));return this});xb(this,"deregisterStates",ua=>{ua.forEach(Ga=>{var Ma;null==(Ma=this.children.get(Ga.id))?void 0:Ma.dispose();this.children.delete(Ga.id)});return this});this._parent=c;this._root=n;this.states&&0<this.states.length&&(this.registerStates(this.states),c=null!=(N=
this.initial)?N:this.states[0].id,N=this.children.get(c))&&(this.setCurrentState(N),null==(da=this.currentState)?void 0:da._events.onEnter({fromId:"initial"}));Ec(this)}get root(){return this._root}get parent(){return this._parent}get ascendants(){return this.parent?"ascendants"in this.parent?[...this.parent.ascendants,this]:[this.parent,this]:[this]}};xb(ft,"cursor");var mn=class extends ft{constructor(){super(...arguments);xb(this,"isLocked",!1);xb(this,"previous");xb(this,"onEnter",({fromId:c})=>
{this.previous=c;this.cursor&&this.app.cursors.setCursor(this.cursor)});xb(this,"onTransition",c=>{({toId:c}=c);c=this.children.get(c);this.app.cursors.reset();c.cursor?this.app.cursors.setCursor(c.cursor):this.cursor&&this.app.cursors.setCursor(this.cursor)})}get app(){return this.root}},gi=class extends ft{get app(){return this.root}get tool(){return this.parent}},Hv=class extends gi{constructor(){super(...arguments);xb(this,"cursor","crosshair");xb(this,"creatingShape");xb(this,"aspectRatio");
xb(this,"initialBounds",{});xb(this,"onEnter",()=>{const {currentPage:c,inputs:{originPoint:n,currentPoint:N}}=this.app;var {Shape:da}=this.tool;da=new da({id:Me(),type:da.id,parentId:c.id,point:[...n],fill:this.app.settings.color,stroke:this.app.settings.color,size:pe.abs(pe.sub(N,n))});this.initialBounds={minX:n[0],minY:n[1],maxX:n[0]+1,maxY:n[1]+1,width:1,height:1};da.canChangeAspectRatio||(da.aspectRatio?(this.aspectRatio=da.aspectRatio,this.initialBounds.height=this.aspectRatio):(this.aspectRatio=
1,this.initialBounds.height=1),this.initialBounds.width=1,this.initialBounds.maxY=this.initialBounds.minY+this.initialBounds.height);this.creatingShape=da;this.creatingShape.setScaleLevel(this.app.settings.scaleLevel);this.app.currentPage.addShapes(da);this.app.setSelectedShapes([da])});xb(this,"onPointerMove",c=>{if(!c.order){if(!this.creatingShape)throw Error("Expected a creating shape.");var {initialBounds:n}=this,{currentPoint:N,originPoint:da,shiftKey:ua}=this.app.inputs;c=ua||this.creatingShape.props.isAspectRatioLocked||
!this.creatingShape.canChangeAspectRatio;n=Je.getTransformedBoundingBox(n,"bottom_right_corner",pe.sub(N,da),0,c);this.app.settings.snapToGrid&&!c&&(n=Je.snapBoundsToGrid(n,8));this.creatingShape.update({point:[n.minX,n.minY],size:[n.width,n.height]})}});xb(this,"onPointerUp",()=>{this.tool.transition("idle");this.creatingShape?(this.app.setSelectedShapes([this.creatingShape]),this.app.api.editShape(this.creatingShape)):this.app.transition("select");this.app.persist()});xb(this,"onKeyDown",(c,n)=>
{switch(n.key){case "Escape":if(!this.creatingShape)throw Error("Expected a creating shape.");this.app.deleteShapes([this.creatingShape]);this.tool.transition("idle")}})}};xb(Hv,"id","creating");var Iv=class extends gi{constructor(){super(...arguments);xb(this,"onPointerDown",(c,n)=>{c.order||this.tool.transition("pointing")});xb(this,"onPinchStart",(...c)=>{var n,N;this.app.transition("select",{returnTo:this.app.currentState.id});null==(N=(n=this.app._events).onPinchStart)?void 0:N.call(n,...c)});
xb(this,"onKeyDown",(c,n)=>{switch(n.key){case "Escape":this.app.transition("select")}})}};xb(Iv,"id","idle");var Jv=class extends gi{constructor(){super(...arguments);xb(this,"onPointerMove",()=>{const {currentPoint:c,originPoint:n}=this.app.inputs;5<Cd.dist(c,n)&&!this.app.readOnly&&(this.tool.transition("creating"),this.app.setSelectedShapes(this.app.currentPage.shapes))});xb(this,"onPointerUp",()=>{this.tool.transition("idle")})}};xb(Jv,"id","pointing");var Em=class extends mn{constructor(){super(...arguments);
xb(this,"cursor","crosshair")}};xb(Em,"id","box");xb(Em,"states",[Iv,Jv,Hv]);xb(Em,"initial","idle");var Kv=class extends gi{constructor(){super(...arguments);xb(this,"shape",{});xb(this,"points",[[0,0,.5]]);xb(this,"persistDebounced",lg(this.app.persist,200));xb(this,"onPinchStart",(c,n)=>{this.tool.transition("pinching",{info:c,event:n})});xb(this,"onEnter",()=>{var c;const {Shape:n,previousShape:N}=this.tool;var {originPoint:da}=this.app.inputs;this.app.history.pause();if(this.app.inputs.shiftKey&&
N){this.shape=N;var {shape:ua}=this;var Ga=ua.props.points[ua.props.points.length-1];const fb=Cd.sub(da,ua.props.point).concat(null!=(c=da[2])?c:.5);this.points=[...ua.props.points,Ga,Ga];const vb=Math.ceil(Cd.dist(Ga,da)/16);for(let Wb=0,oc=Wb/(vb-1);Wb<vb;Wb++){c=this.points;da=c.push;ua=Cd.lrp(Ga,fb,oc);var Ma=Ga[2];da.call(c,ua.concat.call(ua,Ma+(fb[2]-Ma)*oc))}this.addNextPoint(fb)}else this.tool.previousShape=void 0,this.points=[[0,0,null!=(Ga=da[2])?Ga:.5]],this.shape=new n({id:Me(),type:n.id,
parentId:this.app.currentPage.id,point:da.slice(0,2),points:this.points,isComplete:!1,fill:this.app.settings.color,stroke:this.app.settings.color}),this.shape.setScaleLevel(this.app.settings.scaleLevel),this.app.currentPage.addShapes(this.shape)});xb(this,"onPointerMove",()=>{const {shape:c}=this,{currentPoint:n,previousPoint:N}=this.app.inputs;Cd.isEqual(N,n)||this.addNextPoint(Cd.sub(n,c.props.point).concat(n[2]))});xb(this,"onPointerUp",()=>{if(!this.shape)throw Error("Expected a creating shape.");
this.app.history.resume();this.shape.update({isComplete:!0,points:this.tool.simplify?wh.simplify2(this.points,this.tool.simplifyTolerance):this.shape.props.points});this.tool.previousShape=this.shape;this.tool.transition("idle");let c=this.app.selectedTool.id;"pencil"===c||"highlighter"===c?this.persistDebounced():this.app.persist()});xb(this,"onKeyDown",(c,n)=>{switch(n.key){case "Escape":if(!this.shape)throw Error("Expected a creating shape.");this.app.deleteShapes([this.shape]);this.tool.transition("idle")}})}addNextPoint(c){const {shape:n}=
this,N=Cd.min(c,[0,0]);this.points.push(c);0>N[0]||0>N[1]?(this.points=this.points.map(da=>Cd.sub(da,N).concat(da[2])),n.update({point:Cd.add(n.props.point,N),points:this.points})):n.update({points:this.points})}};xb(Kv,"id","creating");var Lv=class extends gi{constructor(){super(...arguments);xb(this,"onPointerDown",(c,n)=>{c.order||this.app.readOnly||this.tool.transition("creating")});xb(this,"onPinchStart",(c,n)=>{this.tool.transition("pinching",{info:c,event:n})});xb(this,"onKeyDown",(c,n)=>{switch(n.key){case "Escape":this.app.transition("select")}})}};
xb(Lv,"id","idle");var Mv=class extends gi{constructor(){super(...arguments);xb(this,"origin",[0,0]);xb(this,"prevDelta",[0,0]);xb(this,"onEnter",c=>{this.prevDelta=c.info.delta;this.origin=c.info.point});xb(this,"onPinch",c=>{this.app.viewport.pinchZoom(c.point,c.delta,c.delta[2])});xb(this,"onPinchEnd",()=>{this.tool.transition("idle")})}};xb(Mv,"id","pinching");var Gq=class extends mn{constructor(){super(...arguments);xb(this,"cursor","crosshair");xb(this,"simplify",!0);xb(this,"simplifyTolerance",
1);xb(this,"previousShape");xb(this,"onPinchStart",(c,n)=>{this.transition("pinching",{info:c,event:n})})}};xb(Gq,"id","draw");xb(Gq,"states",[Lv,Kv,Mv]);xb(Gq,"initial","idle");var Nv=class extends gi{constructor(){super(...arguments);xb(this,"points",[[0,0,.5]]);xb(this,"hitShapes",new Set);xb(this,"onEnter",()=>{const {originPoint:c}=this.app.inputs;this.points=[c];this.hitShapes.clear()});xb(this,"onPointerMove",()=>{const {currentPoint:c,previousPoint:n}=this.app.inputs;Cd.isEqual(n,c)||(this.points.push(c),
this.app.shapesInViewport.filter(N=>N.hitTestLineSegment(n,c)).forEach(N=>this.hitShapes.add(N)),this.app.setErasingShapes(Array.from(this.hitShapes.values())))});xb(this,"onPointerUp",()=>{this.app.deleteShapes(Array.from(this.hitShapes.values()));this.tool.transition("idle")});xb(this,"onKeyDown",(c,n)=>{switch(n.key){case "Escape":this.app.setErasingShapes([]),this.tool.transition("idle")}})}};xb(Nv,"id","erasing");var Ov=class extends gi{constructor(){super(...arguments);xb(this,"onPointerDown",
(c,n)=>{c.order||this.tool.transition("pointing")});xb(this,"onPinchStart",(...c)=>{var n,N;this.app.transition("select",{returnTo:this.app.currentState.id});null==(N=(n=this.app._events).onPinchStart)?void 0:N.call(n,...c)});xb(this,"onKeyDown",(c,n)=>{switch(n.key){case "Escape":this.app.transition("select")}})}};xb(Ov,"id","idle");var Pv=class extends gi{constructor(){super(...arguments);xb(this,"onEnter",()=>{const {currentPoint:c}=this.app.inputs;this.app.setErasingShapes(this.app.shapesInViewport.filter(n=>
n.hitTestPoint(c)))});xb(this,"onPointerMove",()=>{const {currentPoint:c,originPoint:n}=this.app.inputs;5<Cd.dist(c,n)&&(this.tool.transition("erasing"),this.app.setSelectedShapes([]))});xb(this,"onPointerUp",()=>{const c=[...this.app.erasingShapes];this.app.setErasingShapes([]);this.app.deleteShapes(c);this.tool.transition("idle")})}};xb(Pv,"id","pointing");var Gr=class extends mn{constructor(){super(...arguments);xb(this,"cursor","crosshair")}};xb(Gr,"id","erase");xb(Gr,"states",[Ov,Pv,Nv]);xb(Gr,
"initial","idle");var gt=class extends gi{constructor(){super(...arguments);xb(this,"handle",{});xb(this,"handleId","end");xb(this,"currentShape",{});xb(this,"initialShape",{});xb(this,"bindableShapeIds",[]);xb(this,"startBindingShapeId");xb(this,"newStartBindingId","");xb(this,"draggedBindingId","");xb(this,"onPointerMove",()=>{const {inputs:{shiftKey:c,previousPoint:n,originPoint:N,currentPoint:da,modKey:ua,altKey:Ga},settings:{snapToGrid:Ma}}=this.app;var fb=this.app.getShapeById(this.initialShape.id),
{handles:vb}=this.initialShape,Wb=this.handleId,oc="start"===this.handleId?"end":"start";if(!pe.isEqual(n,da)){var xc=pe.sub(da,N);if(c){var Uc=vb[oc].point,md=pe.add(vb[Wb].point,xc),hd=pe.angle(Uc,md);Uc=pe.rotWith(md,Uc,Dh.snapAngleToSegments(hd,24)-hd);xc=pe.add(xc,pe.sub(Uc,md))}xc=pe.add(vb[Wb].point,xc);vb={[Wb]:kg(Af({},vb[Wb]),{point:Ma?pe.snap(xc,8):pe.toFixed(xc),bindingId:void 0})};var Bd=this.currentShape.getHandlesChange(this.initialShape,vb);if(Bd){vb=yi(fb.props,Bd);var Ld={},bd;Wb=
vb.handles[Wb];oc=vb.handles[oc];if(this.startBindingShapeId){var jd;if(xc=this.app.getShapeById(this.startBindingShapeId)){md=xc.getCenter();Uc=vb.handles.end;var rd=pe.add(vb.handles.start.point,vb.point);pe.isEqual(rd,md)&&rd[1]++;hd=xc.hitTestPoint(da);rd=pe.uni(pe.sub(rd,md));const Md=void 0!==this.app.currentPage.bindings[this.newStartBindingId];ua||xc.hitTestPoint(pe.add(vb.point,Uc.point))||(jd=Yc(fb.props,xc,"start",this.newStartBindingId,md,md,rd,hd));jd&&!Md?(Ld[this.newStartBindingId]=
jd,vb.handles.start.bindingId=jd.id):!jd&&Md&&(console.log("removing start binding"),delete Ld[this.newStartBindingId],vb.handles.start.bindingId=void 0)}}if(!ua){jd=pe.add(oc.point,vb.point);oc=pe.add(Wb.point,vb.point);Wb=pe.uni(pe.sub(oc,jd));const Md=pe.add(vb.point,vb.handles.start.point),Dd=pe.add(vb.point,vb.handles.end.point);xc=this.bindableShapeIds.map(Oe=>this.app.getShapeById(Oe)).sort((Oe,Pe)=>Pe.nonce-Oe.nonce).filter(Oe=>![Md,Dd].every(Pe=>Oe.hitTestPoint(Pe)));for(const Oe of xc)if(bd=
Yc(fb.props,Oe,this.handleId,this.draggedBindingId,oc,jd,Wb,Ga))break}bd?(Ld[this.draggedBindingId]=bd,vb=yi(vb,{handles:{[this.handleId]:{bindingId:this.draggedBindingId}}})):(fb=fb.props.handles[this.handleId].bindingId,void 0!==fb&&(delete Ld[fb],vb=yi(vb,{handles:{[this.handleId]:{bindingId:void 0}}})));Bd=this.currentShape.getHandlesChange(vb,vb.handles);pc(()=>{var Md;if(Bd){this.currentShape.update(Bd);this.app.currentPage.updateBindings(Ld);const Dd=Object.values(null!=(Md=Bd.handles)?Md:
{}).map(Oe=>Oe.bindingId).map(Oe=>this.app.currentPage.bindings[Oe]).filter(Boolean).flatMap(Oe=>[Oe.toId,Oe.fromId].filter(Boolean));this.app.setBindingShapes(Dd)}})}}});xb(this,"onPointerUp",()=>{this.tool.transition("idle");this.currentShape&&this.app.setSelectedShapes([this.currentShape]);this.app.transition("select");this.app.persist()});xb(this,"onExit",()=>{this.app.clearBindingShape();this.app.history.resume();this.app.persist()});xb(this,"onKeyDown",(c,n)=>{switch(n.key){case "Escape":this.app.deleteShapes([this.currentShape]),
this.tool.transition("idle")}})}};xb(gt,"id","creating");var Qv=class extends gt{constructor(){super(...arguments);xb(this,"onEnter",()=>{var c;this.app.history.pause();this.newStartBindingId=Me();this.draggedBindingId=Me();this.bindableShapeIds=this.app.currentPage.getBindableShapes();var {Shape:n}=this.tool;const {originPoint:N}=this.app.inputs;n=new n(kg(Af({},n.defaultProps),{id:Me(),type:n.id,parentId:this.app.currentPage.id,point:this.app.settings.snapToGrid?pe.snap(N,8):N,fill:this.app.settings.color,
stroke:this.app.settings.color,scaleLevel:this.app.settings.scaleLevel}));this.initialShape=Bb(n.props);this.currentShape=n;this.app.currentPage.addShapes(n);this.app.setSelectedShapes([n]);if(this.startBindingShapeId=null==(c=this.bindableShapeIds.map(da=>this.app.getShapeById(da)).filter(da=>wh.pointInBounds(N,da.bounds))[0])?void 0:c.id)this.bindableShapeIds.splice(this.bindableShapeIds.indexOf(this.startBindingShapeId),1),this.app.setBindingShapes([this.startBindingShapeId])})}};xb(Qv,"id","creating");
var Rv=class extends gi{constructor(){super(...arguments);xb(this,"onPointerDown",(c,n)=>{c.order||this.tool.transition("pointing")});xb(this,"onPinchStart",(...c)=>{var n,N;this.app.transition("select",{returnTo:this.app.currentState.id});null==(N=(n=this.app._events).onPinchStart)?void 0:N.call(n,...c)});xb(this,"onKeyDown",(c,n)=>{switch(n.key){case "Escape":this.app.transition("select")}});xb(this,"onPointerEnter",c=>{if(!c.order)switch(c.type){case "shape":this.app.setHoveredShape(c.shape.id);
break;case "selection":"background"!==c.handle&&"center"!==c.handle&&this.tool.transition("hoveringSelectionHandle",c)}});xb(this,"onPointerLeave",c=>{c.order||"shape"===c.type&&this.app.hoveredId&&this.app.setHoveredShape(void 0)})}};xb(Rv,"id","idle");var Sv=class extends gi{constructor(){super(...arguments);xb(this,"onPointerMove",()=>{const {currentPoint:c,originPoint:n}=this.app.inputs;5<Cd.dist(c,n)&&!this.app.readOnly&&(this.tool.transition("creating"),this.app.setSelectedShapes(this.app.currentPage.shapes))})}};
xb(Sv,"id","pointing");var Hr=class extends mn{constructor(){super(...arguments);xb(this,"cursor","crosshair")}};xb(Hr,"id","line");xb(Hr,"states",[Rv,Sv,Qv]);xb(Hr,"initial","idle");var Tv=class extends gi{constructor(){super(...arguments);xb(this,"cursor","crosshair");xb(this,"creatingShape");xb(this,"aspectRatio");xb(this,"initialBounds",{});xb(this,"onEnter",()=>{const {currentPage:c,inputs:{originPoint:n}}=this.app,{Shape:N}=this.tool,da=new N({id:Me(),type:N.id,parentId:c.id,point:[...n],text:"",
size:[16,32],isSizeLocked:!0,fill:this.app.settings.color,stroke:this.app.settings.color});this.creatingShape=da;this.creatingShape.setScaleLevel(this.app.settings.scaleLevel);pc(()=>{this.app.currentPage.addShapes(da);const ua=this.app.settings.snapToGrid?pe.snap([...n],8):n,{bounds:Ga}=da;da.update({point:pe.sub(ua,[Ga.width/2,Ga.height/2])});this.app.transition("select");this.app.setSelectedShapes([da]);this.app.currentState.transition("editingShape",{type:"shape",shape:this.creatingShape,order:0})})})}};
xb(Tv,"id","creating");var Uv=class extends gi{constructor(){super(...arguments);xb(this,"onPointerDown",(c,n)=>{c.order||this.app.readOnly||this.tool.transition("creating")});xb(this,"onPinchStart",(...c)=>{var n,N;this.app.transition("select",{returnTo:this.app.currentState.id});null==(N=(n=this.app._events).onPinchStart)?void 0:N.call(n,...c)});xb(this,"onKeyDown",(c,n)=>{switch(n.key){case "Escape":this.app.transition("select")}})}};xb(Uv,"id","idle");var Ir=class extends mn{constructor(){super(...arguments);
xb(this,"cursor","crosshair")}};xb(Ir,"id","box");xb(Ir,"states",[Uv,Tv]);xb(Ir,"initial","idle");var Gz=Lf(F()),Hz=class extends Gz.default{constructor(){super(...arguments);xb(this,"toBBox",c=>c.rotatedBounds)}},Vv=class extends gi{constructor(){super(...arguments);xb(this,"initialSelectedIds",[]);xb(this,"initialSelectedShapes",[]);xb(this,"tree",new Hz);xb(this,"onEnter",()=>{const {selectedShapes:c,currentPage:n,selectedIds:N}=this.app;this.initialSelectedIds=Array.from(N.values());this.initialSelectedShapes=
Array.from(c.values());this.tree.load(n.shapes)});xb(this,"onExit",()=>{this.initialSelectedIds=[];this.tree.clear();this.app.setBrush(void 0)});xb(this,"onPointerMove",()=>{const {inputs:{shiftKey:c,ctrlKey:n,originPoint:N,currentPoint:da}}=this.app,ua=Je.getBoundsFromPoints([da,N],0);this.app.setBrush(ua);const Ga=[...(new Set(this.tree.search(ua).filter(Ma=>n?Je.boundsContain(ua,Ma.rotatedBounds):Ma.hitTestBounds(ua)).filter(Ma=>"group"!==Ma.type).map(Ma=>{var fb;return null!=(fb=this.app.getParentGroup(Ma))?
fb:Ma})))];c?Ga.every(Ma=>this.initialSelectedShapes.includes(Ma))?this.app.setSelectedShapes(this.initialSelectedShapes.filter(Ma=>!Ga.includes(Ma))):this.app.setSelectedShapes([...(new Set([...this.initialSelectedShapes,...Ga]))]):this.app.setSelectedShapes(Ga);this.app.viewport.panToPointWhenNearBounds(da)});xb(this,"onPointerUp",()=>{this.app.setBrush(void 0);this.tool.transition("idle")});xb(this,"handleModifierKey",(c,n)=>{switch(n.key){case "Escape":this.app.setBrush(void 0),this.app.setSelectedShapes(this.initialSelectedIds),
this.tool.transition("idle")}})}};xb(Vv,"id","brushing");var Wv=class extends gi{constructor(){super(...arguments);xb(this,"onEnter",c=>{var n;const {selectedIds:N,inputs:{shiftKey:da}}=this.app;if("shape"===c.type&&!N.has(c.shape.id)){const ua=null!=(n=this.app.getParentGroup(c.shape))?n:c.shape;da?this.app.setSelectedShapes([...Array.from(N.values()),ua.id]):this.app.setSelectedShapes([ua])}});xb(this,"onPointerDown",()=>{this.tool.transition("idle")})}};xb(Wv,"id","contextMenu");var Xv=class extends gi{constructor(){super(...arguments);
xb(this,"onEnter",c=>{"pinching"===c.fromId&&this.parent.returnTo&&this.app.transition(this.parent.returnTo)});xb(this,"onExit",()=>{});xb(this,"onPointerEnter",c=>{if(!c.order)switch(c.type){case "shape":this.app.setHoveredShape(c.shape.id);break;case "selection":"background"!==c.handle&&"center"!==c.handle&&this.tool.transition("hoveringSelectionHandle",c);break;case "canvas":this.app.setHoveredShape(void 0)}});xb(this,"onPointerDown",(c,n)=>{const {selectedShapes:N,inputs:{ctrlKey:da}}=this.app;
if(2===n.button)this.tool.transition("contextMenu",c);else if(da)this.tool.transition("pointingCanvas");else switch(c.type){case "selection":switch(c.handle){case "center":break;case "background":this.tool.transition("pointingBoundsBackground");break;case "rotate":this.tool.transition("pointingRotateHandle");break;default:this.tool.transition("pointingResizeHandle",c)}break;case "shape":if(N.has(c.shape))this.tool.transition("pointingSelectedShape",c);else{const {selectionBounds:ua,inputs:Ga}=this.app;
ua&&wh.pointInBounds(Ga.currentPoint,ua)?this.tool.transition("pointingShapeBehindBounds",c):this.tool.transition("pointingShape",c)}break;case "handle":this.tool.transition("pointingHandle",c);break;case "canvas":this.tool.transition("pointingCanvas");break;case "minimap":this.tool.transition("pointingMinimap",Af(Af({},n),c))}});xb(this,"onPointerLeave",c=>{c.order||"shape"===c.type&&this.app.hoveredId&&this.app.setHoveredShape(void 0)});xb(this,"onPinchStart",(c,n)=>{this.tool.transition("pinching",
{info:c,event:n})});xb(this,"onDoubleClick",c=>{if(!c.order&&1===this.app.selectedShapesArray.length&&!this.app.readOnly){var n=this.app.selectedShapesArray[0];if(n.canEdit&&!n.props.isLocked)switch(c.type){case "shape":this.tool.transition("editingShape",c);break;case "selection":1===this.app.selectedShapesArray.length&&this.tool.transition("editingShape",{type:"shape",target:n})}}});xb(this,"onKeyDown",(c,n)=>{({selectedShapesArray:c}=this.app);switch(n.key){case "Enter":1===c.length&&c[0].canEdit&&
!this.app.readOnly&&this.tool.transition("editingShape",{type:"shape",shape:c[0],order:0});break;case "Escape":c.length&&this.app.setSelectedShapes([])}})}};xb(Xv,"id","idle");var Yv=class extends gi{constructor(){super(...arguments);xb(this,"onEnter",c=>{var n;const {selectedIds:N,inputs:{shiftKey:da}}=this.app,ua=null!=(n=this.app.getParentGroup(c.shape))?n:c.shape;da?this.app.setSelectedShapes([...Array.from(N.values()),ua.id]):this.app.setSelectedShapes([ua])});xb(this,"onPointerMove",()=>{const {currentPoint:c,
originPoint:n}=this.app.inputs;5<Cd.dist(c,n)&&!this.app.readOnly&&this.tool.transition("translating")});xb(this,"onPointerUp",()=>{this.tool.transition("idle")});xb(this,"onPinchStart",(c,n)=>{this.tool.transition("pinching",{info:c,event:n})})}};xb(Yv,"id","pointingShape");var Zv=class extends gi{constructor(){super(...arguments);xb(this,"cursor","move");xb(this,"onPointerMove",()=>{const {currentPoint:c,originPoint:n}=this.app.inputs;5<Cd.dist(c,n)&&!this.app.readOnly&&this.tool.transition("translating")});
xb(this,"onPointerUp",()=>{this.app.setSelectedShapes([]);this.tool.transition("idle")});xb(this,"onPinchStart",(c,n)=>{this.tool.transition("pinching",{info:c,event:n})})}};xb(Zv,"id","pointingBoundsBackground");var $v=class extends gi{constructor(){super(...arguments);xb(this,"onEnter",()=>{var c;const {shiftKey:n}=this.app.inputs;n||(this.app.setSelectedShapes([]),this.app.setEditingShape(),null==(c=window.getSelection())?void 0:c.removeAllRanges())});xb(this,"onPointerMove",()=>{const {currentPoint:c,
originPoint:n}=this.app.inputs;5<Cd.dist(c,n)&&this.tool.transition("brushing")});xb(this,"onPointerUp",()=>{this.app.inputs.shiftKey||this.app.setSelectedShapes([]);this.tool.transition("idle")});xb(this,"onPinchStart",(c,n)=>{this.tool.transition("pinching",{info:c,event:n})});xb(this,"onDoubleClick",()=>{this.app.notify("canvas-dbclick",{point:this.app.inputs.originPoint})})}};xb($v,"id","pointingCanvas");var aw=class extends gi{constructor(){super(...arguments);xb(this,"cursor","move");xb(this,
"isCloning",!1);xb(this,"didClone",!1);xb(this,"initialPoints",{});xb(this,"initialShapePoints",{});xb(this,"initialClonePoints",{});xb(this,"clones",[]);xb(this,"onEnter",()=>{var c;this.app.history.pause();const {allSelectedShapesArray:n,inputs:N}=this.app;this.initialPoints=this.initialShapePoints=Object.fromEntries(n.map(({id:da,props:{point:ua}})=>[da,ua.slice()]));document.querySelectorAll("input,textarea").forEach(da=>da.blur());null==(c=document.getSelection())?void 0:c.empty();N.altKey?this.startCloning():
this.moveSelectedShapesToPointer()});xb(this,"onExit",()=>{this.app.history.resume();this.isCloning=this.didClone=!1;this.clones=[];this.initialPoints={};this.initialShapePoints={};this.initialClonePoints={}});xb(this,"onPointerMove",()=>{const {inputs:{currentPoint:c}}=this.app;this.moveSelectedShapesToPointer();this.app.viewport.panToPointWhenNearBounds(c)});xb(this,"onPointerDown",()=>{this.app.history.resume();this.app.persist();this.tool.transition("idle")});xb(this,"onPointerUp",()=>{this.app.history.resume();
this.app.persist();this.tool.transition("idle")});xb(this,"onKeyDown",(c,n)=>{switch(n.key){case "Alt":this.startCloning();break;case "Escape":this.app.allSelectedShapes.forEach(N=>{N.update({point:this.initialPoints[N.id]})}),this.tool.transition("idle")}});xb(this,"onKeyUp",(c,n)=>{switch(n.key){case "Alt":if(!this.isCloning)throw Error("Expected to be cloning.");const {currentPage:N,allSelectedShapes:da}=this.app;N.removeShapes(...da);this.initialPoints=this.initialShapePoints;this.app.setSelectedShapes(Object.keys(this.initialPoints));
this.moveSelectedShapesToPointer();this.isCloning=!1}})}moveSelectedShapesToPointer(){const {inputs:{shiftKey:c,originPoint:n,currentPoint:N}}=this.app,{initialPoints:da}=this,ua=Cd.sub(N,n);c&&(Math.abs(ua[0])<Math.abs(ua[1])?ua[0]=0:ua[1]=0);pc(()=>{this.app.allSelectedShapesArray.filter(Ga=>!Ga.props.isLocked).forEach(Ga=>{let Ma=Cd.add(da[Ga.id],ua);this.app.settings.snapToGrid&&(Ma=Cd.snap(Ma,8));Ga.update({point:Ma})})})}startCloning(){this.didClone||(this.clones=this.app.allSelectedShapesArray.map(c=>
{const n=this.app.getShapeClass(c.type);if(!n)throw Error("Could not find that shape class.");return new n(kg(Af({},c.serialized),{id:Me(),type:c.type,point:this.initialPoints[c.id],rotation:c.props.rotation,isLocked:!1}))}),this.initialClonePoints=Object.fromEntries(this.clones.map(({id:c,props:{point:n}})=>[c,n.slice()])),this.didClone=!0);this.app.allSelectedShapes.forEach(c=>{c.update({point:this.initialPoints[c.id]})});this.initialPoints=this.initialClonePoints;this.app.currentPage.addShapes(...this.clones);
this.app.setSelectedShapes(Object.keys(this.initialClonePoints));this.moveSelectedShapesToPointer();this.isCloning=!0}};xb(aw,"id","translating");var bw=class extends gi{constructor(){super(...arguments);xb(this,"pointedSelectedShape");xb(this,"onEnter",c=>{this.pointedSelectedShape=c.shape});xb(this,"onExit",()=>{this.pointedSelectedShape=void 0});xb(this,"onPointerMove",()=>{const {currentPoint:c,originPoint:n}=this.app.inputs;5<Cd.dist(c,n)&&!this.app.readOnly&&this.tool.transition("translating")});
xb(this,"onPointerUp",()=>{const {shiftKey:c,currentPoint:n}=this.app.inputs;var {selectedShapesArray:N}=this.app;if(!this.pointedSelectedShape)throw Error("Expected a pointed selected shape");if(c)({selectedIds:N}=this.app),N=Array.from(N.values()),N.splice(N.indexOf(this.pointedSelectedShape.id),1),this.app.setSelectedShapes(N);else{if(1===N.length&&this.pointedSelectedShape.canEdit&&!this.app.readOnly&&!this.pointedSelectedShape.props.isLocked&&this.pointedSelectedShape instanceof xk&&wh.pointInBounds(n,
this.pointedSelectedShape.bounds)){this.tool.transition("editingShape",{shape:this.pointedSelectedShape,order:0,type:"shape"});return}this.app.setSelectedShapes([this.pointedSelectedShape.id])}this.tool.transition("idle")});xb(this,"onPinchStart",(c,n)=>{this.tool.transition("pinching",{info:c,event:n})})}};xb(bw,"id","pointingSelectedShape");var cw=class extends gi{constructor(){super(...arguments);xb(this,"info",{});xb(this,"onEnter",c=>{this.info=c;this.updateCursor()});xb(this,"onExit",()=>{this.app.cursors.reset()});
xb(this,"onPointerMove",()=>{const {currentPoint:c,originPoint:n}=this.app.inputs;5<Cd.dist(c,n)&&this.tool.transition("resizing",this.info)});xb(this,"onPointerUp",()=>{this.tool.transition("hoveringSelectionHandle",this.info)});xb(this,"onPinchStart",(c,n)=>{this.tool.transition("pinching",{info:c,event:n})})}updateCursor(){this.app.cursors.setCursor(fi[this.info.handle],this.app.selectionBounds.rotation)}};xb(cw,"id","pointingResizeHandle");var dw=class extends gi{constructor(){super(...arguments);
xb(this,"isSingle",!1);xb(this,"handle","bottom_right_corner");xb(this,"snapshots",{});xb(this,"initialCommonBounds",{});xb(this,"selectionRotation",0);xb(this,"resizeType","corner");xb(this,"onEnter",c=>{var n,N;const {history:da,selectedShapesArray:ua,selectionBounds:Ga}=this.app;if(!Ga)throw Error("Expected a selected bounds.");this.handle=c.handle;this.resizeType="left_edge"===c.handle||"right_edge"===c.handle?"horizontal-edge":"top_edge"===c.handle||"bottom_edge"===c.handle?"vertical-edge":"corner";
this.app.cursors.setCursor(dw.CURSORS[c.handle],null==(n=this.app.selectionBounds)?void 0:n.rotation);da.pause();const Ma=Je.getBoundsFromPoints(ua.map(fb=>Je.getBoundsCenter(fb.bounds)));this.selectionRotation=(this.isSingle=1===ua.length)?null!=(N=ua[0].props.rotation)?N:0:0;this.initialCommonBounds=Af({},Ga);this.snapshots=Object.fromEntries(ua.map(fb=>{const vb=Af({},fb.bounds),[Wb,oc]=Je.getBoundsCenter(vb);return[fb.id,{props:fb.serialized,bounds:vb,transformOrigin:[(Wb-this.initialCommonBounds.minX)/
this.initialCommonBounds.width,(oc-this.initialCommonBounds.minY)/this.initialCommonBounds.height],innerTransformOrigin:[(Wb-Ma.minX)/Ma.width,(oc-Ma.minY)/Ma.height],isAspectRatioLocked:fb.props.isAspectRatioLocked||!(fb.canChangeAspectRatio&&!fb.props.rotation)}]}));ua.forEach(fb=>{var vb;null==(vb=fb.onResizeStart)?void 0:vb.call(fb,{isSingle:this.isSingle})})});xb(this,"onExit",()=>{this.app.cursors.reset();this.snapshots={};this.initialCommonBounds={};this.selectionRotation=0;this.app.history.resume()});
xb(this,"onPointerMove",()=>{const {inputs:{altKey:c,shiftKey:n,ctrlKey:N,originPoint:da,currentPoint:ua}}=this.app,{handle:Ga,snapshots:Ma,initialCommonBounds:fb}=this;let vb=Cd.sub(ua,da);c&&(vb=Cd.mul(vb,2));const Wb=this.app.selectedShapes.values().next().value;let oc=Je.getTransformedBoundingBox(fb,Ga,vb,this.selectionRotation,n||this.isSingle&&(N?!("clipping"in Wb.props):!Wb.canChangeAspectRatio||Wb.props.isAspectRatioLocked));c&&(oc=Af(Af({},oc),Je.centerBounds(oc,Je.getBoundsCenter(fb))));
const {scaleX:xc,scaleY:Uc}=oc;this.app.selectedShapes.forEach(md=>{var hd,Bd;const {isAspectRatioLocked:Ld,props:bd,bounds:jd,transformOrigin:rd}=Ma[md.id];let Md=Je.getRelativeTransformedBoundingBox(oc,fb,jd,0>xc,0>Uc);if(md.canResize.some(Pe=>Pe)||md.props.isSizeLocked||!this.isSingle){var Dd=[xc,Uc],Oe=null!=(hd=bd.rotation)?hd:0;hd=Je.getBoundsCenter(Md);md.canFlip||(Dd=Cd.abs(Dd));md.canScale||(Dd=null!=(Bd=bd.scale)?Bd:[1,1]);if(Oe&&0>xc&&0<=Uc||0>Uc&&0<=xc)Oe*=-1;this.app.settings.snapToGrid&&
!Ld&&(Md=Je.snapBoundsToGrid(Md,8));md.onResize(bd,{center:hd,rotation:Oe,scale:Dd,bounds:Md,type:Ga,clip:N,transformOrigin:rd})}});this.updateCursor(xc,Uc);this.app.viewport.panToPointWhenNearBounds(ua)});xb(this,"onPointerUp",()=>{this.app.history.resume();this.app.persist();this.tool.transition("idle")});xb(this,"onKeyDown",(c,n)=>{switch(n.key){case "Escape":this.app.selectedShapes.forEach(N=>{N.update(Af({},this.snapshots[N.id].props))}),this.tool.transition("idle")}})}updateCursor(c,n){var N,
da,ua,Ga;const Ma=0>c&&0<=n;c=0>n&&0<=c;switch(this.handle){case "top_left_corner":case "bottom_right_corner":Ma||c?"nwse-resize"===this.app.cursors.cursor&&this.app.cursors.setCursor("nesw-resize",null==(N=this.app.selectionBounds)?void 0:N.rotation):"nesw-resize"===this.app.cursors.cursor&&this.app.cursors.setCursor("nwse-resize",null==(da=this.app.selectionBounds)?void 0:da.rotation);break;case "top_right_corner":case "bottom_left_corner":Ma||c?"nesw-resize"===this.app.cursors.cursor&&this.app.cursors.setCursor("nwse-resize",
null==(ua=this.app.selectionBounds)?void 0:ua.rotation):"nwse-resize"===this.app.cursors.cursor&&this.app.cursors.setCursor("nesw-resize",null==(Ga=this.app.selectionBounds)?void 0:Ga.rotation)}}},ht=dw;xb(ht,"id","resizing");xb(ht,"CURSORS",{bottom_edge:"ns-resize",top_edge:"ns-resize",left_edge:"ew-resize",right_edge:"ew-resize",bottom_left_corner:"nesw-resize",bottom_right_corner:"nwse-resize",top_left_corner:"nwse-resize",top_right_corner:"nesw-resize"});var ew=class extends gi{constructor(){super(...arguments);
xb(this,"cursor","rotate");xb(this,"handle","");xb(this,"onEnter",c=>{this.app.history.pause();this.handle=c.handle;this.updateCursor()});xb(this,"onPointerMove",()=>{const {currentPoint:c,originPoint:n}=this.app.inputs;5<Cd.dist(c,n)&&this.tool.transition("rotating",{handle:this.handle})});xb(this,"onPointerUp",()=>{this.app.history.resume();this.app.persist();this.tool.transition("idle")});xb(this,"onPinchStart",(c,n)=>{this.tool.transition("pinching",{info:c,event:n})})}updateCursor(){this.app.cursors.setCursor(fi[this.handle],
this.app.selectionRotation)}};xb(ew,"id","pointingRotateHandle");var fw=class extends gi{constructor(){super(...arguments);xb(this,"info",{});xb(this,"onEnter",c=>{this.info=c});xb(this,"onPointerMove",()=>{const {currentPoint:c,originPoint:n}=this.app.inputs;5<Cd.dist(c,n)&&!this.app.readOnly&&this.tool.transition("translating")});xb(this,"onPointerUp",()=>{const {selectedIds:c,inputs:{shiftKey:n}}=this.app;n?this.app.setSelectedShapes([...Array.from(c.values()),this.info.shape.id]):this.app.setSelectedShapes([this.info.shape.id]);
this.tool.transition("idle")});xb(this,"onPinchStart",(c,n)=>{this.tool.transition("pinching",{info:c,event:n})})}};xb(fw,"id","pointingShapeBehindBounds");var it=class extends gi{constructor(){super(...arguments);xb(this,"cursor","rotate");xb(this,"snapshot",{});xb(this,"initialCommonCenter",[0,0]);xb(this,"initialCommonBounds",{});xb(this,"initialAngle",0);xb(this,"initialSelectionRotation",0);xb(this,"handle","");xb(this,"onEnter",c=>{const {history:n,selectedShapesArray:N,selectionBounds:da}=
this.app;if(!da)throw Error("Expected selected bounds.");n.pause();this.handle=c.handle;this.initialSelectionRotation=this.app.selectionRotation;this.initialCommonBounds=Af({},da);this.initialCommonCenter=Je.getBoundsCenter(da);this.initialAngle=Cd.angle(this.initialCommonCenter,this.app.inputs.currentPoint);this.snapshot=Object.fromEntries(N.map(ua=>[ua.id,{point:[...ua.props.point],center:[...ua.center],rotation:ua.props.rotation,handles:"handles"in ua?to(ua.handles):void 0}]));this.updateCursor()});
xb(this,"onExit",()=>{this.app.history.resume();this.snapshot={}});xb(this,"onPointerMove",()=>{const {selectedShapes:c,inputs:{shiftKey:n,currentPoint:N}}=this.app,{snapshot:da,initialCommonCenter:ua,initialAngle:Ga,initialSelectionRotation:Ma}=this;let fb=Cd.angle(ua,N)-Ga;n&&(fb=Dh.snapAngleToSegments(fb,24));c.forEach(Wb=>{var oc=da[Wb.id];let xc=0;if(n){var {rotation:Uc=0}=oc;xc=Dh.snapAngleToSegments(Uc,24)-Uc}const md=Cd.sub(oc.center,oc.point);Uc=Cd.rotWith(oc.center,ua,fb);if("handles"in
Wb){oc=oc.handles;const hd=oc.map(Ld=>Cd.rotWith(Ld.point,md,fb)),Bd=Je.getCommonTopLeft(hd);Wb.update({point:Cd.add(Bd,Cd.sub(Uc,md)),handles:oc.map((Ld,bd)=>kg(Af({},Ld),{point:Cd.sub(hd[bd],Bd)}))})}else Wb.update({point:Cd.sub(Uc,md),rotation:Dh.clampRadians((oc.rotation||0)+fb+xc)})});const vb=Dh.clampRadians(Ma+fb);this.app.setSelectionRotation(n?Dh.snapAngleToSegments(vb,24):vb);this.updateCursor()});xb(this,"onPointerUp",()=>{this.app.history.resume();this.app.persist();this.tool.transition("idle")});
xb(this,"onKeyDown",(c,n)=>{switch(n.key){case "Escape":this.app.selectedShapes.forEach(N=>{N.update(this.snapshot[N.id])}),this.tool.transition("idle")}})}updateCursor(){this.app.cursors.setCursor(fi[this.handle],this.app.selectionRotation)}};xb(it,"id","rotating");var gw=class extends gi{constructor(){super(...arguments);xb(this,"onPinch",(c,n)=>{this.app.viewport.pinchZoom(c.point,c.delta,c.delta[2])});xb(this,"onPinchEnd",()=>{this.tool.transition("idle")});xb(this,"onPointerDown",()=>{this.tool.transition("idle")})}};
xb(gw,"id","pinching");var hw=class extends gt{constructor(){super(...arguments);xb(this,"cursor","grabbing");xb(this,"onEnter",c=>{this.app.history.pause();this.newStartBindingId=Me();this.draggedBindingId=Me();this.bindableShapeIds=this.app.currentPage.getBindableShapes();this.handleId=c.id;this.currentShape=c.shape;this.initialShape=Bb(this.currentShape.props);this.app.setSelectedShapes([this.currentShape])})}};xb(hw,"id","translatingHandle");var iw=class extends gi{constructor(){super(...arguments);
xb(this,"cursor","grabbing");xb(this,"info",{});xb(this,"onEnter",c=>{this.info=c});xb(this,"onPointerMove",()=>{const {currentPoint:c,originPoint:n}=this.app.inputs;5<Cd.dist(c,n)&&this.tool.transition("translatingHandle",this.info)});xb(this,"onPointerUp",()=>{this.tool.transition("idle")});xb(this,"onPinchStart",(c,n)=>{this.tool.transition("pinching",{info:c,event:n})})}};xb(iw,"id","pointingHandle");var jw=class extends gi{constructor(){super(...arguments);xb(this,"handle");xb(this,"onEnter",
c=>{var n;this.app.cursors.setCursor(fi[c.handle],null!=(n=this.app.selectionBounds.rotation)?n:0);this.handle=c.handle});xb(this,"onExit",()=>{this.app.cursors.reset()});xb(this,"onPinchStart",(c,n)=>{this.tool.transition("pinching",{info:c,event:n})});xb(this,"onPointerDown",c=>{switch(c.type){case "selection":switch(c.handle){case "center":break;case "background":break;case "top_left_resize_corner":case "top_right_resize_corner":case "bottom_right_resize_corner":case "bottom_left_resize_corner":this.tool.transition("pointingRotateHandle",
c);break;default:this.tool.transition("pointingResizeHandle",c)}}});xb(this,"onPointerLeave",()=>{this.tool.transition("idle")});xb(this,"onDoubleClick",c=>{var n;if(!c.order&&1===this.app.selectedShapes.size){var N=this.app.selectedShapes.values().next().value;if(!N.canEdit||this.app.readOnly||N.props.isLocked)N.onResetBounds({asset:N.props.assetId?this.app.assets[N.props.assetId]:void 0,zoom:this.app.viewport.camera.zoom}),this.tool.transition("idle");else switch(c.type){case "shape":this.tool.transition("editingShape",
c);break;case "selection":null==(n=N.onResetBounds)?void 0:n.call(N,{zoom:this.app.viewport.camera.zoom}),1===this.app.selectedShapesArray.length&&this.tool.transition("editingShape",{type:"shape",target:N})}}})}};xb(jw,"id","hoveringSelectionHandle");var kw=class extends gi{constructor(){super(...arguments);xb(this,"editingShape",{});xb(this,"onEnter",c=>{this.editingShape=c.shape;this.app.setEditingShape(c.shape)});xb(this,"onExit",()=>{var c;if(this.editingShape&&"text"in this.editingShape.props){const n=
this.editingShape.props.text.trim();""===n&&"text"===this.editingShape.props.type?this.app.deleteShapes([this.editingShape]):(this.editingShape.onResetBounds(),this.editingShape.update({text:n}))}this.app.persist();this.app.setEditingShape();null==(c=document.querySelector(".tl-canvas"))?void 0:c.focus()});xb(this,"onPinchStart",(c,n)=>{this.tool.transition("pinching",{info:c,event:n})});xb(this,"onPointerDown",c=>{switch(c.type){case "shape":if(c.shape===this.editingShape)break;this.tool.transition("idle",
c);break;case "canvas":c.order||this.tool.transition("idle",c)}});xb(this,"onKeyDown",(c,n)=>{switch(n.key){case "Escape":pc(()=>{n.stopPropagation();this.app.setSelectedShapes([this.editingShape]);this.tool.transition("idle")})}})}};xb(kw,"id","editingShape");var lw=class extends gi{constructor(){super(...arguments);xb(this,"minimapZoom",1);xb(this,"minimapRect",{minX:0,minY:0,maxX:0,maxY:0,width:0,height:0});xb(this,"getCameraPoint",c=>{const n=document.querySelector(".tl-preview-minimap svg");
var N=document.querySelector(".tl-preview-minimap #minimap-camera-rect");if(n&&N){const da=n.getBoundingClientRect();this.minimapRect.height=da.height;this.minimapRect.width=da.width;this.minimapRect.minX=da.left;this.minimapRect.minY=da.top;this.minimapRect.maxX=da.right;this.minimapRect.maxY=da.bottom;this.minimapZoom=+n.dataset.commonBoundWidth/this.minimapRect.width;c=Cd.sub(c,[this.minimapRect.minX,this.minimapRect.minY]);N=N.getBoundingClientRect();N=Cd.mul(Cd.sub(c,[N.left+N.width/2,N.top+
N.height/2]),this.minimapZoom);return Cd.sub(this.app.viewport.camera.point,N)}});xb(this,"onEnter",c=>{(c=this.getCameraPoint([c.clientX,c.clientY]))?this.app.viewport.update({point:c}):this.tool.transition("idle")});xb(this,"onPointerMove",(c,n)=>{"clientX"in n&&(c=this.getCameraPoint([n.clientX,n.clientY]))&&this.app.viewport.update({point:c})});xb(this,"onPointerUp",()=>{this.tool.transition("idle")})}};xb(lw,"id","pointingMinimap");var op=class extends mn{constructor(){super(...arguments);xb(this,
"returnTo","");xb(this,"onEnter",c=>{this.returnTo=null==c?void 0:c.returnTo})}};xb(op,"id","select");xb(op,"initial","idle");xb(op,"shortcut","whiteboard/select");xb(op,"states",[Xv,Vv,Wv,$v,Yv,fw,bw,Zv,jw,cw,ew,lw,iw,hw,aw,ht,it,it,gw,kw]);var mw=class extends gi{constructor(){super(...arguments);xb(this,"cursor","grabbing");xb(this,"originalScreenPoint",[]);xb(this,"originalCameraPoint",[]);xb(this,"prevState","idle");xb(this,"onEnter",c=>{this.prevState=null==c?void 0:c.prevState;this.originalScreenPoint=
this.app.inputs.currentScreenPoint;this.originalCameraPoint=this.app.viewport.camera.point});xb(this,"onPointerMove",(c,n)=>{c=pe.sub(this.originalScreenPoint,this.app.inputs.currentScreenPoint);this.app.viewport.update({point:pe.sub(this.originalCameraPoint,pe.div(c,this.app.viewport.camera.zoom))})});xb(this,"onPointerUp",()=>{var c;this.tool.transition(null!=(c=this.prevState)?c:"idle")})}};xb(mw,"id","panning");var nw=class extends gi{constructor(){super(...arguments);xb(this,"onEnter",c=>{this.parent.prevTool&&
c.exit&&(this.app.setCurrentState(this.parent.prevTool),setTimeout(()=>{this.app.cursors.reset();this.app.cursors.setCursor(this.parent.prevTool.cursor)}))});xb(this,"onPointerDown",(c,n)=>{c.order||this.tool.transition("panning")})}};xb(nw,"id","idle");var ow=class extends gi{constructor(){super(...arguments);xb(this,"onPointerDown",(c,n)=>{c.order||this.tool.transition("panning",{prevState:"idleHold"})});xb(this,"onPinchStart",(c,n)=>{this.tool.transition("pinching",{info:c,event:n})})}};xb(ow,
"id","idleHold");var pw=class extends gi{constructor(){super(...arguments);xb(this,"origin",[0,0]);xb(this,"prevDelta",[0,0]);xb(this,"onEnter",c=>{this.prevDelta=c.info.delta;this.origin=c.info.point});xb(this,"onPinch",c=>{this.app.viewport.pinchZoom(c.point,c.delta,c.delta[2])});xb(this,"onPinchEnd",()=>{this.tool.transition("idle")})}};xb(pw,"id","pinching");var pp=class extends mn{constructor(){super(...arguments);xb(this,"cursor","grab");xb(this,"prevTool",null);xb(this,"onEnter",c=>{this.prevTool=
null==c?void 0:c.prevTool});xb(this,"onKeyDown",(c,n)=>{switch(n.key){case "Escape":this.app.transition("select")}});xb(this,"onPinchStart",(c,n)=>{this.transition("pinching",{info:c,event:n})})}};xb(pp,"id","move");xb(pp,"shortcut","whiteboard/pan");xb(pp,"states",[nw,ow,mw,pw]);xb(pp,"initial","idle");var Zj=class{constructor(c,n={}){xb(this,"lastShapesNounces",null);xb(this,"app");xb(this,"id");xb(this,"name");xb(this,"shapes",[]);xb(this,"bindings",{});xb(this,"nonce",0);xb(this,"bringForward",
fb=>{this.bringToFront(fb);return this});xb(this,"sendBackward",fb=>{this.sendToBack(fb);return this});xb(this,"bringToFront",fb=>{const vb=this.parseShapesArg(fb);fb=this.shapes.filter(Wb=>!vb.includes(Wb));this.shapes=fb.concat(vb);fb={op:"bringToFront",shapes:vb,before:fb[fb.length-1]};this.app.persist(fb);this.persistInfo=fb;return this});xb(this,"sendToBack",fb=>{const vb=this.parseShapesArg(fb);fb=this.shapes.filter(Wb=>!vb.includes(Wb));this.shapes=vb.concat(fb);this.app.persist({op:"sendToBack",
shapes:vb,next:fb[0]});return this});xb(this,"flip",(fb,vb)=>{fb=this.parseShapesArg(fb);const Wb=Je.getCommonBounds(fb.map(oc=>oc.bounds));fb.forEach(oc=>{var xc;const Uc=Je.getRelativeTransformedBoundingBox(Wb,Wb,oc.bounds,"horizontal"===vb,"vertical"===vb);if(oc.serialized)oc.onResize(oc.serialized,{bounds:Uc,center:Je.getBoundsCenter(Uc),rotation:null!=(xc=oc.props.rotation)?xc:-0,type:"top_left_corner",scale:oc.canFlip&&oc.props.scale?"horizontal"===vb?[-oc.props.scale[0],1]:[1,-oc.props.scale[1]]:
[1,1],clip:!1,transformOrigin:[.5,.5]})});this.app.persist();return this});xb(this,"getShapeById",fb=>this.shapes.find(vb=>vb.id===fb));xb(this,"cleanup",fb=>{fb=tc(this.bindings,fb);const vb=new Set;let Wb=!1;const oc=to(this.bindings);fb.forEach(xc=>{var Uc;if(this.bindings[xc.id]){var md=this.getShapeById(xc.toId),hd=this.getShapeById(xc.fromId);md&&hd?vb.has(hd.id)||(xc=this.updateArrowBindings(hd),vb.add(hd.id),xc&&(md=Af(Af({},hd.props),xc),null==(Uc=this.getShapeById(md.id))?void 0:Uc.update(md,
!1,(0,Yz.default)(null==xc?void 0:xc.handles,null==hd?void 0:hd.props.handles)))):(delete oc[xc.id],Wb=!0)}});Object.keys(oc).forEach(xc=>{const Uc=this.bindings[xc];0===this.shapes.filter(md=>md.id===Uc.fromId||md.id===Uc.toId).length&&(delete oc[xc],Wb=!0)});Wb&&this.update({bindings:oc})});xb(this,"updateArrowBindings",fb=>{var vb,Wb,oc,xc={start:to(fb.props.handles.start),end:to(fb.props.handles.end)},Uc={isBound:!1,handle:fb.props.handles.start,point:pe.add(fb.props.handles.start.point,fb.props.point)},
md={isBound:!1,handle:fb.props.handles.end,point:pe.add(fb.props.handles.end.point,fb.props.point)};if(fb.props.handles.start.bindingId){var hd=void 0!==(null==(vb=fb.props.decorations)?void 0:vb.start);vb=fb.props.handles.start;var Bd=this.bindings[fb.props.handles.start.bindingId],Ld=this.getShapeById(null==Bd?void 0:Bd.toId);if(Ld){Uc=Ld.getBounds();var bd=Ld.getExpandedBounds(),jd=Je.expandBounds(Uc,hd?Bd.distance:1);const {minX:rd,minY:Md,width:Dd,height:Oe}=bd,Pe=pe.add([rd,Md],pe.mulV([Dd,
Oe],pe.rotWith(Bd.point,[.5,.5],Ld.props.rotation||0)));Uc={isBound:!0,hasDecoration:hd,binding:Bd,handle:vb,point:Pe,target:Ld,bounds:Uc,expandedBounds:bd,intersectBounds:jd,center:Ld.getCenter()}}}if(fb.props.handles.end.bindingId&&(hd=void 0!==(null==(Wb=fb.props.decorations)?void 0:Wb.end),Wb=fb.props.handles.end,vb=this.bindings[fb.props.handles.end.bindingId],Bd=this.getShapeById(null==vb?void 0:vb.toId))){md=Bd.getBounds();Ld=Bd.getExpandedBounds();bd=hd?Je.expandBounds(md,vb.distance):md;
const {minX:rd,minY:Md,width:Dd,height:Oe}=Ld;jd=pe.add([rd,Md],pe.mulV([Dd,Oe],pe.rotWith(vb.point,[.5,.5],Bd.props.rotation||0)));md={isBound:!0,hasDecoration:hd,binding:vb,handle:Wb,point:jd,target:Bd,bounds:md,expandedBounds:Ld,intersectBounds:bd,center:Bd.getCenter()}}for(const rd of["end","start"]){Wb="start"===rd?Uc:md;const Md="start"===rd?md:Uc;if(Wb.isBound)if(Wb.binding.distance){if(hd=pe.uni(pe.sub(Wb.point,Md.point)),vb=E(Md.point,hd,Wb.intersectBounds,Wb.target.props.rotation).filter(Dd=>
Dd.didIntersect).map(Dd=>Dd.points[0]).sort((Dd,Oe)=>pe.dist(Dd,Md.point)-pe.dist(Oe,Md.point)),vb[0])if(Bd=void 0,Md.isBound&&(Bd=E(Md.point,hd,Md.intersectBounds,Md.target.props.rotation).filter(Dd=>Dd.didIntersect).map(Dd=>Dd.points[0]).sort((Dd,Oe)=>pe.dist(Dd,Md.point)-pe.dist(Oe,Md.point))[0]),Md.isBound&&(2>vb.length||Bd&&vb[0]&&10>Math.ceil(pe.dist(vb[0],Bd))||Je.boundsContain(Wb.expandedBounds,Md.expandedBounds)||Je.boundsCollide(Wb.expandedBounds,Md.expandedBounds)))hd=pe.uni(pe.sub(Md.point,
Wb.point)),vb=E(Wb.point,hd,Wb.bounds,Wb.target.props.rotation).filter(Dd=>Dd.didIntersect).map(Dd=>Dd.points[0]),vb[0]&&(xc[rd].point=pe.toFixed(pe.sub(vb[0],fb.props.point)),xc["start"===rd?"end":"start"].point=pe.toFixed(pe.add(pe.sub(vb[0],fb.props.point),pe.mul(hd,Math.min(pe.dist(vb[0],Md.point),10*(Je.boundsContain(Md.bounds,Wb.intersectBounds)?-1:1))))));else{if(!Md.isBound&&(vb[0]&&10>pe.dist(vb[0],Md.point)||wh.pointInBounds(Md.point,Wb.intersectBounds)))return xc=pe.uni(pe.sub(Wb.center,
Md.point)),null==(oc=fb.getHandlesChange)?void 0:oc.call(fb,fb.props,{[rd]:kg(Af({},fb.props.handles[rd]),{point:pe.toFixed(pe.add(pe.sub(Md.point,fb.props.point),pe.mul(xc,10)))})});vb[0]&&(xc[rd].point=pe.toFixed(pe.sub(vb[0],fb.props.point)))}}else xc[rd].point=pe.sub(Wb.point,fb.props.point)}return fb.getHandlesChange(fb.props,xc)});const {id:N,name:da,shapes:ua=[],bindings:Ga={},nonce:Ma}=n;this.id=N;this.name=da;this.bindings=Object.assign({},Ga);this.app=c;this.nonce=Ma||0;this.persistInfo=
null;this.addShapes(...ua);Ec(this);kc(()=>{const fb=0<this.shapes.length?Object.fromEntries(this.shapes.map(vb=>[vb.id,vb.nonce])):null;if(this.lastShapesNounces&&fb){const vb=this.lastShapesNounces,Wb=[...(new Set([...Object.keys(fb),...Object.keys(vb)]))].filter(oc=>vb[oc]!==fb[oc]);requestAnimationFrame(()=>{this.cleanup(Wb)})}fb&&(this.lastShapesNounces=fb)})}get serialized(){return{id:this.id,name:this.name,shapes:this.shapes.map(c=>c.serialized).filter(c=>!!c).map(c=>Bb(c)),bindings:to(this.bindings),
nonce:this.nonce}}get shapesById(){return Object.fromEntries(this.shapes.map(c=>[c.id,c]))}update(c){Object.assign(this,c);return this}updateBindings(c){Object.assign(this.bindings,c);return this}updateShapesIndex(c){this.shapes.sort((n,N)=>c.indexOf(n.id)-c.indexOf(N.id));return this}addShapes(...c){if(0!==c.length)return c="getBounds"in c[0]?c:c.map(n=>new (this.app.getShapeClass(n.type))(n)),this.shapes.push(...c),c}parseShapesArg(c){return"string"===typeof c[0]?this.shapes.filter(n=>c.includes(n.id)):
c}removeShapes(...c){const n=this.parseShapesArg(c);this.shapes=this.shapes.filter(N=>!n.includes(N));return n}getBindableShapes(){return this.shapes.filter(c=>c.canBind).sort((c,n)=>n.nonce-c.nonce).map(c=>c.id)}};re([Qg],Zj.prototype,"id",2);re([Qg],Zj.prototype,"name",2);re([Qg],Zj.prototype,"shapes",2);re([Qg],Zj.prototype,"bindings",2);re([Zg],Zj.prototype,"serialized",1);re([Zg],Zj.prototype,"shapesById",1);re([Qg],Zj.prototype,"nonce",2);re([Cg],Zj.prototype,"update",1);re([Cg],Zj.prototype,
"updateBindings",1);re([Cg],Zj.prototype,"updateShapesIndex",1);re([Cg],Zj.prototype,"addShapes",1);re([Cg],Zj.prototype,"removeShapes",1);re([Cg],Zj.prototype,"bringForward",2);re([Cg],Zj.prototype,"sendBackward",2);re([Cg],Zj.prototype,"bringToFront",2);re([Cg],Zj.prototype,"sendToBack",2);re([Cg],Zj.prototype,"cleanup",2);var jj=class{constructor(){xb(this,"shiftKey",!1);xb(this,"ctrlKey",!1);xb(this,"modKey",!1);xb(this,"altKey",!1);xb(this,"spaceKey",!1);xb(this,"isPinching",!1);xb(this,"currentScreenPoint",
[0,0]);xb(this,"currentPoint",[0,0]);xb(this,"previousScreenPoint",[0,0]);xb(this,"previousPoint",[0,0]);xb(this,"originScreenPoint",[0,0]);xb(this,"originPoint",[0,0]);xb(this,"pointerIds",new Set);xb(this,"state","idle");xb(this,"containerOffset",[0,0]);xb(this,"onPointerDown",(c,n)=>{this.pointerIds.add(n.pointerId);this.updateModifiers(n);this.originScreenPoint=this.currentScreenPoint;this.originPoint=c;this.state="pointing"});xb(this,"onPointerMove",(c,n)=>{"pinching"!==this.state&&("panning"===
this.state&&(this.state="idle"),this.updateModifiers(n),this.previousPoint=this.currentPoint,this.currentPoint=c)});xb(this,"onPointerUp",(c,n)=>{this.pointerIds.clear();this.updateModifiers(n);this.state="idle"});xb(this,"onKeyDown",c=>{this.updateModifiers(c);switch(c.key){case " ":this.spaceKey=!0}});xb(this,"onKeyUp",c=>{this.updateModifiers(c);switch(c.key){case " ":this.spaceKey=!1}});xb(this,"onPinchStart",(c,n)=>{this.updateModifiers(n);this.state="pinching"});xb(this,"onPinch",(c,n)=>{"pinching"===
this.state&&this.updateModifiers(n)});xb(this,"onPinchEnd",(c,n)=>{"pinching"===this.state&&(this.updateModifiers(n),this.state="idle")});Ec(this)}updateContainerOffset(c){Object.assign(this.containerOffset,c)}updateModifiers(c){c.isPrimary&&("clientX"in c&&(this.previousScreenPoint=this.currentScreenPoint,this.currentScreenPoint=pe.sub([c.clientX,c.clientY],this.containerOffset)),"shiftKey"in c&&(this.shiftKey=c.shiftKey,this.ctrlKey=c.ctrlKey,this.altKey=c.altKey,this.modKey=Ub()?c.metaKey:c.ctrlKey))}};
re([Qg],jj.prototype,"shiftKey",2);re([Qg],jj.prototype,"ctrlKey",2);re([Qg],jj.prototype,"modKey",2);re([Qg],jj.prototype,"altKey",2);re([Qg],jj.prototype,"spaceKey",2);re([Qg],jj.prototype,"isPinching",2);re([Qg],jj.prototype,"currentScreenPoint",2);re([Qg],jj.prototype,"currentPoint",2);re([Qg],jj.prototype,"previousScreenPoint",2);re([Qg],jj.prototype,"previousPoint",2);re([Qg],jj.prototype,"originScreenPoint",2);re([Qg],jj.prototype,"originPoint",2);re([Qg],jj.prototype,"state",2);re([Qg],jj.prototype,
"containerOffset",2);re([Cg],jj.prototype,"updateContainerOffset",1);re([Cg],jj.prototype,"updateModifiers",1);re([Cg],jj.prototype,"onPointerDown",2);re([Cg],jj.prototype,"onPointerMove",2);re([Cg],jj.prototype,"onPointerUp",2);re([Cg],jj.prototype,"onKeyDown",2);re([Cg],jj.prototype,"onKeyUp",2);re([Cg],jj.prototype,"onPinchStart",2);re([Cg],jj.prototype,"onPinch",2);re([Cg],jj.prototype,"onPinchEnd",2);var Iz=(c,n=100)=>-(Math.cos(Math.PI*Cd.clamp(c/n,0,1))-1)/2,so=class{constructor(){xb(this,
"bounds",{minX:0,minY:0,maxX:1080,maxY:720,width:1080,height:720});xb(this,"camera",{point:[0,0],zoom:1});xb(this,"updateBounds",c=>{this.bounds=c;return this});xb(this,"panCamera",c=>this.update({point:Cd.sub(this.camera.point,Cd.div(c,this.camera.zoom))}));xb(this,"panToPointWhenNearBounds",c=>{const n=Cd.div([so.panThreshold,so.panThreshold],this.camera.zoom),N=Cd.sub([this.currentView.maxX,this.currentView.maxY],Cd.add(c,n));c=Cd.sub([this.currentView.minX,this.currentView.minY],Cd.sub(c,n));
this.panCamera(Cd.mul([0>N[0]?N[0]:0<c[0]?c[0]:0,0>N[1]?N[1]:0<c[1]?c[1]:0],-so.panMultiplier*this.camera.zoom))});xb(this,"update",({point:c,zoom:n})=>{void 0===c||isNaN(c[0])||isNaN(c[1])||(this.camera.point=c);void 0===n||isNaN(n)||(this.camera.zoom=Math.min(4,Math.max(.1,n)));return this});xb(this,"getPagePoint",c=>{const {camera:n,bounds:N}=this;return Cd.sub(Cd.div(Cd.sub(c,[N.minX,N.minY]),n.zoom),n.point)});xb(this,"getScreenPoint",c=>{const {camera:n}=this;return Cd.mul(Cd.add(c,n.point),
n.zoom)});xb(this,"onZoom",(c,n,N=!1)=>this.pinchZoom(c,[0,0],n,N));xb(this,"pinchZoom",(c,n,N,da=!1)=>{var {camera:ua}=this;n=Cd.sub(ua.point,Cd.div(n,ua.zoom));N=Cd.clamp(N,so.minZoom,so.maxZoom);ua=Cd.div(c,ua.zoom);c=Cd.div(c,N);c=Cd.toFixed(Cd.add(n,Cd.sub(c,ua)));da?this.animateCamera({point:c,zoom:N}):this.update({point:c,zoom:N});return this});xb(this,"setZoom",(c,n=!1)=>{const {bounds:N}=this;this.onZoom([N.width/2,N.height/2],c,n)});xb(this,"zoomIn",()=>{const {camera:c}=this;this.setZoom(c.zoom/
.8,!0)});xb(this,"zoomOut",()=>{const {camera:c}=this;this.setZoom(.8*c.zoom,!0)});xb(this,"resetZoom",()=>{this.setZoom(1,!0);return this});xb(this,"animateCamera",({point:c,zoom:n})=>this.animateToViewport({minX:-c[0],minY:-c[1],maxX:this.bounds.width/n-c[0],maxY:this.bounds.height/n-c[1],width:this.bounds.width/n,height:this.bounds.height/n}));xb(this,"animateToViewport",c=>{const n=performance.now(),N=Af({},this.currentView),da=()=>{var ua=performance.now()-n;ua=Iz(ua);var Ga=N.minX+(c.minX-N.minX)*
ua;this.update({point:[-Ga,-(N.minY+(c.minY-N.minY)*ua)],zoom:this.bounds.width/(N.maxX+(c.maxX-N.maxX)*ua-Ga)});1>ua&&requestAnimationFrame(da)};da()});xb(this,"zoomToBounds",({width:c,height:n,minX:N,minY:da})=>{const {bounds:ua,camera:Ga}=this;let Ma=Math.min((ua.width-100)/c,(ua.height-100)/n);Ma=Math.min(1,Math.max(so.minZoom,Ga.zoom===Ma||1>Ga.zoom?Math.min(1,Ma):Ma));c=Cd.add([-N,-da],[(ua.width-c*Ma)/2/Ma,(ua.height-n*Ma)/2/Ma]);this.animateCamera({point:c,zoom:Ma})});Ec(this)}get currentView(){const {bounds:c,
camera:{point:n,zoom:N}}=this,da=c.width/N,ua=c.height/N;return{minX:-n[0],minY:-n[1],maxX:da-n[0],maxY:ua-n[1],width:da,height:ua}}},yl=so;xb(yl,"minZoom",.1);xb(yl,"maxZoom",4);xb(yl,"panMultiplier",.05);xb(yl,"panThreshold",100);re([Qg],yl.prototype,"bounds",2);re([Qg],yl.prototype,"camera",2);re([Cg],yl.prototype,"updateBounds",2);re([Cg],yl.prototype,"update",2);re([Zg],yl.prototype,"currentView",1);var Jz=class{constructor(c){xb(this,"app");xb(this,"editShape",n=>{(null==n?0:n.props.isLocked)||
this.app.transition("select").selectedTool.transition("editingShape",{shape:n});return this});xb(this,"hoverShape",n=>{this.app.setHoveredShape(n);return this});xb(this,"createShapes",(...n)=>{this.app.createShapes(n);return this});xb(this,"updateShapes",(...n)=>{this.app.updateShapes(n);return this});xb(this,"deleteShapes",(...n)=>{this.app.deleteShapes(n.length?n:this.app.selectedShapesArray);return this});xb(this,"selectShapes",(...n)=>{this.app.setSelectedShapes(n);return this});xb(this,"deselectShapes",
(...n)=>{const N="string"===typeof n[0]?n:n.map(da=>da.id);this.app.setSelectedShapes(this.app.selectedShapesArray.filter(da=>!N.includes(da.id)));return this});xb(this,"flipHorizontal",(...n)=>{this.app.flipHorizontal(n);return this});xb(this,"flipVertical",(...n)=>{this.app.flipVertical(n);return this});xb(this,"selectAll",()=>{this.app.setSelectedShapes(this.app.currentPage.shapes.filter(n=>!this.app.shapesInGroups().includes(n)));return this});xb(this,"deselectAll",()=>{this.app.setSelectedShapes([]);
return this});xb(this,"zoomIn",()=>{this.app.viewport.zoomIn();return this});xb(this,"zoomOut",()=>{this.app.viewport.zoomOut();return this});xb(this,"resetZoom",()=>{this.app.viewport.resetZoom();return this});xb(this,"zoomToFit",()=>{var {shapes:n}=this.app.currentPage;if(0===n.length)return this;n=Je.getCommonBounds(n.map(N=>N.bounds));this.app.viewport.zoomToBounds(n);return this});xb(this,"cameraToCenter",()=>{var {shapes:n}=this.app.currentPage;if(0===n.length)return this;n=Je.getCommonBounds(n.map(N=>
N.bounds));this.app.viewport.update({point:pe.add(pe.neg(Je.getBoundsCenter(n)),[this.app.viewport.currentView.width/2,this.app.viewport.currentView.height/2])});return this});xb(this,"zoomToSelection",()=>{const {selectionBounds:n}=this.app;if(!n)return this;this.app.viewport.zoomToBounds(n);return this});xb(this,"resetZoomToCursor",()=>{this.app.viewport.animateCamera({zoom:1,point:pe.sub(this.app.inputs.originScreenPoint,this.app.inputs.originPoint)});return this});xb(this,"toggleGrid",()=>{const {settings:n}=
this.app;n.update({showGrid:!n.showGrid});return this});xb(this,"toggleSnapToGrid",()=>{const {settings:n}=this.app;n.update({snapToGrid:!n.snapToGrid});return this});xb(this,"togglePenMode",()=>{const {settings:n}=this.app;n.update({penMode:!n.penMode});return this});xb(this,"setColor",n=>{const {settings:N}=this.app;N.update({color:n});this.app.selectedShapesArray.forEach(da=>{da.props.isLocked||da.update({fill:n,stroke:n})});this.app.persist();return this});xb(this,"setScaleLevel",n=>{const {settings:N}=
this.app;N.update({scaleLevel:n});this.app.selectedShapes.forEach(da=>{da.props.isLocked||da.setScaleLevel(n)});this.app.persist();return this});xb(this,"undo",()=>{this.app.undo();return this});xb(this,"redo",()=>{this.app.redo();return this});xb(this,"persist",()=>{this.app.persist();return this});xb(this,"createNewLineBinding",(n,N)=>this.app.createNewLineBinding(n,N));xb(this,"clone",n=>{if(!this.app.readOnly&&1===this.app.selectedShapesArray.length&&Object.values(nb).some(Uc=>Uc===this.app.selectedShapesArray[0].type)){var N=
this.app.allSelectedShapesArray[0],da=this.app.getShapeClass(N.type),{minX:ua,minY:Ga,maxX:Ma,maxY:fb,width:vb,height:Wb}=N.bounds,oc=[0,0];switch(n){case "down":oc=[ua,fb+100];break;case "up":oc=[ua,Ga-100-Wb];break;case "left":oc=[ua-100-vb,Ga];break;case "right":oc=[Ma+100,Ga]}var xc=new da(kg(Af({},N.serialized),{id:Me(),nonce:Date.now(),refs:[],label:"",point:oc}));this.app.history.pause();this.app.currentPage.addShapes(xc);this.app.createNewLineBinding(N,xc);this.app.history.resume();this.app.persist();
setTimeout(()=>this.editShape(xc))}});xb(this,"cloneShapes",({shapes:n,assets:N,bindings:da,point:ua=[0,0]})=>{const Ga=Je.getCommonBounds(n.filter(vb=>"group"!==vb.type).map(vb=>{var Wb,oc,xc,Uc,md,hd,Bd,Ld,bd,jd,rd,Md,Dd,Oe,Pe,cg;return{minX:null!=(oc=null==(Wb=vb.point)?void 0:Wb[0])?oc:ua[0],minY:null!=(Uc=null==(xc=vb.point)?void 0:xc[1])?Uc:ua[1],width:null!=(hd=null==(md=vb.size)?void 0:md[0])?hd:4,height:null!=(Ld=null==(Bd=vb.size)?void 0:Bd[1])?Ld:4,maxX:(null!=(jd=null==(bd=vb.point)?void 0:
bd[0])?jd:ua[0])+(null!=(Md=null==(rd=vb.size)?void 0:rd[0])?Md:4),maxY:(null!=(Oe=null==(Dd=vb.point)?void 0:Dd[1])?Oe:ua[1])+(null!=(cg=null==(Pe=vb.size)?void 0:Pe[1])?cg:4)}})),Ma=n.map(vb=>kg(Af({},vb),{id:Me(),point:[ua[0]+vb.point[0]-Ga.minX,ua[1]+vb.point[1]-Ga.minY]}));Ma.forEach(vb=>{var Wb;vb.children&&0<(null==(Wb=vb.children)?void 0:Wb.length)&&(vb.children=vb.children.map(oc=>{var xc;return null==(xc=Ma[n.findIndex(Uc=>Uc.id===oc)])?void 0:xc.id}).filter(Kc))});const fb=[];Ma.flatMap(vb=>
{var Wb;return Object.values(null!=(Wb=vb.handles)?Wb:{})}).forEach(vb=>{if(vb.bindingId){var Wb=da[vb.bindingId];if(Wb){var oc=n.findIndex(Uc=>Uc.id===Wb.fromId);const xc=n.findIndex(Uc=>Uc.id===Wb.toId);Wb&&-1!==oc&&-1!==xc?(oc=kg(Af({},Wb),{id:Me(),fromId:Ma[oc].id,toId:Ma[xc].id}),fb.push(oc),vb.bindingId=oc.id):vb.bindingId=void 0}else console.warn("binding not found",vb.bindingId)}});N=N.filter(vb=>Ma.some(Wb=>Wb.assetId===vb.id));return{shapes:Ma,assets:N,bindings:fb}});xb(this,"getClonedShapesFromTldrString",
(n,N)=>{try{{var da;const Wb=null==(da=n.match(/<whiteboard-tldr>(.*)<\/whiteboard-tldr>/))?void 0:da[1];if(Wb){try{var ua=JSON.parse(Wb)}catch(oc){ua=null}var Ga=ua}else Ga=void 0}n=Ga;if(!n)return null;const {shapes:Ma,bindings:fb,assets:vb}=n;return this.cloneShapes({shapes:Ma,bindings:fb,assets:vb,point:N})}catch(Ma){console.log(Ma)}return null});xb(this,"cloneShapesIntoCurrentPage",n=>{(n=this.cloneShapes(n))&&this.addClonedShapes(n);return this});xb(this,"addClonedShapes",n=>{const {shapes:N,
assets:da,bindings:ua}=n;0<da.length&&this.app.createAssets(da);0<N.length&&this.app.createShapes(N);this.app.currentPage.updateBindings(Object.fromEntries(ua.map(Ga=>[Ga.id,Ga])));this.app.selectedTool.transition("idle");return this});xb(this,"addClonedShapesFromTldrString",(n,N)=>{(n=this.getClonedShapesFromTldrString(n,N))&&this.addClonedShapes(n);return this});xb(this,"doGroup",(n=this.app.allSelectedShapesArray)=>{if(!this.app.readOnly){this.app.history.pause();var N=[...n.filter(da=>"group"===
da.type),...n.map(da=>this.app.getParentGroup(da))].filter(Kc);this.app.currentPage.removeShapes(...N);n=n.filter(da=>"group"!==da.type);1<n.length&&(N=this.app.getShapeClass("group"),N=new N({id:Me(),type:N.id,parentId:this.app.currentPage.id,children:n.map(da=>da.id)}),this.app.currentPage.addShapes(N),this.app.setSelectedShapes([N]),n.push(N),this.app.bringForward(n));this.app.history.resume();this.app.persist(this.app.currentPage.persistInfo)}});xb(this,"unGroup",(n=this.app.allSelectedShapesArray)=>
{if(!this.app.readOnly){n=[...n.filter(da=>"group"===da.type),...n.map(da=>this.app.getParentGroup(da))].filter(Kc);var N=this.app.shapesInGroups(n);0<n.length&&(this.app.currentPage.removeShapes(...n),this.app.persist(),this.app.setSelectedShapes(N))}});xb(this,"convertShapes",(n,N=this.app.allSelectedShapesArray)=>{const da=this.app.getShapeClass(n);this.app.currentPage.removeShapes(...N);N=N.map(ua=>new da(kg(Af({},ua.serialized),{type:n,nonce:Date.now()})));this.app.currentPage.addShapes(...N);
this.app.persist();this.app.setSelectedShapes(N)});xb(this,"setCollapsed",(n,N=this.app.allSelectedShapesArray)=>{N.forEach(da=>{"logseq-portal"===da.props.type&&da.setCollapsed(n)});this.app.persist()});this.app=c}},qp=class{constructor(){xb(this,"cursor","default");xb(this,"rotation",0);xb(this,"reset",()=>{this.cursor="default"});xb(this,"setCursor",(c,n=0)=>{if(c!==this.cursor||n!==this.rotation)this.cursor=c,this.rotation=n});xb(this,"setRotation",c=>{c!==this.rotation&&(this.rotation=c)});Ec(this)}};
re([Qg],qp.prototype,"cursor",2);re([Qg],qp.prototype,"rotation",2);re([Cg],qp.prototype,"reset",2);re([Cg],qp.prototype,"setCursor",2);re([Cg],qp.prototype,"setRotation",2);var rp=class{constructor(c){xb(this,"app");xb(this,"stack",[]);xb(this,"isPaused",!0);xb(this,"pause",()=>{this.isPaused||(this.isPaused=!0)});xb(this,"resume",()=>{this.isPaused&&(this.isPaused=!1)});xb(this,"persist",n=>{this.isPaused||this.creating||this.app.notify("persist",n)});xb(this,"undo",()=>{this.isPaused||"idle"===
this.app.selectedTool.currentState.id&&this.app.appUndo&&this.app.appUndo()});xb(this,"redo",()=>{this.isPaused||"idle"===this.app.selectedTool.currentState.id&&this.app.appRedo&&this.app.appRedo()});xb(this,"instantiateShape",n=>new (this.app.getShapeClass(n.type))(n));xb(this,"deserialize",n=>{pc(()=>{var N,{pages:da}=n;const ua=this.isPaused;this.pause();const Ga=[...this.app.selectedIds];try{const Ma=new Map(this.app.pages),fb=[];for(const vb of da){const Wb=Ma.get(vb.id);if(void 0!==Wb){const oc=
new Map(Wb.shapes.map(xc=>[xc.props.id,xc]));da=[];for(const xc of vb.shapes){const Uc=oc.get(xc.id);void 0!==Uc?(Uc.nonce!==xc.nonce&&(Uc.update(xc,!0),Uc.nonce=xc.nonce,Uc.setLastSerialized(xc)),oc.delete(xc.id)):da.push(this.instantiateShape(xc))}0<oc.size&&!this.app.selectedTool.isInAny("creating","editingShape")&&Wb.removeShapes(...oc.values());0<da.length&&Wb.addShapes(...da);Ma.delete(vb.id);Wb.updateBindings(vb.bindings);Wb.nonce=null!=(N=vb.nonce)?N:0}else{const {id:oc,name:xc,shapes:Uc,
bindings:md,nonce:hd}=vb;fb.push(new Zj(this.app,{id:oc,name:xc,nonce:hd,bindings:md,shapes:Uc.map(Bd=>this.instantiateShape(Bd))}))}}0<fb.length&&this.app.addPages(fb);0<Ma.size&&this.app.removePages(Array.from(Ma.values()));this.app.setSelectedShapes(Ga).setErasingShapes([])}catch(Ma){console.warn(Ma)}ua||this.resume()})});this.app=c;Ec(this)}get creating(){return"creating"===this.app.selectedTool.currentState.id}};re([Qg],rp.prototype,"stack",2);re([Cg],rp.prototype,"persist",2);re([Cg],rp.prototype,
"undo",2);re([Cg],rp.prototype,"redo",2);re([Cg],rp.prototype,"deserialize",2);var nn=class{constructor(){xb(this,"mode","light");xb(this,"showGrid",!0);xb(this,"snapToGrid",!1);xb(this,"penMode",!1);xb(this,"scaleLevel","md");xb(this,"color","");Ec(this)}update(c){Object.assign(this,c)}};re([Qg],nn.prototype,"mode",2);re([Qg],nn.prototype,"showGrid",2);re([Qg],nn.prototype,"snapToGrid",2);re([Qg],nn.prototype,"penMode",2);re([Qg],nn.prototype,"scaleLevel",2);re([Qg],nn.prototype,"color",2);re([Cg],
nn.prototype,"update",1);var mh=class extends np{constructor(c,n,N,da){var ua,Ga;super();xb(this,"uuid",Me());xb(this,"readOnly");xb(this,"api");xb(this,"inputs",new jj);xb(this,"cursors",new qp);xb(this,"viewport",new yl);xb(this,"settings",new nn);xb(this,"Tools",[]);xb(this,"history",new rp(this));xb(this,"persist",this.history.persist);xb(this,"undo",this.history.undo);xb(this,"redo",this.history.redo);xb(this,"saving",!1);xb(this,"saveState",()=>{this.history.isPaused||(this.saving=!0,requestAnimationFrame(()=>
{this.saving&&(this.persist(),this.saving=!1)}))});xb(this,"load",()=>{this.notify("load",null);return this});xb(this,"save",()=>{this.notify("save",null);return this});xb(this,"pages",new Map([["page",new Zj(this,{id:"page",name:"page",shapes:[],bindings:{}})]]));xb(this,"getPageById",Ma=>{const fb=this.pages.get(Ma);if(!fb)throw Error(`Could not find a page named ${Ma}.`);return fb});xb(this,"getShapeById",(Ma,fb=this.currentPage.id)=>{var vb;return null==(vb=this.getPageById(fb))?void 0:vb.shapesById[Ma]});
xb(this,"createShapes",Ma=>{if(this.readOnly)return this;(Ma=this.currentPage.addShapes(...Ma))&&this.notify("create-shapes",Ma);this.persist();return this});xb(this,"updateShapes",Ma=>{if(this.readOnly)return this;Ma.forEach(fb=>{const vb=this.getShapeById(fb.id);null==vb?void 0:vb.update(fb);fb.type!==(null==vb?void 0:vb.type)&&this.api.convertShapes(fb.type,[vb])});this.persist();return this});xb(this,"deleteShapes",Ma=>{if(0===Ma.length||this.readOnly)return this;Ma=Ma.map(oc=>"string"===typeof oc?
this.getShapeById(oc):oc).filter(Kc).filter(oc=>!oc.props.isLocked);const fb=this.shapesInGroups(Ma);Ma.forEach(oc=>{this.getParentGroup(oc)&&fb.push(oc)});let vb=new Set([...Ma,...fb].map(oc=>oc.id));fb.forEach(oc=>{var xc;const Uc=this.getParentGroup(oc);if(Uc){const md=null==(xc=Uc.props.children)?void 0:xc.filter(hd=>hd!==oc.id);!md||1>=(null==md?void 0:md.length)?vb.add(Uc.id):Uc.update({children:md})}});const Wb=(oc,xc)=>{var Uc;[...vb].includes(oc)&&"line"===(null==(Uc=this.getShapeById(xc))?
void 0:Uc.type)&&vb.add(xc)};this.currentPage.shapes.filter(oc=>!oc.props.isLocked).flatMap(oc=>{var xc;return Object.values(null!=(xc=oc.props.handles)?xc:{})}).flatMap(oc=>oc.bindingId).filter(Kc).map(oc=>{var xc,Uc;const md=null==(xc=this.currentPage.bindings[oc])?void 0:xc.toId;oc=null==(Uc=this.currentPage.bindings[oc])?void 0:Uc.fromId;md&&oc&&(Wb(md,oc),Wb(oc,md))});Ma=[...vb].map(oc=>this.getShapeById(oc));this.setSelectedShapes(this.selectedShapesArray.filter(oc=>!vb.has(oc.id)));(Ma=this.currentPage.removeShapes(...Ma))&&
this.notify("delete-shapes",Ma);this.persist();return this});xb(this,"bringForward",(Ma=this.selectedShapesArray)=>{0<Ma.length&&!this.readOnly&&this.currentPage.bringForward(Ma);return this});xb(this,"sendBackward",(Ma=this.selectedShapesArray)=>{0<Ma.length&&!this.readOnly&&this.currentPage.sendBackward(Ma);return this});xb(this,"sendToBack",(Ma=this.selectedShapesArray)=>{0<Ma.length&&!this.readOnly&&this.currentPage.sendToBack(Ma);return this});xb(this,"bringToFront",(Ma=this.selectedShapesArray)=>
{0<Ma.length&&!this.readOnly&&this.currentPage.bringToFront(Ma);return this});xb(this,"flipHorizontal",(Ma=this.selectedShapesArray)=>{this.currentPage.flip(Ma,"horizontal");return this});xb(this,"flipVertical",(Ma=this.selectedShapesArray)=>{this.currentPage.flip(Ma,"vertical");return this});xb(this,"align",(Ma,fb=this.selectedShapesArray)=>{if(2>fb.length||this.readOnly)return this;const vb=fb.map(md=>{const hd=md.getBounds();return{id:md.id,point:[hd.minX,hd.minY],bounds:hd}}),Wb=Je.getCommonBounds(vb.map(({bounds:md})=>
md)),oc=Wb.minX+Wb.width/2,xc=Wb.minY+Wb.height/2,Uc=Object.fromEntries(vb.map(({id:md,point:hd,bounds:Bd})=>[md,{prev:hd,next:{top:[hd[0],Wb.minY],centerVertical:[hd[0],xc-Bd.height/2],bottom:[hd[0],Wb.maxY-Bd.height],left:[Wb.minX,hd[1]],centerHorizontal:[oc-Bd.width/2,hd[1]],right:[Wb.maxX-Bd.width,hd[1]]}[Ma]}]));fb.forEach(md=>{Uc[md.id]&&md.update({point:Uc[md.id].next})});this.persist();return this});xb(this,"distribute",(Ma,fb=this.selectedShapesArray)=>{if(2>fb.length||this.readOnly)return this;
const vb=Object.fromEntries(Je.getDistributions(fb,Ma).map(Wb=>[Wb.id,Wb]));fb.forEach(Wb=>{vb[Wb.id]&&Wb.update({point:vb[Wb.id].next})});this.persist();return this});xb(this,"packIntoRectangle",(Ma=this.selectedShapesArray)=>{if(2>Ma.length||this.readOnly)return this;const fb=Object.fromEntries(Je.getPackedDistributions(Ma).map(vb=>[vb.id,vb]));Ma.forEach(vb=>{fb[vb.id]&&vb.update({point:fb[vb.id].next})});this.persist();return this});xb(this,"setLocked",Ma=>{if(0===this.selectedShapesArray.length||
this.readOnly)return this;this.selectedShapesArray.forEach(fb=>{fb.update({isLocked:Ma})});this.persist();return this});xb(this,"assets",{});xb(this,"removeUnusedAssets",()=>{const Ma=this.getCleanUpAssets();Object.keys(this.assets).forEach(fb=>{Ma.some(vb=>vb.id===fb)||delete this.assets[fb]});this.persist();return this});xb(this,"copy",()=>{if(0<this.selectedShapesArray.length&&!this.editingShape){const fb=this.allSelectedShapesArray;var Ma=JSON.stringify({shapes:fb.map(Wb=>Wb.serialized),assets:this.getCleanUpAssets().filter(Wb=>
fb.some(oc=>oc.props.assetId===Wb.id)),bindings:Bb(this.currentPage.bindings)});Ma=encodeURIComponent(`<whiteboard-tldr>${Ma}</whiteboard-tldr>`);const vb=this.selectedShapesArray.map(Wb=>`((${Wb.props.id}))`).join(" ");this.notify("copy",{text:vb,html:Ma})}});xb(this,"paste",(Ma,fb)=>{var vb;this.editingShape||this.readOnly||this.notify("paste",{point:this.inputs.currentPoint,shiftKey:!!fb,dataTransfer:null!=(vb=null==Ma?void 0:Ma.clipboardData)?vb:void 0})});xb(this,"cut",()=>{this.copy();this.api.deleteShapes()});
xb(this,"drop",(Ma,fb)=>{this.notify("drop",{dataTransfer:Ma,point:fb?this.viewport.getPagePoint(fb):Je.getBoundsCenter(this.viewport.currentView)})});xb(this,"selectTool",(Ma,fb={})=>{this.readOnly&&!["select","move"].includes(Ma)||this.transition(Ma,fb)});xb(this,"editingId");xb(this,"setEditingShape",Ma=>{this.editingId="string"===typeof Ma?Ma:null==Ma?void 0:Ma.id;return this});xb(this,"clearEditingState",()=>{this.selectedTool.transition("idle");return this.setEditingShape()});xb(this,"hoveredId");
xb(this,"setHoveredShape",Ma=>{this.hoveredId="string"===typeof Ma?Ma:null==Ma?void 0:Ma.id;return this});xb(this,"selectedIds",new Set);xb(this,"selectedShapes",new Set);xb(this,"selectionRotation",0);xb(this,"setSelectedShapes",Ma=>{var fb;const {selectedIds:vb,selectedShapes:Wb}=this;vb.clear();Wb.clear();Ma[0]&&"string"===typeof Ma[0]?Ma.forEach(xc=>vb.add(xc)):Ma.forEach(xc=>vb.add(xc.id));const oc=this.currentPage.shapes.filter(xc=>vb.has(xc.id));oc.forEach(xc=>Wb.add(xc));this.selectionRotation=
1===oc.length?null!=(fb=oc[0].props.rotation)?fb:0:0;0===Ma.length&&this.setEditingShape();return this});xb(this,"erasingIds",new Set);xb(this,"erasingShapes",new Set);xb(this,"setErasingShapes",Ma=>{const {erasingIds:fb,erasingShapes:vb}=this;fb.clear();vb.clear();Ma[0]&&"string"===typeof Ma[0]?Ma.forEach(Wb=>fb.add(Wb)):Ma.forEach(Wb=>fb.add(Wb.id));this.currentPage.shapes.filter(Wb=>fb.has(Wb.id)).forEach(Wb=>vb.add(Wb));return this});xb(this,"bindingIds");xb(this,"setBindingShapes",Ma=>{this.bindingIds=
Ma;return this});xb(this,"clearBindingShape",()=>this.setBindingShapes());xb(this,"createNewLineBinding",(Ma,fb)=>{Ma="string"===typeof Ma?this.getShapeById(Ma):Ma;fb="string"===typeof fb?this.getShapeById(fb):fb;if((null==Ma?0:Ma.canBind)&&(null==fb?0:fb.canBind)&&(fb=td(Ma,fb))){const [vb,Wb]=fb;this.createShapes([vb]);this.currentPage.updateBindings(Object.fromEntries(Wb.map(oc=>[oc.id,oc])));this.persist();return!0}return!1});xb(this,"brush");xb(this,"setBrush",Ma=>{this.brush=Ma;return this});
xb(this,"setCamera",(Ma,fb)=>{this.viewport.update({point:Ma,zoom:fb});return this});xb(this,"getPagePoint",Ma=>{const {camera:fb}=this.viewport;return Cd.sub(Cd.div(Ma,fb.zoom),fb.point)});xb(this,"getScreenPoint",Ma=>{const {camera:fb}=this.viewport;return Cd.mul(Cd.add(Ma,fb.point),fb.zoom)});xb(this,"Shapes",new Map);xb(this,"registerShapes",Ma=>{Ma.forEach(fb=>{if("group"===fb.id){const vb=this;fb.prototype.getShapes=function(){var Wb,oc;return null!=(oc=null==(Wb=this.props.children)?void 0:
Wb.map(xc=>vb.getShapeById(xc)).filter(Boolean))?oc:[]}}return this.Shapes.set(fb.id,fb)})});xb(this,"deregisterShapes",Ma=>{Ma.forEach(fb=>this.Shapes.delete(fb.id))});xb(this,"getShapeClass",Ma=>{if(!Ma)throw Error("No shape type provided.");const fb=this.Shapes.get(Ma);if(!fb)throw Error(`Could not find shape class for ${Ma}`);return fb});xb(this,"wrapUpdate",Ma=>{pc(()=>{const fb=!this.history.isPaused;fb&&this.history.pause();Ma();fb&&(this.history.resume(),this.persist())})});xb(this,"subscriptions",
new Set([]));xb(this,"subscribe",(Ma,fb)=>{if(void 0===fb)throw Error("Callback is required.");const vb={event:Ma,callback:fb};this.subscriptions.add(vb);return()=>this.unsubscribe(vb)});xb(this,"unsubscribe",Ma=>{this.subscriptions.delete(Ma);return this});xb(this,"notify",(Ma,fb)=>{this.subscriptions.forEach(vb=>{vb.event===Ma&&vb.callback(this,fb)});return this});xb(this,"onTransition",()=>{});xb(this,"onPointerDown",(Ma,fb)=>{if(!this.editingShape&&1===fb.button&&!this.isIn("move"))this.temporaryTransitionToMove(fb);
else if(2===fb.button&&!this.editingShape)fb.preventDefault(),this.transition("select");else if("clientX"in fb)this.inputs.onPointerDown([...this.viewport.getPagePoint([fb.clientX,fb.clientY]),fb.pressure],fb)});xb(this,"onPointerUp",(Ma,fb)=>{if(!this.editingShape&&1===fb.button&&this.isIn("move"))this.selectedTool.transition("idle",{exit:!0}),fb.stopPropagation(),fb.preventDefault();else if("clientX"in fb)this.inputs.onPointerUp([...this.viewport.getPagePoint([fb.clientX,fb.clientY]),fb.pressure],
fb)});xb(this,"onPointerMove",(Ma,fb)=>{if("clientX"in fb)this.inputs.onPointerMove([...this.viewport.getPagePoint([fb.clientX,fb.clientY]),fb.pressure],fb)});xb(this,"onKeyDown",(Ma,fb)=>{if(this.editingShape||" "!==fb.key||this.isIn("move"))this.inputs.onKeyDown(fb);else this.temporaryTransitionToMove(fb)});xb(this,"onKeyUp",(Ma,fb)=>{if(!this.editingShape&&" "===fb.key&&this.isIn("move"))this.selectedTool.transition("idle",{exit:!0}),fb.stopPropagation(),fb.preventDefault();else this.inputs.onKeyUp(fb)});
xb(this,"onPinchStart",(Ma,fb)=>{this.inputs.onPinchStart([...this.viewport.getPagePoint(Ma.point),.5],fb)});xb(this,"onPinch",(Ma,fb)=>{this.inputs.onPinch([...this.viewport.getPagePoint(Ma.point),.5],fb)});xb(this,"onPinchEnd",(Ma,fb)=>{this.inputs.onPinchEnd([...this.viewport.getPagePoint(Ma.point),.5],fb)});this._states=[op,pp];this.readOnly=da;this.history.pause();this.states&&0<this.states.length&&(this.registerStates(this.states),da=null!=(ua=this.initial)?ua:this.states[0].id,ua=this.children.get(da))&&
(this.currentState=ua,null==(Ga=this.currentState)?void 0:Ga._events.onEnter({fromId:"initial"}));n&&this.registerShapes(n);N&&this.registerTools(N);this.history.resume();c&&this.history.deserialize(c);this.api=new Jz(this);Ec(this);this.notify("mount",null)}loadDocumentModel(c){this.history.deserialize(c);c.assets&&0<c.assets.length&&this.addAssets(c.assets);return this}get serialized(){return{}}get currentPageId(){return this.pages.keys().next().value}get currentPage(){return this.getPageById(this.currentPageId)}addPages(c){c.forEach(n=>
this.pages.set(n.id,n));this.persist();return this}removePages(c){c.forEach(n=>this.pages.delete(n.id));this.persist();return this}shapesInGroups(c=this.shapes){return c.flatMap(n=>n.props.children).filter(Kc).map(n=>this.getShapeById(n)).filter(Kc)}getParentGroup(c){return this.shapes.find(n=>{var N;return null==(N=n.props.children)?void 0:N.includes(c.id)})}addAssets(c){c.forEach(n=>this.assets[n.id]=n);return this}removeAssets(c){"string"===typeof c[0]?c.forEach(n=>delete this.assets[n]):c.forEach(n=>
delete this.assets[n.id]);this.persist();return this}getCleanUpAssets(){const c=new Set;this.pages.forEach(n=>n.shapes.forEach(N=>{N.props.assetId&&this.assets[N.props.assetId]&&c.add(this.assets[N.props.assetId])}));return Array.from(c)}createAssets(c){this.addAssets(c);this.notify("create-assets",{assets:c});this.persist();return this}get selectedTool(){return this.currentState}registerTools(c){this.Tools=c;return this.registerStates(c)}get editingShape(){const {editingId:c,currentPage:n}=this;
return c?n.shapes.find(N=>N.id===c):void 0}get hoveredShape(){const {hoveredId:c,currentPage:n}=this;return c?n.shapes.find(N=>N.id===c):void 0}get hoveredGroup(){const {hoveredShape:c}=this;return c?this.shapes.find(n=>{var N;return"group"===n.type&&(null==(N=n.props.children)?void 0:N.includes(c.id))}):void 0}get selectedShapesArray(){const {selectedShapes:c,selectedTool:n}=this;return"select"!==n.id?[]:Array.from(c.values())}get allSelectedShapes(){return new Set(this.allSelectedShapesArray)}get allSelectedShapesArray(){const {selectedShapesArray:c}=
this;return[...(new Set([...c,...this.shapesInGroups(c)]))]}setSelectionRotation(c){this.selectionRotation=c}get erasingShapesArray(){return Array.from(this.erasingShapes.values())}get bindingShapes(){var c;const n=1===this.selectedShapesArray.length?this.selectedShapesArray.flatMap(da=>{var ua;return Object.values(null!=(ua=da.props.handles)?ua:{})}).flatMap(da=>da.bindingId).filter(Kc).flatMap(da=>{var ua,Ga;return[null==(ua=this.currentPage.bindings[da])?void 0:ua.fromId,null==(Ga=this.currentPage.bindings[da])?
void 0:Ga.toId]}).filter(Kc):[],N=[...(null!=(c=this.bindingIds)?c:[]),...n];return N?this.currentPage.shapes.filter(da=>null==N?void 0:N.includes(da.id)):void 0}get currentGrid(){const {zoom:c}=this.viewport.camera;return.15>c?128:1>c?32:8}get shapes(){const {currentPage:{shapes:c}}=this;return Array.from(c.values())}get shapesInViewport(){const {selectedShapes:c,currentPage:n,viewport:{currentView:N}}=this;return n.shapes.filter(da=>!da.canUnmount||c.has(da)||Je.boundsContain(N,da.rotatedBounds)||
Je.boundsCollide(N,da.rotatedBounds))}get selectionDirectionHint(){const {selectionBounds:c,viewport:{currentView:n}}=this;if(c&&!Je.boundsContain(n,c)&&!Je.boundsCollide(n,c)){var N=Je.getBoundsCenter(c);return Cd.clampV([(N[0]-n.minX-n.width/2)/n.width,(N[1]-n.minY-n.height/2)/n.height],-1,1)}}get selectionBounds(){const {selectedShapesArray:c}=this;if(0!==c.length)return 1===c.length?kg(Af({},c[0].bounds),{rotation:c[0].props.rotation}):Je.getCommonBounds(this.selectedShapesArray.map(n=>n.rotatedBounds))}get showSelection(){var c;
const {selectedShapesArray:n}=this;return this.isIn("select")&&!this.isInAny("select.translating","select.pinching","select.rotating")&&(1===n.length&&!(null==(c=n[0])?0:c.hideSelection)||1<n.length)}get showSelectionDetail(){return this.isIn("select")&&!this.isInAny("select.translating","select.pinching")&&0<this.selectedShapes.size&&!this.selectedShapesArray.every(c=>c.hideSelectionDetail)&&!1}get showSelectionRotation(){return this.showSelectionDetail&&this.isInAny("select.rotating","select.pointingRotateHandle")}get showContextBar(){const {selectedShapesArray:c}=
this;return this.isInAny("select.idle","select.hoveringSelectionHandle")&&!this.isIn("select.contextMenu")&&0<c.length&&!this.readOnly&&!c.every(n=>n.hideContextBar)}get showRotateHandles(){const {selectedShapesArray:c}=this;return this.isInAny("select.idle","select.hoveringSelectionHandle","select.pointingRotateHandle","select.pointingResizeHandle")&&0<c.length&&!this.readOnly&&!c.some(n=>n.hideRotateHandle)}get showResizeHandles(){const {selectedShapesArray:c}=this;return this.isInAny("select.idle",
"select.hoveringSelectionHandle","select.pointingShape","select.pointingSelectedShape","select.pointingRotateHandle","select.pointingResizeHandle")&&1===c.length&&!this.readOnly&&!c.every(n=>n.hideResizeHandles)}get showCloneHandles(){const {selectedShapesArray:c}=this;return this.isInAny("select.idle","select.hoveringSelectionHandle","select.pointingShape","select.pointingSelectedShape")&&1===c.length&&Object.values(nb).some(n=>n===this.selectedShapesArray[0].type)&&!this.readOnly}temporaryTransitionToMove(c){c.stopPropagation();
c.preventDefault();this.transition("move",{prevTool:this.selectedTool});this.selectedTool.transition("idleHold")}};xb(mh,"id","app");xb(mh,"initial","select");re([Zg],mh.prototype,"serialized",1);re([Qg],mh.prototype,"pages",2);re([Zg],mh.prototype,"currentPageId",1);re([Zg],mh.prototype,"currentPage",1);re([Cg],mh.prototype,"addPages",1);re([Cg],mh.prototype,"removePages",1);re([Cg],mh.prototype,"createShapes",2);re([Cg],mh.prototype,"updateShapes",2);re([Cg],mh.prototype,"deleteShapes",2);re([Qg],
mh.prototype,"assets",2);re([Cg],mh.prototype,"addAssets",1);re([Cg],mh.prototype,"removeAssets",1);re([Cg],mh.prototype,"removeUnusedAssets",2);re([Zg],mh.prototype,"selectedTool",1);re([Qg],mh.prototype,"editingId",2);re([Zg],mh.prototype,"editingShape",1);re([Cg],mh.prototype,"setEditingShape",2);re([Qg],mh.prototype,"hoveredId",2);re([Zg],mh.prototype,"hoveredShape",1);re([Zg],mh.prototype,"hoveredGroup",1);re([Cg],mh.prototype,"setHoveredShape",2);re([Qg],mh.prototype,"selectedIds",2);re([Qg],
mh.prototype,"selectedShapes",2);re([Qg],mh.prototype,"selectionRotation",2);re([Zg],mh.prototype,"selectedShapesArray",1);re([Zg],mh.prototype,"allSelectedShapes",1);re([Zg],mh.prototype,"allSelectedShapesArray",1);re([Cg],mh.prototype,"setSelectedShapes",2);re([Cg],mh.prototype,"setSelectionRotation",1);re([Qg],mh.prototype,"erasingIds",2);re([Qg],mh.prototype,"erasingShapes",2);re([Zg],mh.prototype,"erasingShapesArray",1);re([Cg],mh.prototype,"setErasingShapes",2);re([Qg],mh.prototype,"bindingIds",
2);re([Zg],mh.prototype,"bindingShapes",1);re([Cg],mh.prototype,"setBindingShapes",2);re([Cg],mh.prototype,"createNewLineBinding",2);re([Qg],mh.prototype,"brush",2);re([Cg],mh.prototype,"setBrush",2);re([Cg],mh.prototype,"setCamera",2);re([Zg],mh.prototype,"currentGrid",1);re([Zg],mh.prototype,"shapes",1);re([Zg],mh.prototype,"shapesInViewport",1);re([Zg],mh.prototype,"selectionDirectionHint",1);re([Zg],mh.prototype,"selectionBounds",1);re([Zg],mh.prototype,"showSelection",1);re([Zg],mh.prototype,
"showSelectionDetail",1);re([Zg],mh.prototype,"showSelectionRotation",1);re([Zg],mh.prototype,"showContextBar",1);re([Zg],mh.prototype,"showRotateHandles",1);re([Zg],mh.prototype,"showResizeHandles",1);re([Zg],mh.prototype,"showCloneHandles",1);var Kz=Function.prototype.toString,jt=Object.create,Lz=Object.prototype.toString,Mz=function(){function c(){this._keys=[];this._values=[]}c.prototype.has=function(n){return!!~this._keys.indexOf(n)};c.prototype.get=function(n){return this._values[this._keys.indexOf(n)]};
c.prototype.set=function(n,N){this._keys.push(n);this._values.push(N)};return c}(),Nz="undefined"!==typeof WeakMap?Ae:ke,Oz="g"===/test/g.flags?lf:Cf,Pz="undefined"!==typeof Symbol?gf:Uf,Qz=Object.defineProperty,Rz=Object.getOwnPropertyDescriptor,qw=Object.getOwnPropertyNames,kt=Object.getOwnPropertySymbols,rw=Object.prototype,sw=rw.hasOwnProperty,Sz=rw.propertyIsEnumerable,tw="function"===typeof kt,Tz=tw?sg:qw,Uz=Array.isArray,lt=Object.assign,Vz=Object.getPrototypeOf,uw={array:function(c,n){var N=
new n.Constructor;n.cache.set(c,N);for(var da=0,ua=c.length;da<ua;++da)N[da]=n.copier(c[da],n);return N},arrayBuffer:function(c,n){return c.slice(0)},blob:function(c,n){return c.slice(0,c.size,c.type)},dataView:function(c,n){return new n.Constructor(c.buffer.slice(0))},date:function(c,n){return new n.Constructor(c.getTime())},error:oh,map:Fg,object:tw?tg:Rf,regExp:function(c,n){n=new n.Constructor(c.source,Oz(c));n.lastIndex=c.lastIndex;return n},set:$h},Wz=lt({},uw,{array:function(c,n){var N=new n.Constructor;
n.cache.set(c,N);return Ag(c,N,n)},map:function(c,n){return Ag(c,Fg(c,n),n)},object:function(c,n){var N=He(n.prototype);n.cache.set(c,N);return Ag(c,N,n)},set:function(c,n){return Ag(c,$h(c,n),n)}});qi(lt({},Wz,{}));var Xz=qi({}),Yz=Lf(ca()),Zz=Lf(Ba()),to=Xz,Zk=class{static insertTextFirefox(c,n){c.setRangeText(n,c.selectionStart||0,c.selectionEnd||0,"end");c.dispatchEvent(new InputEvent("input",{data:n,inputType:"insertText",isComposing:!1}))}static insert(c,n){const N=c.ownerDocument,da=N.activeElement;
da!==c&&c.focus();N.execCommand("insertText",!1,n)||Zk.insertTextFirefox(c,n);da===N.body?c.blur():da instanceof HTMLElement&&da!==c&&da.focus()}static set(c,n){c.select();Zk.insert(c,n)}static getSelection(c){const {selectionStart:n,selectionEnd:N}=c;return c.value.slice(n?n:void 0,N?N:void 0)}static wrapSelection(c,n,N){const {selectionStart:da,selectionEnd:ua}=c,Ga=Zk.getSelection(c);Zk.insert(c,n+Ga+(null!=N?N:n));c.selectionStart=(da||0)+n.length;c.selectionEnd=(ua||0)+n.length}static replace(c,
n,N){let da=0;c.value.replace(n,(...ua)=>{const Ga=da+ua[ua.length-2],Ma=ua[0].length;c.selectionStart=Ga;c.selectionEnd=Ga+Ma;ua="string"===typeof N?N:N(...ua);Zk.insert(c,ua);c.selectionStart=Ga;da+=ua.length-Ma;return ua})}static findLineEnd(c,n){const N=c.lastIndexOf("\n",n-1)+1;return"\t"!==c.charAt(N)?n:N+1}static indent(c){var n;const {selectionStart:N,selectionEnd:da,value:ua}=c;var Ga=ua.slice(N,da);if((Ga=null==(n=/\n/g.exec(Ga))?void 0:n.length)&&0<Ga){n=ua.lastIndexOf("\n",N-1)+1;var Ma=
c.value.slice(n,da-1);Ga=Ma.replace(/^|\n/g,`$&${Zk.INDENT}`);Ma=Ga.length-Ma.length;c.setSelectionRange(n,da-1);Zk.insert(c,Ga);c.setSelectionRange(N+1,da+Ma)}else Zk.insert(c,Zk.INDENT)}static unindent(c){const {selectionStart:n,selectionEnd:N,value:da}=c;var ua=da.lastIndexOf("\n",n-1)+1;const Ga=Zk.findLineEnd(da,N);var Ma=c.value.slice(ua,Ga);const fb=Ma.replace(/(^|\n)(\t| {1,2})/g,"$1");Ma=Ma.length-fb.length;c.setSelectionRange(ua,Ga);Zk.insert(c,fb);ua=(ua=/\t| {1,2}/.exec(da.slice(ua,n)))?
ua[0].length:0;c.setSelectionRange(n-ua,Math.max(n-ua,N-Ma))}static normalizeText(c){return c.replace(Zk.fixNewLines,"\n")}},sp=Zk;xb(sp,"fixNewLines",/\r?\n|\r/g);xb(sp,"INDENT","  ");var on;"undefined"!==typeof window&&(on=hf());var mt=new Map,vw=Ub()?"":"ctrl",$z=class extends mh{},ww=Lf(Z(69)),aA=()=>{};/^((?!chrome|android).)*safari/i.test(navigator.userAgent);var xw=Lf(Z(69)),nt={},Hq=Lf(Z(69)),bA=c=>{for(c=c.parentElement;c&&c!==document.body;){const {overflowY:n}=window.getComputedStyle(c);
if(c.scrollHeight>c.clientHeight&&("auto"===n||"scroll"===n||"overlay"===n))return c;c=c.parentElement}return document},ot=Lf(Z(69)),pt=new Map,cA={accent:"var(--lx-accent-09, hsl(var(--primary)))",brushFill:"var(--ls-scrollbar-background-color, rgba(0, 0, 0, .05))",brushStroke:"var(--ls-scrollbar-thumb-hover-color, rgba(0, 0, 0, .05))",selectStroke:"var(--color-selectedStroke)",selectFill:"var(--color-selectedFill)",binding:"var(--color-binding, rgba(65, 132, 244, 0.5))",background:"var(--ls-primary-background-color, hsl(var(--background)))",
foreground:"var(--ls-primary-text-color, hsl(var(--foreground)))",grid:"var(--ls-quaternary-background-color, hsl(var(--secondary)))"},dA=((c,...n)=>c.reduce((N,da,ua)=>N+da+(ua<n.length?n[ua]:""),""))`
  .tl-container {
    --tl-zoom: 1;
    --tl-scale: calc(1 / var(--tl-zoom));
    --tl-padding: calc(64px / var(--tl-zoom));;
    --tl-shadow-color: 0deg 0% 0%;
    --tl-binding-distance: ${4}px;
    --tl-shadow-elevation-low: 0px 0.4px 0.5px hsl(var(--tl-shadow-color) / 0.04),
      0px 0.6px 0.8px -0.7px hsl(var(--tl-shadow-color) / 0.06),
      0.1px 1.2px 1.5px -1.4px hsl(var(--tl-shadow-color) / 0.08);
    --tl-shadow-elevation-medium: 0px 0.4px 0.5px hsl(var(--tl-shadow-color) / 0.04),
      0.1px 1.3px 1.7px -0.5px hsl(var(--tl-shadow-color) / 0.06),
      0.1px 2.8px 3.6px -1px hsl(var(--tl-shadow-color) / 0.07),
      0.3px 6.1px 7.8px -1.4px hsl(var(--tl-shadow-color) / 0.09);
    --tl-shadow-elevation-high: 0px 0.4px 0.5px hsl(var(--tl-shadow-color) / 0.04),
      0.1px 2.3px 3px -0.2px hsl(var(--tl-shadow-color) / 0.05),
      0.2px 4.1px 5.3px -0.5px hsl(var(--tl-shadow-color) / 0.06),
      0.4px 6.6px 8.5px -0.7px hsl(var(--tl-shadow-color) / 0.07),
      0.6px 10.3px 13.2px -1px hsl(var(--tl-shadow-color) / 0.08),
      0.9px 16px 20.6px -1.2px hsl(var(--tl-shadow-color) / 0.09),
      1.3px 24.3px 31.2px -1.4px hsl(var(--tl-shadow-color) / 0.1);
    box-sizing: border-box;
    position: relative;
    top: 0px;
    left: 0px;
    width: 100%;
    height: 100%;
    max-width: 100%;
    max-height: 100%;
    box-sizing: border-box;
    padding: 0px;
    margin: 0px;
    outline: none;
    z-index: 100;
    user-select: none;
    touch-action: none;
    overscroll-behavior: none;
    background-color: var(--tl-background);
    cursor: inherit;
    box-sizing: border-box;
    color: var(--tl-foreground);
    -webkit-user-select: none;
    -webkit-user-drag: none;
  }

  .tl-overlay {
    background: none;
    fill: transparent;
    position: absolute;
    width: 100%;
    height: 100%;
    touch-action: none;
    pointer-events: none;
  }

  .tl-snap-line {
    stroke: var(--tl-accent);
    stroke-width: calc(1px * var(--tl-scale));
  }

  .tl-snap-point {
    stroke: var(--tl-accent);
    stroke-width: calc(1px * var(--tl-scale));
  }

  .tl-canvas {
    position: absolute;
    width: 100%;
    height: 100%;
    touch-action: none;
    pointer-events: all;
    overflow: clip;
    outline: none;
  }

  .tl-layer {
    position: absolute;
    top: 0px;
    left: 0px;
    height: 0px;
    width: 0px;
    contain: layout style size;
  }

  .tl-absolute {
    position: absolute;
    top: 0px;
    left: 0px;
    transform-origin: center center;
    contain: layout style size;
  }

  .tl-positioned {
    position: absolute;
    transform-origin: center center;
    pointer-events: none;
    display: flex;
    align-items: center;
    justify-content: center;
    contain: layout style size;
  }

  .tl-positioned-svg {
    width: 100%;
    height: 100%;
    overflow: hidden;
    contain: layout style size;
    pointer-events: none;
  }

  .tl-positioned-div {
    position: relative;
    width: 100%;
    height: 100%;
    padding: var(--tl-padding);
    contain: layout style size;
  }

  .tl-positioned-inner {
    position: relative;
    width: 100%;
    height: 100%;
  }

  .tl-counter-scaled {
    transform: scale(var(--tl-scale));
  }

  .tl-dashed {
    stroke-dasharray: calc(2px * var(--tl-scale)), calc(2px * var(--tl-scale));
  }

  .tl-transparent {
    fill: transparent;
    stroke: transparent;
  }

  .tl-corner-handle {
    stroke: var(--tl-selectStroke);
    fill: var(--tl-background);
    stroke-width: calc(1.5px * var(--tl-scale));
  }

  .tl-rotate-handle {
    stroke: var(--tl-selectStroke);
    fill: var(--tl-background);
    stroke-width: calc(1.5px * var(--tl-scale));
  }

  .tl-clone-handle {
    stroke: var(--tl-selectStroke);
    fill: var(--tl-background);
    stroke-width: calc(1.5px * var(--tl-scale));
  }

  .tl-clone-handle:hover {
    fill: var(--tl-selectStroke);
    cursor: pointer;
  }

  .tl-clone-handle:hover line {
    stroke: var(--tl-background);
  }

  .tl-user {
    left: -4px;
    top: -4px;
    height: 8px;
    width: 8px;
    border-radius: 100%;
    pointer-events: none;
  }

  .tl-indicator {
    fill: transparent;
    stroke-width: calc(1.5px * var(--tl-scale));
    pointer-events: none;
  }

  .tl-indicator-container {
    transform-origin: 0 0;
    fill: transparent;
    stroke-width: calc(1.5px * var(--tl-scale));
    pointer-events: none;
  }

  .tl-user-indicator-bounds {
    border-style: solid;
    border-width: calc(1px * var(--tl-scale));
  }

  .tl-selected {
    stroke: var(--tl-selectStroke);
  }

  .tl-hovered {
    stroke: var(--tl-selectStroke);
  }

  .tl-clone-target {
    pointer-events: all;
  }

  .tl-clone-target:hover .tl-clone-button {
    opacity: 1;
  }

  .tl-clone-button-target {
    cursor: pointer;
    pointer-events: all;
  }

  .tl-clone-button-target:hover .tl-clone-button {
    fill: var(--tl-selectStroke);
  }

  .tl-clone-button {
    opacity: 0;
    r: calc(8px * var(--tl-scale));
    stroke-width: calc(1.5px * var(--tl-scale));
    stroke: var(--tl-selectStroke);
    fill: var(--tl-background);
  }

  .tl-bounds {
    pointer-events: none;
    contain: layout style size;
  }

  .tl-bounds-bg {
    stroke: none;
    fill: var(--tl-selectFill);
    pointer-events: all;
    contain: layout style size;
  }

  .tl-bounds-fg {
    fill: transparent;
    stroke: var(--tl-selectStroke);
    stroke-width: calc(1.5px * var(--tl-scale));
  }

  .tl-brush {
    fill: var(--tl-brushFill);
    stroke: var(--tl-brushStroke);
    stroke-width: calc(1px * var(--tl-scale));
    pointer-events: none;
  }

  .tl-dot {
    fill: var(--tl-background);
    stroke: var(--tl-foreground);
    stroke-width: 2px;
  }

  .tl-handle {
    fill: var(--tl-background);
    stroke: var(--tl-selectStroke);
    stroke-width: 1.5px;
    pointer-events: none;
  }

  .tl-handle-bg {
    fill: transparent;
    stroke: none;
    r: calc(16px / max(1, var(--tl-zoom)));
    pointer-events: all;
    cursor: grab;
  }

  .tl-handle-bg:active {
    pointer-events: all;
    fill: none;
  }

  .tl-handle-bg:hover {
    cursor: grab;
    fill: var(--tl-selectFill);
  }

  .tl-binding-indicator {
    fill: transparent;
    stroke: var(--tl-binding);
  }

  .tl-centered {
    display: grid;
    place-content: center;
    place-items: center;
  }

  .tl-centered > * {
    grid-column: 1;
    grid-row: 1;
  }

  .tl-centered-g {
    transform: translate(var(--tl-padding), var(--tl-padding));
  }

  .tl-current-parent > *[data-shy='true'] {
    opacity: 1;
  }

  .tl-binding {
    fill: none;
    stroke: var(--tl-selectStroke);
    stroke-width: calc(2px * var(--tl-scale));
  }

  .tl-counter-scaled-positioned {
    position: absolute;
    top: 0;
    left: 0;
    pointer-events: none;
    padding: 0;
    contain: layout style size;
  }

  .tl-fade-in {
    opacity: 1;
    transition-timing-function: ease-in-out;
    transition-property: opacity;
    transition-duration: 0.12s;
    transition-delay: 0;
  }

  .tl-fade-out {
    opacity: 0;
    transition-timing-function: ease-out;
    transition-property: opacity;
    transition-duration: 0.12s;
    transition-delay: 0;
  }

  .tl-counter-scaled-positioned > .tl-positioned-div {
    user-select: none;
    padding: 64px;
  }

  .tl-context-bar > * {
    grid-column: 1;
    grid-row: 1;
  }

  .tl-bounds-detail {
    padding: 2px 3px;
    border-radius: 1px;
    white-space: nowrap;
    width: fit-content;
    text-align: center;
    font-size: 12px;
    font-weight: 500;
    background-color: var(--tl-selectStroke);
    color: var(--tl-background);
  }

  .tl-grid-canvas {
    position: absolute;
    touch-action: none;
    pointer-events: none;
    user-select: none;
  }

  .tl-grid {
    position: absolute;
    width: 100%;
    height: 100%;
    touch-action: none;
    pointer-events: none;
    user-select: none;
  }

  .tl-grid-dot {
    fill: var(--tl-grid);
  }

  .tl-html-canvas {
    position: absolute;
    top: 0px;
    left: 0px;
    width: 100%;
    height: 100%;
    zindex: 20000;
    pointer-events: none;
    border: 2px solid red;
  }

  .tl-direction-indicator {
    z-index: 100000;
    position: absolute;
    top: 0px;
    left: 0px;
    fill: var(--tl-selectStroke);
  }
`,yw=Lf(Z(69)),zw=Lf(Z(69)),qt={},kj={toVector(c,n){void 0===c&&(c=n);return Array.isArray(c)?c:[c,c]},add(c,n){return[c[0]+n[0],c[1]+n[1]]},sub(c,n){return[c[0]-n[0],c[1]-n[1]]},addTo(c,n){c[0]+=n[0];c[1]+=n[1]},subTo(c,n){c[0]-=n[0];c[1]-=n[1]}},Aw={pointer:{start:"down",change:"move",end:"up"},mouse:{start:"down",change:"move",end:"up"},touch:{start:"start",change:"move",end:"end"},gesture:{start:"start",change:"change",end:"end"}},eA=["enter","leave"],fA=["gotpointercapture","lostpointercapture"],
Bw=class{constructor(c,n,N){this.ctrl=c;this.args=n;this.key=N;this.state||(this.state={},this.computeValues([0,0]),this.computeInitial(),this.init&&this.init(),this.reset())}get state(){return this.ctrl.state[this.key]}set state(c){this.ctrl.state[this.key]=c}get shared(){return this.ctrl.state.shared}get eventStore(){return this.ctrl.gestureEventStores[this.key]}get timeoutStore(){return this.ctrl.gestureTimeoutStores[this.key]}get config(){return this.ctrl.config[this.key]}get sharedConfig(){return this.ctrl.config.shared}get handler(){return this.ctrl.handlers[this.key]}reset(){const {state:c,
shared:n,ingKey:N,args:da}=this;n[N]=c._active=c.active=c._blocked=c._force=!1;c._step=[!1,!1];c.intentional=!1;c._movement=[0,0];c._distance=[0,0];c._direction=[0,0];c._delta=[0,0];c._bounds=[[-Infinity,Infinity],[-Infinity,Infinity]];c.args=da;c.axis=void 0;c.memo=void 0;c.elapsedTime=0;c.direction=[0,0];c.distance=[0,0];c.overflow=[0,0];c._movementBound=[!1,!1];c.velocity=[0,0];c.movement=[0,0];c.delta=[0,0];c.timeStamp=0}start(c){const n=this.state,N=this.config;n._active||(this.reset(),this.computeInitial(),
n._active=!0,n.target=c.target,n.currentTarget=c.currentTarget,n.lastOffset=N.from?ih(N.from,n):n.offset,n.offset=n.lastOffset);n.startTime=n.timeStamp=c.timeStamp}computeValues(c){const n=this.state;n._values=c;n.values=this.config.transform(c)}computeInitial(){const c=this.state;c._initial=c._values;c.initial=c.values}compute(c){const {state:n,config:N,shared:da}=this;n.args=this.args;var ua=0;if(c){n.event=c;N.preventDefault&&c.cancelable&&n.event.preventDefault();n.type=c.type;da.touches=this.ctrl.pointerIds.size||
this.ctrl.touchIds.size;da.locked=!!document.pointerLockElement;ua=Object;var Ga=ua.assign,Ma={};"buttons"in c&&(Ma.buttons=c.buttons);if("shiftKey"in c){const {shiftKey:Md,altKey:Dd,metaKey:Oe,ctrlKey:Pe}=c;Object.assign(Ma,{shiftKey:Md,altKey:Dd,metaKey:Oe,ctrlKey:Pe})}Ga.call(ua,da,Ma);da.down=da.pressed=1===da.buttons%2||0<da.touches;ua=c.timeStamp-n.timeStamp;n.timeStamp=c.timeStamp;n.elapsedTime=n.timeStamp-n.startTime}n._active&&(Ga=n._delta.map(Math.abs),kj.addTo(n._distance,Ga));this.axisIntent&&
this.axisIntent(c);const [fb,vb]=n._movement,[Wb,oc]=N.threshold,{_step:xc,values:Uc}=n;N.hasCustomTransform?(!1===xc[0]&&(xc[0]=Math.abs(fb)>=Wb&&Uc[0]),!1===xc[1]&&(xc[1]=Math.abs(vb)>=oc&&Uc[1])):(!1===xc[0]&&(xc[0]=Math.abs(fb)>=Wb&&Math.sign(fb)*Wb),!1===xc[1]&&(xc[1]=Math.abs(vb)>=oc&&Math.sign(vb)*oc));n.intentional=!1!==xc[0]||!1!==xc[1];if(n.intentional){Ga=[0,0];if(N.hasCustomTransform){const [Md,Dd]=Uc;Ga[0]=!1!==xc[0]?Md-xc[0]:0;Ga[1]=!1!==xc[1]?Dd-xc[1]:0}else Ga[0]=!1!==xc[0]?fb-xc[0]:
0,Ga[1]=!1!==xc[1]?vb-xc[1]:0;this.restrictToAxis&&!n._blocked&&this.restrictToAxis(Ga);Ma=n.offset;var md=n._active&&!n._blocked||n.active;md&&(n.first=n._active&&!n.active,n.last=!n._active&&n.active,n.active=da[this.ingKey]=n._active,c&&(n.first&&("bounds"in N&&(n._bounds=ih(N.bounds,n)),this.setup&&this.setup()),n.movement=Ga,this.computeOffset()));var [hd,Bd]=n.offset,[[Ld,bd],[jd,rd]]=n._bounds;n.overflow=[hd<Ld?-1:hd>bd?1:0,Bd<jd?-1:Bd>rd?1:0];n._movementBound[0]=n.overflow[0]?!1===n._movementBound[0]?
n._movement[0]:n._movementBound[0]:!1;n._movementBound[1]=n.overflow[1]?!1===n._movementBound[1]?n._movement[1]:n._movementBound[1]:!1;n.offset=Pf(n._bounds,n.offset,n._active?N.rubberband||[0,0]:[0,0]);n.delta=kj.sub(n.offset,Ma);this.computeMovement();md&&(!n.last||32<ua)&&(n.delta=kj.sub(n.offset,Ma),c=n.delta.map(Math.abs),kj.addTo(n.distance,c),n.direction=n.delta.map(Math.sign),n._direction=n._delta.map(Math.sign),!n.first&&0<ua&&(n.velocity=[c[0]/ua,c[1]/ua]))}}emit(){const c=this.state;var n=
this.shared;const N=this.config;c._active||this.clean();if(!c._blocked&&c.intentional||c._force||N.triggerAllEvents)n=this.handler(wf(wf(wf({},n),c),{},{[this.aliasKey]:c.values})),void 0!==n&&(c.memo=n)}clean(){this.eventStore.clean();this.timeoutStore.clean()}},Iq=class extends Bw{constructor(...c){super(...c);yf(this,"aliasKey","xy")}reset(){super.reset();this.state.axis=void 0}init(){this.state.offset=[0,0];this.state.lastOffset=[0,0]}computeOffset(){this.state.offset=kj.add(this.state.lastOffset,
this.state.movement)}computeMovement(){this.state.movement=kj.sub(this.state.offset,this.state.lastOffset)}axisIntent(c){const n=this.state,N=this.config;!n.axis&&c&&(c="object"===typeof N.axisThreshold?N.axisThreshold[Sg(c)]:N.axisThreshold,n.axis=rc(n._movement,c));n._blocked=(N.lockDirection||!!N.axis)&&!n.axis||!!N.axis&&N.axis!==n.axis}restrictToAxis(c){if(this.config.axis||this.config.lockDirection)switch(this.state.axis){case "x":c[1]=0;break;case "y":c[0]=0}}},gA=c=>c,Cw={enabled(c=!0){return c},
eventOptions(c,n,N){return wf(wf({},N.shared.eventOptions),c)},preventDefault(c=!1){return c},triggerAllEvents(c=!1){return c},rubberband(c=0){switch(c){case !0:return[.15,.15];case !1:return[0,0];default:return kj.toVector(c)}},from(c){if("function"===typeof c)return c;if(null!=c)return kj.toVector(c)},transform(c,n,N){c=c||N.shared.transform;this.hasCustomTransform=!!c;return c||gA},threshold(c){return kj.toVector(c,0)}},uo=wf(wf({},Cw),{},{axis(c,n,{axis:N}){this.lockDirection="lock"===N;if(!this.lockDirection)return N},
axisThreshold(c=0){return c},bounds(c={}){if("function"===typeof c)return Ga=>uo.bounds(c(Ga));if("current"in c)return()=>c.current;if("function"===typeof HTMLElement&&c instanceof HTMLElement)return c;const {left:n=-Infinity,right:N=Infinity,top:da=-Infinity,bottom:ua=Infinity}=c;return[[n,N],[da,ua]]}}),Dw={ArrowRight:(c=1)=>[10*c,0],ArrowLeft:(c=1)=>[-10*c,0],ArrowUp:(c=1)=>[0,-10*c],ArrowDown:(c=1)=>[0,10*c]},hA=class extends Iq{constructor(...c){super(...c);yf(this,"ingKey","dragging")}reset(){super.reset();
const c=this.state;c._pointerId=void 0;c._pointerActive=!1;c._keyboardActive=!1;c._preventScroll=!1;c._delayed=!1;c.swipe=[0,0];c.tap=!1;c.canceled=!1;c.cancel=this.cancel.bind(this)}setup(){const c=this.state;if(c._bounds instanceof HTMLElement){const n=c._bounds.getBoundingClientRect(),N=c.currentTarget.getBoundingClientRect();c._bounds=uo.bounds({left:n.left-N.left+c.offset[0],right:n.right-N.right+c.offset[0],top:n.top-N.top+c.offset[1],bottom:n.bottom-N.bottom+c.offset[1]})}}cancel(){const c=
this.state;c.canceled||(c.canceled=!0,c._active=!1,setTimeout(()=>{this.compute();this.emit()},0))}setActive(){this.state._active=this.state._pointerActive||this.state._keyboardActive}clean(){this.pointerClean();this.state._pointerActive=!1;this.state._keyboardActive=!1;super.clean()}pointerDown(c){const n=this.config,N=this.state;if(null==c.buttons||(Array.isArray(n.pointerButtons)?n.pointerButtons.includes(c.buttons):-1===n.pointerButtons||n.pointerButtons===c.buttons)){var da=this.ctrl.setEventIds(c);
n.pointerCapture&&c.target.setPointerCapture(c.pointerId);da&&1<da.size&&N._pointerActive||(this.start(c),this.setupPointer(c),N._pointerId=Gg(c),N._pointerActive=!0,this.computeValues(zf(c)),this.computeInitial(),n.preventScrollAxis&&"mouse"!==Sg(c)?(N._active=!1,this.setupScrollPrevention(c)):0<n.delay?(this.setupDelayTrigger(c),n.triggerAllEvents&&(this.compute(c),this.emit())):this.startPointerDrag(c))}}startPointerDrag(c){const n=this.state;n._active=!0;n._preventScroll=!0;n._delayed=!1;this.compute(c);
this.emit()}pointerMove(c){const n=this.state,N=this.config;if(n._pointerActive&&(n.type!==c.type||c.timeStamp!==n.timeStamp)){var da=Gg(c);if(void 0===n._pointerId||da===n._pointerId)da=zf(c),document.pointerLockElement===c.target?n._delta=[c.movementX,c.movementY]:(n._delta=kj.sub(da,n._values),this.computeValues(da)),kj.addTo(n._movement,n._delta),this.compute(c),n._delayed&&n.intentional?(this.timeoutStore.remove("dragDelay"),n.active=!1,this.startPointerDrag(c)):N.preventScrollAxis&&!n._preventScroll?
n.axis&&(n.axis===N.preventScrollAxis||"xy"===N.preventScrollAxis?(n._active=!1,this.clean()):(this.timeoutStore.remove("startPointerDrag"),this.startPointerDrag(c))):this.emit()}}pointerUp(c){this.ctrl.setEventIds(c);try{this.config.pointerCapture&&c.target.hasPointerCapture(c.pointerId)&&c.target.releasePointerCapture(c.pointerId)}catch(Ma){}const n=this.state,N=this.config;if(n._active&&n._pointerActive){var da=Gg(c);if(void 0===n._pointerId||da===n._pointerId){this.state._pointerActive=!1;this.setActive();
this.compute(c);var [ua,Ga]=n._distance;n.tap=ua<=N.tapsThreshold&&Ga<=N.tapsThreshold;if(n.tap&&N.filterTaps)n._force=!0;else{const [Ma,fb]=n.direction,[vb,Wb]=n.velocity,[oc,xc]=n.movement,[Uc,md]=N.swipe.velocity,[hd,Bd]=N.swipe.distance;n.elapsedTime<N.swipe.duration&&(Math.abs(vb)>Uc&&Math.abs(oc)>hd&&(n.swipe[0]=Ma),Math.abs(Wb)>md&&Math.abs(xc)>Bd&&(n.swipe[1]=fb))}this.emit()}}}pointerClick(c){!this.state.tap&&0<c.detail&&(c.preventDefault(),c.stopPropagation())}setupPointer(c){const n=this.config,
N=n.device;n.pointerLock&&c.currentTarget.requestPointerLock();n.pointerCapture||(this.eventStore.add(this.sharedConfig.window,N,"change",this.pointerMove.bind(this)),this.eventStore.add(this.sharedConfig.window,N,"end",this.pointerUp.bind(this)),this.eventStore.add(this.sharedConfig.window,N,"cancel",this.pointerUp.bind(this)))}pointerClean(){this.config.pointerLock&&document.pointerLockElement===this.state.currentTarget&&document.exitPointerLock()}preventScroll(c){this.state._preventScroll&&c.cancelable&&
c.preventDefault()}setupScrollPrevention(c){this.state._preventScroll=!1;"persist"in c&&"function"===typeof c.persist&&c.persist();const n=this.eventStore.add(this.sharedConfig.window,"touch","change",this.preventScroll.bind(this),{passive:!1});this.eventStore.add(this.sharedConfig.window,"touch","end",n);this.eventStore.add(this.sharedConfig.window,"touch","cancel",n);this.timeoutStore.add("startPointerDrag",this.startPointerDrag.bind(this),this.config.preventScrollDelay,c)}setupDelayTrigger(c){this.state._delayed=
!0;this.timeoutStore.add("dragDelay",()=>{this.state._step=[0,0];this.startPointerDrag(c)},this.config.delay)}keyDown(c){const n=Dw[c.key];if(n){const N=this.state,da=c.shiftKey?10:c.altKey?.1:1;this.start(c);N._delta=n(da);N._keyboardActive=!0;kj.addTo(N._movement,N._delta);this.compute(c);this.emit()}}keyUp(c){c.key in Dw&&(this.state._keyboardActive=!1,this.setActive(),this.compute(c),this.emit())}bind(c){const n=this.config.device;c(n,"start",this.pointerDown.bind(this));this.config.pointerCapture&&
(c(n,"change",this.pointerMove.bind(this)),c(n,"end",this.pointerUp.bind(this)),c(n,"cancel",this.pointerUp.bind(this)),c("lostPointerCapture","",this.pointerUp.bind(this)));this.config.keys&&(c("key","down",this.keyDown.bind(this)),c("key","up",this.keyUp.bind(this)));this.config.filterTaps&&c("click","",this.pointerClick.bind(this),{capture:!0,passive:!1})}},vo="undefined"!==typeof window&&window.document&&window.document.createElement;try{var Ew="constructor"in GestureEvent}catch(c){Ew=!1}var iA=
Ew,Jq=vo&&"ontouchstart"in window||vo&&1<window.navigator.maxTouchPoints,Fw=vo&&"ontouchstart"in window||vo&&1<window.navigator.maxTouchPoints,Gw=vo&&"onpointerdown"in window,jA=vo&&"exitPointerLock"in window.document,Hw={mouse:0,touch:0,pen:8},kA=wf(wf({},uo),{},{device(c,n,{pointer:{touch:N=!1,lock:da=!1,mouse:ua=!1}={}}){this.pointerLock=da&&jA;return Jq&&N?"touch":this.pointerLock?"mouse":Gw&&!ua?"pointer":Jq?"touch":"mouse"},preventScrollAxis(c,n,{preventScroll:N}){this.preventScrollDelay="number"===
typeof N?N:N||void 0===N&&c?250:void 0;if(Fw&&!1!==N)return c?c:void 0!==N?"y":void 0},pointerCapture(c,n,{pointer:{capture:N=!0,buttons:da=1,keys:ua=!0}={}}){this.pointerButtons=da;this.keys=ua;return!this.pointerLock&&"pointer"===this.device&&N},threshold(c,n,{filterTaps:N=!1,tapsThreshold:da=3,axis:ua}){c=kj.toVector(c,N?da:ua?1:0);this.filterTaps=N;this.tapsThreshold=da;return c},swipe({velocity:c=.5,distance:n=50,duration:N=250}={}){return{velocity:this.transform(kj.toVector(c)),distance:this.transform(kj.toVector(n)),
duration:N}},delay(c=0){switch(c){case !0:return 180;case !1:return 0;default:return c}},axisThreshold(c){return c?wf(wf({},Hw),c):Hw}}),lA=class extends Bw{constructor(...c){super(...c);yf(this,"ingKey","pinching");yf(this,"aliasKey","da")}init(){this.state.offset=[1,0];this.state.lastOffset=[1,0];this.state._pointerEvents=new Map}reset(){super.reset();const c=this.state;c._touchIds=[];c.canceled=!1;c.cancel=this.cancel.bind(this);c.turns=0}computeOffset(){const {type:c,movement:n,lastOffset:N}=
this.state;this.state.offset="wheel"===c?kj.add(n,N):[(1+n[0])*N[0],n[1]+N[1]]}computeMovement(){const {offset:c,lastOffset:n}=this.state;this.state.movement=[c[0]/n[0],c[1]-n[1]]}axisIntent(){const c=this.state,[n,N]=c._movement;if(!c.axis){const da=30*Math.abs(n)-Math.abs(N);0>da?c.axis="angle":0<da&&(c.axis="scale")}}restrictToAxis(c){this.config.lockDirection&&("scale"===this.state.axis?c[1]=0:"angle"===this.state.axis&&(c[0]=0))}cancel(){const c=this.state;c.canceled||setTimeout(()=>{c.canceled=
!0;c._active=!1;this.compute();this.emit()},0)}touchStart(c){this.ctrl.setEventIds(c);var n=this.state;const N=this.ctrl.touchIds;n._active&&n._touchIds.every(da=>N.has(da))||2>N.size||(this.start(c),n._touchIds=Array.from(N).slice(0,2),n=mf(c,n._touchIds),this.pinchStart(c,n))}pointerStart(c){if(null==c.buttons||1===c.buttons%2){this.ctrl.setEventIds(c);c.target.setPointerCapture(c.pointerId);var n=this.state,N=n._pointerEvents,da=this.ctrl.pointerIds;n._active&&Array.from(N.keys()).every(ua=>da.has(ua))||
(2>N.size&&N.set(c.pointerId,c),2>n._pointerEvents.size||(this.start(c),n=of(...Array.from(N.values())),this.pinchStart(c,n)))}}pinchStart(c,n){this.state.origin=n.origin;this.computeValues([n.distance,n.angle]);this.computeInitial();this.compute(c);this.emit()}touchMove(c){if(this.state._active){var n=mf(c,this.state._touchIds);this.pinchMove(c,n)}}pointerMove(c){var n=this.state._pointerEvents;n.has(c.pointerId)&&n.set(c.pointerId,c);this.state._active&&(n=of(...Array.from(n.values())),this.pinchMove(c,
n))}pinchMove(c,n){const N=this.state,da=n.angle-N._values[1];let ua=0;270<Math.abs(da)&&(ua+=Math.sign(da));this.computeValues([n.distance,n.angle-360*ua]);N.origin=n.origin;N.turns=ua;N._movement=[N._values[0]/N._initial[0]-1,N._values[1]-N._initial[1]];this.compute(c);this.emit()}touchEnd(c){this.ctrl.setEventIds(c);this.state._active&&this.state._touchIds.some(n=>!this.ctrl.touchIds.has(n))&&(this.state._active=!1,this.compute(c),this.emit())}pointerEnd(c){const n=this.state;this.ctrl.setEventIds(c);
try{c.target.releasePointerCapture(c.pointerId)}catch(N){}n._pointerEvents.has(c.pointerId)&&n._pointerEvents.delete(c.pointerId);n._active&&2>n._pointerEvents.size&&(n._active=!1,this.compute(c),this.emit())}gestureStart(c){c.cancelable&&c.preventDefault();const n=this.state;n._active||(this.start(c),this.computeValues([c.scale,c.rotation]),n.origin=[c.clientX,c.clientY],this.compute(c),this.emit())}gestureMove(c){c.cancelable&&c.preventDefault();if(this.state._active){var n=this.state;this.computeValues([c.scale,
c.rotation]);n.origin=[c.clientX,c.clientY];var N=n._movement;n._movement=[c.scale-1,c.rotation];n._delta=kj.sub(n._movement,N);this.compute(c);this.emit()}}gestureEnd(c){this.state._active&&(this.state._active=!1,this.compute(c),this.emit())}wheel(c){const n=this.config.modifierKey;if(!n||c[n])this.state._active?this.wheelChange(c):this.wheelStart(c),this.timeoutStore.add("wheelEnd",this.wheelEnd.bind(this))}wheelStart(c){this.start(c);this.wheelChange(c)}wheelChange(c){"uv"in c||c.cancelable&&c.preventDefault();
const n=this.state;n._delta=[-Oh(c)[1]/100*n.offset[0],0];kj.addTo(n._movement,n._delta);fd(n);this.state.origin=[c.clientX,c.clientY];this.compute(c);this.emit()}wheelEnd(){this.state._active&&(this.state._active=!1,this.compute(),this.emit())}bind(c){const n=this.config.device;n&&(c(n,"start",this[n+"Start"].bind(this)),c(n,"change",this[n+"Move"].bind(this)),c(n,"end",this[n+"End"].bind(this)),c(n,"cancel",this[n+"End"].bind(this)));this.config.pinchOnWheel&&c("wheel","",this.wheel.bind(this),
{passive:!1})}},mA=wf(wf({},Cw),{},{device(c,n,{shared:N,pointer:{touch:da=!1}={}}){if(N.target&&!Jq&&iA)return"gesture";if(Jq&&da)return"touch";if(Fw){if(Gw)return"pointer";if(Jq)return"touch"}},bounds(c,n,{scaleBounds:N={},angleBounds:da={}}){const ua=Ma=>{Ma=ih(N,Ma);Ma=Object.assign({},{min:-Infinity,max:Infinity},Ma||{});return[Ma.min,Ma.max]},Ga=Ma=>{Ma=ih(da,Ma);Ma=Object.assign({},{min:-Infinity,max:Infinity},Ma||{});return[Ma.min,Ma.max]};return"function"!==typeof N&&"function"!==typeof da?
[ua(),Ga()]:Ma=>[ua(Ma),Ga(Ma)]},threshold(c,n,N){this.lockDirection="lock"===N.axis;return kj.toVector(c,this.lockDirection?[.1,3]:0)},modifierKey(c){return void 0===c?"ctrlKey":c},pinchOnWheel(c=!0){return c}}),nA=class extends Iq{constructor(...c){super(...c);yf(this,"ingKey","moving")}move(c){this.config.mouseOnly&&"mouse"!==c.pointerType||(this.state._active?this.moveChange(c):this.moveStart(c),this.timeoutStore.add("moveEnd",this.moveEnd.bind(this)))}moveStart(c){this.start(c);this.computeValues(zf(c));
this.compute(c);this.computeInitial();this.emit()}moveChange(c){if(this.state._active){var n=zf(c),N=this.state;N._delta=kj.sub(n,N._values);kj.addTo(N._movement,N._delta);this.computeValues(n);this.compute(c);this.emit()}}moveEnd(c){this.state._active&&(this.state._active=!1,this.compute(c),this.emit())}bind(c){c("pointer","change",this.move.bind(this));c("pointer","leave",this.moveEnd.bind(this))}},oA=wf(wf({},uo),{},{mouseOnly:(c=!0)=>c}),pA=class extends Iq{constructor(...c){super(...c);yf(this,
"ingKey","scrolling")}scroll(c){this.state._active||this.start(c);this.scrollChange(c);this.timeoutStore.add("scrollEnd",this.scrollEnd.bind(this))}scrollChange(c){c.cancelable&&c.preventDefault();const n=this.state;var N,da;const {scrollX:ua,scrollY:Ga,scrollLeft:Ma,scrollTop:fb}=c.currentTarget;var vb=[null!==(N=null!==ua&&void 0!==ua?ua:Ma)&&void 0!==N?N:0,null!==(da=null!==Ga&&void 0!==Ga?Ga:fb)&&void 0!==da?da:0];n._delta=kj.sub(vb,n._values);kj.addTo(n._movement,n._delta);this.computeValues(vb);
this.compute(c);this.emit()}scrollEnd(){this.state._active&&(this.state._active=!1,this.compute(),this.emit())}bind(c){c("scroll","",this.scroll.bind(this))}},qA=uo,rA=class extends Iq{constructor(...c){super(...c);yf(this,"ingKey","wheeling")}wheel(c){this.state._active||this.start(c);this.wheelChange(c);this.timeoutStore.add("wheelEnd",this.wheelEnd.bind(this))}wheelChange(c){const n=this.state;n._delta=Oh(c);kj.addTo(n._movement,n._delta);fd(n);this.compute(c);this.emit()}wheelEnd(){this.state._active&&
(this.state._active=!1,this.compute(),this.emit())}bind(c){c("wheel","",this.wheel.bind(this))}},sA=uo,tA=class extends Iq{constructor(...c){super(...c);yf(this,"ingKey","hovering")}enter(c){this.config.mouseOnly&&"mouse"!==c.pointerType||(this.start(c),this.computeValues(zf(c)),this.compute(c),this.emit())}leave(c){if(!this.config.mouseOnly||"mouse"===c.pointerType){var n=this.state;if(n._active){n._active=!1;var N=zf(c);n._movement=n._delta=kj.sub(N,n._values);this.computeValues(N);this.compute(c);
n.delta=n.movement;this.emit()}}}bind(c){c("pointer","enter",this.enter.bind(this));c("pointer","leave",this.leave.bind(this))}},uA=wf(wf({},uo),{},{mouseOnly:(c=!0)=>c}),rt=new Map,st=new Map,vA={key:"drag",engine:hA,resolver:kA},wA={key:"hover",engine:tA,resolver:uA},xA={key:"move",engine:nA,resolver:oA},yA={key:"pinch",engine:lA,resolver:mA},zA={key:"scroll",engine:pA,resolver:qA},AA={key:"wheel",engine:rA,resolver:sA},tt=Lf(Z(69)),BA={target(c){if(c)return()=>"current"in c?c.current:c},enabled(c=
!0){return c},window(c=vo?window:void 0){return c},eventOptions({passive:c=!0,capture:n=!1}={}){return{passive:c,capture:n}},transform(c){return c}},CA=["target","eventOptions","window","enabled","transform"],Iw=class{constructor(c,n){yf(this,"_listeners",new Set);this._ctrl=c;this._gestureKey=n}add(c,n,N,da,ua){const Ga=this._listeners,Ma=ni(n,N),fb=wf(wf({},this._gestureKey?this._ctrl.config[this._gestureKey].eventOptions:{}),ua);c.addEventListener(Ma,da,fb);const vb=()=>{c.removeEventListener(Ma,
da,fb);Ga.delete(vb)};Ga.add(vb);return vb}clean(){this._listeners.forEach(c=>c());this._listeners.clear()}},DA=class{constructor(){yf(this,"_timeouts",new Map)}add(c,n,N=140,...da){this.remove(c);this._timeouts.set(c,window.setTimeout(n,N,...da))}remove(c){(c=this._timeouts.get(c))&&window.clearTimeout(c)}clean(){this._timeouts.forEach(c=>void window.clearTimeout(c));this._timeouts.clear()}},EA=class{constructor(c){yf(this,"gestures",new Set);yf(this,"_targetEventStore",new Iw(this));yf(this,"gestureEventStores",
{});yf(this,"gestureTimeoutStores",{});yf(this,"handlers",{});yf(this,"config",{});yf(this,"pointerIds",new Set);yf(this,"touchIds",new Set);yf(this,"state",{shared:{shiftKey:!1,metaKey:!1,ctrlKey:!1,altKey:!1}});c.drag&&fe(this,"drag");c.wheel&&fe(this,"wheel");c.scroll&&fe(this,"scroll");c.move&&fe(this,"move");c.pinch&&fe(this,"pinch");c.hover&&fe(this,"hover")}setEventIds(c){if("touches"in c)return this.touchIds=new Set(jf(c));if("pointerId"in c)return"pointerup"===c.type||"pointercancel"===c.type?
this.pointerIds.delete(c.pointerId):"pointerdown"===c.type&&this.pointerIds.add(c.pointerId),this.pointerIds}applyHandlers(c,n){this.handlers=c;this.nativeHandlers=n}applyConfig(c,n){this.config=Xd(c,n,this.config)}clean(){this._targetEventStore.clean();for(const c of this.gestures)this.gestureEventStores[c].clean(),this.gestureTimeoutStores[c].clean()}effect(){this.config.shared.target&&this.bind();return()=>this._targetEventStore.clean()}bind(...c){var n=this.config.shared;const N={};let da;if(n.target&&
(da=n.target(),!da))return;if(n.enabled){for(const ua of this.gestures){const Ga=this.config[ua],Ma=Jw(N,Ga.eventOptions,!!da);Ga.enabled&&(new (rt.get(ua))(this,c,ua)).bind(Ma)}n=Jw(N,n.eventOptions,!!da);for(const ua in this.nativeHandlers)n(ua,"",Ga=>this.nativeHandlers[ua](wf(wf({},this.state.shared),{},{event:Ga,args:c})),void 0,!0)}for(const ua in N)N[ua]=bc(...N[ua]);if(!da)return N;for(const ua in N){const {device:Ga,capture:Ma,passive:fb}=Sf(ua);this._targetEventStore.add(da,Ga,"",N[ua],
{capture:Ma,passive:fb})}}},Jw=(c,n,N)=>(da,ua,Ga,Ma={},fb=!1)=>{var vb,Wb;const oc=null!==(vb=Ma.capture)&&void 0!==vb?vb:n.capture;Ma=null!==(Wb=Ma.passive)&&void 0!==Wb?Wb:n.passive;da=fb?da:vg(da,ua,oc);N&&Ma&&(da+="Passive");c[da]=c[da]||[];c[da].push(Ga)},FA=/^on(Drag|Wheel|Scroll|Move|Pinch|Hover)/,Jr=Lf(Z(69)),ut=Lf(Z(69)),Kw=Lf(Z(69)),Lw=Lf(Z(69)),GA=Lf(Z(69)),HA=Lf(Z(69)),IA=Lf(Z(69)),JA=Lf(Z(69)),KA={none:(c,n)=>"none",["default"]:(c,n)=>"default",pointer:(c,n)=>"pointer",crosshair:(c,
n)=>"crosshair",move:(c,n)=>"move",wait:(c,n)=>"wait",progress:(c,n)=>"progress",grab:(c,n)=>wd('\x3cpath d\x3d"m13.5557 17.5742c-.098-.375-.196-.847-.406-1.552-.167-.557-.342-.859-.47-1.233-.155-.455-.303-.721-.496-1.181-.139-.329-.364-1.048-.457-1.44-.119-.509.033-.924.244-1.206.253-.339.962-.49 1.357-.351.371.13.744.512.916.788.288.46.357.632.717 1.542.393.992.564 1.918.611 2.231l.085.452c-.001-.04-.043-1.122-.044-1.162-.035-1.029-.06-1.823-.038-2.939.002-.126.064-.587.084-.715.078-.5.305-.8.673-.979.412-.201.926-.215 1.401-.017.423.173.626.55.687 1.022.014.109.094.987.093 1.107-.013 1.025.006 1.641.015 2.174.004.231.003 1.625.017 1.469.061-.656.094-3.189.344-3.942.144-.433.405-.746.794-.929.431-.203 1.113-.07 1.404.243.285.305.446.692.482 1.153.032.405-.019.897-.02 1.245 0 .867-.021 1.324-.037 2.121-.001.038-.015.298.023.182.094-.28.188-.542.266-.745.049-.125.241-.614.359-.859.114-.234.211-.369.415-.688.2-.313.415-.448.668-.561.54-.235 1.109.112 1.301.591.086.215.009.713-.028 1.105-.061.647-.254 1.306-.352 1.648-.128.447-.274 1.235-.34 1.601-.072.394-.234 1.382-.359 1.82-.086.301-.371.978-.652 1.384 0 0-1.074 1.25-1.192 1.812-.117.563-.078.567-.101.965-.024.399.121.923.121.923s-.802.104-1.234.034c-.391-.062-.875-.841-1-1.078-.172-.328-.539-.265-.682-.023-.225.383-.709 1.07-1.051 1.113-.668.084-2.054.03-3.139.02 0 0 .185-1.011-.227-1.358-.305-.26-.83-.784-1.144-1.06l-.832-.921c-.284-.36-.629-1.093-1.243-1.985-.348-.504-1.027-1.085-1.284-1.579-.223-.425-.331-.954-.19-1.325.225-.594.675-.897 1.362-.832.519.05.848.206 1.238.537.225.19.573.534.75.748.163.195.203.276.377.509.23.307.302.459.214.121" fill\x3d"%23fff"/\x3e\x3cg stroke\x3d"%23000" stroke-linecap\x3d"round" stroke-width\x3d".75"\x3e\x3cpath d\x3d"m13.5557 17.5742c-.098-.375-.196-.847-.406-1.552-.167-.557-.342-.859-.47-1.233-.155-.455-.303-.721-.496-1.181-.139-.329-.364-1.048-.457-1.44-.119-.509.033-.924.244-1.206.253-.339.962-.49 1.357-.351.371.13.744.512.916.788.288.46.357.632.717 1.542.393.992.564 1.918.611 2.231l.085.452c-.001-.04-.043-1.122-.044-1.162-.035-1.029-.06-1.823-.038-2.939.002-.126.064-.587.084-.715.078-.5.305-.8.673-.979.412-.201.926-.215 1.401-.017.423.173.626.55.687 1.022.014.109.094.987.093 1.107-.013 1.025.006 1.641.015 2.174.004.231.003 1.625.017 1.469.061-.656.094-3.189.344-3.942.144-.433.405-.746.794-.929.431-.203 1.113-.07 1.404.243.285.305.446.692.482 1.153.032.405-.019.897-.02 1.245 0 .867-.021 1.324-.037 2.121-.001.038-.015.298.023.182.094-.28.188-.542.266-.745.049-.125.241-.614.359-.859.114-.234.211-.369.415-.688.2-.313.415-.448.668-.561.54-.235 1.109.112 1.301.591.086.215.009.713-.028 1.105-.061.647-.254 1.306-.352 1.648-.128.447-.274 1.235-.34 1.601-.072.394-.234 1.382-.359 1.82-.086.301-.371.978-.652 1.384 0 0-1.074 1.25-1.192 1.812-.117.563-.078.567-.101.965-.024.399.121.923.121.923s-.802.104-1.234.034c-.391-.062-.875-.841-1-1.078-.172-.328-.539-.265-.682-.023-.225.383-.709 1.07-1.051 1.113-.668.084-2.054.03-3.139.02 0 0 .185-1.011-.227-1.358-.305-.26-.83-.784-1.144-1.06l-.832-.921c-.284-.36-.629-1.093-1.243-1.985-.348-.504-1.027-1.085-1.284-1.579-.223-.425-.331-.954-.19-1.325.225-.594.675-.897 1.362-.832.519.05.848.206 1.238.537.225.19.573.534.75.748.163.195.203.276.377.509.23.307.302.459.214.121" stroke-linejoin\x3d"round"/\x3e\x3cpath d\x3d"m20.5664 21.7344v-3.459"/\x3e\x3cpath d\x3d"m18.5508 21.7461-.016-3.473"/\x3e\x3cpath d\x3d"m16.5547 18.3047.021 3.426"/\x3e\x3c/g\x3e',
c,n),grabbing:(c,n)=>wd("\x3cpath d\x3d'm13.5732 12.0361c.48-.178 1.427-.069 1.677.473.213.462.396 1.241.406 1.075.024-.369-.024-1.167.137-1.584.117-.304.347-.59.686-.691.285-.086.62-.116.916-.055.313.064.642.287.765.499.362.623.368 1.899.385 1.831.064-.272.07-1.229.283-1.584.141-.235.497-.445.687-.479.294-.052.656-.068.964-.008.249.049.586.344.677.487.219.344.342 1.316.379 1.658.016.141.074-.393.293-.736.406-.639 1.844-.763 1.898.639.026.654.02.624.02 1.064 0 .516-.012.828-.04 1.202-.03.399-.116 1.304-.241 1.742-.086.301-.371.978-.653 1.384 0 0-1.074 1.25-1.191 1.812-.117.563-.078.567-.102.965-.023.399.121.923.121.923s-.801.104-1.234.034c-.391-.062-.875-.84-1-1.078-.172-.328-.539-.265-.682-.023-.224.383-.709 1.07-1.05 1.113-.669.084-2.055.03-3.14.02 0 0 .185-1.011-.227-1.358-.305-.26-.83-.784-1.144-1.06l-.832-.921c-.283-.36-1.002-.929-1.243-1.985-.213-.936-.192-1.395.037-1.77.232-.381.67-.589.854-.625.208-.042.692-.039.875.062.223.123.313.159.488.391.23.307.312.456.213.121-.076-.262-.322-.595-.434-.97-.109-.361-.401-.943-.38-1.526.008-.221.103-.771.832-1.042' fill\x3d'%23fff'/\x3e\x3cg stroke\x3d'%23000' stroke-width\x3d'.75'\x3e\x3cpath d\x3d'm13.5732 12.0361c.48-.178 1.427-.069 1.677.473.213.462.396 1.241.406 1.075.024-.369-.024-1.167.137-1.584.117-.304.347-.59.686-.691.285-.086.62-.116.916-.055.313.064.642.287.765.499.362.623.368 1.899.385 1.831.064-.272.07-1.229.283-1.584.141-.235.497-.445.687-.479.294-.052.656-.068.964-.008.249.049.586.344.677.487.219.344.342 1.316.379 1.658.016.141.074-.393.293-.736.406-.639 1.844-.763 1.898.639.026.654.02.624.02 1.064 0 .516-.012.828-.04 1.202-.03.399-.116 1.304-.241 1.742-.086.301-.371.978-.653 1.384 0 0-1.074 1.25-1.191 1.812-.117.563-.078.567-.102.965-.023.399.121.923.121.923s-.801.104-1.234.034c-.391-.062-.875-.84-1-1.078-.172-.328-.539-.265-.682-.023-.224.383-.709 1.07-1.05 1.113-.669.084-2.055.03-3.14.02 0 0 .185-1.011-.227-1.358-.305-.26-.83-.784-1.144-1.06l-.832-.921c-.283-.36-1.002-.929-1.243-1.985-.213-.936-.192-1.395.037-1.77.232-.381.67-.589.854-.625.208-.042.692-.039.875.062.223.123.313.159.488.391.23.307.312.456.213.121-.076-.262-.322-.595-.434-.97-.109-.361-.401-.943-.38-1.526.008-.221.103-.771.832-1.042z' stroke-linejoin\x3d'round'/\x3e\x3cpath d\x3d'm20.5664 19.7344v-3.459' stroke-linecap\x3d'round'/\x3e\x3cpath d\x3d'm18.5508 19.7461-.016-3.473' stroke-linecap\x3d'round'/\x3e\x3cpath d\x3d'm16.5547 16.3047.021 3.426' stroke-linecap\x3d'round'/\x3e\x3c/g\x3e",
c,n),text:(c,n)=>wd("\x3cpath d\x3d'm6.94 2v-1c-1.35866267-.08246172-2.66601117.53165299-3.47 1.63-.80398883-1.09834701-2.11133733-1.71246172-3.47-1.63v1c1.30781678-.16635468 2.55544738.59885876 3 1.84v5.1h-1v1h1v4.16c-.4476345 1.2386337-1.69302129 2.002471-3 1.84v1c1.35687108.0731933 2.6600216-.5389494 3.47-1.63.8099784 1.0910506 2.11312892 1.7031933 3.47 1.63v-1c-1.28590589.133063-2.49760499-.6252793-2.94-1.84v-4.18h1v-1h-1v-5.08c.43943906-1.21710975 1.65323743-1.97676587 2.94-1.84z' transform\x3d'translate(14 9)'/\x3e",
c,n),["resize-edge"]:(c,n)=>wd("\x3cpath d\x3d'm9 17.9907v.005l5.997 5.996.001-3.999h1.999 2.02v4l5.98-6.001-5.98-5.999.001 4.019-2.021.002h-2l.001-4.022zm1.411.003 3.587-3.588-.001 2.587h3.5 2.521v-2.585l3.565 3.586-3.564 3.585-.001-2.585h-2.521l-3.499-.001-.001 2.586z' fill\x3d'%23fff'/\x3e\x3cpath d\x3d'm17.4971 18.9932h2.521v2.586l3.565-3.586-3.565-3.585v2.605h-2.521-3.5v-2.607l-3.586 3.587 3.586 3.586v-2.587z' fill\x3d'%23000'/\x3e",c,n),["resize-corner"]:(c,n)=>wd("\x3cpath d\x3d'm19.7432 17.0869-4.072 4.068 2.829 2.828-8.473-.013-.013-8.47 2.841 2.842 4.075-4.068 1.414-1.415-2.844-2.842h8.486v8.484l-2.83-2.827z' fill\x3d'%23fff'/\x3e\x3cpath d\x3d'm18.6826 16.7334-4.427 4.424 1.828 1.828-5.056-.016-.014-5.054 1.842 1.841 4.428-4.422 2.474-2.475-1.844-1.843h5.073v5.071l-1.83-1.828z' fill\x3d'%23000'/\x3e",
c,n),["ew-resize"]:(c,n)=>wd("\x3cpath d\x3d'm9 17.9907v.005l5.997 5.996.001-3.999h1.999 2.02v4l5.98-6.001-5.98-5.999.001 4.019-2.021.002h-2l.001-4.022zm1.411.003 3.587-3.588-.001 2.587h3.5 2.521v-2.585l3.565 3.586-3.564 3.585-.001-2.585h-2.521l-3.499-.001-.001 2.586z' fill\x3d'%23fff'/\x3e\x3cpath d\x3d'm17.4971 18.9932h2.521v2.586l3.565-3.586-3.565-3.585v2.605h-2.521-3.5v-2.607l-3.586 3.587 3.586 3.586v-2.587z' fill\x3d'%23000'/\x3e",c,n),["ns-resize"]:(c,n)=>wd("\x3cpath d\x3d'm9 17.9907v.005l5.997 5.996.001-3.999h1.999 2.02v4l5.98-6.001-5.98-5.999.001 4.019-2.021.002h-2l.001-4.022zm1.411.003 3.587-3.588-.001 2.587h3.5 2.521v-2.585l3.565 3.586-3.564 3.585-.001-2.585h-2.521l-3.499-.001-.001 2.586z' fill\x3d'%23fff'/\x3e\x3cpath d\x3d'm17.4971 18.9932h2.521v2.586l3.565-3.586-3.565-3.585v2.605h-2.521-3.5v-2.607l-3.586 3.587 3.586 3.586v-2.587z' fill\x3d'%23000'/\x3e",
c+90,n),["nesw-resize"]:(c,n)=>wd("\x3cpath d\x3d'm19.7432 17.0869-4.072 4.068 2.829 2.828-8.473-.013-.013-8.47 2.841 2.842 4.075-4.068 1.414-1.415-2.844-2.842h8.486v8.484l-2.83-2.827z' fill\x3d'%23fff'/\x3e\x3cpath d\x3d'm18.6826 16.7334-4.427 4.424 1.828 1.828-5.056-.016-.014-5.054 1.842 1.841 4.428-4.422 2.474-2.475-1.844-1.843h5.073v5.071l-1.83-1.828z' fill\x3d'%23000'/\x3e",c,n),["nwse-resize"]:(c,n)=>wd("\x3cpath d\x3d'm19.7432 17.0869-4.072 4.068 2.829 2.828-8.473-.013-.013-8.47 2.841 2.842 4.075-4.068 1.414-1.415-2.844-2.842h8.486v8.484l-2.83-2.827z' fill\x3d'%23fff'/\x3e\x3cpath d\x3d'm18.6826 16.7334-4.427 4.424 1.828 1.828-5.056-.016-.014-5.054 1.842 1.841 4.428-4.422 2.474-2.475-1.844-1.843h5.073v5.071l-1.83-1.828z' fill\x3d'%23000'/\x3e",
c+90,n),rotate:(c,n)=>wd('\x3cg\x3e\x3cpath d\x3d"M22.4789 9.45728L25.9935 12.9942L22.4789 16.5283V14.1032C18.126 14.1502 14.6071 17.6737 14.5675 22.0283H17.05L13.513 25.543L9.97889 22.0283H12.5674C12.6071 16.5691 17.0214 12.1503 22.4789 12.1031L22.4789 9.45728Z" fill\x3d"black"/\x3e\x3cpath fill-rule\x3d"evenodd" clip-rule\x3d"evenodd" d\x3d"M21.4789 7.03223L27.4035 12.9945L21.4789 18.9521V15.1868C18.4798 15.6549 16.1113 18.0273 15.649 21.0284H19.475L13.5128 26.953L7.55519 21.0284H11.6189C12.1243 15.8155 16.2679 11.6677 21.4789 11.1559L21.4789 7.03223ZM22.4789 12.1031C17.0214 12.1503 12.6071 16.5691 12.5674 22.0284H9.97889L13.513 25.543L17.05 22.0284H14.5675C14.5705 21.6896 14.5947 21.3558 14.6386 21.0284C15.1157 17.4741 17.9266 14.6592 21.4789 14.1761C21.8063 14.1316 22.1401 14.1069 22.4789 14.1032V16.5284L25.9935 12.9942L22.4789 9.45729L22.4789 12.1031Z" fill\x3d"white"/\x3e\x3c/g\x3e',
c+45,n),["nwse-rotate"]:(c,n)=>wd('\x3cg\x3e\x3cpath d\x3d"M22.4789 9.45728L25.9935 12.9942L22.4789 16.5283V14.1032C18.126 14.1502 14.6071 17.6737 14.5675 22.0283H17.05L13.513 25.543L9.97889 22.0283H12.5674C12.6071 16.5691 17.0214 12.1503 22.4789 12.1031L22.4789 9.45728Z" fill\x3d"black"/\x3e\x3cpath fill-rule\x3d"evenodd" clip-rule\x3d"evenodd" d\x3d"M21.4789 7.03223L27.4035 12.9945L21.4789 18.9521V15.1868C18.4798 15.6549 16.1113 18.0273 15.649 21.0284H19.475L13.5128 26.953L7.55519 21.0284H11.6189C12.1243 15.8155 16.2679 11.6677 21.4789 11.1559L21.4789 7.03223ZM22.4789 12.1031C17.0214 12.1503 12.6071 16.5691 12.5674 22.0284H9.97889L13.513 25.543L17.05 22.0284H14.5675C14.5705 21.6896 14.5947 21.3558 14.6386 21.0284C15.1157 17.4741 17.9266 14.6592 21.4789 14.1761C21.8063 14.1316 22.1401 14.1069 22.4789 14.1032V16.5284L25.9935 12.9942L22.4789 9.45729L22.4789 12.1031Z" fill\x3d"white"/\x3e\x3c/g\x3e',
c,n),["nesw-rotate"]:(c,n)=>wd('\x3cg\x3e\x3cpath d\x3d"M22.4789 9.45728L25.9935 12.9942L22.4789 16.5283V14.1032C18.126 14.1502 14.6071 17.6737 14.5675 22.0283H17.05L13.513 25.543L9.97889 22.0283H12.5674C12.6071 16.5691 17.0214 12.1503 22.4789 12.1031L22.4789 9.45728Z" fill\x3d"black"/\x3e\x3cpath fill-rule\x3d"evenodd" clip-rule\x3d"evenodd" d\x3d"M21.4789 7.03223L27.4035 12.9945L21.4789 18.9521V15.1868C18.4798 15.6549 16.1113 18.0273 15.649 21.0284H19.475L13.5128 26.953L7.55519 21.0284H11.6189C12.1243 15.8155 16.2679 11.6677 21.4789 11.1559L21.4789 7.03223ZM22.4789 12.1031C17.0214 12.1503 12.6071 16.5691 12.5674 22.0284H9.97889L13.513 25.543L17.05 22.0284H14.5675C14.5705 21.6896 14.5947 21.3558 14.6386 21.0284C15.1157 17.4741 17.9266 14.6592 21.4789 14.1761C21.8063 14.1316 22.1401 14.1069 22.4789 14.1032V16.5284L25.9935 12.9942L22.4789 9.45729L22.4789 12.1031Z" fill\x3d"white"/\x3e\x3c/g\x3e',
c+90,n),["senw-rotate"]:(c,n)=>wd('\x3cg\x3e\x3cpath d\x3d"M22.4789 9.45728L25.9935 12.9942L22.4789 16.5283V14.1032C18.126 14.1502 14.6071 17.6737 14.5675 22.0283H17.05L13.513 25.543L9.97889 22.0283H12.5674C12.6071 16.5691 17.0214 12.1503 22.4789 12.1031L22.4789 9.45728Z" fill\x3d"black"/\x3e\x3cpath fill-rule\x3d"evenodd" clip-rule\x3d"evenodd" d\x3d"M21.4789 7.03223L27.4035 12.9945L21.4789 18.9521V15.1868C18.4798 15.6549 16.1113 18.0273 15.649 21.0284H19.475L13.5128 26.953L7.55519 21.0284H11.6189C12.1243 15.8155 16.2679 11.6677 21.4789 11.1559L21.4789 7.03223ZM22.4789 12.1031C17.0214 12.1503 12.6071 16.5691 12.5674 22.0284H9.97889L13.513 25.543L17.05 22.0284H14.5675C14.5705 21.6896 14.5947 21.3558 14.6386 21.0284C15.1157 17.4741 17.9266 14.6592 21.4789 14.1761C21.8063 14.1316 22.1401 14.1069 22.4789 14.1032V16.5284L25.9935 12.9942L22.4789 9.45729L22.4789 12.1031Z" fill\x3d"white"/\x3e\x3c/g\x3e',
c+180,n),["swne-rotate"]:(c,n)=>wd('\x3cg\x3e\x3cpath d\x3d"M22.4789 9.45728L25.9935 12.9942L22.4789 16.5283V14.1032C18.126 14.1502 14.6071 17.6737 14.5675 22.0283H17.05L13.513 25.543L9.97889 22.0283H12.5674C12.6071 16.5691 17.0214 12.1503 22.4789 12.1031L22.4789 9.45728Z" fill\x3d"black"/\x3e\x3cpath fill-rule\x3d"evenodd" clip-rule\x3d"evenodd" d\x3d"M21.4789 7.03223L27.4035 12.9945L21.4789 18.9521V15.1868C18.4798 15.6549 16.1113 18.0273 15.649 21.0284H19.475L13.5128 26.953L7.55519 21.0284H11.6189C12.1243 15.8155 16.2679 11.6677 21.4789 11.1559L21.4789 7.03223ZM22.4789 12.1031C17.0214 12.1503 12.6071 16.5691 12.5674 22.0284H9.97889L13.513 25.543L17.05 22.0284H14.5675C14.5705 21.6896 14.5947 21.3558 14.6386 21.0284C15.1157 17.4741 17.9266 14.6592 21.4789 14.1761C21.8063 14.1316 22.1401 14.1069 22.4789 14.1032V16.5284L25.9935 12.9942L22.4789 9.45729L22.4789 12.1031Z" fill\x3d"white"/\x3e\x3c/g\x3e',
c+270,n)},LA=Lf(Z(69));Lf(Z(69));var Mw=Z(69),Nw=Lf(Z(69));if(!Z(69).useState)throw Error("mobx-react-lite requires React with Hooks support");if(!Ec)throw Error("mobx-react-lite@3 requires mobx at least version 6 to be available");var MA=Z(70),Kq=Lf(Z(69)),Ow="undefined"===typeof FinalizationRegistry?void 0:FinalizationRegistry,NA=1E4,OA=function(c){var n="function"===typeof Symbol&&Symbol.iterator,N=n&&c[n],da=0;if(N)return N.call(c);if(c&&"number"===typeof c.length)return{next:function(){c&&da>=
c.length&&(c=void 0);return{value:c&&c[da++],done:!c}}};throw new TypeError(n?"Object is not iterable.":"Symbol.iterator is not defined.");},Pw=Ow?de(Ow):Ge(),PA=Pw.addReactionToTrack,QA=Pw.recordReactionAsCommitted,Qw=function(c,n){var N="function"===typeof Symbol&&c[Symbol.iterator];if(!N)return c;c=N.call(c);var da,ua=[];try{for(;(void 0===n||0<n--)&&!(da=c.next()).done;)ua.push(da.value)}catch(Ma){var Ga={error:Ma}}finally{try{da&&!da.done&&(N=c["return"])&&N.call(c)}finally{if(Ga)throw Ga.error;
}}return ua},RA=function(){return function(){}}(),tp=Z(69),Rw="function"===typeof Symbol&&Symbol.for,Sw=Rw?Symbol.for("react.forward_ref"):"function"===typeof tp.forwardRef&&(0,tp.forwardRef)(function(c){return null}).$$typeof,Tw=Rw?Symbol.for("react.memo"):"function"===typeof tp.memo&&(0,tp.memo)(function(c){return null}).$$typeof,SA={$$typeof:!0,render:!0,compare:!0,type:!0,displayName:!0};Df.displayName="Observer";Z(69);Z(69);Z(69);(function(c){c||=ne;pb({reactionScheduler:c})})(MA.unstable_batchedUpdates);
var TA=Lf(Z(69)),vt=Z(288),$k=TA.forwardRef(function(c,n){var {children:N,opacity:da,centered:ua,className:Ga=""}=c,Ma=Zi(c,["children","opacity","centered","className"]);return(0,vt.jsx)(Df,{children:()=>(0,vt.jsx)("div",{ref:n,className:`tl-positioned-div ${Ga}`,style:da?{opacity:da}:void 0,draggable:!1,children:(0,vt.jsx)("div",kg(Af({className:`tl-positioned-inner ${ua?"tl-centered":""}`},Ma),{children:N}))})})}),UA=Lf(Z(69)),wt=Z(288),zl=UA.forwardRef(function(c,n){var {id:N,className:da="",
style:ua,children:Ga}=c,Ma=Zi(c,["id","className","style","children"]);return(0,wt.jsx)(Df,{children:()=>(0,wt.jsx)("svg",{ref:n,style:ua,className:`tl-positioned-svg ${da}`,children:(0,wt.jsx)("g",kg(Af({id:N,className:"tl-centered-g"},Ma),{children:Ga}))})})}),Lq=Lf(Z(69)),Uw=Lf(Z(69)),Kr=Lf(Z(69)),VA=Z(288),pn=ue(function(c){var {id:n,bounds:N,zIndex:da,rotation:ua=0,className:Ga="",children:Ma}=c;c=Zi(c,"id bounds zIndex rotation className children".split(" "));const fb=Kr.useRef(null);Kr.useLayoutEffect(()=>
{fb.current.style.transform=`translate(
        calc(${N.minX}px - var(--tl-padding)),
        calc(${N.minY}px - var(--tl-padding)))
        rotate(${ua+(N.rotation||0)}rad)`},[N.minX,N.minY,ua,N.rotation]);Kr.useLayoutEffect(()=>{const vb=fb.current;vb.style.width=`calc(${Math.floor(N.width)}px + (var(--tl-padding) * 2))`;vb.style.height=`calc(${Math.floor(N.height)}px + (var(--tl-padding) * 2))`},[N.width,N.height]);Kr.useLayoutEffect(()=>{const vb=fb.current;void 0!==da&&(vb.style.zIndex=da.toString())},[da]);return(0,VA.jsx)("div",kg(Af({id:n,ref:fb,className:`tl-positioned ${Ga}`,"aria-label":"container"},c),{children:Ma}))}),
WA=Lf(Z(69)),Vw=Z(288),XA=ue(function({shapes:c,hidden:n,bounds:N,rotation:da=0}){const {components:{ContextBar:ua},viewport:{bounds:Ga,camera:{point:[Ma,fb],zoom:vb}}}=od(),Wb=WA.useRef(null);var oc=Je.getRotatedBounds(N,da);oc=Je.multiplyBounds(oc,vb);wb(Wb,N,da,10005);if(!ua)throw Error("Expected a ContextBar component.");const xc=Je.translateBounds(oc,[Ma*vb,fb*vb]);return(0,Vw.jsx)("div",{ref:Wb,className:"tl-counter-scaled-positioned","aria-label":"context-bar-container","data-html2canvas-ignore":"true",
children:(0,Vw.jsx)(ua,{hidden:n,shapes:c,bounds:N,offsets:{left:xc.minX,right:Ga.width-xc.maxX,top:xc.minY,bottom:Ga.height-xc.maxY,width:xc.width,height:xc.height},scaledBounds:oc,rotation:da})})}),Ww=Lf(Z(69)),YA=Z(288),Xw=ue(function({children:c}){const n=Ww.useRef(null),{viewport:N}=od(),da=n.current,{zoom:ua,point:Ga}=N.camera;Ww.useEffect(()=>{da&&(da.style.transform=`scale(${ua}) translate3d(${Ga[0]}px, ${Ga[1]}px, 0)`)},[ua,Ga,da]);return(0,YA.jsx)("div",{ref:n,className:"tl-absolute tl-layer",
children:c})}),Lr=Z(288),Yw=ue(function({shape:c,isHovered:n=!1,isSelected:N=!1,isBinding:da=!1,isEditing:ua=!1,isLocked:Ga=!1,meta:Ma}){const {bounds:fb,props:{scale:vb,rotation:Wb=0},ReactIndicator:oc}=c;return(0,Lr.jsx)(pn,{"data-type":"Indicator","data-html2canvas-ignore":"true",bounds:fb,rotation:Wb,scale:vb,zIndex:ua?1E3:1E4,children:(0,Lr.jsx)(zl,{children:(0,Lr.jsx)("g",{className:`tl-indicator-container ${N?"tl-selected":"tl-hovered"} ${Ga?"tl-locked":""}`,children:(0,Lr.jsx)(oc,{isEditing:ua,
isBinding:da,isHovered:n,isLocked:Ga,isSelected:N,isErasing:!1,meta:Ma})})})})}),Zw=Lf(Z(69)),Mr=Z(288),ZA=ue(function({bounds:c,shape:n}){const {viewport:{camera:{zoom:N}},components:{QuickLinks:da}}=od();var ua=Te();const Ga=Ig(n);if(!da)throw Error("Expected a QuickLinks component.");ua=50>c.height*N||!ua.selectedShapesArray.includes(n);return(0,Mr.jsx)(pn,{bounds:c,className:"tl-quick-links-container","data-html2canvas-ignore":"true",children:(0,Mr.jsx)($k,{children:(0,Mr.jsx)("span",kg(Af({style:{position:"absolute",
top:"100%",pointerEvents:"all",transformOrigin:"left top",paddingTop:"8px",transform:"scale(var(--tl-scale))",minWidth:"320px"}},Ga),{onPointerDown:Ma=>Ma.stopPropagation(),children:(0,Mr.jsx)(da,{className:"tl-backlinks-count "+(ua?"tl-backlinks-count-rounded":""),id:n.id,shape:n})}))})})}),Nr=Z(288),$A=ue(function({bounds:c,shape:n}){const {viewport:{camera:{zoom:N}},components:{BacklinksCount:da}}=od();var ua=Te();if(!da)throw Error("Expected a BacklinksCount component.");const Ga=Ma=>Ma.stopPropagation();
ua=50>c.height*N||!ua.selectedShapesArray.includes(n)||n.hideSelection;return(0,Nr.jsx)(pn,{bounds:c,className:"tl-backlinks-count-container",children:(0,Nr.jsx)($k,{children:(0,Nr.jsx)("span",{style:{position:"absolute",left:"100%",pointerEvents:"all",transformOrigin:"left top",transform:"translateY(6px) scale(var(--tl-scale))"},onPointerDown:Ga,onWheelCapture:Ga,onKeyDown:Ga,title:"Shape Backlinks",children:(0,Nr.jsx)(da,{className:"tl-backlinks-count "+(ua?"tl-backlinks-count-rounded":""),id:n.id,
shape:n})})})})}),aB=Lf(Z(69)),$w=Z(288),bB=ue(function({bounds:c,hidden:n,shapes:N,rotation:da=0,detail:ua="size"}){const {components:{SelectionDetail:Ga},viewport:{camera:{zoom:Ma}}}=od(),fb=aB.useRef(null),vb=Je.multiplyBounds(c,Ma);wb(fb,c,da,10003);if(!Ga)throw Error("Expected a SelectionDetail component.");return(0,$w.jsx)("div",{ref:fb,className:`tl-counter-scaled-positioned ${n?"tl-fade-out":""}`,"aria-label":"bounds-detail-container","data-html2canvas-ignore":"true",children:(0,$w.jsx)(Ga,
{shapes:N,bounds:c,scaledBounds:vb,zoom:Ma,rotation:da,detail:ua})})}),ax=Z(288),cB=ue(function({shape:c,isHovered:n=!1,isSelected:N=!1,isBinding:da=!1,isErasing:ua=!1,isEditing:Ga=!1,onEditingEnd:Ma,asset:fb,meta:vb,zIndex:Wb}){const {bounds:oc,props:{rotation:xc,scale:Uc},ReactComponent:md}=c,hd=Te(),Bd=Ig(c);var Ld=hd.getParentGroup(c);Ld=hd.selectedIds.has(null==Ld?void 0:Ld.id);return(0,ax.jsx)(pn,{"data-shape-id":c.id,"data-html2canvas-ignore":!N&&!Ld&&0!==hd.selectedShapes.size||null,zIndex:Wb,
"data-type":"Shape",bounds:oc,rotation:xc,scale:Uc,children:(0,ax.jsx)(md,{meta:vb,isEditing:Ga,isBinding:da,isHovered:n,isSelected:N,isErasing:ua,events:Bd,asset:fb,onEditingEnd:Ma})})}),up=Z(288),bx=[[-1,.15,64],[.05,.375,16],[.15,1,4],[.7,2.5,1]],dB=ue(function({size:c}){const {viewport:{camera:{point:n,zoom:N}}}=od();return(0,up.jsxs)("svg",{className:"tl-grid",version:"1.1",xmlns:"http://www.w3.org/2000/svg","data-html2canvas-ignore":"true",children:[(0,up.jsx)("defs",{children:bx.map(([da,ua,
Ga],Ma)=>{Ga=Ga*c*N;var fb=n[0]*N,vb=n[1]*N;fb=0<fb?fb%Ga:Ga+fb%Ga;vb=0<vb?vb%Ga:Ga+vb%Ga;da=Wi(N,[da,ua],[0,1]);return(0,up.jsx)("pattern",{id:`grid-${Ma}`,width:Ga,height:Ga,patternUnits:"userSpaceOnUse",children:!(2<da||.1>da)&&(0,up.jsx)("circle",{className:"tl-grid-dot",cx:fb,cy:vb,r:1.5,opacity:Math.max(0,Math.min(da,1))})},`grid-pattern-${Ma}`)})}),bx.map((da,ua)=>(0,up.jsx)("rect",{width:"100%",height:"100%",fill:`url(#grid-${ua})`},`grid-rect-${ua}`))]})}),cx=ue(function({size:c}){return(0,up.jsx)(dB,
{size:c})}),dx=Z(288),ex=ue(function({bounds:c}){const n=Vd("background");return(0,dx.jsx)(zl,kg(Af({"data-html2canvas-ignore":"true"},n),{children:(0,dx.jsx)("rect",{className:"tl-bounds-bg",width:Math.max(1,c.width),height:Math.max(1,c.height),pointerEvents:"all",rx:8,ry:8})}))});Z(69);var fx=Z(288),gx=ue(function({scaledBounds:c,shapes:n,detail:N="size",rotation:da=0}){var ua;const Ga=1===n.length?da:null!=(ua=c.rotation)?ua:0;return(0,fx.jsx)($k,{centered:!0,children:(0,fx.jsx)("div",{className:"tl-bounds-detail",
style:{transform:Ga<ei||Ga>3*ei?`rotate(${Ga}rad) translateY(${c.height/2+24}px)`:`rotate(${Math.PI+Ga}rad) translateY(${c.height/2+32}px)`,padding:"2px 3px",borderRadius:"1px"},children:1===n.length&&"line"===n[0].type?`${pe.dist(n[0].props.handles.start.point,n[0].props.handles.end.point).toFixed()}`:"size"===N?`${c.width.toFixed()} \xD7 ${c.height.toFixed()}`:`\u2220${Dh.radiansToDegrees(Dh.clampRadians(da)).toFixed()}\xB0`})})}),xt=Z(288),eB={top_left_corner:"tl-cursor-nwse",top_right_corner:"tl-cursor-nesw",
bottom_right_corner:"tl-cursor-nwse",bottom_left_corner:"tl-cursor-nesw"},Or=ue(function({cx:c,cy:n,size:N,targetSize:da,corner:ua,isHidden:Ga}){const Ma=Vd(ua);return(0,xt.jsxs)("g",kg(Af({opacity:Ga?0:1},Ma),{children:[(0,xt.jsx)("rect",{className:"tl-transparent "+(Ga?"":eB[ua]),"aria-label":`${ua} target`,x:c-1.25*da,y:n-1.25*da,width:2.5*da,height:2.5*da,pointerEvents:Ga?"none":"all"}),(0,xt.jsx)("rect",{className:"tl-corner-handle","aria-label":`${ua} handle`,x:c-N/2,y:n-N/2,width:N,height:N,
pointerEvents:"none"})]}))}),Pr=Z(288),yt=ue(function({cx:c,cy:n,size:N,direction:da,isHidden:ua}){const Ga=Te();return(0,Pr.jsxs)("g",{className:"tl-clone-handle",opacity:ua?0:1,children:[(0,Pr.jsx)("circle",{"aria-label":`${da} handle`,pointerEvents:"all",onPointerDown:Ma=>Ga.api.clone(da),cx:c,cy:n,r:N}),(0,Pr.jsx)("line",{x1:c-N/2,y1:n,x2:c+N/2,y2:n}),(0,Pr.jsx)("line",{x1:c,y1:n-N/2,x2:c,y2:n+N/2})]})}),fB=Z(288),gB={top_edge:"tl-cursor-ns",right_edge:"tl-cursor-ew",bottom_edge:"tl-cursor-ns",
left_edge:"tl-cursor-ew"},Qr=ue(function({x:c,y:n,width:N,height:da,targetSize:ua,edge:Ga,disabled:Ma,isHidden:fb}){const vb=Vd(Ga);return(0,fB.jsx)("rect",Af({pointerEvents:fb||Ma?"none":"all",className:"tl-transparent tl-edge-handle "+(fb?"":gB[Ga]),"aria-label":`${Ga} target`,opacity:fb?0:1,x:c-ua,y:n-ua,width:Math.max(1,N+2*ua),height:Math.max(1,da+2*ua)},vb))}),zt=Z(288);ue(function({cx:c,cy:n,size:N,targetSize:da,isHidden:ua}){const Ga=Vd("rotate");return(0,zt.jsxs)("g",kg(Af({opacity:ua?0:
1},Ga),{children:[(0,zt.jsx)("circle",{className:"tl-transparent ","aria-label":"rotate target",cx:c,cy:n,r:da,pointerEvents:ua?"none":"all"}),(0,zt.jsx)("circle",{className:"tl-rotate-handle","aria-label":"rotate handle",cx:c,cy:n,r:N/2,pointerEvents:"none"})]}))});Z(69);var hx=Z(288),Rr=ue(function({cx:c,cy:n,targetSize:N,corner:da,isHidden:ua}){const Ga=Vd(da);return(0,hx.jsx)("g",kg(Af({opacity:ua?0:1},Ga),{children:(0,hx.jsx)("rect",{className:"tl-transparent","aria-label":`${da} target`,x:c-
2.5*N,y:n-2.5*N,width:3*N,height:3*N,pointerEvents:ua?"none":"all"})}))}),Ij=Z(288),ix=ue(function({bounds:c,showResizeHandles:n,showRotateHandles:N,showCloneHandles:da,shapes:ua}){var Ga,Ma;const fb=Te();let {width:vb,height:Wb}=c;var oc=fb.viewport.camera.zoom;c=8/oc;const xc=6/oc;oc=30/oc;const Uc=2*c,md=1===ua.length?ua[0].canResize:[!0,!0],hd=null!=(Ma=null==(Ga=fb.editingShape)?void 0:Ga.props.borderRadius)?Ma:0;return(0,Ij.jsx)(Ij.Fragment,{children:0<ua.length&&(0,Ij.jsxs)(zl,{children:[!fb.editingShape&&
(0,Ij.jsx)("rect",{className:"tl-bounds-fg",width:Math.max(vb,1),height:Math.max(Wb,1),rx:hd,ry:hd,pointerEvents:"none"}),(0,Ij.jsx)(Qr,{x:2*xc,y:0,width:vb-4*xc,height:0,targetSize:xc,edge:"top_edge",disabled:!md[1],isHidden:!n}),(0,Ij.jsx)(Qr,{x:vb,y:2*xc,width:0,height:Wb-4*xc,targetSize:xc,edge:"right_edge",disabled:!md[0],isHidden:!n}),(0,Ij.jsx)(Qr,{x:2*xc,y:Wb,width:vb-4*xc,height:0,targetSize:xc,edge:"bottom_edge",disabled:!md[1],isHidden:!n}),(0,Ij.jsx)(Qr,{x:0,y:2*xc,width:0,height:Wb-4*
xc,targetSize:xc,edge:"left_edge",disabled:!md[0],isHidden:!n}),(0,Ij.jsx)(Rr,{cx:0,cy:0,targetSize:xc,corner:"top_left_resize_corner",isHidden:!N}),(0,Ij.jsx)(Rr,{cx:vb+2*xc,cy:0,targetSize:xc,corner:"top_right_resize_corner",isHidden:!N}),(0,Ij.jsx)(Rr,{cx:vb+2*xc,cy:Wb+2*xc,targetSize:xc,corner:"bottom_right_resize_corner",isHidden:!N}),(0,Ij.jsx)(Rr,{cx:0,cy:Wb+2*xc,targetSize:xc,corner:"bottom_left_resize_corner",isHidden:!N}),(0,Ij.jsx)(yt,{cx:-oc,cy:Wb/2,size:Uc,direction:"left",isHidden:!da}),
(0,Ij.jsx)(yt,{cx:vb+oc,cy:Wb/2,size:Uc,direction:"right",isHidden:!da}),(0,Ij.jsx)(yt,{cx:vb/2,cy:Wb+oc,size:Uc,direction:"down",isHidden:!da}),(null==md?void 0:md.every(Bd=>Bd))&&(0,Ij.jsxs)(Ij.Fragment,{children:[(0,Ij.jsx)(Or,{cx:0,cy:0,size:c,targetSize:xc,corner:"top_left_corner",isHidden:!n}),(0,Ij.jsx)(Or,{cx:vb,cy:0,size:c,targetSize:xc,corner:"top_right_corner",isHidden:!n}),(0,Ij.jsx)(Or,{cx:vb,cy:Wb,size:c,targetSize:xc,corner:"bottom_right_corner",isHidden:!n}),(0,Ij.jsx)(Or,{cx:0,cy:Wb,
size:c,targetSize:xc,corner:"bottom_left_corner",isHidden:!n})]})]})})}),At=Z(288),jx=ue(function({bounds:c}){return(0,At.jsx)(pn,{bounds:c,zIndex:10001,children:(0,At.jsx)(zl,{children:(0,At.jsx)("rect",{className:"tl-brush",x:0,y:0,width:c.width,height:c.height})})})}),kx=Z(288);ue(function(){return(0,kx.jsx)(kx.Fragment,{})});var Bt=Z(288),lx=ue(function({shape:c,handle:n,id:N}){c=nd(c,N);const [da,ua]=n.point;return(0,Bt.jsxs)("g",kg(Af({className:"tl-handle","aria-label":"handle"},c),{transform:`translate(${da}, ${ua})`,
children:[(0,Bt.jsx)("circle",{className:"tl-handle-bg",pointerEvents:"all"}),(0,Bt.jsx)("circle",{className:"tl-counter-scaled tl-handle",pointerEvents:"none",r:4})]}))}),mx=Lf(Z(69)),Ct=Z(288),Dt=ue(function({direction:c}){const {viewport:{bounds:n}}=od(),N=mx.useRef(null);mx.useLayoutEffect(()=>{const da=N.current;if(da){var ua=[n.width/2,n.height/2],Ga=Je.getRectangleSides([12,12],[n.width-24,n.height-24]);for(const [,[Ma,fb]]of Ga)Ga=q(ua,c,Ma,fb),Ga.didIntersect&&(Ga=Ga.points[0],da.style.transform=
`translate(${Ga[0]-6}px,${Ga[1]-6}px) rotate(${pe.toAngle(c)}rad)`)}},[c,n]);return(0,Ct.jsx)("div",{ref:N,className:"tl-direction-indicator","data-html2canvas-ignore":"true",children:(0,Ct.jsx)("svg",{height:12,width:12,children:(0,Ct.jsx)("polygon",{points:"0,0 12,6 0,12"})})})}),lj=Z(288),hB=ue(function({id:c,className:n,brush:N,shapes:da,assets:ua,bindingShapes:Ga,editingShape:Ma,hoveredShape:fb,hoveredGroup:vb,selectionBounds:Wb,selectedShapes:oc,erasingShapes:xc,selectionDirectionHint:Uc,cursor:md=
"default",cursorRotation:hd=0,selectionRotation:Bd=0,showSelection:Ld=!0,showHandles:bd=!0,showSelectionRotation:jd=!1,showResizeHandles:rd=!0,showRotateHandles:Md=!0,showCloneHandles:Dd=!0,showSelectionDetail:Oe=!0,showContextBar:Pe=!0,showGrid:cg=!0,gridSize:cf=8,onEditingEnd:Of=aA,theme:Hg=Ai,children:ah}){var Eg;const bh=Lq.useRef(null),{viewport:vf,components:Ef,meta:xf}=od(),Vf=Te(),ch=Lq.useCallback(Wg=>{Vf.inputs.updateContainerOffset([Wg.minX,Wg.minY])},[]);le(Hg,c);$c(bh);se(bh,vf,ch);Ne(bh);
be();yd(bh,md,hd);Jd(bh);pg(bh);c=$f();const Fh=(md=1===(null==oc?void 0:oc.length)&&oc[0])&&"handles"in md.props?null==oc?void 0:oc[0]:void 0,Vi=Lq.useMemo(()=>new Set(oc||[]),[oc]),hi=Lq.useMemo(()=>new Set(xc||[]),[xc]);md=1===(null==oc?void 0:oc.length)?oc[0]:void 0;vb=[...(new Set([vb,fb]))].filter(Kc);return(0,lj.jsxs)("div",{ref:bh,className:`tl-container ${null!=n?n:""}`,children:[(0,lj.jsxs)("div",kg(Af({tabIndex:-1,className:"tl-absolute tl-canvas"},c),{children:[cg&&Ef.Grid&&(0,lj.jsx)(Ef.Grid,
{size:cf}),(0,lj.jsxs)(Xw,{children:[Ef.SelectionBackground&&oc&&Wb&&Ld&&(0,lj.jsx)(pn,{"data-type":"SelectionBackground",bounds:Wb,zIndex:2,"data-html2canvas-ignore":"true",children:(0,lj.jsx)(Ef.SelectionBackground,{shapes:oc,bounds:Wb,showResizeHandles:rd,showRotateHandles:Md})}),da&&da.map((Wg,Ki)=>(0,lj.jsx)(cB,{shape:Wg,asset:ua&&Wg.props.assetId?ua[Wg.props.assetId]:void 0,isEditing:Wg===Ma,isHovered:Wg===fb,isBinding:null==Ga?void 0:Ga.includes(Wg),isSelected:Vi.has(Wg),isErasing:hi.has(Wg),
meta:xf,zIndex:1E3+Ki,onEditingEnd:Of},"shape_"+Wg.id)),!Vf.isIn("select.pinching")&&(null==oc?void 0:oc.map(Wg=>(0,lj.jsx)(Yw,{shape:Wg,isEditing:Wg===Ma,isHovered:!1,isBinding:!1,isSelected:!0,isLocked:Wg.props.isLocked},"selected_indicator_"+Wg.id))),vb.map(Wg=>Wg!==Ma&&(0,lj.jsx)(Yw,{shape:Wg},"hovered_indicator_"+Wg.id)),md&&Ef.BacklinksCount&&(0,lj.jsx)($A,{hidden:!1,bounds:md.bounds,shape:md}),fb&&fb!==md&&Ef.QuickLinks&&(0,lj.jsx)(ZA,{hidden:!1,bounds:fb.bounds,shape:fb}),N&&Ef.Brush&&(0,lj.jsx)(Ef.Brush,
{bounds:N}),oc&&Wb&&(0,lj.jsxs)(lj.Fragment,{children:[Ld&&Ef.SelectionForeground&&(0,lj.jsx)(pn,{"data-type":"SelectionForeground","data-html2canvas-ignore":"true",bounds:Wb,zIndex:Ma&&oc.includes(Ma)?1002:10002,children:(0,lj.jsx)(Ef.SelectionForeground,{shapes:oc.filter(Wg=>!Wg.props.isLocked),bounds:Wb,showResizeHandles:rd,showRotateHandles:Md,showCloneHandles:Dd})}),bd&&Fh&&Ef.Handle&&(0,lj.jsx)(pn,{"data-type":"onlySelectedShapeWithHandles","data-html2canvas-ignore":"true",bounds:Wb,zIndex:10003,
children:(0,lj.jsx)(zl,{children:Object.entries(null!=(Eg=Fh.props.handles)?Eg:{}).map(([Wg,Ki])=>Lq.createElement(Ef.Handle,{key:`${Ki.id}_handle_${Ki.id}`,shape:Fh,handle:Ki,id:Wg}))})}),oc&&Ef.SelectionDetail&&(0,lj.jsx)(bB,{"data-html2canvas-ignore":"true",shapes:oc,bounds:Wb,detail:jd?"rotation":"size",hidden:!Oe,rotation:Bd},"detail"+oc.map(Wg=>Wg.id).join(""))]})]}),Uc&&Wb&&oc&&(0,lj.jsx)(Dt,{direction:Uc,bounds:Wb,shapes:oc}),(0,lj.jsx)("div",{id:"tl-dev-tools-canvas-anchor","data-html2canvas-ignore":"true"})]})),
(0,lj.jsx)(Xw,{children:oc&&Wb&&(0,lj.jsx)(lj.Fragment,{children:oc&&Ef.ContextBar&&(0,lj.jsx)(XA,{shapes:oc.filter(Wg=>!Wg.props.isLocked),hidden:!Pe,bounds:md?md.bounds:Wb,rotation:md?md.props.rotation:0},"context"+oc.map(Wg=>Wg.id).join(""))})}),ah]})}),nx=Lf(Z(69)),ox=Lf(Z(69)),px=Z(288);ue(function({children:c}){const n=ox.useRef(null),{viewport:N}=od();ox.useEffect(()=>kc(()=>{const da=n.current;if(da){var {zoom:ua,point:Ga}=N.camera;da.style.transform=`scale(${ua}) translateX(${Ga[0]}px) translateY(${Ga[1]}px)`}}),
[]);return(0,px.jsx)("svg",{className:"tl-absolute tl-overlay",pointerEvents:"none",children:(0,px.jsx)("g",{ref:n,pointerEvents:"none",children:c})})});var iB=Z(288),jB=ue(function(c){const n=sc(c),N=Ie(c.id);Sc(n,c);wc(n,c);return(0,iB.jsx)(N.Provider,{value:n,children:c.children})}),kB=Z(288),lB=ue(function({id:c="noid",viewport:n,inputs:N,callbacks:da=Ai,meta:ua=Ai,components:Ga=Ai,children:Ma}){const [fb,vb]=nx.useState(()=>{const {Brush:oc,ContextBar:xc,DirectionIndicator:Uc,Grid:md,Handle:hd,
SelectionBackground:Bd,SelectionDetail:Ld,SelectionForeground:bd}=Ga,jd=Zi(Ga,"Brush ContextBar DirectionIndicator Grid Handle SelectionBackground SelectionDetail SelectionForeground".split(" "));return{id:c,viewport:n,inputs:N,callbacks:da,meta:ua,components:kg(Af({},jd),{Brush:null===oc?void 0:jx,ContextBar:xc,DirectionIndicator:null===Uc?void 0:Dt,Grid:null===md?void 0:cx,Handle:null===hd?void 0:lx,SelectionBackground:null===Bd?void 0:ex,SelectionDetail:null===Ld?void 0:gx,SelectionForeground:null===
bd?void 0:ix})}});nx.useLayoutEffect(()=>{const {Brush:oc,ContextBar:xc,DirectionIndicator:Uc,Grid:md,Handle:hd,SelectionBackground:Bd,SelectionDetail:Ld,SelectionForeground:bd}=Ga,jd=Zi(Ga,"Brush ContextBar DirectionIndicator Grid Handle SelectionBackground SelectionDetail SelectionForeground".split(" "));return kc(()=>{vb({id:c,viewport:n,inputs:N,callbacks:da,meta:ua,components:kg(Af({},jd),{Brush:null===oc?void 0:jx,ContextBar:xc,DirectionIndicator:null===Uc?void 0:Dt,Grid:null===md?void 0:cx,
Handle:null===hd?void 0:lx,SelectionBackground:null===Bd?void 0:ex,SelectionDetail:null===Ld?void 0:gx,SelectionForeground:null===bd?void 0:ix})})})},[]);const Wb=cd(c);return(0,kB.jsx)(Wb.Provider,{value:fb,children:Ma})}),qx=Z(288),mB=Z(288),nB=ue(function(c){const n=Te();return(0,mB.jsx)(Jg,Af({viewport:n.viewport,inputs:n.inputs,callbacks:n._events,brush:n.brush,editingShape:n.editingShape,hoveredShape:n.hoveredShape,hoveredGroup:n.hoveredGroup,bindingShapes:n.bindingShapes,selectionDirectionHint:n.selectionDirectionHint,
selectionBounds:n.selectionBounds,selectedShapes:n.selectedShapesArray,erasingShapes:n.erasingShapesArray,shapes:n.shapes,assets:n.assets,showGrid:n.settings.showGrid,penMode:n.settings.penMode,showSelection:n.showSelection,showSelectionRotation:n.showSelectionRotation,showResizeHandles:n.showResizeHandles,showRotateHandles:n.showRotateHandles,showCloneHandles:n.showCloneHandles,showSelectionDetail:n.showSelectionDetail,showContextBar:n.showContextBar,cursor:n.cursors.cursor,cursorRotation:n.cursors.rotation,
selectionRotation:n.selectionRotation,onEditingEnd:n.clearEditingState},c))});Z(288);var vp=Lf(Z(69)),qn=Lf(Z(69)),oB=Z(288),pB="add-link block-search block connector group internal-link link-to-block link-to-page link-to-whiteboard move-to-sidebar-right object-compact object-expanded open-as-page page-search page references-hide references-show select-cursor text ungroup whiteboard-element whiteboard".split(" "),eh=c=>{var {name:n,className:N}=c;c=Zi(c,["name","className"]);const da=pB.includes(n)?
"tie tie-":"ti ti-";return(0,oB.jsx)("i",Af({className:[da+n,N].join(" ")},c))},wo=Z(288),Mq=window.LSUI,rx=Z(288),Et=Z(288),qB=({style:c,icon:n,onClick:N})=>(0,Et.jsx)("button",{"data-html2canvas-ignore":"true",style:c,className:"tl-circle-button",onPointerDown:N,children:(0,Et.jsx)("div",{className:"tl-circle-button-icons-wrapper",children:(0,Et.jsx)(eh,{name:n})})}),Ft=Z(288),rB=window.LSUI,vi=Lf(Z(69)).default.createContext({}),sB=Lf(Z(69)),sx=Z(288),ak=c=>{var {action:n,shortcut:N,opts:da}=c;
c=Zi(c,["action","shortcut","opts"]);var {renderers:ua}=sB.useContext(vi);ua=null==ua?void 0:ua.KeyboardShortcut;return(0,sx.jsx)("div",kg(Af({className:"tl-menu-right-slot"},c),{children:(0,sx.jsx)(ua,{action:n,shortcut:N,opts:da})}))},al=Z(288),rn=window.LSUI,tB=ue(function(){const c=Te(),n=N=>{N.preventDefault()};return(0,al.jsxs)(rn.DropdownMenu,{children:[(0,al.jsx)(rn.DropdownMenuTrigger,{className:"tl-button text-sm px-2 important",id:"tl-zoom",children:(100*c.viewport.camera.zoom).toFixed(0)+
"%"}),(0,al.jsxs)(rn.DropdownMenuContent,{onCloseAutoFocus:N=>N.preventDefault(),id:"zoomPopup",sideOffset:12,children:[(0,al.jsxs)(rn.DropdownMenuItem,{onSelect:n,onClick:c.api.zoomToFit,children:["Zoom to drawing",(0,al.jsx)(ak,{action:"whiteboard/zoom-to-fit"})]}),(0,al.jsxs)(rn.DropdownMenuItem,{onSelect:n,onClick:c.api.zoomToSelection,disabled:0===c.selectedShapesArray.length,children:["Zoom to fit selection",(0,al.jsx)(ak,{action:"whiteboard/zoom-to-selection"})]}),(0,al.jsxs)(rn.DropdownMenuItem,
{onSelect:n,onClick:c.api.zoomIn,children:["Zoom in",(0,al.jsx)(ak,{action:"whiteboard/zoom-in"})]}),(0,al.jsxs)(rn.DropdownMenuItem,{onSelect:n,onClick:c.api.zoomOut,children:["Zoom out",(0,al.jsx)(ak,{action:"whiteboard/zoom-out"})]}),(0,al.jsxs)(rn.DropdownMenuItem,{onSelect:n,onClick:c.api.resetZoom,children:["Reset zoom",(0,al.jsx)(ak,{action:"whiteboard/reset-zoom"})]})]})]})}),Jj=Z(288),uB=window.LSUI,vB=ue(function(){const c=Te(),{handlers:{t:n}}=qn.useContext(vi),N=qn.useCallback(()=>{c.api.undo()},
[c]),da=qn.useCallback(()=>{c.api.redo()},[c]),ua=qn.useCallback(()=>{c.api.zoomIn()},[c]),Ga=qn.useCallback(()=>{c.api.zoomOut()},[c]),Ma=qn.useCallback(()=>{c.api.toggleGrid()},[c]),fb=qn.useCallback(()=>{c.api.toggleSnapToGrid()},[c]),vb=qn.useCallback(()=>{c.api.togglePenMode()},[c]);return(0,Jj.jsxs)("div",{className:"tl-action-bar","data-html2canvas-ignore":"true",children:[!c.readOnly&&(0,Jj.jsxs)("div",{className:"tl-toolbar tl-history-bar mr-2 mb-2",children:[(0,Jj.jsx)(kh,{tooltip:n("whiteboard/undo"),
onClick:N,children:(0,Jj.jsx)(eh,{name:"arrow-back-up"})}),(0,Jj.jsx)(kh,{tooltip:n("whiteboard/redo"),onClick:da,children:(0,Jj.jsx)(eh,{name:"arrow-forward-up"})})]}),(0,Jj.jsxs)("div",{className:"tl-toolbar tl-zoom-bar mr-2 mb-2",children:[(0,Jj.jsx)(kh,{tooltip:n("whiteboard/zoom-in"),onClick:ua,id:"tl-zoom-in",children:(0,Jj.jsx)(eh,{name:"plus"})}),(0,Jj.jsx)(kh,{tooltip:n("whiteboard/zoom-out"),onClick:Ga,id:"tl-zoom-out",children:(0,Jj.jsx)(eh,{name:"minus"})}),(0,Jj.jsx)(uB.Separator,{orientation:"vertical"}),
(0,Jj.jsx)(tB,{})]}),(0,Jj.jsxs)("div",{className:"tl-toolbar tl-grid-bar mr-2 mb-2",children:[(0,Jj.jsx)(xg,{tooltip:n("whiteboard/toggle-grid"),className:"tl-button",pressed:c.settings.showGrid,id:"tl-show-grid",onPressedChange:Ma,children:(0,Jj.jsx)(eh,{name:"grid-dots"})}),!c.readOnly&&(0,Jj.jsx)(xg,{tooltip:n("whiteboard/snap-to-grid"),className:"tl-button",pressed:c.settings.snapToGrid,id:"tl-snap-to-grid",onPressedChange:fb,children:(0,Jj.jsx)(eh,{name:c.settings.snapToGrid?"magnet":"magnet-off"})})]}),
!c.readOnly&&(0,Jj.jsx)("div",{className:"tl-toolbar tl-pen-mode-bar mb-2",children:(0,Jj.jsx)(xg,{tooltip:n("whiteboard/toggle-pen-mode"),className:"tl-button",pressed:c.settings.penMode,id:"tl-toggle-pen-mode",onPressedChange:vb,children:(0,Jj.jsx)(eh,{name:c.settings.penMode?"pencil":"pencil-off"})})})]})}),tx=Lf(Z(69)),wB=Lf(Z(70)),Gt=Z(288),Sr=c=>`[${c.map(n=>{var N;return null!=(N=null==n?void 0:n.toFixed(2))?N:"-"}).join(", ")}]`,xB=ue(()=>{var c;const {viewport:{bounds:n,camera:{point:N,zoom:da}},
inputs:ua}=od(),Ga=tx.default.useRef();tx.default.useEffect(()=>{const fb=document.getElementById("tl-statusbar-anchor");Ga.current=fb},[]);const Ma=[["Z",null!=(c=null==da?void 0:da.toFixed(2))?c:"null"],["MP",Sr(ua.currentPoint)],["MS",Sr(ua.currentScreenPoint)],["VP",Sr(N)],["VBR",Sr([n.maxX,n.maxY])]].map(fb=>fb.join("")).join("|");c=Ga.current?wB.default.createPortal((0,Gt.jsx)("div",{style:{flex:1,display:"flex",alignItems:"center"},children:Ma}),Ga.current):null;return(0,Gt.jsx)(Gt.Fragment,
{children:c})}),Nq=Lf(Z(69)),Tr=Z(288),jm=ue(c=>{var {id:n,icon:N,tooltip:da,tooltipSide:ua="left",handleClick:Ga}=c;c=Zi(c,["id","icon","tooltip","tooltipSide","handleClick"]);var Ma;const fb=Te(),vb=null==(Ma=[...fb.Tools,op,pp])?void 0:Ma.find(Wb=>Wb.id===n);Ma=(Ma=null==vb?void 0:vb.shortcut)&&da?(0,Tr.jsxs)("div",{className:"flex",children:[da,(0,Tr.jsx)(ak,{action:Ma})]}):da;return(0,Tr.jsx)(kh,kg(Af({},c),{tooltipSide:ua,tooltip:Ma,"data-tool":n,"data-selected":n===fb.selectedTool.id,onClick:Ga,
children:"string"===typeof N?(0,Tr.jsx)(eh,{name:N}):N}))}),yB=Lf(Z(69)),sn=Z(288),Ht=window.LSUI,ux=ue(function(c){var {popoverSide:n="left",setGeometry:N,activeGeometry:da,chevron:ua=!0}=c;c=Zi(c,["popoverSide","setGeometry","activeGeometry","chevron"]);var {handlers:{t:Ga}}=yB.default.useContext(vi);const Ma=[{id:"box",icon:"square",tooltip:Ga("whiteboard/rectangle")},{id:"ellipse",icon:"circle",tooltip:Ga("whiteboard/circle")},{id:"polygon",icon:"triangle",tooltip:Ga("whiteboard/triangle")}];
Ga={id:"shapes",icon:"triangle-square-circle",tooltip:Ga("whiteboard/shape")};Ga=da?Ma.find(fb=>fb.id===da):Ga;return(0,sn.jsxs)(Ht.Popover,{children:[(0,sn.jsx)(Ht.PopoverTrigger,{asChild:!0,children:(0,sn.jsxs)("div",kg(Af({},c),{className:"tl-geometry-tools-pane-anchor",children:[(0,sn.jsx)(jm,kg(Af({},Ga),{tooltipSide:n})),ua&&(0,sn.jsx)(eh,{"data-selected":da,className:"tl-popover-indicator",name:"chevron-down-left"})]}))}),(0,sn.jsx)(Ht.PopoverContent,{className:"p-0 w-auto",side:n,sideOffset:15,
collisionBoundary:document.querySelector(".logseq-tldraw"),children:(0,sn.jsx)("div",{className:`tl-toolbar tl-geometry-toolbar ${["left","right"].includes(n)?"flex-col":"flex-row"}`,children:Ma.map(fb=>(0,sn.jsx)(jm,{id:fb.id,icon:fb.icon,handleClick:N,tooltipSide:n},fb.id))})})]})}),Ur=Z(288),Vr=window.LSUI,vx=Lf(Z(69)),bk=Z(288),Wr=window.LSUI,zB=Lf(Z(69)),It=Z(69),AB={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",
strokeLinejoin:"round"},BB=((c,n)=>{const N=(0,It.forwardRef)((da,ua)=>{var {color:Ga="currentColor",size:Ma=24,strokeWidth:fb=2,absoluteStrokeWidth:vb,children:Wb}=da;da=Zi(da,["color","size","strokeWidth","absoluteStrokeWidth","children"]);return(0,It.createElement)("svg",Af(kg(Af({ref:ua},AB),{width:Ma,height:Ma,stroke:Ga,strokeWidth:vb?24*Number(fb)/Number(Ma):fb,className:`lucide lucide-${c.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase()}`}),da),[...n.map(([oc,xc])=>(0,It.createElement)(oc,
xc)),...((Array.isArray(Wb)?Wb:[Wb])||[])])});N.displayName=`${c}`;return N})("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]),Fm=Z(288),wp=window.LSUI,CB=Lf(Z(69)),DB=Z(288),Dk=Z(288),wx=window.LSUI,EB=ue(function(){const c=Te(),{handlers:{t:n}}=Nq.useContext(vi),N=Nq.useCallback(Ma=>{c.api.setColor(Ma)},[]),da=Nq.useCallback(Ma=>{(Ma=Ma.currentTarget.dataset.tool)&&c.selectTool(Ma)},[]),[ua,Ga]=Nq.useState(()=>{var Ma;return null!=(Ma=Object.values(nb).find(fb=>fb===c.selectedTool.id))?
Ma:Object.values(nb)[0]});Nq.useEffect(()=>{Ga(Ma=>{var fb;return null!=(fb=Object.values(nb).find(vb=>vb===c.selectedTool.id))?fb:Ma})},[c.selectedTool.id]);return(0,Dk.jsx)("div",{className:"tl-primary-tools","data-html2canvas-ignore":"true",children:(0,Dk.jsxs)("div",{className:"tl-toolbar tl-tools-floating-panel",children:[(0,Dk.jsx)(jm,{handleClick:()=>c.selectTool("select"),tooltip:n("whiteboard/select"),id:"select",icon:"select-cursor"}),(0,Dk.jsx)(jm,{handleClick:()=>c.selectTool("move"),
tooltip:n("whiteboard/pan"),id:"move",icon:c.isIn("move.panning")?"hand-grab":"hand-stop"}),(0,Dk.jsx)(wx.Separator,{orientation:"horizontal"}),(0,Dk.jsx)(jm,{handleClick:()=>c.selectTool("logseq-portal"),tooltip:n("whiteboard/add-block-or-page"),id:"logseq-portal",icon:"circle-plus"}),(0,Dk.jsx)(jm,{handleClick:()=>c.selectTool("pencil"),tooltip:n("whiteboard/draw"),id:"pencil",icon:"ballpen"}),(0,Dk.jsx)(jm,{handleClick:()=>c.selectTool("highlighter"),tooltip:n("whiteboard/highlight"),id:"highlighter",
icon:"highlight"}),(0,Dk.jsx)(jm,{handleClick:()=>c.selectTool("erase"),tooltip:n("whiteboard/eraser"),id:"erase",icon:"eraser"}),(0,Dk.jsx)(jm,{handleClick:()=>c.selectTool("line"),tooltip:n("whiteboard/connector"),id:"line",icon:"connector"}),(0,Dk.jsx)(jm,{handleClick:()=>c.selectTool("text"),tooltip:n("whiteboard/text"),id:"text",icon:"text"}),(0,Dk.jsx)(ux,{activeGeometry:ua,setGeometry:da}),(0,Dk.jsx)(wx.Separator,{orientation:"horizontal",style:{margin:"0 -4px"}}),(0,Dk.jsx)(qf,{popoverSide:"left",
color:c.settings.color,setColor:N}),(0,Dk.jsx)(Si,{scaleLevel:c.settings.scaleLevel,popoverSide:"left",compact:!0})]})})}),Jt=Z(288),FB=ue(function(){const c=Te();return(0,Jt.jsxs)("div",{className:"tl-statusbar","data-html2canvas-ignore":"true",children:[c.selectedTool.id," | ",c.selectedTool.currentState.id,(0,Jt.jsx)("div",{style:{flex:1}}),(0,Jt.jsx)("div",{id:"tl-statusbar-anchor",className:"flex gap-1"})]})}),xp=Z(288),GB=ue(function(){const c=Te();return(0,xp.jsxs)(xp.Fragment,{children:[fc()&&
(0,xp.jsx)(FB,{}),fc()&&(0,xp.jsx)(xB,{}),!c.readOnly&&(0,xp.jsx)(EB,{}),(0,xp.jsx)(vB,{})]})}),Oq=Lf(Z(69)),ck=Lf(Z(69)),xx=Lf(Z(69)),HB=Lf(Z(69)),tn=Z(288),yx=({id:c,showReferenceContent:n=!1})=>{var N;const {handlers:{isWhiteboardPage:da,redirectToPage:ua,sidebarAddBlock:Ga,queryBlockByUUID:Ma},renderers:{Breadcrumb:fb,PageName:vb}}=HB.default.useContext(vi);var Wb="";let oc=og(c)?"B":"P",xc="";if(og(c)){Wb=Ma(c);if(!Wb)return(0,tn.jsx)("span",{className:"p-2",children:"Invalid reference. Did you remove it?"});
xc=Wb.title;Wb="whiteboard-shape"===(null==(N=Wb.properties)?void 0:N["ls-type"])?"link-to-whiteboard":"link-to-block"}else Wb=da(c)?"link-to-whiteboard":"link-to-page";N=xc&&23<xc.length?xc.slice(0,20)+"...":xc;return(0,tn.jsxs)("button",{className:"inline-flex gap-1 items-center w-full",onPointerDown:Uc=>{Uc.stopPropagation();Uc.shiftKey?Ga(c,"B"===oc?"block":"page"):ua(c)},children:[(0,tn.jsx)(eh,{name:Wb}),(0,tn.jsx)("span",{className:"pointer-events-none block-link-reference-row",children:"P"===
oc?(0,tn.jsx)(vb,{pageName:c}):(0,tn.jsxs)(tn.Fragment,{children:[(0,tn.jsx)(fb,{levelLimit:1,blockId:c,endSeparator:n}),n&&N]})})]})},lk=Lf(Z(69)),Kk=Z(69),IB=["children"],Xr="undefined"!==typeof document?Kk.useLayoutEffect:Kk.useEffect,sh=Lf(Z(69)),Sh=Z(69),JB=Z(70),Pq,dk,KB="undefined"!=typeof document?Sh.useLayoutEffect:Sh.useEffect;!function(c){c[c.DEBUG=0]="DEBUG";c[c.INFO=1]="INFO";c[c.WARN=2]="WARN";c[c.ERROR=3]="ERROR"}(dk||={});var LB=((Pq={})[dk.DEBUG]="debug",Pq[dk.INFO]="log",Pq[dk.WARN]=
"warn",Pq[dk.ERROR]="error",Pq),un=rh(function(){var c=hg(dk.ERROR);return{log:hg(function(n,N,da){var ua;void 0===da&&(da=dk.INFO);da>=(null!=(ua=("undefined"==typeof globalThis?window:globalThis).VIRTUOSO_LOG_LEVEL)?ua:c(4))&&console[LB[da]]("%creact-virtuoso: %c%s %o","color: #0253b3; font-weight: bold","color: initial",n,N)}),logLevel:c}},[],{singleton:!0}),Lk=rh(function(){var c=$g(),n=$g(),N=hg(0),da=$g(),ua=hg(0),Ga=$g(),Ma=$g(),fb=hg(0),vb=hg(0),Wb=hg(0),oc=hg(0),xc=$g(),Uc=$g(),md=hg(!1),
hd=hg(!1);return Pg(Kf(c,Dg(function(Bd){return Bd.scrollTop})),n),Pg(Kf(c,Dg(function(Bd){return Bd.scrollHeight})),Ma),Pg(n,ua),{scrollContainerState:c,scrollTop:n,viewportHeight:Ga,headerHeight:fb,fixedHeaderHeight:vb,fixedFooterHeight:Wb,footerHeight:oc,scrollHeight:Ma,smoothScrollTargetReached:da,react18ConcurrentRendering:hd,scrollTo:xc,scrollBy:Uc,statefulScrollTop:ua,deviation:N,scrollingInProgress:md}},[],{singleton:!0}),oi={lvl:0},Kt=rh(function(){return{recalcInProgress:hg(!1)}},[],{singleton:!0}),
MB={offsetHeight:"height",offsetWidth:"width"},Gm=rh(function(c){var n=c[0].log,N=c[1].recalcInProgress;c=$g();var da=$g(),ua=Ui(da,0),Ga=$g(),Ma=$g(),fb=hg(0),vb=hg([]),Wb=hg(void 0),oc=hg(void 0),xc=hg(function(jd,rd){return Rb(jd,MB[rd])}),Uc=hg(void 0),md=hg(0),hd={offsetTree:[],sizeTree:oi,groupOffsetTree:oi,lastIndex:0,lastOffset:0,lastSize:0,groupIndices:[]},Bd=Ui(Kf(c,zh(vb,n,md),zi(vh,hd),xh()),hd);Pg(Kf(vb,Bh(function(jd){return 0<jd.length}),zh(Bd,md),Dg(function(jd){var rd=jd[0],Md=jd[1],
Dd=jd[2];jd=rd.reduce(function(Oe,Pe,cg){return Gd(Oe,Pe,$i(Pe,Md.offsetTree,Dd)||cg)},oi);return Ia({},Md,{groupIndices:rd,groupOffsetTree:jd})})),Bd);Pg(Kf(da,zh(Bd),Bh(function(jd){return jd[0]<jd[1].lastIndex}),Dg(function(jd){var rd=jd[1];return[{startIndex:jd[0],endIndex:rd.lastIndex,size:rd.lastSize}]})),c);Pg(Wb,oc);var Ld=Ui(Kf(Wb,Dg(function(jd){return void 0===jd})),!0);Pg(Kf(oc,Bh(function(jd){return void 0!==jd&&Bd(4).sizeTree===oi}),Dg(function(jd){return[{startIndex:0,endIndex:0,size:jd}]})),
c);hd=Yi(Kf(c,zh(Bd),zi(function(jd,rd){rd=rd[1];return{changed:rd!==jd.sizes,sizes:rd}},{changed:!1,sizes:hd}),Dg(function(jd){return jd.changed})));Yh(Kf(fb,zi(function(jd,rd){return{diff:jd.prev-rd,prev:rd}},{diff:0,prev:0}),Dg(function(jd){return jd.diff})),function(jd){0<jd?(N(0,!0),Ga(0,jd)):0>jd&&Ma(0,jd)});Yh(Kf(fb,zh(n)),function(jd){0>jd[0]&&(0,jd[1])("`firstItemIndex` prop should not be set to less than zero. If you don't know the total count, just use a very high value",{firstItemIndex:fb},
dk.ERROR)});n=Yi(Ga);Pg(Kf(Ga,zh(Bd),Dg(function(jd){var rd=jd[0];jd=jd[1];if(0<jd.groupIndices.length)throw Error("Virtuoso: prepending items does not work with groups");return te(jd.sizeTree).reduce(function(Md,Dd){var Oe=Dd.k;Dd=Dd.v;return{ranges:[].concat(Md.ranges,[{startIndex:Md.prevIndex,endIndex:Oe+rd-1,size:Md.prevSize}]),prevIndex:Oe+rd,prevSize:Dd}},{ranges:[],prevIndex:0,prevSize:jd.lastSize}).ranges})),c);var bd=Yi(Kf(Ma,zh(Bd,md),Dg(function(jd){return $i(-jd[0],jd[1].offsetTree,jd[2])})));
return Pg(Kf(Ma,zh(Bd,md),Dg(function(jd){var rd=jd[0],Md=jd[1];jd=jd[2];if(0<Md.groupIndices.length)throw Error("Virtuoso: shifting items does not work with groups");var Dd=te(Md.sizeTree).reduce(function(Oe,Pe){return Gd(Oe,Math.max(0,Pe.k+rd),Pe.v)},oi);return Ia({},Md,{sizeTree:Dd},ii(Md.offsetTree,0,Dd,jd))})),Bd),{data:Uc,totalCount:da,sizeRanges:c,groupIndices:vb,defaultItemSize:oc,fixedItemSize:Wb,unshiftWith:Ga,shiftWith:Ma,shiftWithOffset:bd,beforeUnshiftWith:n,firstItemIndex:fb,gap:md,
sizes:Bd,listRefresh:hd,statefulTotalCount:ua,trackItemSizes:Ld,itemSize:xc}},Xh(un,Kt),{singleton:!0}),NB="undefined"!=typeof document&&"scrollBehavior"in document.documentElement.style,Qq=rh(function(c){function n(){Ld&&(Ld(),Ld=null);jd&&(jd(),jd=null);bd&&(clearTimeout(bd),bd=null);fb(0,!1)}var N=c[0],da=N.sizes,ua=N.totalCount,Ga=N.listRefresh;N=N.gap;var Ma=c[1],fb=Ma.scrollingInProgress,vb=Ma.viewportHeight,Wb=Ma.scrollTo,oc=Ma.smoothScrollTargetReached,xc=Ma.headerHeight,Uc=Ma.footerHeight,
md=Ma.fixedHeaderHeight;Ma=Ma.fixedFooterHeight;c=c[2].log;var hd=$g(),Bd=hg(0),Ld=null,bd=null,jd=null;return Pg(Kf(hd,zh(da,vb,ua,Bd,xc,Uc,c),zh(N,md,Ma),Dg(function(rd){var Md=rd[0],Dd=Md[0],Oe=Md[1],Pe=Md[2],cg=Md[3],cf=Md[4],Of=Md[5],Hg=Md[6],ah=Md[7],Eg=rd[1];Md=rd[2];rd=rd[3];var bh=qj(Dd),vf=bh.align,Ef=bh.behavior,xf=bh.offset;--cg;bh=Gh(bh,Oe,cg);Of=$i(bh,Oe.offsetTree,Eg)+Of;"end"===vf?(Of+=Md+Ad(Oe.sizeTree,bh)[1]-Pe+rd,bh===cg&&(Of+=Hg)):"center"===vf?Of+=(Md+Ad(Oe.sizeTree,bh)[1]-Pe+
rd)/2:Of-=cf;xf&&(Of+=xf);var Vf=function(Fh){n();Fh?(ah("retrying to scroll to",{location:Dd},dk.DEBUG),hd(0,Dd)):ah("list did not change, scroll successful",{},dk.DEBUG)};if(n(),"smooth"===Ef){var ch=!1;jd=Yh(Ga,function(Fh){ch=ch||Fh});Ld=kk(oc,function(){Vf(ch)})}else Ld=kk(Kf(Ga,function(Fh){var Vi=setTimeout(function(){Fh(!1)},150);return function(hi){hi&&(Fh(!0),clearTimeout(Vi))}}),Vf);bd=setTimeout(function(){n()},1200);fb(0,!0);return ah("scrolling from index to",{index:bh,top:Of,behavior:Ef},
dk.DEBUG),{top:Of,behavior:Ef}})),Wb),{scrollToIndex:hd,topListHeight:Bd}},Xh(Gm,Lk,un),{singleton:!0}),OB={atBottom:!1,notAtBottomBecause:"NOT_SHOWING_LAST_ITEM",state:{offsetBottom:0,scrollTop:0,viewportHeight:0,scrollHeight:0}},Rq=rh(function(c){var n=c[0],N=n.scrollContainerState;c=n.scrollTop;var da=n.viewportHeight,ua=n.headerHeight,Ga=n.footerHeight,Ma=n.scrollBy;n=hg(!1);var fb=hg(!0),vb=$g(),Wb=$g(),oc=hg(4),xc=hg(0),Uc=Ui(Kf(Am(Kf(Kh(c),gk(1),Kj(!0)),Kf(Kh(c),gk(1),Kj(!1),Gl(100))),xh()),
!1),md=Ui(Kf(Am(Kf(Ma,Kj(!0)),Kf(Ma,Kj(!1),Gl(200))),xh()),!1);Pg(Kf(Ci(Kh(c),Kh(xc)),Dg(function(hd){return hd[0]<=hd[1]}),xh()),fb);Pg(Kf(fb,hk(50)),Wb);da=Yi(Kf(Ci(N,Kh(da),Kh(ua),Kh(Ga),Kh(oc)),zi(function(hd,Bd){var Ld,bd,jd=Bd[0],rd=jd.scrollTop;jd=jd.scrollHeight;var Md=Bd[1],Dd={viewportHeight:Md,scrollTop:rd,scrollHeight:jd};return rd+Md-jd>-Bd[4]?(rd>hd.state.scrollTop?(Ld="SCROLLED_DOWN",bd=hd.state.scrollTop-rd):(Ld="SIZE_DECREASED",bd=hd.state.scrollTop-rd||hd.scrollTopDelta),{atBottom:!0,
state:Dd,atBottomBecause:Ld,scrollTopDelta:bd}):{atBottom:!1,notAtBottomBecause:Dd.scrollHeight>hd.state.scrollHeight?"SIZE_INCREASED":Md<hd.state.viewportHeight?"VIEWPORT_HEIGHT_DECREASING":rd<hd.state.scrollTop?"SCROLLING_UPWARDS":"NOT_FULLY_SCROLLED_TO_LAST_ITEM_BOTTOM",state:Dd}},OB),xh(function(hd,Bd){return hd&&hd.atBottom===Bd.atBottom})));ua=Ui(Kf(N,zi(function(hd,Bd){var Ld=Bd.scrollTop,bd=Bd.scrollHeight;Bd=Bd.viewportHeight;return 1.01>Math.abs(hd.scrollHeight-bd)?{scrollTop:Ld,scrollHeight:bd,
jump:0,changed:!1}:hd.scrollTop!==Ld&&1>bd-(Ld+Bd)?{scrollHeight:bd,scrollTop:Ld,jump:hd.scrollTop-Ld,changed:!0}:{scrollHeight:bd,scrollTop:Ld,jump:0,changed:!0}},{scrollHeight:0,jump:0,scrollTop:0,changed:!1}),Bh(function(hd){return hd.changed}),Dg(function(hd){return hd.jump})),0);Pg(Kf(da,Dg(function(hd){return hd.atBottom})),n);Pg(Kf(n,hk(50)),vb);Ga=hg("down");Pg(Kf(N,Dg(function(hd){return hd.scrollTop}),xh(),zi(function(hd,Bd){return md(4)?{direction:hd.direction,prevScrollTop:Bd}:{direction:Bd<
hd.prevScrollTop?"up":"down",prevScrollTop:Bd}},{direction:"down",prevScrollTop:0}),Dg(function(hd){return hd.direction})),Ga);Pg(Kf(N,hk(50),Kj("none")),Ga);N=hg(0);return Pg(Kf(Uc,Bh(function(hd){return!hd}),Kj(0)),N),Pg(Kf(c,hk(100),zh(Uc),Bh(function(hd){return!!hd[1]}),zi(function(hd,Bd){return[hd[1],Bd[0]]},[0,0]),Dg(function(hd){return hd[1]-hd[0]})),N),{isScrolling:Uc,isAtTop:fb,isAtBottom:n,atBottomState:da,atTopStateChange:Wb,atBottomStateChange:vb,scrollDirection:Ga,atBottomThreshold:oc,
atTopThreshold:xc,scrollVelocity:N,lastJumpDueToItemResize:ua}},Xh(Lk)),xo=rh(function(c){var n=c[0].log;c=hg(!1);var N=Yi(Kf(c,Bh(function(da){return da}),xh()));return Yh(c,function(da){da&&n(4)("props updated",{},dk.DEBUG)}),{propsReady:c,didMount:N}},Xh(un),{singleton:!0}),Lt=rh(function(c){var n=c[0],N=n.sizes,da=n.listRefresh;n=n.defaultItemSize;var ua=c[1].scrollTop,Ga=c[2].scrollToIndex;c=c[3].didMount;var Ma=hg(!0),fb=hg(0);return Pg(Kf(c,zh(fb),Bh(function(vb){return!!vb[1]}),Kj(!1)),Ma),
Yh(Kf(Ci(da,c),zh(Ma,N,n),Bh(function(vb){var Wb=vb[1],oc=vb[3];return vb[0][1]&&(vb[2].sizeTree!==oi||void 0!==oc)&&!Wb}),zh(fb)),function(vb){var Wb=vb[1];setTimeout(function(){kk(ua,function(){Ma(0,!0)});Ga(0,Wb)})}),{scrolledToInitialItem:Ma,initialTopMostItemIndex:fb}},Xh(Gm,Lk,Qq,xo),{singleton:!0}),PB=rh(function(c){function n(Bd){vb(0,{index:"LAST",align:"end",behavior:Bd})}function N(Bd){var Ld=kk(fb,function(bd){!Bd||bd.atBottom||"SIZE_INCREASED"!==bd.notAtBottomBecause||hd||(xc(4)("scrolling to bottom due to increased size",
{},dk.DEBUG),n("auto"))});setTimeout(Ld,100)}var da=c[0],ua=da.totalCount,Ga=da.listRefresh,Ma=c[1];da=Ma.isAtBottom;var fb=Ma.atBottomState,vb=c[2].scrollToIndex;Ma=c[3].scrolledToInitialItem;var Wb=c[4],oc=Wb.propsReady;Wb=Wb.didMount;var xc=c[5].log;c=c[6].scrollingInProgress;var Uc=hg(!1),md=$g(),hd=null;return Yh(Kf(Ci(Kf(Kh(ua),gk(1)),Wb),zh(Kh(Uc),da,Ma,c),Dg(function(Bd){var Ld=Bd[0],bd=Ld[0];Ld=Ld[1]&&Bd[3];var jd="auto";Ld&&(jd=Bd[1],Bd=Bd[2]||Bd[4],jd="function"==typeof jd?Qn(jd(Bd)):Bd&&
Qn(jd),Ld=Ld&&!!jd);return{totalCount:bd,shouldFollow:Ld,followOutputBehavior:jd}}),Bh(function(Bd){return Bd.shouldFollow})),function(Bd){var Ld=Bd.totalCount,bd=Bd.followOutputBehavior;hd&&(hd(),hd=null);hd=kk(Ga,function(){xc(4)("following output to ",{totalCount:Ld},dk.DEBUG);n(bd);hd=null})}),Yh(Kf(Ci(Kh(Uc),ua,oc),Bh(function(Bd){return Bd[0]&&Bd[2]}),zi(function(Bd,Ld){Ld=Ld[1];return{refreshed:Bd.value===Ld,value:Ld}},{refreshed:!1,value:0}),Bh(function(Bd){return Bd.refreshed}),zh(Uc,ua)),
function(Bd){N(!1!==Bd[1])}),Yh(md,function(){N(!1!==Uc(4))}),Yh(Ci(Kh(Uc),fb),function(Bd){var Ld=Bd[1];Bd[0]&&!Ld.atBottom&&"VIEWPORT_HEIGHT_DECREASING"===Ld.notAtBottomBecause&&n("auto")}),{followOutput:Uc,autoscrollToBottom:md}},Xh(Gm,Rq,Qq,Lt,xo,un,Lk)),zx=rh(function(c){var n=c[0],N=n.totalCount,da=n.groupIndices;n=n.sizes;var ua=c[1];c=ua.scrollTop;ua=ua.headerHeight;var Ga=$g(),Ma=$g(),fb=Yi(Kf(Ga,Dg(ll)));return Pg(Kf(fb,Dg(function(vb){return vb.totalCount})),N),Pg(Kf(fb,Dg(function(vb){return vb.groupIndices})),
da),Pg(Kf(Ci(c,n,ua),Bh(function(vb){return vb[1].groupOffsetTree!==oi}),Dg(function(vb){return Ad(vb[1].groupOffsetTree,Math.max(vb[0]-vb[2],0),"v")[0]}),xh(),Dg(function(vb){return[vb]})),Ma),{groupCounts:Ga,topItemsIndexes:Ma}},Xh(Gm,Lk)),Mt=rh(function(c){var n=c[0];c=n.scrollTop;var N=n.viewportHeight,da=n.deviation,ua=n.headerHeight,Ga=n.fixedHeaderHeight;n=$g();var Ma=hg(0),fb=hg(0),vb=hg(0);c=Ui(Kf(Ci(Kh(c),Kh(N),Kh(ua),Kh(n,Pm),Kh(vb),Kh(Ma),Kh(Ga),Kh(da),Kh(fb)),Dg(function(Wb){var oc=Wb[0],
xc=Wb[1],Uc=Wb[2],md=Wb[3],hd=md[0];md=md[1];var Bd=Wb[4],Ld=Wb[6],bd=Wb[7],jd=Wb[8],rd=oc-bd;Wb=Wb[5]+Ld;var Md=Math.max(Uc-rd,0),Dd="none",Oe="number"==typeof jd?jd:jd.top||0;jd="number"==typeof jd?jd:jd.bottom||0;return hd-=bd,md+=Uc+Ld,hd+(Uc+Ld)>oc+Wb-Oe&&(Dd="up"),md-bd<oc-Md+xc+jd&&(Dd="down"),"none"!==Dd?[Math.max(rd-Uc-Rn(Bd,"top",Dd)-Oe,0),rd-Md-Ld+xc+Rn(Bd,"bottom",Dd)+jd]:null}),Bh(function(Wb){return null!=Wb}),xh(Pm)),[0,0]);return{listBoundary:n,overscan:vb,topListHeight:Ma,increaseViewportBy:fb,
visibleRange:c}},Xh(Lk),{singleton:!0}),Ax={items:[],topItems:[],offsetTop:0,offsetBottom:0,top:0,bottom:0,topListHeight:0,totalCount:0,firstItemIndex:0},yp=rh(function(c){var n=c[0],N=n.sizes,da=n.totalCount,ua=n.data,Ga=n.firstItemIndex,Ma=n.gap,fb=c[1],vb=c[2],Wb=vb.visibleRange;n=vb.listBoundary;vb=vb.topListHeight;var oc=c[3],xc=oc.scrolledToInitialItem,Uc=oc.initialTopMostItemIndex;oc=c[4].topListHeight;var md=c[5],hd=c[6].didMount,Bd=c[7].recalcInProgress;c=hg([]);var Ld=$g();Pg(fb.topItemsIndexes,
c);N=Ui(Kf(Ci(hd,Bd,Kh(Wb,Pm),Kh(da),Kh(N),Kh(Uc),xc,Kh(c),Kh(Ga),Kh(Ma),ua),Bh(function(bd){return bd[0]&&!bd[1]}),Dg(function(bd){var jd=bd[2],rd=jd[0],Md=jd[1];jd=bd[3];var Dd=bd[5],Oe=bd[6],Pe=bd[7],cg=bd[8],cf=bd[9],Of=bd[10];bd=bd[4];var Hg=bd.sizeTree,ah=bd.offsetTree;if(0===jd||0===rd&&0===Md)return Ia({},Ax,{totalCount:jd});if(Hg===oi)return Lo(function(hi,Wg,Ki){return Wg.groupOffsetTree!==oi?(hi=Di(hi,Wg),[{index:Ad(Wg.groupOffsetTree,hi)[0],size:0,offset:0},{index:hi,size:0,offset:0,data:Ki&&
Ki[0]}]):[{index:hi,size:0,offset:0,data:Ki&&Ki[0]}]}("number"==typeof Dd?Dd:"LAST"===Dd.index?jd-1:Dd.index,bd,Of),[],jd,cf,bd,cg);Dd=[];if(0<Pe.length){var Eg,bh=Pe[0],vf=Pe[Pe.length-1],Ef=0;for(Hg=Tb(Ug(Hg,bh,vf));!(Eg=Hg()).done;){var xf=Eg.value;Eg=xf.value;var Vf=Math.min(xf.end,vf);for(xf=Math.max(xf.start,bh);xf<=Vf;xf++)Dd.push({index:xf,size:Eg,offset:Ef,data:Of&&Of[xf]}),Ef+=Eg}}if(!Oe)return Lo([],Dd,jd,cf,bd,cg);var ch=0<Pe.length?Pe[Pe.length-1]+1:0,Fh=function(hi,Wg,Ki,Ni){return void 0===
Ni&&(Ni=0),0<Ni&&(Wg=Math.max(Wg,hi[lh(hi,Ni,Ff)].offset)),Bg((Pk=Ki,tu=lh(cj=hi,Wg,zn=ri),uu=lh(cj,Pk,zn,tu),cj.slice(tu,uu+1)),Ch);var cj,Pk,zn,tu,uu}(ah,rd,Md,ch);if(0===Fh.length)return null;var Vi=jd-1;return Lo(bj([],function(hi){for(var Wg,Ki=Tb(Fh);!(Wg=Ki()).done;){var Ni=Wg.value,cj=Ni.value;Wg=cj.offset;var Pk=Ni.start,zn=cj.size;cj.offset<rd&&(cj=(Pk+=Math.floor((rd-cj.offset+cf)/(zn+cf)))-Ni.start,Wg+=cj*zn+cj*cf);Pk<ch&&(Wg+=(ch-Pk)*zn,Pk=ch);for(Ni=Math.min(Ni.end,Vi);Pk<=Ni&&!(Wg>=
Md);Pk++)hi.push({index:Pk,size:zn,offset:Wg,data:Of&&Of[Pk]}),Wg+=zn+cf}}),Dd,jd,cf,bd,cg)}),Bh(function(bd){return null!==bd}),xh()),Ax);return Pg(Kf(ua,Bh(function(bd){return void 0!==bd}),Dg(function(bd){return bd.length})),da),Pg(Kf(N,Dg(function(bd){return bd.topListHeight})),oc),Pg(oc,vb),Pg(Kf(N,Dg(function(bd){return[bd.top,bd.bottom]})),n),Pg(Kf(N,Dg(function(bd){return bd.items})),Ld),Ia({listState:N,topItemsIndexes:c,endReached:Yi(Kf(N,Bh(function(bd){return 0<bd.items.length}),zh(da,
ua),Bh(function(bd){var jd=bd[0].items;return jd[jd.length-1].originalIndex===bd[1]-1}),Dg(function(bd){return[bd[1]-1,bd[2]]}),xh(Pm),Dg(function(bd){return bd[0]}))),startReached:Yi(Kf(N,hk(200),Bh(function(bd){var jd=bd.items;return 0<jd.length&&jd[0].originalIndex===bd.topItems.length}),Dg(function(bd){return bd.items[0].index}),xh())),rangeChanged:Yi(Kf(N,Bh(function(bd){return 0<bd.items.length}),Dg(function(bd){bd=bd.items;for(var jd=0,rd=bd.length-1;"group"===bd[jd].type&&jd<rd;)jd++;for(;"group"===
bd[rd].type&&rd>jd;)rd--;return{startIndex:bd[jd].index,endIndex:bd[rd].index}}),xh(Fk))),itemsRendered:Ld},md)},Xh(Gm,zx,Mt,Lt,Qq,Rq,xo,Kt),{singleton:!0}),QB=rh(function(c){var n=c[0],N=n.sizes,da=n.firstItemIndex,ua=n.data;n=n.gap;var Ga=c[1].listState;c=c[2].didMount;var Ma=hg(0);return Pg(Kf(c,zh(Ma),Bh(function(fb){return 0!==fb[1]}),zh(N,da,n,ua),Dg(function(fb){var vb=fb[0][1],Wb=fb[1],oc=fb[2],xc=fb[3];fb=fb[4];var Uc=void 0===fb?[]:fb;fb=0;if(0<Wb.groupIndices.length)for(var md,hd=Tb(Wb.groupIndices);!((md=
hd()).done||md.value-fb>=vb);)fb++;vb+=fb;return Lo(Array.from({length:vb}).map(function(Bd,Ld){return{index:Ld,size:0,offset:0,data:Uc[Ld]}}),[],vb,xc,Wb,oc)})),Ga),{initialItemCount:Ma}},Xh(Gm,yp,xo),{singleton:!0}),Bx=rh(function(c){c=c[0].scrollVelocity;var n=hg(!1),N=$g(),da=hg(!1);return Pg(Kf(c,zh(da,n,N),Bh(function(ua){return!!ua[1]}),Dg(function(ua){var Ga=ua[0],Ma=ua[1],fb=ua[2];ua=ua[3];var vb=Ma.enter;if(fb){if((0,Ma.exit)(Ga,ua))return!1}else if(vb(Ga,ua))return!0;return fb}),xh()),
n),Yh(Kf(Ci(n,c,N),zh(da)),function(ua){var Ga=ua[0];ua=ua[1];return Ga[0]&&ua&&ua.change&&ua.change(Ga[1],Ga[2])}),{isSeeking:n,scrollSeekConfiguration:da,scrollVelocity:c,scrollSeekRangeChanged:N}},Xh(Rq),{singleton:!0}),RB=rh(function(c){c=c[0].topItemsIndexes;var n=hg(0);return Pg(Kf(n,Bh(function(N){return 0<N}),Dg(function(N){return Array.from({length:N}).map(function(da,ua){return ua})})),c),{topItemCount:n}},Xh(yp)),Nt=rh(function(c){var n=c[0],N=n.footerHeight,da=n.headerHeight,ua=n.fixedHeaderHeight;
n=n.fixedFooterHeight;var Ga=c[1].listState;c=$g();N=Ui(Kf(Ci(N,n,da,ua,Ga),Dg(function(Ma){var fb=Ma[4];return Ma[0]+Ma[1]+Ma[2]+Ma[3]+fb.offsetBottom+fb.bottom})),0);return Pg(Kh(N),c),{totalListHeight:N,totalListHeightChanged:c}},Xh(Lk,yp),{singleton:!0}),SB=Qm(function(){return/iP(ad|hone|od).+Version\/[\d.]+.*Safari/i.test(navigator.userAgent)}),TB=rh(function(c){function n(Ld){0<Ld?(da(0,{top:-Ld,behavior:"auto"}),Ga(0,0)):(Ga(0,0),da(0,{top:-Ld,behavior:"auto"}))}var N=c[0],da=N.scrollBy,ua=
N.scrollTop,Ga=N.deviation,Ma=N.scrollingInProgress,fb=c[1];N=fb.isScrolling;var vb=fb.isAtBottom,Wb=fb.scrollDirection,oc=c[3],xc=oc.beforeUnshiftWith,Uc=oc.shiftWithOffset,md=oc.sizes;oc=oc.gap;var hd=c[4].log,Bd=c[5].recalcInProgress;c=Yi(Kf(c[2].listState,zh(fb.lastJumpDueToItemResize),zi(function(Ld,bd){var jd=Ld[1],rd=bd[0],Md=rd.items,Dd=rd.totalCount;rd=rd.bottom+rd.offsetBottom;var Oe=0;return Ld[2]===Dd&&0<jd.length&&0<Md.length&&(0===Md[0].originalIndex&&0===jd[0].originalIndex||0!=(Oe=
rd-Ld[3])&&(Oe+=bd[1])),[Oe,Md,Dd,rd]},[0,[],0,0]),Bh(function(Ld){return 0!==Ld[0]}),zh(ua,Wb,Ma,vb,hd),Bh(function(Ld){return!Ld[3]&&0!==Ld[1]&&"up"===Ld[2]}),Dg(function(Ld){var bd=Ld[0][0];return(0,Ld[5])("Upward scrolling compensation",{amount:bd},dk.DEBUG),bd})));return Yh(Kf(c,zh(Ga,N)),function(Ld){var bd=Ld[0],jd=Ld[1];Ld[2]&&SB()?Ga(0,jd-bd):n(-bd)}),Yh(Kf(Ci(Ui(N,!1),Ga,Bd),Bh(function(Ld){return!Ld[0]&&!Ld[2]&&0!==Ld[1]}),Dg(function(Ld){return Ld[1]}),hk(1)),n),Pg(Kf(Uc,Dg(function(Ld){return{top:-Ld}})),
da),Yh(Kf(xc,zh(md,oc),Dg(function(Ld){var bd=Ld[0];return bd*Ld[1].lastSize+bd*Ld[2]})),function(Ld){Ga(0,Ld);requestAnimationFrame(function(){Ik(da,{top:Ld});requestAnimationFrame(function(){Ga(0,0);Bd(0,!1)})})}),{deviation:Ga}},Xh(Lk,Rq,yp,Gm,un,Kt)),UB=rh(function(c){var n=c[0].totalListHeight,N=c[1].didMount,da=c[2].scrollTo;c=hg(0);return Yh(Kf(N,zh(c),Bh(function(ua){return 0!==ua[1]}),Dg(function(ua){return{top:ua[1]}})),function(ua){kk(Kf(n,Bh(function(Ga){return 0!==Ga})),function(){setTimeout(function(){da(0,
ua)})})}),{initialScrollTop:c}},Xh(Nt,xo,Lk),{singleton:!0}),VB=rh(function(c){var n=c[0].viewportHeight;c=c[1].totalListHeight;var N=hg(!1);return{alignToBottom:N,paddingTopAddition:Ui(Kf(Ci(N,n,c),Bh(function(da){return da[0]}),Dg(function(da){return Math.max(0,da[1]-da[2])}),xh()),0)}},Xh(Lk,Nt),{singleton:!0}),Cx=rh(function(c){var n=c[0];c=n.scrollTo;n=n.scrollContainerState;var N=$g(),da=$g(),ua=$g(),Ga=hg(!1),Ma=hg(void 0);return Pg(Kf(Ci(N,da),Dg(function(fb){var vb=fb[0];return{scrollTop:Math.max(0,
vb.scrollTop-fb[1].offsetTop),scrollHeight:vb.scrollHeight,viewportHeight:vb.viewportHeight}})),n),Pg(Kf(c,zh(da),Dg(function(fb){var vb=fb[0];return Ia({},vb,{top:vb.top+fb[1].offsetTop})})),ua),{useWindowScroll:Ga,customScrollParent:Ma,windowScrollContainerState:N,windowViewportRect:da,windowScrollTo:ua}},Xh(Lk)),WB=["done","behavior","align"],XB=rh(function(c){var n=c[0],N=n.sizes,da=n.totalCount;n=n.gap;var ua=c[1],Ga=ua.scrollTop,Ma=ua.viewportHeight,fb=ua.headerHeight,vb=ua.fixedHeaderHeight,
Wb=ua.fixedFooterHeight,oc=ua.scrollingInProgress;c=c[2].scrollToIndex;ua=$g();return Pg(Kf(ua,zh(N,Ma,da,fb,vb,Wb,Ga),zh(n),Dg(function(xc){var Uc=xc[0],md=Uc[0],hd=Uc[1],Bd=Uc[2],Ld=Uc[3],bd=Uc[4],jd=Uc[5],rd=Uc[6];Uc=Uc[7];var Md=xc[1];xc=md.done;var Dd=md.behavior,Oe=md.align,Pe=Cc(md,WB),cg=null;md=Gh(md,hd,Ld-1);bd=$i(md,hd.offsetTree,Md)+bd+jd;return bd<Uc+jd?cg=Ia({},Pe,{behavior:Dd,align:null!=Oe?Oe:"start"}):bd+Ad(hd.sizeTree,md)[1]>Uc+Bd-rd&&(cg=Ia({},Pe,{behavior:Dd,align:null!=Oe?Oe:
"end"})),cg?xc&&kk(Kf(oc,gk(1),Bh(function(cf){return!1===cf})),xc):xc&&xc(),cg}),Bh(function(xc){return null!==xc})),c),{scrollIntoView:ua}},Xh(Gm,Lk,Qq,yp,un),{singleton:!0}),YB=["listState","topItemsIndexes"],ZB=rh(function(c){return Ia({},c[0],c[1],c[2],c[3],c[4],c[5],c[6],c[7],c[8])},Xh(Mt,QB,xo,Bx,Nt,UB,VB,Cx,XB)),Dx=rh(function(c){var n=c[0],N=n.totalCount,da=n.sizeRanges,ua=n.fixedItemSize,Ga=n.defaultItemSize,Ma=n.trackItemSizes,fb=n.itemSize,vb=n.data,Wb=n.firstItemIndex,oc=n.groupIndices,
xc=n.statefulTotalCount;n=n.gap;var Uc=c[1],md=Uc.initialTopMostItemIndex;Uc=Uc.scrolledToInitialItem;var hd=c[2],Bd=c[3],Ld=c[4],bd=Ld.listState,jd=Ld.topItemsIndexes;Ld=Cc(Ld,YB);var rd=c[5].scrollToIndex,Md=c[7].topItemCount,Dd=c[8].groupCounts,Oe=c[9];c=c[10];return Pg(Ld.rangeChanged,Oe.scrollSeekRangeChanged),Pg(Kf(Oe.windowViewportRect,Dg(function(Pe){return Pe.visibleHeight})),hd.viewportHeight),Ia({totalCount:N,data:vb,firstItemIndex:Wb,sizeRanges:da,initialTopMostItemIndex:md,scrolledToInitialItem:Uc,
topItemsIndexes:jd,topItemCount:Md,groupCounts:Dd,fixedItemHeight:ua,defaultItemHeight:Ga,gap:n},Bd,{statefulTotalCount:xc,listState:bd,scrollToIndex:rd,trackItemSizes:Ma,itemSize:fb,groupIndices:oc},Ld,Oe,hd,c)},Xh(Gm,Lt,Lk,PB,yp,Qq,TB,RB,zx,ZB,un)),Ex=Qm(function(){if("undefined"==typeof document)return"sticky";var c=document.createElement("div");return c.style.position="-webkit-sticky","-webkit-sticky"===c.style.position?"-webkit-sticky":"sticky"}),Yr=sh.createContext(void 0),Fx=sh.createContext(void 0),
$B=["placeholder"],aC=["style","children"],bC=["style","children"],cC=rh(function(){var c=hg(function(vb){return"Item "+vb}),n=hg(null),N=hg(function(vb){return"Group "+vb}),da=hg({}),ua=hg(um),Ga=hg("div"),Ma=hg(Ji),fb=function(vb,Wb){return void 0===Wb&&(Wb=null),Ui(Kf(da,Dg(function(oc){return oc[vb]}),xh()),Wb)};return{context:n,itemContent:c,groupContent:N,components:da,computeItemKey:ua,headerFooterTag:Ga,scrollerRef:Ma,FooterComponent:fb("Footer"),HeaderComponent:fb("Header"),TopItemListComponent:fb("TopItemList"),
ListComponent:fb("List","div"),ItemComponent:fb("Item","div"),GroupComponent:fb("Group","div"),ScrollerComponent:fb("Scroller","div"),EmptyPlaceholder:fb("EmptyPlaceholder"),ScrollSeekPlaceholder:fb("ScrollSeekPlaceholder")}}),dC=rh(function(c){function n(ua,Ga,Ma){Pg(Kf(ua,zh(da.components),Dg(function(fb){var vb,Wb=fb[0];fb=fb[1];return console.warn("react-virtuoso: "+Ma+" property is deprecated. Pass components."+Ga+" instead."),Ia({},fb,((vb={})[Ga]=Wb,vb))})),da.components)}var N=c[0],da=c[1];
c={item:Uj(da.itemContent,"Rename the %citem%c prop to %citemContent."),group:Uj(da.groupContent,"Rename the %cgroup%c prop to %cgroupContent."),topItems:Uj(N.topItemCount,"Rename the %ctopItems%c prop to %ctopItemCount."),itemHeight:Uj(N.fixedItemHeight,"Rename the %citemHeight%c prop to %cfixedItemHeight."),scrollingStateChange:Uj(N.isScrolling,"Rename the %cscrollingStateChange%c prop to %cisScrolling."),adjustForPrependedItems:$g(),maxHeightCacheSize:$g(),footer:$g(),header:$g(),HeaderContainer:$g(),
FooterContainer:$g(),ItemContainer:$g(),ScrollContainer:$g(),GroupContainer:$g(),ListContainer:$g(),emptyComponent:$g(),scrollSeek:$g()};return Yh(c.adjustForPrependedItems,function(){console.warn("react-virtuoso: adjustForPrependedItems is no longer supported. Use the firstItemIndex property instead - https://virtuoso.dev/prepend-items.","color: red;","color: inherit;","color: blue;")}),Yh(c.maxHeightCacheSize,function(){console.warn("react-virtuoso: maxHeightCacheSize is no longer necessary. Setting it has no effect - remove it from your code.")}),
Yh(c.HeaderContainer,function(){console.warn("react-virtuoso: HeaderContainer is deprecated. Use headerFooterTag if you want to change the wrapper of the header component and pass components.Header to change its contents.")}),Yh(c.FooterContainer,function(){console.warn("react-virtuoso: FooterContainer is deprecated. Use headerFooterTag if you want to change the wrapper of the footer component and pass components.Footer to change its contents.")}),Yh(c.scrollSeek,function(ua){var Ga=ua.placeholder;
ua=Cc(ua,$B);console.warn("react-virtuoso: scrollSeek property is deprecated. Pass scrollSeekConfiguration and specify the placeholder in components.ScrollSeekPlaceholder instead.");Ga=Ia({},(0,da.components)(4),{ScrollSeekPlaceholder:Ga});(0,da.components)(0,Ga);(0,N.scrollSeekConfiguration)(0,ua)}),n(c.footer,"Footer","footer"),n(c.header,"Header","header"),n(c.ItemContainer,"Item","ItemContainer"),n(c.ListContainer,"List","ListContainer"),n(c.ScrollContainer,"Scroller","ScrollContainer"),n(c.emptyComponent,
"EmptyPlaceholder","emptyComponent"),n(c.GroupContainer,"Group","GroupContainer"),Ia({},N,da,c)},Xh(Dx,cC)),eC=function(c){return sh.createElement("div",{style:{height:c.height}})},fC={position:Ex(),zIndex:1,overflowAnchor:"none"},gC={overflowAnchor:"none"},Gx=sh.memo(function(c){c=c.showTopList;c=void 0!==c&&c;var n=Bi("listState"),N=Al("sizeRanges"),da=Bi("useWindowScroll"),ua=Bi("customScrollParent"),Ga=Al("windowScrollContainerState"),Ma=Al("scrollContainerState");da=ua||da?Ga:Ma;var fb=Bi("itemContent"),
vb=Bi("context"),Wb=Bi("groupContent");Ga=Bi("trackItemSizes");Ma=Bi("itemSize");var oc=Bi("log"),xc=Al("gap");N=Vb(N,Ma,Ga,c?Ji:da,oc,xc,ua).callbackRef;ua=sh.useState(0);var Uc=ua[0],md=ua[1];Ot("deviation",function(Md){Uc!==Md&&md(Md)});ua=Bi("EmptyPlaceholder");var hd=Bi("ScrollSeekPlaceholder")||eC;da=Bi("ListComponent");var Bd=Bi("ItemComponent"),Ld=Bi("GroupComponent"),bd=Bi("computeItemKey"),jd=Bi("isSeeking"),rd=0<Bi("groupIndices").length;Ga=Bi("paddingTopAddition");Ga=c?{}:{boxSizing:"border-box",
paddingTop:n.offsetTop+Ga,paddingBottom:n.offsetBottom,marginTop:Uc};return!c&&0===n.totalCount&&ua?(0,Sh.createElement)(ua,uj(ua,vb)):(0,Sh.createElement)(da,Ia({},uj(da,vb),{ref:N,style:Ga,"data-test-id":c?"virtuoso-top-item-list":"virtuoso-item-list"}),(c?n.topItems:n.items).map(function(Md){var Dd=Md.originalIndex,Oe=bd(Dd+n.firstItemIndex,Md.data,vb);return jd?(0,Sh.createElement)(hd,Ia({},uj(hd,vb),{key:Oe,index:Md.index,height:Md.size,type:Md.type||"item"},"group"===Md.type?{}:{groupIndex:Md.groupIndex})):
"group"===Md.type?(0,Sh.createElement)(Ld,Ia({},uj(Ld,vb),{key:Oe,"data-index":Dd,"data-known-size":Md.size,"data-item-index":Md.index,style:fC}),Wb(Md.index)):(0,Sh.createElement)(Bd,Ia({},uj(Bd,vb),{key:Oe,"data-index":Dd,"data-known-size":Md.size,"data-item-index":Md.index,"data-item-group-index":Md.groupIndex,style:gC}),rd?fb(Md.index,Md.groupIndex,Md.data,vb):fb(Md.index,Md.data,vb))}))}),hC={height:"100%",outline:"none",overflowY:"auto",position:"relative",WebkitOverflowScrolling:"touch"},zp=
{width:"100%",height:"100%",position:"absolute",top:0},iC={width:"100%",position:Ex(),top:0},jC=sh.memo(function(){var c=Bi("HeaderComponent"),n=Al("headerHeight"),N=Bi("headerFooterTag"),da=mc(function(Ga){return n(Rb(Ga,"height"))}),ua=Bi("context");return c?(0,Sh.createElement)(N,{ref:da},(0,Sh.createElement)(c,uj(c,ua))):null}),kC=sh.memo(function(){var c=Bi("FooterComponent"),n=Al("footerHeight"),N=Bi("headerFooterTag"),da=mc(function(Ga){return n(Rb(Ga,"height"))}),ua=Bi("context");return c?
(0,Sh.createElement)(N,{ref:da},(0,Sh.createElement)(c,uj(c,ua))):null}),lC=function(c){c=c.children;var n=(0,Sh.useContext)(Yr),N=Al("viewportHeight"),da=Al("fixedItemHeight"),ua=mc(Wh(N,function(Ga){return Rb(Ga,"height")}));return sh.useEffect(function(){n&&(N(n.viewportHeight),da(n.itemHeight))},[n,N,da]),sh.createElement("div",{style:zp,ref:ua,"data-viewport-type":"element"},c)},mC=function(c){c=c.children;var n=(0,Sh.useContext)(Yr),N=Al("windowViewportRect"),da=Al("fixedItemHeight"),ua=Bi("customScrollParent");
ua=Rm(N,ua);return sh.useEffect(function(){n&&(da(n.itemHeight),N({offsetTop:0,visibleHeight:n.viewportHeight,visibleWidth:100}))},[n,N,da]),sh.createElement("div",{ref:ua,style:zp,"data-viewport-type":"window"},c)},nC=function(c){c=c.children;var n=Bi("TopItemListComponent"),N=Bi("headerHeight");N=Ia({},iC,{marginTop:N+"px"});var da=Bi("context");return(0,Sh.createElement)(n||"div",{style:N,context:da},c)},Zr=qc(dC,{required:{},optional:{context:"context",followOutput:"followOutput",firstItemIndex:"firstItemIndex",
itemContent:"itemContent",groupContent:"groupContent",overscan:"overscan",increaseViewportBy:"increaseViewportBy",totalCount:"totalCount",topItemCount:"topItemCount",initialTopMostItemIndex:"initialTopMostItemIndex",components:"components",groupCounts:"groupCounts",atBottomThreshold:"atBottomThreshold",atTopThreshold:"atTopThreshold",computeItemKey:"computeItemKey",defaultItemHeight:"defaultItemHeight",fixedItemHeight:"fixedItemHeight",itemSize:"itemSize",scrollSeekConfiguration:"scrollSeekConfiguration",
headerFooterTag:"headerFooterTag",data:"data",initialItemCount:"initialItemCount",initialScrollTop:"initialScrollTop",alignToBottom:"alignToBottom",useWindowScroll:"useWindowScroll",customScrollParent:"customScrollParent",scrollerRef:"scrollerRef",logLevel:"logLevel",react18ConcurrentRendering:"react18ConcurrentRendering",item:"item",group:"group",topItems:"topItems",itemHeight:"itemHeight",scrollingStateChange:"scrollingStateChange",maxHeightCacheSize:"maxHeightCacheSize",footer:"footer",header:"header",
ItemContainer:"ItemContainer",ScrollContainer:"ScrollContainer",ListContainer:"ListContainer",GroupContainer:"GroupContainer",emptyComponent:"emptyComponent",HeaderContainer:"HeaderContainer",FooterContainer:"FooterContainer",scrollSeek:"scrollSeek"},methods:{scrollToIndex:"scrollToIndex",scrollIntoView:"scrollIntoView",scrollTo:"scrollTo",scrollBy:"scrollBy",adjustForPrependedItems:"adjustForPrependedItems",autoscrollToBottom:"autoscrollToBottom"},events:{isScrolling:"isScrolling",endReached:"endReached",
startReached:"startReached",rangeChanged:"rangeChanged",atBottomStateChange:"atBottomStateChange",atTopStateChange:"atTopStateChange",totalListHeightChanged:"totalListHeightChanged",itemsRendered:"itemsRendered",groupIndices:"groupIndices"}},sh.memo(function(c){var n=Bi("useWindowScroll"),N=0<Bi("topItemsIndexes").length,da=Bi("customScrollParent"),ua=da||n?mC:lC;return sh.createElement(da||n?qC:pC,Ia({},c),sh.createElement(ua,null,sh.createElement(jC,null),sh.createElement(Gx,null),sh.createElement(kC,
null)),N&&sh.createElement(nC,null,sh.createElement(Gx,{showTopList:!0})))})),oC=Zr.Component,Al=Zr.usePublisher,Bi=Zr.useEmitterValue,Ot=Zr.useEmitter,pC=vq({usePublisher:Al,useEmitterValue:Bi,useEmitter:Ot}),qC=fm({usePublisher:Al,useEmitterValue:Bi,useEmitter:Ot}),Hx={items:[],offsetBottom:0,offsetTop:0,top:0,bottom:0,itemHeight:0,itemWidth:0},rC={items:[{index:0}],offsetBottom:0,offsetTop:0,top:0,bottom:0,itemHeight:0,itemWidth:0},Ix=Math.round,Jx=Math.ceil,$r=Math.floor,Pt=Math.min,Ap=Math.max,
sC=rh(function(c){var n=c[0],N=n.overscan,da=n.visibleRange,ua=n.listBoundary,Ga=c[1];n=Ga.scrollTop;var Ma=Ga.viewportHeight,fb=Ga.scrollBy,vb=Ga.scrollTo,Wb=Ga.smoothScrollTargetReached,oc=Ga.scrollContainerState,xc=Ga.footerHeight;Ga=Ga.headerHeight;var Uc=c[2],md=c[3],hd=c[4],Bd=hd.propsReady,Ld=hd.didMount,bd=c[5];hd=bd.windowViewportRect;var jd=bd.windowScrollTo,rd=bd.useWindowScroll,Md=bd.customScrollParent;bd=bd.windowScrollContainerState;c=c[6];var Dd=hg(0),Oe=hg(0),Pe=hg(Hx),cg=hg({height:0,
width:0}),cf=hg({height:0,width:0}),Of=$g(),Hg=$g(),ah=hg(0),Eg=hg(void 0),bh=hg({row:0,column:0});Pg(Kf(Ci(Ld,Oe,Eg),Bh(function(vf){return 0!==vf[1]}),Dg(function(vf){return{items:$o(0,vf[1]-1,vf[2]),top:0,bottom:0,offsetBottom:0,offsetTop:0,itemHeight:0,itemWidth:0}})),Pe);Pg(Kf(Ci(Kh(Dd),da,Kh(bh,qq),Kh(cf,function(vf,Ef){return vf&&vf.width===Ef.width&&vf.height===Ef.height}),Eg),zh(cg),Dg(function(vf){var Ef=vf[0],xf=Ef[0],Vf=Ef[1],ch=Vf[0],Fh=Vf[1],Vi=Ef[2],hi=Ef[3],Wg=Ef[4],Ki=vf[1];vf=Vi.row;
var Ni=Vi.column;Ef=hi.height;Vf=hi.width;var cj=Ki.width;if(0===xf||0===cj)return Hx;if(0===Vf)return Ia({},rC,{items:$o(0,0,Wg)});Ni=Ap(1,$r((cj+Ni)/(Vf+Ni)));ch=Ni*$r((ch+vf)/(Ef+vf));Fh=Ni*Jx((Fh+vf)/(Ef+vf))-1;Fh=Pt(xf-1,Ap(Fh,Ni-1));ch=$o(Pt(Fh,Ap(0,ch)),Fh,Wg);hi=em(Ki,Vi,hi,ch);Vi=hi.top;hi=hi.bottom;xf=Jx(xf/Ni);return{items:ch,offsetTop:Vi,offsetBottom:xf*Ef+(xf-1)*vf-hi,top:Vi,bottom:hi,itemHeight:Ef,itemWidth:Vf}})),Pe);Pg(Kf(Eg,Bh(function(vf){return void 0!==vf}),Dg(function(vf){return vf.length})),
Dd);Pg(Kf(cg,Dg(function(vf){return vf.height})),Ma);Pg(Kf(Ci(cg,cf,Pe,bh),Dg(function(vf){vf=em(vf[0],vf[3],vf[1],vf[2].items);return[vf.top,vf.bottom]}),xh(Pm)),ua);da=Yi(Kf(Kh(Pe),Bh(function(vf){return 0<vf.items.length}),zh(Dd),Bh(function(vf){var Ef=vf[0].items;return Ef[Ef.length-1].index===vf[1]-1}),Dg(function(vf){return vf[1]-1}),xh()));ua=Yi(Kf(Kh(Pe),Bh(function(vf){vf=vf.items;return 0<vf.length&&0===vf[0].index}),Kj(0),xh()));Ma=Yi(Kf(Kh(Pe),Bh(function(vf){return 0<vf.items.length}),
Dg(function(vf){vf=vf.items;return{startIndex:vf[0].index,endIndex:vf[vf.length-1].index}}),xh(Fk)));Pg(Ma,md.scrollSeekRangeChanged);Pg(Kf(Of,zh(cg,cf,Dd,bh),Dg(function(vf){var Ef=vf[1],xf=vf[2],Vf=vf[3],ch=vf[4],Fh=qj(vf[0]);vf=Fh.align;var Vi=Fh.behavior,hi=Fh.offset;Fh=Fh.index;"LAST"===Fh&&(Fh=Vf-1);Vf=ym(Ef,ch,xf,Ap(0,Fh,Pt(Vf-1,Fh)));return"end"===vf?Vf=Ix(Vf-Ef.height+xf.height):"center"===vf&&(Vf=Ix(Vf-Ef.height/2+xf.height/2)),hi&&(Vf+=hi),{top:Vf,behavior:Vi}})),vb);Ld=Ui(Kf(Pe,Dg(function(vf){return vf.offsetBottom+
vf.bottom})),0);return Pg(Kf(hd,Dg(function(vf){return{width:vf.visibleWidth,height:vf.visibleHeight}})),cg),Ia({data:Eg,totalCount:Dd,viewportDimensions:cg,itemDimensions:cf,scrollTop:n,scrollHeight:Hg,overscan:N,scrollBy:fb,scrollTo:vb,scrollToIndex:Of,smoothScrollTargetReached:Wb,windowViewportRect:hd,windowScrollTo:jd,useWindowScroll:rd,customScrollParent:Md,windowScrollContainerState:bd,deviation:ah,scrollContainerState:oc,footerHeight:xc,headerHeight:Ga,initialItemCount:Oe,gap:bh},md,{gridState:Pe,
totalListHeight:Ld},Uc,{startReached:ua,endReached:da,rangeChanged:Ma,propsReady:Bd},c)},Xh(Mt,Lk,Rq,Bx,xo,Cx,un)),tC=["placeholder"],uC=rh(function(){var c=hg(function(Wb){return"Item "+Wb}),n=hg({}),N=hg(null),da=hg("virtuoso-grid-item"),ua=hg("virtuoso-grid-list"),Ga=hg(um),Ma=hg("div"),fb=hg(Ji),vb=function(Wb,oc){return void 0===oc&&(oc=null),Ui(Kf(n,Dg(function(xc){return xc[Wb]}),xh()),oc)};return{context:N,itemContent:c,components:n,computeItemKey:Ga,itemClassName:da,listClassName:ua,headerFooterTag:Ma,
scrollerRef:fb,FooterComponent:vb("Footer"),HeaderComponent:vb("Header"),ListComponent:vb("List","div"),ItemComponent:vb("Item","div"),ScrollerComponent:vb("Scroller","div"),ScrollSeekPlaceholder:vb("ScrollSeekPlaceholder","div")}}),vC=rh(function(c){function n(ua,Ga,Ma){Pg(Kf(ua,zh(da.components),Dg(function(fb){var vb,Wb=fb[0];fb=fb[1];return console.warn("react-virtuoso: "+Ma+" property is deprecated. Pass components."+Ga+" instead."),Ia({},fb,((vb={})[Ga]=Wb,vb))})),da.components)}var N=c[0],
da=c[1];c={item:Uj(da.itemContent,"Rename the %citem%c prop to %citemContent."),ItemContainer:$g(),ScrollContainer:$g(),ListContainer:$g(),emptyComponent:$g(),scrollSeek:$g()};return Yh(c.scrollSeek,function(ua){var Ga=ua.placeholder;ua=Cc(ua,tC);console.warn("react-virtuoso: scrollSeek property is deprecated. Pass scrollSeekConfiguration and specify the placeholder in components.ScrollSeekPlaceholder instead.");Ga=Ia({},(0,da.components)(4),{ScrollSeekPlaceholder:Ga});(0,da.components)(0,Ga);(0,N.scrollSeekConfiguration)(0,
ua)}),n(c.ItemContainer,"Item","ItemContainer"),n(c.ListContainer,"List","ListContainer"),n(c.ScrollContainer,"Scroller","ScrollContainer"),Ia({},N,da,c)},Xh(sC,uC)),wC=sh.memo(function(){var c=Fj("gridState"),n=Fj("listClassName"),N=Fj("itemClassName"),da=Fj("itemContent"),ua=Fj("computeItemKey"),Ga=Fj("isSeeking"),Ma=Ml("scrollHeight"),fb=Fj("ItemComponent"),vb=Fj("ListComponent"),Wb=Fj("ScrollSeekPlaceholder"),oc=Fj("context"),xc=Ml("itemDimensions"),Uc=Ml("gap"),md=Fj("log"),hd=mc(function(Bd){Ma(Bd.parentElement.parentElement.scrollHeight);
var Ld=Bd.firstChild;Ld&&xc(Ld.getBoundingClientRect());Uc({row:Um("row-gap",getComputedStyle(Bd).rowGap,md),column:Um("column-gap",getComputedStyle(Bd).columnGap,md)})});return(0,Sh.createElement)(vb,Ia({ref:hd,className:n},uj(vb,oc),{style:{paddingTop:c.offsetTop,paddingBottom:c.offsetBottom}}),c.items.map(function(Bd){var Ld=ua(Bd.index,Bd.data,oc);return Ga?(0,Sh.createElement)(Wb,Ia({key:Ld},uj(Wb,oc),{index:Bd.index,height:c.itemHeight,width:c.itemWidth})):(0,Sh.createElement)(fb,Ia({},uj(fb,
oc),{className:N,"data-index":Bd.index,key:Ld}),da(Bd.index,Bd.data,oc))}))}),xC=sh.memo(function(){var c=Fj("HeaderComponent"),n=Ml("headerHeight"),N=Fj("headerFooterTag"),da=mc(function(Ga){return n(Rb(Ga,"height"))}),ua=Fj("context");return c?(0,Sh.createElement)(N,{ref:da},(0,Sh.createElement)(c,uj(c,ua))):null}),yC=sh.memo(function(){var c=Fj("FooterComponent"),n=Ml("footerHeight"),N=Fj("headerFooterTag"),da=mc(function(Ga){return n(Rb(Ga,"height"))}),ua=Fj("context");return c?(0,Sh.createElement)(N,
{ref:da},(0,Sh.createElement)(c,uj(c,ua))):null}),zC=function(c){c=c.children;var n=(0,Sh.useContext)(Fx),N=Ml("itemDimensions"),da=Ml("viewportDimensions"),ua=mc(function(Ga){da(Ga.getBoundingClientRect())});return sh.useEffect(function(){n&&(da({height:n.viewportHeight,width:n.viewportWidth}),N({height:n.itemHeight,width:n.itemWidth}))},[n,da,N]),sh.createElement("div",{style:zp,ref:ua},c)},AC=function(c){c=c.children;var n=(0,Sh.useContext)(Fx),N=Ml("windowViewportRect"),da=Ml("itemDimensions"),
ua=Fj("customScrollParent");ua=Rm(N,ua);return sh.useEffect(function(){n&&(da({height:n.itemHeight,width:n.itemWidth}),N({offsetTop:0,visibleHeight:n.viewportHeight,visibleWidth:n.viewportWidth}))},[n,N,da]),sh.createElement("div",{ref:ua,style:zp},c)},Qt=qc(vC,{optional:{context:"context",totalCount:"totalCount",overscan:"overscan",itemContent:"itemContent",components:"components",computeItemKey:"computeItemKey",data:"data",initialItemCount:"initialItemCount",scrollSeekConfiguration:"scrollSeekConfiguration",
headerFooterTag:"headerFooterTag",listClassName:"listClassName",itemClassName:"itemClassName",useWindowScroll:"useWindowScroll",customScrollParent:"customScrollParent",scrollerRef:"scrollerRef",item:"item",ItemContainer:"ItemContainer",ScrollContainer:"ScrollContainer",ListContainer:"ListContainer",scrollSeek:"scrollSeek"},methods:{scrollTo:"scrollTo",scrollBy:"scrollBy",scrollToIndex:"scrollToIndex"},events:{isScrolling:"isScrolling",endReached:"endReached",startReached:"startReached",rangeChanged:"rangeChanged",
atBottomStateChange:"atBottomStateChange",atTopStateChange:"atTopStateChange"}},sh.memo(function(c){c=Ia({},c);var n=Fj("useWindowScroll"),N=Fj("customScrollParent"),da=N||n?AC:zC;return sh.createElement(N||n?CC:BC,Ia({},c),sh.createElement(da,null,sh.createElement(xC,null),sh.createElement(wC,null),sh.createElement(yC,null)))})),Ml=Qt.usePublisher,Fj=Qt.useEmitterValue,Kx=Qt.useEmitter,BC=vq({usePublisher:Ml,useEmitterValue:Fj,useEmitter:Kx}),CC=fm({usePublisher:Ml,useEmitterValue:Fj,useEmitter:Kx}),
DC=rh(function(){var c=hg(function(vb){return sh.createElement("td",null,"Item $",vb)}),n=hg(null),N=hg(null),da=hg(null),ua=hg({}),Ga=hg(um),Ma=hg(Ji),fb=function(vb,Wb){return void 0===Wb&&(Wb=null),Ui(Kf(ua,Dg(function(oc){return oc[vb]}),xh()),Wb)};return{context:n,itemContent:c,fixedHeaderContent:N,fixedFooterContent:da,components:ua,computeItemKey:Ga,scrollerRef:Ma,TableComponent:fb("Table","table"),TableHeadComponent:fb("TableHead","thead"),TableFooterComponent:fb("TableFoot","tfoot"),TableBodyComponent:fb("TableBody",
"tbody"),TableRowComponent:fb("TableRow","tr"),ScrollerComponent:fb("Scroller","div"),EmptyPlaceholder:fb("EmptyPlaceholder"),ScrollSeekPlaceholder:fb("ScrollSeekPlaceholder"),FillerRow:fb("FillerRow")}}),EC=rh(function(c){return Ia({},c[0],c[1])},Xh(Dx,DC)),FC=function(c){return sh.createElement("tr",null,sh.createElement("td",{style:{height:c.height}}))},GC=function(c){return sh.createElement("tr",null,sh.createElement("td",{style:{height:c.height,padding:0,border:0}}))},HC=sh.memo(function(){var c=
Mi("listState"),n=Nl("sizeRanges"),N=Mi("useWindowScroll"),da=Mi("customScrollParent"),ua=Nl("windowScrollContainerState"),Ga=Nl("scrollContainerState");N=da||N?ua:Ga;var Ma=Mi("itemContent");ua=Mi("trackItemSizes");da=Vb(n,Mi("itemSize"),ua,N,Mi("log"),void 0,da);n=da.callbackRef;var fb=da.ref;da=sh.useState(0);var vb=da[0],Wb=da[1];St("deviation",function(bd){vb!==bd&&(fb.current.style.marginTop=bd+"px",Wb(bd))});ua=Mi("EmptyPlaceholder");var oc=Mi("ScrollSeekPlaceholder")||FC;N=Mi("FillerRow")||
GC;da=Mi("TableBodyComponent");var xc=Mi("TableRowComponent"),Uc=Mi("computeItemKey"),md=Mi("isSeeking");Ga=Mi("paddingTopAddition");var hd=Mi("firstItemIndex"),Bd=Mi("statefulTotalCount"),Ld=Mi("context");if(0===Bd&&ua)return(0,Sh.createElement)(ua,uj(ua,Ld));ua=c.offsetTop+Ga+vb;Ga=c.offsetBottom;ua=0<ua?sh.createElement(N,{height:ua,key:"padding-top"}):null;N=0<Ga?sh.createElement(N,{height:Ga,key:"padding-bottom"}):null;c=c.items.map(function(bd){var jd=bd.originalIndex,rd=Uc(jd+hd,bd.data,Ld);
return md?(0,Sh.createElement)(oc,Ia({},uj(oc,Ld),{key:rd,index:bd.index,height:bd.size,type:bd.type||"item"})):(0,Sh.createElement)(xc,Ia({},uj(xc,Ld),{key:rd,"data-index":jd,"data-known-size":bd.size,"data-item-index":bd.index,style:{overflowAnchor:"none"}}),Ma(bd.index,bd.data,Ld))});return(0,Sh.createElement)(da,Ia({ref:n,"data-test-id":"virtuoso-item-list"},uj(da,Ld)),[ua].concat(c,[N]))}),IC=function(c){c=c.children;var n=(0,Sh.useContext)(Yr),N=Nl("viewportHeight"),da=Nl("fixedItemHeight"),
ua=mc(Wh(N,function(Ga){return Rb(Ga,"height")}));return sh.useEffect(function(){n&&(N(n.viewportHeight),da(n.itemHeight))},[n,N,da]),sh.createElement("div",{style:zp,ref:ua,"data-viewport-type":"element"},c)},JC=function(c){c=c.children;var n=(0,Sh.useContext)(Yr),N=Nl("windowViewportRect"),da=Nl("fixedItemHeight"),ua=Mi("customScrollParent");ua=Rm(N,ua);return sh.useEffect(function(){n&&(da(n.itemHeight),N({offsetTop:0,visibleHeight:n.viewportHeight,visibleWidth:100}))},[n,N,da]),sh.createElement("div",
{ref:ua,style:zp,"data-viewport-type":"window"},c)},Rt=qc(EC,{required:{},optional:{context:"context",followOutput:"followOutput",firstItemIndex:"firstItemIndex",itemContent:"itemContent",fixedHeaderContent:"fixedHeaderContent",fixedFooterContent:"fixedFooterContent",overscan:"overscan",increaseViewportBy:"increaseViewportBy",totalCount:"totalCount",topItemCount:"topItemCount",initialTopMostItemIndex:"initialTopMostItemIndex",components:"components",groupCounts:"groupCounts",atBottomThreshold:"atBottomThreshold",
atTopThreshold:"atTopThreshold",computeItemKey:"computeItemKey",defaultItemHeight:"defaultItemHeight",fixedItemHeight:"fixedItemHeight",itemSize:"itemSize",scrollSeekConfiguration:"scrollSeekConfiguration",data:"data",initialItemCount:"initialItemCount",initialScrollTop:"initialScrollTop",alignToBottom:"alignToBottom",useWindowScroll:"useWindowScroll",customScrollParent:"customScrollParent",scrollerRef:"scrollerRef",logLevel:"logLevel",react18ConcurrentRendering:"react18ConcurrentRendering"},methods:{scrollToIndex:"scrollToIndex",
scrollIntoView:"scrollIntoView",scrollTo:"scrollTo",scrollBy:"scrollBy"},events:{isScrolling:"isScrolling",endReached:"endReached",startReached:"startReached",rangeChanged:"rangeChanged",atBottomStateChange:"atBottomStateChange",atTopStateChange:"atTopStateChange",totalListHeightChanged:"totalListHeightChanged",itemsRendered:"itemsRendered",groupIndices:"groupIndices"}},sh.memo(function(c){var n=Mi("useWindowScroll"),N=Mi("customScrollParent"),da=Nl("fixedHeaderHeight"),ua=Nl("fixedFooterHeight"),
Ga=Mi("fixedHeaderContent"),Ma=Mi("fixedFooterContent"),fb=Mi("context");da=mc(Wh(da,function(xc){return Rb(xc,"height")}));var vb=mc(Wh(ua,function(xc){return Rb(xc,"height")}));ua=N||n?LC:KC;n=N||n?JC:IC;N=Mi("TableComponent");var Wb=Mi("TableHeadComponent"),oc=Mi("TableFooterComponent");Ga=Ga?sh.createElement(Wb,Ia({key:"TableHead",style:{zIndex:1,position:"sticky",top:0},ref:da},uj(Wb,fb)),Ga()):null;Ma=Ma?sh.createElement(oc,Ia({key:"TableFoot",style:{zIndex:1,position:"sticky",bottom:0},ref:vb},
uj(oc,fb)),Ma()):null;return sh.createElement(ua,Ia({},c),sh.createElement(n,null,sh.createElement(N,Ia({style:{borderSpacing:0}},uj(N,fb)),[Ga,sh.createElement(HC,{key:"TableBody"}),Ma])))})),Nl=Rt.usePublisher,Mi=Rt.useEmitterValue,St=Rt.useEmitter,KC=vq({usePublisher:Nl,useEmitterValue:Mi,useEmitter:St}),LC=fm({usePublisher:Nl,useEmitterValue:Mi,useEmitter:St}),Lx=Lf(Z(69)),km=function(c){function n(N){N=c.call(this,"An error occurred. See https://github.com/styled-components/polished/blob/main/src/internalHelpers/errors.md#"+
N+" for more information.")||this;if(void 0===N)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return N}rl(n,c);return n}(lq(Error)),Mx={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"00ffff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000",blanchedalmond:"ffebcd",blue:"0000ff",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",
crimson:"dc143c",cyan:"00ffff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkgrey:"a9a9a9",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkslategrey:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dimgrey:"696969",dodgerblue:"1e90ff",
firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"ff00ff",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",grey:"808080",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgray:"d3d3d3",
lightgreen:"90ee90",lightgrey:"d3d3d3",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslategray:"789",lightslategrey:"789",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"0f0",limegreen:"32cd32",linen:"faf0e6",magenta:"f0f",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370db",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",
midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"db7093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",rebeccapurple:"639",red:"f00",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",
salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",slategrey:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",wheat:"f5deb3",white:"fff",whitesmoke:"f5f5f5",yellow:"ff0",yellowgreen:"9acd32"},MC=/^#[a-fA-F0-9]{6}$/,NC=/^#[a-fA-F0-9]{8}$/,OC=/^#[a-fA-F0-9]{3}$/,PC=/^#[a-fA-F0-9]{4}$/,
Tt=/^rgb\(\s*(\d{1,3})\s*(?:,)?\s*(\d{1,3})\s*(?:,)?\s*(\d{1,3})\s*\)$/i,QC=/^rgb(?:a)?\(\s*(\d{1,3})\s*(?:,)?\s*(\d{1,3})\s*(?:,)?\s*(\d{1,3})\s*(?:,|\/)\s*([-+]?\d*[.]?\d+[%]?)\s*\)$/i,RC=/^hsl\(\s*(\d{0,3}[.]?[0-9]+(?:deg)?)\s*(?:,)?\s*(\d{1,3}[.]?[0-9]?)%\s*(?:,)?\s*(\d{1,3}[.]?[0-9]?)%\s*\)$/i,SC=/^hsl(?:a)?\(\s*(\d{0,3}[.]?[0-9]+(?:deg)?)\s*(?:,)?\s*(\d{1,3}[.]?[0-9]?)%\s*(?:,)?\s*(\d{1,3}[.]?[0-9]?)%\s*(?:,|\/)\s*([-+]?\d*[.]?\d+[%]?)\s*\)$/i,Ut=function(c){return 7===c.length&&c[1]===c[2]&&
c[3]===c[4]&&c[5]===c[6]?"#"+c[1]+c[3]+c[5]:c},TC=Po(ap,ap.length,[]),Nx=Z(288),Ol=Lf(Z(69)),bl=class{static insertTextFirefox(c,n){c.setRangeText(n,c.selectionStart||0,c.selectionEnd||0,"end");c.dispatchEvent(new InputEvent("input",{data:n,inputType:"insertText",isComposing:!1}))}static insert(c,n){const N=c.ownerDocument,da=N.activeElement;da!==c&&c.focus();N.execCommand("insertText",!1,n)||bl.insertTextFirefox(c,n);da===N.body?c.blur():da instanceof HTMLElement&&da!==c&&da.focus()}static set(c,
n){c.select();bl.insert(c,n)}static getSelection(c){const {selectionStart:n,selectionEnd:N}=c;return c.value.slice(n?n:void 0,N?N:void 0)}static wrapSelection(c,n,N){const {selectionStart:da,selectionEnd:ua}=c,Ga=bl.getSelection(c);bl.insert(c,n+Ga+(null!=N?N:n));c.selectionStart=(da||0)+n.length;c.selectionEnd=(ua||0)+n.length}static replace(c,n,N){let da=0;c.value.replace(n,(...ua)=>{const Ga=da+ua[ua.length-2],Ma=ua[0].length;c.selectionStart=Ga;c.selectionEnd=Ga+Ma;ua="string"===typeof N?N:N(...ua);
bl.insert(c,ua);c.selectionStart=Ga;da+=ua.length-Ma;return ua})}static findLineEnd(c,n){const N=c.lastIndexOf("\n",n-1)+1;return"\t"!==c.charAt(N)?n:N+1}static indent(c){var n;const {selectionStart:N,selectionEnd:da,value:ua}=c;var Ga=ua.slice(N,da);if((Ga=null==(n=/\n/g.exec(Ga))?void 0:n.length)&&0<Ga){n=ua.lastIndexOf("\n",N-1)+1;var Ma=c.value.slice(n,da-1);Ga=Ma.replace(/^|\n/g,"$\x26  ");Ma=Ga.length-Ma.length;c.setSelectionRange(n,da-1);bl.insert(c,Ga);c.setSelectionRange(N+1,da+Ma)}else bl.insert(c,
"  ")}static unindent(c){const {selectionStart:n,selectionEnd:N,value:da}=c;var ua=da.lastIndexOf("\n",n-1)+1;const Ga=bl.findLineEnd(da,N);var Ma=c.value.slice(ua,Ga);const fb=Ma.replace(/(^|\n)(\t| {1,2})/g,"$1");Ma=Ma.length-fb.length;c.setSelectionRange(ua,Ga);bl.insert(c,fb);ua=(ua=/\t| {1,2}/.exec(da.slice(ua,n)))?ua[0].length:0;c.setSelectionRange(n-ua,Math.max(n-ua,N-Ma))}},Vt=Z(288),as=c=>c.stopPropagation(),bs=Ol.memo(function({font:c,text:n,color:N,fontStyle:da,fontSize:ua,fontWeight:Ga,
offsetX:Ma=0,offsetY:fb=0,scale:vb=1,isEditing:Wb=!1,pointerEvents:oc=!1,onBlur:xc,onChange:Uc}){const md=Ol.useRef(null),hd=Ol.useRef(!1),Bd=Ol.useCallback(Dd=>{Uc(sp.normalizeText(Dd.currentTarget.value))},[Uc]),Ld=Ol.useCallback(Dd=>{if("Escape"!==Dd.key)if("Tab"===Dd.key&&0===n.length)Dd.preventDefault();else{if("Meta"!==Dd.key&&!Dd.metaKey)Dd.stopPropagation();else if("z"===Dd.key&&Dd.metaKey){document.execCommand(Dd.shiftKey?"redo":"undo",!1);Dd.stopPropagation();Dd.preventDefault();return}"Tab"===
Dd.key&&(Dd.preventDefault(),Dd.shiftKey?bl.unindent(Dd.currentTarget):bl.indent(Dd.currentTarget),null==Uc?void 0:Uc(sp.normalizeText(Dd.currentTarget.value)))}},[Uc]),bd=Ol.useCallback(Dd=>{Wb&&(Dd.currentTarget.setSelectionRange(0,0),null==xc?void 0:xc())},[xc]),jd=Ol.useCallback(Dd=>{Wb&&hd.current&&document.activeElement===Dd.currentTarget&&Dd.currentTarget.select()},[Wb]),rd=Ol.useCallback(Dd=>{Wb&&Dd.stopPropagation()},[Wb]);Ol.useEffect(()=>{Wb&&requestAnimationFrame(()=>{hd.current=!0;const Dd=
md.current;Dd&&(Dd.focus(),Dd.select())})},[Wb,xc]);const Md=Ol.useRef(null);Ol.useLayoutEffect(()=>{const Dd=Md.current;if(Dd){var Oe=eg(n||"Enter text",{fontFamily:"var(--ls-font-family)",fontSize:ua,lineHeight:1,fontWeight:Ga},4);Dd.style.transform=`scale(${vb}, ${vb}) translate(${Ma}px, ${fb}px)`;Dd.style.width=Oe[0]+1+"px";Dd.style.height=Oe[1]+1+"px"}},[n,Ga,ua,fb,Ma,vb]);return(0,Vt.jsx)("div",{className:"tl-text-label-wrapper",children:(0,Vt.jsxs)("div",{className:"tl-text-label-inner-wrapper",
ref:Md,style:{font:c,fontStyle:da,fontSize:ua,fontWeight:Ga,color:N,pointerEvents:oc?"all":"none",userSelect:Wb?"text":"none"},children:[Wb?(0,Vt.jsx)("textarea",{ref:md,style:{font:c,color:N,fontStyle:da,fontSize:ua,fontWeight:Ga},className:"tl-text-label-textarea",name:"text",tabIndex:-1,autoComplete:"false",autoCapitalize:"false",autoCorrect:"false",autoSave:"false",autoFocus:!0,placeholder:"Enter text",spellCheck:"true",wrap:"off",dir:"auto",datatype:"wysiwyg",defaultValue:n,color:N,onFocus:jd,
onChange:Bd,onKeyDown:Ld,onBlur:bd,onPointerDown:rd,onContextMenu:as,onCopy:as,onPaste:as,onCut:as}):n,""]})})}),vn=Z(288),Ox={xs:10,sm:16,md:20,lg:32,xl:48,xxl:60},Bp=class extends xk{constructor(){super(...arguments);xb(this,"canEdit",!0);xb(this,"ReactComponent",ue(({events:c,isErasing:n,isBinding:N,isSelected:da,isEditing:ua,onEditingEnd:Ga})=>{const {props:{size:[Ma,fb],stroke:vb,fill:Wb,noFill:oc,strokeWidth:xc,strokeType:Uc,borderRadius:md,opacity:hd,label:Bd,italic:Ld,fontWeight:bd,fontSize:jd}}=
this;var rd=Bd||ua?eg(Bd,{fontFamily:"var(--ls-font-family)",fontSize:jd,lineHeight:1,fontWeight:bd},4):[0,0];const Md=pe.mul(this.props.size,.5);rd=Math.max(.5,Math.min(1,Ma/rd[0],fb/rd[1]));const Dd=this.getBounds(),Oe=Lx.useMemo(()=>pe.sub(Md,pe.toFixed([Dd.width/2,Dd.height/2])),[Dd,rd,Md]),Pe=Lx.useCallback(cg=>{var cf;null==(cf=this.update)?void 0:cf.call(this,{label:cg})},[Bd]);return(0,vn.jsxs)("div",kg(Af({},c),{style:{width:"100%",height:"100%",overflow:"hidden"},className:"tl-box-container",
children:[(0,vn.jsx)(bs,{font:"20px / 1 var(--ls-font-family)",text:Bd,color:rf(vb,"text"),offsetX:Oe[0],offsetY:Oe[1],fontSize:jd,scale:rd,isEditing:ua,onChange:Pe,onBlur:Ga,fontStyle:Ld?"italic":"normal",fontWeight:bd,pointerEvents:!!Bd}),(0,vn.jsxs)(zl,{opacity:n?.2:hd,children:[N&&(0,vn.jsx)(sq,{mode:"svg",strokeWidth:xc,size:[Ma,fb]}),(0,vn.jsx)("rect",{className:da||!oc?"tl-hitarea-fill":"tl-hitarea-stroke",x:xc/2,y:xc/2,rx:md,ry:md,width:Math.max(.01,Ma-xc),height:Math.max(.01,fb-xc),pointerEvents:"all"}),
(0,vn.jsx)("rect",{x:xc/2,y:xc/2,rx:md,ry:md,width:Math.max(.01,Ma-xc),height:Math.max(.01,fb-xc),strokeWidth:xc,stroke:rf(vb,"stroke"),strokeDasharray:"dashed"===Uc?"8 2":void 0,fill:oc?"none":rf(Wb,"background")})]})]}))}));xb(this,"setScaleLevel",c=>Zh(this,null,function*(){this.update({scaleLevel:c,fontSize:Ox[null!=c?c:"md"],strokeWidth:Ox[null!=c?c:"md"]/10});this.onResetBounds()}));xb(this,"ReactIndicator",ue(()=>{const {props:{size:[c,n],borderRadius:N,isLocked:da}}=this;return(0,vn.jsx)("g",
{children:(0,vn.jsx)("rect",{width:c,height:n,rx:N,ry:N,fill:"transparent",strokeDasharray:da?"8 2":void 0})})}));xb(this,"validateProps",c=>{void 0!==c.size&&(c.size[0]=Math.max(c.size[0],1),c.size[1]=Math.max(c.size[1],1));void 0!==c.borderRadius&&(c.borderRadius=Math.max(0,c.borderRadius));return Vk(this,c)})}get scaleLevel(){var c;return null!=(c=this.props.scaleLevel)?c:"md"}};xb(Bp,"id","box");xb(Bp,"defaultProps",{id:"box",parentId:"page",type:"box",point:[0,0],size:[100,100],borderRadius:2,
stroke:"",fill:"",noFill:!1,fontWeight:400,fontSize:20,italic:!1,strokeType:"line",strokeWidth:2,opacity:1,label:""});re([Zg],Bp.prototype,"scaleLevel",1);re([Cg],Bp.prototype,"setScaleLevel",2);var Px=Lf(Z(69)),lm=Z(288),Qx={xs:10,sm:16,md:20,lg:32,xl:48,xxl:60},Cp=class extends ct{constructor(){super(...arguments);xb(this,"canEdit",!0);xb(this,"ReactComponent",ue(({isSelected:c,isErasing:n,events:N,isEditing:da,onEditingEnd:ua})=>{const {size:[Ga,Ma],stroke:fb,fill:vb,noFill:Wb,strokeWidth:oc,strokeType:xc,
opacity:Uc,label:md,italic:hd,fontWeight:Bd,fontSize:Ld}=this.props;var bd=md||da?eg(md,{fontFamily:"var(--ls-font-family)",fontSize:Ld,lineHeight:1,fontWeight:Bd},4):[0,0];const jd=pe.mul(this.props.size,.5);bd=Math.max(.5,Math.min(1,Ga/bd[0],Ma/bd[1]));const rd=this.getBounds(),Md=Px.useMemo(()=>pe.sub(jd,pe.toFixed([rd.width/2,rd.height/2])),[rd,bd,jd]),Dd=Px.useCallback(Oe=>{var Pe;null==(Pe=this.update)?void 0:Pe.call(this,{label:Oe})},[md]);return(0,lm.jsxs)("div",kg(Af({},N),{style:{width:"100%",
height:"100%",overflow:"hidden"},className:"tl-ellipse-container",children:[(0,lm.jsx)(bs,{font:"18px / 1 var(--ls-font-family)",text:md,color:rf(fb,"text"),offsetX:Md[0],offsetY:Md[1],scale:bd,isEditing:da,onChange:Dd,onBlur:ua,fontStyle:hd?"italic":"normal",fontSize:Ld,fontWeight:Bd,pointerEvents:!!md}),(0,lm.jsxs)(zl,kg(Af({},N),{opacity:n?.2:Uc,children:[(0,lm.jsx)("ellipse",{className:c||!Wb?"tl-hitarea-fill":"tl-hitarea-stroke",cx:Ga/2,cy:Ma/2,rx:Math.max(.01,(Ga-oc)/2),ry:Math.max(.01,(Ma-
oc)/2)}),(0,lm.jsx)("ellipse",{cx:Ga/2,cy:Ma/2,rx:Math.max(.01,(Ga-oc)/2),ry:Math.max(.01,(Ma-oc)/2),strokeWidth:oc,stroke:rf(fb,"stroke"),strokeDasharray:"dashed"===xc?"8 2":void 0,fill:Wb?"none":rf(vb,"background")})]}))]}))}));xb(this,"setScaleLevel",c=>Zh(this,null,function*(){this.update({scaleLevel:c,fontSize:Qx[null!=c?c:"md"],strokeWidth:Qx[null!=c?c:"md"]/10});this.onResetBounds()}));xb(this,"ReactIndicator",ue(()=>{const {size:[c,n],isLocked:N}=this.props;return(0,lm.jsx)("g",{children:(0,lm.jsx)("ellipse",
{cx:c/2,cy:n/2,rx:c/2,ry:n/2,strokeWidth:2,fill:"transparent",strokeDasharray:N?"8 2":"undefined"})})}));xb(this,"validateProps",c=>{void 0!==c.size&&(c.size[0]=Math.max(c.size[0],1),c.size[1]=Math.max(c.size[1],1));return Vk(this,c)})}get scaleLevel(){var c;return null!=(c=this.props.scaleLevel)?c:"md"}getShapeSVGJsx(c){const {size:[n,N],stroke:da,fill:ua,noFill:Ga,strokeWidth:Ma,strokeType:fb,opacity:vb}=this.props;return(0,lm.jsxs)("g",{opacity:vb,children:[(0,lm.jsx)("ellipse",{className:Ga?"tl-hitarea-stroke":
"tl-hitarea-fill",cx:n/2,cy:N/2,rx:Math.max(.01,(n-Ma)/2),ry:Math.max(.01,(N-Ma)/2)}),(0,lm.jsx)("ellipse",{cx:n/2,cy:N/2,rx:Math.max(.01,(n-Ma)/2),ry:Math.max(.01,(N-Ma)/2),strokeWidth:Ma,stroke:rf(da,"stroke"),strokeDasharray:"dashed"===fb?"8 2":void 0,fill:Ga?"none":rf(ua,"background")})]})}};xb(Cp,"id","ellipse");xb(Cp,"defaultProps",{id:"ellipse",parentId:"page",type:"ellipse",point:[0,0],size:[100,100],stroke:"",fill:"",noFill:!1,fontWeight:400,fontSize:20,italic:!1,strokeType:"line",strokeWidth:2,
opacity:1,label:""});re([Zg],Cp.prototype,"scaleLevel",1);re([Cg],Cp.prototype,"setScaleLevel",2);var Sq=Z(288),Wt=class extends Fr{constructor(){super(...arguments);xb(this,"ReactComponent",ue(({events:c})=>{const n=this.getBounds(),N=Te(),da=N.selectedShapesArray.some(Ga=>N.shapesInGroups([this]).includes(Ga)),ua=this.ReactIndicator;return(0,Sq.jsxs)(zl,kg(Af({},c),{className:"tl-group-container",children:[(0,Sq.jsx)("rect",{className:"tl-hitarea-fill",x:1,y:1,width:Math.max(.01,n.width-2),height:Math.max(.01,
n.height-2),pointerEvents:"all"}),da&&(0,Sq.jsx)("g",{stroke:"var(--color-selectedFill)",children:(0,Sq.jsx)(ua,{})})]}))}));xb(this,"ReactIndicator",ue(()=>{const c=this.getBounds();return(0,Sq.jsx)("rect",{strokeDasharray:"8 2",x:-8,y:-8,rx:4,ry:4,width:c.width+16,height:c.height+16,fill:"transparent"})}))}};xb(Wt,"id","group");xb(Wt,"defaultProps",{id:"group",type:"group",parentId:"page",point:[0,0],size:[0,0],children:[]});var cs=Z(288),UC={xs:1,sm:1.6,md:2,lg:3.2,xl:4.8,xxl:6},yo=class extends lp{constructor(c=
{}){super(c);xb(this,"ReactComponent",ue(({events:n,isErasing:N})=>{const {pointsPath:da,props:{stroke:ua,strokeWidth:Ga,opacity:Ma}}=this;return(0,cs.jsx)(zl,kg(Af({},n),{opacity:N?.2:1,children:(0,cs.jsx)("path",{d:da,strokeWidth:16*Ga,stroke:rf(ua,"stroke"),fill:"none",pointerEvents:"all",strokeLinejoin:"round",strokeLinecap:"round",opacity:Ma})}))}));xb(this,"setScaleLevel",n=>Zh(this,null,function*(){this.update({scaleLevel:n,strokeWidth:UC[null!=n?n:"md"]});this.onResetBounds()}));xb(this,"ReactIndicator",
ue(()=>{const {pointsPath:n,props:N}=this;return(0,cs.jsx)("path",{d:n,fill:"none",strokeDasharray:N.isLocked?"8 2":"undefined"})}));xb(this,"validateProps",n=>{n=Vk(this,n);void 0!==n.strokeWidth&&(n.strokeWidth=Math.max(n.strokeWidth,1));return n});Ec(this)}get pointsPath(){const {points:c}=this.props;return Xj.getCurvedPathForPoints(c)}get scaleLevel(){var c;return null!=(c=this.props.scaleLevel)?c:"md"}getShapeSVGJsx(){const {pointsPath:c,props:{stroke:n,strokeWidth:N,opacity:da}}=this;return(0,cs.jsx)("path",
{d:c,strokeWidth:16*N,stroke:rf(n,"stroke"),fill:"none",pointerEvents:"all",strokeLinejoin:"round",strokeLinecap:"round",opacity:da})}};xb(yo,"id","highlighter");xb(yo,"defaultProps",{id:"highlighter",parentId:"page",type:"highlighter",point:[0,0],points:[],isComplete:!1,stroke:"",fill:"",noFill:!0,strokeType:"line",strokeWidth:2,opacity:.5});re([Zg],yo.prototype,"pointsPath",1);re([Zg],yo.prototype,"scaleLevel",1);re([Cg],yo.prototype,"setScaleLevel",2);var Xt=Lf(Z(69)),ds=Z(288),Yt={xs:.5,sm:.8,
md:1,lg:1.5,xl:2,xxl:3},wn=class extends xk{constructor(){super(...arguments);xb(this,"canChangeAspectRatio",!0);xb(this,"canFlip",!1);xb(this,"canEdit",!0);xb(this,"htmlAnchorRef",Xt.createRef());xb(this,"setScaleLevel",c=>Zh(this,null,function*(){var n;const N=pe.mul(this.props.size,Yt[null!=c?c:"md"]/Yt[null!=(n=this.props.scaleLevel)?n:"md"]);this.update({scaleLevel:c});yield Gc();this.update({size:N})}));xb(this,"onResetBounds",c=>{var n;if(this.htmlAnchorRef.current){const N=this.htmlAnchorRef.current.getBoundingClientRect(),
[da,ua]=pe.div([N.width,N.height],null!=(n=null==c?void 0:c.zoom)?n:1);this.update({size:[Math.max(Math.min(da||400,1400),10),Math.max(Math.min(ua||400,1400),10)]})}return this});xb(this,"ReactComponent",ue(({events:c,isErasing:n,isEditing:N})=>{const {props:{html:da,scaleLevel:ua}}=this,Ga=Sm(),Ma=Te(),fb=Ma.selectedIds.has(this.id),vb=Ga||fb&&!N||"select"!==Ma.selectedTool.id,Wb=Xt.useCallback(xc=>{vb||xc.stopPropagation()},[vb]),oc=Yt[null!=ua?ua:"md"];Xt.useEffect(()=>{0===this.props.size[1]&&
(this.onResetBounds({zoom:Ma.viewport.camera.zoom}),Ma.persist({replace:!0}))},[]);return(0,ds.jsx)($k,kg(Af({style:{overflow:"hidden",pointerEvents:"all",opacity:n?.2:1}},c),{children:(0,ds.jsx)("div",{onWheelCapture:Wb,onPointerDown:Wb,onPointerUp:Wb,className:"tl-html-container",style:{pointerEvents:Ga||!N&&!fb?"none":"all",overflow:N?"auto":"hidden",width:`calc(100% / ${oc})`,height:`calc(100% / ${oc})`,transform:`scale(${oc})`},children:(0,ds.jsx)("div",{ref:this.htmlAnchorRef,className:"tl-html-anchor",
dangerouslySetInnerHTML:{__html:da.trim()}})})}))}));xb(this,"ReactIndicator",ue(()=>{const {props:{size:[c,n],isLocked:N}}=this;return(0,ds.jsx)("rect",{width:c,height:n,fill:"transparent",strokeDasharray:N?"8 2":"undefined"})}));xb(this,"validateProps",c=>{void 0!==c.size&&(c.size[0]=Math.max(c.size[0],1),c.size[1]=Math.max(c.size[1],1));return Vk(this,c)})}get scaleLevel(){var c;return null!=(c=this.props.scaleLevel)?c:"md"}};xb(wn,"id","html");xb(wn,"defaultProps",{id:"html",type:"html",parentId:"page",
point:[0,0],size:[600,0],html:""});re([Zg],wn.prototype,"scaleLevel",1);re([Cg],wn.prototype,"setScaleLevel",2);var Rx=Lf(Z(69)),Tq=Z(288),zo=class extends xk{constructor(){super(...arguments);xb(this,"frameRef",Rx.createRef());xb(this,"canEdit",!0);xb(this,"onIFrameSourceChange",c=>{this.update({url:c})});xb(this,"reload",()=>{var c,n;this.frameRef.current&&(this.frameRef.current.src=null==(n=null==(c=this.frameRef)?void 0:c.current)?void 0:n.src)});xb(this,"ReactComponent",ue(({events:c,isErasing:n,
isEditing:N})=>{Rx.useRef(null);const da=Te();return(0,Tq.jsx)($k,kg(Af({style:{overflow:"hidden",pointerEvents:"all",opacity:n?.2:1}},c),{children:(0,Tq.jsx)("div",{className:"tl-iframe-container",style:{pointerEvents:N||da.readOnly?"all":"none",userSelect:"none"},children:this.props.url&&(0,Tq.jsx)("div",{style:{overflow:"hidden",position:"relative",height:"100%"},children:(0,Tq.jsx)("iframe",{ref:this.frameRef,className:"absolute inset-0 w-full h-full m-0",width:"100%",height:"100%",src:`${this.props.url}`,
frameBorder:"0",sandbox:"allow-scripts allow-same-origin allow-presentation"})})})}))}));xb(this,"ReactIndicator",ue(()=>{const {props:{size:[c,n],isLocked:N}}=this;return(0,Tq.jsx)("rect",{width:c,height:n,fill:"transparent",rx:8,ry:8,strokeDasharray:N?"8 2":"undefined"})}))}};xb(zo,"id","iframe");xb(zo,"defaultProps",{id:"iframe",type:"iframe",parentId:"page",point:[0,0],size:[853,480],url:""});re([Cg],zo.prototype,"onIFrameSourceChange",2);re([Cg],zo.prototype,"reload",2);var VC=Lf(Z(69)),Dp=Z(288),
es=class extends dt{constructor(){super(...arguments);xb(this,"ReactComponent",ue(({events:c,isErasing:n,isBinding:N,asset:da})=>{const {props:{opacity:ua,objectFit:Ga,clipping:Ma,size:[fb,vb]}}=this,[Wb,oc,xc,Uc]=Array.isArray(Ma)?Ma:[Ma,Ma,Ma,Ma],{handlers:md}=VC.useContext(vi);return(0,Dp.jsxs)($k,kg(Af({},c),{opacity:n?.2:ua,children:[N&&(0,Dp.jsx)(sq,{mode:"html",strokeWidth:4,size:[fb,vb]}),(0,Dp.jsx)("div",{"data-asset-loaded":!!da,className:"tl-image-shape-container",children:da?(0,Dp.jsx)("img",
{src:md?md.makeAssetUrl(da.src):da.src,draggable:!1,style:{position:"relative",top:-Wb,left:-Uc,width:fb+(Uc-oc),height:vb+(Wb-xc),objectFit:Ga}}):"Asset is missing"})]}))}));xb(this,"ReactIndicator",ue(()=>{const {props:{size:[c,n],isLocked:N}}=this;return(0,Dp.jsx)("rect",{width:c,height:n,fill:"transparent",strokeDasharray:N?"8 2":"undefined"})}))}getShapeSVGJsx({assets:c}){var n,N;const da=this.getBounds(),{assetId:ua,clipping:Ga}=this.props;if(c=c.find(Ma=>Ma.id===ua)){Array.isArray(Ga);const Ma=
null==(N=null==(n=window.logseq)?void 0:n.api)?void 0:N.make_asset_url;return(0,Dp.jsx)("image",{width:da.width,height:da.height,href:Ma?Ma(c.src):c.src})}return super.getShapeSVGJsx({})}};xb(es,"id","image");xb(es,"defaultProps",{id:"image1",parentId:"page",type:"image",point:[0,0],size:[100,100],opacity:1,assetId:"",clipping:0,objectFit:"fill",isAspectRatioLocked:!0});var Zt=Lf(Z(69)),WC=Lf(Z(69)),$t=Z(288),Ep=Z(288),Sx={xs:10,sm:16,md:20,lg:32,xl:48,xxl:60},XC=WC.memo(function({style:c,start:n,
end:N,decorationStart:da,decorationEnd:ua,scaleLevel:Ga}){const Ma=pe.dist(n,N);if(2>Ma)return null;const {strokeWidth:fb}=c,vb=1+fb*Sx[null!=Ga?Ga:"md"]/10,Wb="M"+pe.toFixed(n)+"L"+pe.toFixed(N);Ga=Math.min(Ma/3,fb*Sx[null!=Ga?Ga:"md"]);da=da?Wl(n,N,Ga):null;ua=ua?Wl(N,n,Ga):null;return(0,Ep.jsxs)(Ep.Fragment,{children:[(0,Ep.jsx)("path",{className:"tl-stroke-hitarea",d:Wb}),(0,Ep.jsx)("path",{d:Wb,strokeWidth:vb,stroke:c.stroke,strokeLinecap:"round",strokeLinejoin:"round",strokeDasharray:"dashed"===
c.strokeType?"8 4":void 0,pointerEvents:"stroke"}),da&&(0,Ep.jsx)(No,{left:da.left,middle:n,right:da.right,stroke:c.stroke,strokeWidth:vb}),ua&&(0,Ep.jsx)(No,{left:ua.left,middle:N,right:ua.right,stroke:c.stroke,strokeWidth:vb})]})}),fs=Z(288),Mk=Z(288),YC={xs:10,sm:16,md:20,lg:32,xl:48,xxl:60},Fp=class extends Fq{constructor(){super(...arguments);xb(this,"hideSelection",!0);xb(this,"canEdit",!0);xb(this,"ReactComponent",ue(({events:c,isErasing:n,isEditing:N,onEditingEnd:da})=>{const {stroke:ua,handles:{start:Ga,
end:Ma},opacity:fb,label:vb,italic:Wb,fontWeight:oc,fontSize:xc,id:Uc}=this.props,md=vb||N?eg(vb||"Enter text",{fontFamily:"var(--ls-font-family)",fontSize:xc,lineHeight:1,fontWeight:oc},6):[0,0],hd=pe.med(Ga.point,Ma.point);var Bd=pe.dist(Ga.point,Ma.point);Bd=Math.max(.5,Math.min(1,Math.max(Bd/(md[1]+128),Bd/(md[0]+128))));const Ld=this.getBounds(),bd=Zt.useMemo(()=>pe.sub(hd,pe.toFixed([Ld.width/2,Ld.height/2])),[Ld,Bd,hd]),jd=Zt.useCallback(rd=>{var Md;null==(Md=this.update)?void 0:Md.call(this,
{label:rd})},[vb]);return(0,Mk.jsxs)("div",kg(Af({},c),{style:{width:"100%",height:"100%",overflow:"hidden"},className:"tl-line-container",children:[(0,Mk.jsx)(bs,{font:"20px / 1 var(--ls-font-family)",text:vb,fontSize:xc,color:rf(ua,"text"),offsetX:bd[0],offsetY:bd[1],scale:Bd,isEditing:N,onChange:jd,onBlur:da,fontStyle:Wb?"italic":"normal",fontWeight:oc,pointerEvents:!!vb}),(0,Mk.jsxs)(zl,{opacity:n?.2:fb,id:Uc+"_svg",children:[(0,Mk.jsx)(bp,{id:Uc,bounds:Ld,labelSize:md,offset:bd,scale:Bd}),(0,Mk.jsx)("g",
{pointerEvents:"none",mask:vb||N?`url(#${Uc}_clip)`:"",children:this.getShapeSVGJsx({preview:!1})})]})]}))}));xb(this,"setScaleLevel",c=>Zh(this,null,function*(){this.update({scaleLevel:c,fontSize:YC[null!=c?c:"md"]});this.onResetBounds()}));xb(this,"ReactIndicator",ue(({isEditing:c})=>{const {id:n,decorations:N,label:da,strokeWidth:ua,fontSize:Ga,fontWeight:Ma,handles:{start:fb,end:vb},isLocked:Wb}=this.props,oc=this.getBounds(),xc=da||c?eg(da,{fontFamily:"var(--ls-font-family)",fontSize:Ga,lineHeight:1,
fontWeight:Ma},6):[0,0],Uc=pe.med(fb.point,vb.point);var md=pe.dist(fb.point,vb.point);md=Math.max(.5,Math.min(1,Math.max(md/(xc[1]+128),md/(xc[0]+128))));const hd=Zt.useMemo(()=>pe.sub(Uc,pe.toFixed([oc.width/2,oc.height/2])),[oc,md,Uc]);return(0,Mk.jsxs)("g",{children:[(0,Mk.jsx)("path",{mask:da?`url(#${n}_clip)`:"",d:Bj({strokeWidth:ua},fb.point,vb.point,null==N?void 0:N.start,null==N?void 0:N.end),strokeDasharray:Wb?"8 2":"undefined"}),da&&!c&&(0,Mk.jsx)("rect",{x:oc.width/2-xc[0]/2*md+hd[0],
y:oc.height/2-xc[1]/2*md+hd[1],width:xc[0]*md,height:xc[1]*md,rx:4*md,ry:4*md,fill:"transparent"})]})}));xb(this,"validateProps",c=>Vk(this,c))}get scaleLevel(){var c;return null!=(c=this.props.scaleLevel)?c:"md"}getShapeSVGJsx({preview:c}){const {stroke:n,fill:N,strokeWidth:da,strokeType:ua,decorations:Ga,label:Ma,scaleLevel:fb,handles:{start:vb,end:Wb}}=this.props,oc=pe.med(vb.point,Wb.point);return(0,Mk.jsxs)(Mk.Fragment,{children:[(0,Mk.jsx)(XC,{style:{stroke:rf(n,"text"),fill:N,strokeWidth:da,
strokeType:ua},scaleLevel:fb,start:vb.point,end:Wb.point,decorationStart:null==Ga?void 0:Ga.start,decorationEnd:null==Ga?void 0:Ga.end}),c&&(0,Mk.jsx)(Mk.Fragment,{children:(0,Mk.jsx)("text",{style:{transformOrigin:"top left"},fontFamily:"Inter",fontSize:20,transform:`translate(${oc[0]}, ${oc[1]})`,textAnchor:"middle",fill:rf(n,"text"),stroke:rf(n,"text"),children:Ma})})]})}};xb(Fp,"id","line");xb(Fp,"defaultProps",{id:"line",parentId:"page",type:"line",point:[0,0],handles:{start:{id:"start",canBind:!0,
point:[0,0]},end:{id:"end",canBind:!0,point:[1,1]}},stroke:"",fill:"",noFill:!0,fontWeight:400,fontSize:20,italic:!1,strokeType:"line",strokeWidth:1,opacity:1,decorations:{end:"arrow"},label:""});re([Zg],Fp.prototype,"scaleLevel",1);re([Cg],Fp.prototype,"setScaleLevel",2);var Nk=Lf(Z(69)),mj=Z(288),Uq={xs:.5,sm:.8,md:1,lg:1.5,xl:2,xxl:3},ZC=ue(({type:c,fill:n,opacity:N,children:da})=>{const ua="var(--ls-secondary-background-color)"!==n?rf(n,"background"):"var(--ls-tertiary-background-color)";n=n&&
"var(--ls-secondary-background-color)"!==n?tf(n)?`var(--ls-highlight-color-${n})`:n:"var(--ls-secondary-background-color)";return(0,mj.jsxs)("div",{className:`tl-logseq-portal-header tl-logseq-portal-header-${"P"===c?"page":"block"}`,children:[(0,mj.jsx)("div",{className:"absolute inset-0 tl-logseq-portal-header-bg",style:{opacity:N,background:"P"===c?ua:`linear-gradient(0deg, ${n}, ${ua})`}}),(0,mj.jsx)("div",{className:"relative",children:da})]})}),Gj=class extends xk{constructor(c={}){var n;super(c);
xb(this,"hideRotateHandle",!0);xb(this,"canChangeAspectRatio",!0);xb(this,"canFlip",!0);xb(this,"canEdit",!0);xb(this,"persist",null);xb(this,"initialHeightCalculated",!0);xb(this,"getInnerHeight",null);xb(this,"setCollapsed",N=>Zh(this,null,function*(){var da;if("B"===this.props.blockType){if(this.update({compact:N}),this.canResize[1]=!N,!N)this.onResetBounds()}else{const ua=this.props.size[1];this.canResize[1]=!N;this.update({isAutoResizing:!N,collapsed:N,size:[this.props.size[0],N?this.getHeaderHeight():
this.props.collapsedHeight],collapsedHeight:N?ua:this.props.collapsedHeight})}null==(da=this.persist)?void 0:da.call(this)}));xb(this,"setScaleLevel",N=>Zh(this,null,function*(){var da;const ua=pe.mul(this.props.size,Uq[null!=N?N:"md"]/Uq[null!=(da=this.props.scaleLevel)?da:"md"]);this.update({scaleLevel:N});yield Gc();this.update({size:ua})}));xb(this,"onResetBounds",N=>{N=this.getAutoResizeHeight();null!==N&&1<Math.abs(N-this.props.size[1])&&(this.update({size:[this.props.size[0],N]}),this.initialHeightCalculated=
!0);return this});xb(this,"onResize",(N,da)=>{var ua;const {bounds:Ga,rotation:Ma,scale:[fb,vb]}=da;N=[...this.scale];0>fb&&(N[0]*=-1);0>vb&&(N[1]*=-1);da=Ga.height;this.props.isAutoResizing&&(da=null!=(ua=this.getAutoResizeHeight())?ua:da);return this.update({point:[Ga.minX,Ga.minY],size:[Math.max(1,Ga.width),Math.max(1,da)],scale:N,rotation:Ma})});xb(this,"PortalComponent",ue(({})=>{const {props:{pageId:N,fill:da,opacity:ua}}=this,{renderers:Ga}=Nk.useContext(vi),Ma=Te(),fb=Nk.useRef(null),[,vb]=
this.useComponentSize(fb,this.props.compact?".tl-logseq-cp-container \x3e .single-block":".tl-logseq-cp-container \x3e .page");if(null==Ga||!Ga.Page)return null;const {Page:Wb,Block:oc}=Ga,[xc,Uc]=Nk.useState(!1);Nk.useEffect(()=>{var md,hd;if(this.props.isAutoResizing){const Bd=(null!=(hd=null==(md=this.getInnerHeight)?void 0:md.call(this))?hd:vb)+this.getHeaderHeight();vb&&1<Math.abs(Bd-this.props.size[1])&&(this.update({size:[this.props.size[0],Bd]}),xc&&Ma.persist({replace:!0}))}},[vb,this.props.isAutoResizing]);
Nk.useEffect(()=>{this.initialHeightCalculated||setTimeout(()=>{this.onResetBounds();Ma.persist({replace:!0})})},[this.initialHeightCalculated]);Nk.useEffect(()=>{setTimeout(function(){Uc(!0)})},[]);return(0,mj.jsxs)(mj.Fragment,{children:[(0,mj.jsx)("div",{className:"absolute inset-0 tl-logseq-cp-container-bg",style:{textRendering:.5>Ma.viewport.camera.zoom?"optimizeSpeed":"auto",background:da&&"var(--ls-secondary-background-color)"!==da?tf(da)?`var(--ls-highlight-color-${da})`:da:"var(--ls-secondary-background-color)",
opacity:ua}}),(0,mj.jsx)("div",{ref:fb,className:"relative tl-logseq-cp-container",style:{overflow:this.props.isAutoResizing?"visible":"auto"},children:(xc||!this.initialHeightCalculated)&&("B"===this.props.blockType&&this.props.compact?(0,mj.jsx)(oc,{blockId:N}):(0,mj.jsx)(Wb,{pageName:N}))})]})}));xb(this,"ReactComponent",ue(N=>{var da;const {events:ua,isErasing:Ga,isEditing:Ma,isBinding:fb}=N,{props:{opacity:vb,pageId:Wb,fill:oc,scaleLevel:xc,strokeWidth:Uc,size:md}}=this,hd=Te(),{renderers:Bd,
handlers:Ld}=Nk.useContext(vi);this.persist=()=>hd.persist();const bd=Sm(),jd=hd.selectedIds.has(this.id)&&1===hd.selectedIds.size,rd=hd.isIn("logseq-portal.creating")&&!Wb,Md=(bd||jd&&!Ma||"select"!==hd.selectedTool.id)&&!rd,Dd=Nk.useCallback(vf=>{Md||vf.stopPropagation()},[Md]),Oe=1===hd.selectedShapesArray.length&&hd.selectedShapesArray.some(vf=>"logseq-portal"===vf.type&&vf.props.id!==this.props.id&&Wb&&vf.props.pageId===Wb),Pe=Uq[null!=xc?xc:"md"];Nk.useEffect(()=>this.props.collapsed&&Ma?(this.update({size:[this.props.size[0],
this.props.collapsedHeight]}),()=>{this.update({size:[this.props.size[0],this.getHeaderHeight()]})}):()=>{},[Ma,this.props.collapsed]);Nk.useEffect(()=>{if(rd){const vf=[hd.viewport.bounds.width,hd.viewport.bounds.height],Ef=hd.viewport.getScreenPoint([this.bounds.minX,this.bounds.minY]);(Ef[0]>vf[0]-400||Ef[1]>vf[1]-240||1.5<hd.viewport.camera.zoom||.5>hd.viewport.camera.zoom)&&hd.viewport.zoomToBounds(kg(Af({},this.bounds),{minY:this.bounds.maxY+25}))}},[hd.viewport.bounds.height.toFixed(2)]);const cg=
Nk.useCallback((vf,Ef)=>{this.initialHeightCalculated=!1;Ef=Ef?"P":"B";this.update({pageId:vf,size:[400,320],blockType:Ef,compact:"B"===Ef});hd.selectTool("select");hd.history.resume();hd.history.persist()},[]),cf=this.PortalComponent;var Of=Nk.useMemo(()=>{var vf;if(Wb&&"B"===this.props.blockType)return null==(vf=null==Ld?void 0:Ld.queryBlockByUUID(Wb))?void 0:vf.title},[null==Ld?void 0:Ld.queryBlockByUUID,Wb]);Of="B"===this.props.blockType&&"string"!==typeof Of;const Hg=(!this.props.collapsed||
Ma)&&!Of;if(null==Bd||!Bd.Page)return null;const {Breadcrumb:ah,PageName:Eg}=Bd,bh={width:`calc(100% / ${Pe})`,height:`calc(100% / ${Pe})`,opacity:Ga?.2:1};1!==Pe&&(bh.transform=`scale(${Pe})`);return(0,mj.jsxs)($k,kg(Af({style:{pointerEvents:"all"}},ua),{children:[fb&&(0,mj.jsx)(sq,{mode:"html",strokeWidth:Uc,size:md}),(0,mj.jsx)("div",{"data-inner-events":!Md,onWheelCapture:Dd,onPointerDown:Dd,onPointerUp:Dd,style:{width:"100%",height:"100%",pointerEvents:bd||!Ma&&!jd?"none":"all"},children:rd?
(0,mj.jsx)(Vs,{onChange:cg,onAddBlock:vf=>{setTimeout(()=>{var Ef,xf,Vf;hd.api.editShape(this);null==(Vf=null==(xf=null==(Ef=window.logseq)?void 0:Ef.api)?void 0:xf.edit_block)?void 0:Vf.call(xf,vf)})},placeholder:"Create or search your graph..."}):(0,mj.jsxs)("div",{className:"tl-logseq-portal-container","data-collapsed":this.collapsed,"data-page-id":Wb,"data-portal-selected":Oe,"data-editing":Ma,style:bh,children:[!this.props.compact&&!Of&&(0,mj.jsx)(ZC,{type:null!=(da=this.props.blockType)?da:
"P",fill:oc,opacity:vb,children:"P"===this.props.blockType?(0,mj.jsx)(Eg,{pageName:Wb}):(0,mj.jsx)(ah,{blockId:Wb})}),Of&&(0,mj.jsx)("div",{className:"tl-target-not-found",children:"Target not found"}),Hg&&(0,mj.jsx)(cf,Af({},N))]})})]}))}));xb(this,"ReactIndicator",ue(()=>{const N=this.getBounds();return(0,mj.jsx)("rect",{width:N.width,height:N.height,fill:"transparent",rx:8,ry:8,strokeDasharray:this.props.isLocked?"8 2":"undefined"})}));xb(this,"validateProps",N=>{var da;if(void 0!==N.size){const ua=
Uq[null!=(da=this.props.scaleLevel)?da:"md"];N.size[0]=Math.max(N.size[0],60*ua);N.size[1]=Math.max(N.size[1],40*ua)}return Vk(this,N)});Ec(this);c.collapsed&&Object.assign(this.canResize,[!0,!1]);0===(null==(n=c.size)?void 0:n[1])&&(this.initialHeightCalculated=!1)}static isPageOrBlock(c){return c?/^\(\(.*\)\)$/.test(c)&&40===c.length?"B":"P":!1}get collapsed(){return"B"===this.props.blockType?this.props.compact:this.props.collapsed}get scaleLevel(){var c;return null!=(c=this.props.scaleLevel)?c:
"md"}useComponentSize(c,n=""){const [N,da]=Nk.useState([0,0]),ua=Te();Nk.useEffect(()=>{setTimeout(()=>{if(null==c?0:c.current){const Ga=n?c.current.querySelector(n):c.current;if(Ga){const Ma=()=>{const {width:vb,height:Wb}=Ga.getBoundingClientRect(),oc=pe.div([vb,Wb],ua.viewport.camera.zoom);da(oc);return oc};Ma();this.getInnerHeight=()=>Ma()[1];const fb=new ResizeObserver(()=>{Ma()});fb.observe(Ga);return()=>{fb.disconnect()}}}return()=>{}},10)},[c,n]);return N}getHeaderHeight(){var c;const n=Uq[null!=
(c=this.props.scaleLevel)?c:"md"];return this.props.compact?0:40*n}getAutoResizeHeight(){return this.getInnerHeight?this.getHeaderHeight()+this.getInnerHeight():null}getShapeSVGJsx({}){var c,n,N;const da=this.getBounds();return(0,mj.jsxs)(mj.Fragment,{children:[(0,mj.jsx)("rect",{fill:this.props.fill&&"var(--ls-secondary-background-color)"!==this.props.fill?tf(this.props.fill)?`var(--ls-highlight-color-${this.props.fill})`:this.props.fill:"var(--ls-secondary-background-color)",stroke:rf(this.props.fill,
"background"),strokeWidth:null!=(c=this.props.strokeWidth)?c:2,fillOpacity:null!=(n=this.props.opacity)?n:.2,width:da.width,rx:8,ry:8,height:da.height}),!this.props.compact&&(0,mj.jsx)("rect",{fill:this.props.fill&&"var(--ls-secondary-background-color)"!==this.props.fill?rf(this.props.fill,"background"):"var(--ls-tertiary-background-color)",fillOpacity:null!=(N=this.props.opacity)?N:.2,x:1,y:1,width:da.width-2,height:38,rx:8,ry:8}),(0,mj.jsx)("text",{style:{transformOrigin:"top left"},transform:`translate(${da.width/
2}, ${10+da.height/2})`,textAnchor:"middle",fontFamily:"var(--ls-font-family)",fontSize:"32",fill:"var(--ls-secondary-text-color)",stroke:"var(--ls-secondary-text-color)",children:"P"===this.props.blockType?this.props.pageName:""})]})}};xb(Gj,"id","logseq-portal");xb(Gj,"defaultSearchQuery","");xb(Gj,"defaultSearchFilter",null);xb(Gj,"defaultProps",{id:"logseq-portal",type:"logseq-portal",parentId:"page",point:[0,0],size:[400,50],collapsedHeight:0,stroke:"",fill:"",noFill:!1,borderRadius:8,strokeWidth:2,
strokeType:"line",opacity:1,pageId:"",collapsed:!1,compact:!1,scaleLevel:"md",isAutoResizing:!0});re([Zg],Gj.prototype,"collapsed",1);re([Cg],Gj.prototype,"setCollapsed",2);re([Zg],Gj.prototype,"scaleLevel",1);re([Cg],Gj.prototype,"setScaleLevel",2);var {min:Gp,PI:$C}=Math,Vq=$C+1E-4,au=Z(288),aD={xs:1,sm:1.6,md:2,lg:3.2,xl:4.8,xxl:6},bD={easing:c=>Math.sin(c*Math.PI/2),simulatePressure:!0},cD={easing:c=>c*c,simulatePressure:!1},Ao=class extends lp{constructor(c={}){super(c);xb(this,"ReactComponent",
ue(({events:n,isErasing:N})=>{const {props:{opacity:da}}=this;return(0,au.jsx)(zl,kg(Af({},n),{opacity:N?.2:da,children:this.getShapeSVGJsx()}))}));xb(this,"setScaleLevel",n=>Zh(this,null,function*(){this.update({scaleLevel:n,strokeWidth:aD[null!=n?n:"md"]});this.onResetBounds()}));xb(this,"ReactIndicator",ue(()=>{const {pointsPath:n}=this;return(0,au.jsx)("path",{d:n,strokeDasharray:this.props.isLocked?"8 2":"undefined"})}));xb(this,"validateProps",n=>{n=Vk(this,n);void 0!==n.strokeWidth&&(n.strokeWidth=
Math.max(n.strokeWidth,1));return n});Ec(this)}get pointsPath(){var c=this.props;if(2>c.points.length)var n="";else n=kg(Af({size:1+1.5*c.strokeWidth,thinning:.65,streamline:.65,smoothing:.65},.5===c.points[1][2]?bD:cD),{last:c.isComplete}),c=Ws(c.points,n),n=Xj.getSvgPathFromStroke(uq(c,n));return n}get scaleLevel(){var c;return null!=(c=this.props.scaleLevel)?c:"md"}getShapeSVGJsx(){const {pointsPath:c,props:{stroke:n,strokeWidth:N,strokeType:da}}=this;return(0,au.jsx)("path",{pointerEvents:"all",
d:c,strokeWidth:N/2,strokeLinejoin:"round",strokeLinecap:"round",stroke:rf(n,"text"),fill:rf(n,"text"),strokeDasharray:"dashed"===da?"12 4":void 0})}};xb(Ao,"id","pencil");xb(Ao,"defaultProps",{id:"pencil",parentId:"page",type:"pencil",point:[0,0],points:[],isComplete:!1,stroke:"",fill:"",noFill:!0,strokeType:"line",strokeWidth:2,opacity:1});re([Zg],Ao.prototype,"pointsPath",1);re([Zg],Ao.prototype,"scaleLevel",1);re([Cg],Ao.prototype,"setScaleLevel",2);var Tx=Lf(Z(69)),Pl=Z(288),Ux={xs:10,sm:16,
md:20,lg:32,xl:48,xxl:60},Hp=class extends ln{constructor(){super(...arguments);xb(this,"canEdit",!0);xb(this,"ReactComponent",ue(({events:c,isErasing:n,isSelected:N,isEditing:da,onEditingEnd:ua})=>{const {offset:[Ga,Ma],props:{stroke:fb,fill:vb,noFill:Wb,strokeWidth:oc,opacity:xc,strokeType:Uc,label:md,italic:hd,fontWeight:Bd,fontSize:Ld}}=this,bd=this.getVertices(oc/2).join();var jd=md||da?eg(md,{fontFamily:"var(--ls-font-family)",fontSize:Ld,lineHeight:1,fontWeight:Bd},4):[0,0];const rd=[this.props.size[0]/
2,2*this.props.size[1]/3];jd=Math.max(.5,Math.min(1,this.props.size[0]/(2*jd[0]),this.props.size[1]/(2*jd[1])));const Md=this.getBounds(),Dd=Tx.useMemo(()=>pe.sub(rd,pe.toFixed([Md.width/2,Md.height/2])),[Md,jd,rd]),Oe=Tx.useCallback(Pe=>{var cg;null==(cg=this.update)?void 0:cg.call(this,{label:Pe})},[md]);return(0,Pl.jsxs)("div",kg(Af({},c),{style:{width:"100%",height:"100%",overflow:"hidden"},children:[(0,Pl.jsx)(bs,{font:"20px / 1 var(--ls-font-family)",text:md,fontSize:Ld,color:rf(fb,"text"),
offsetX:Dd[0],offsetY:Dd[1]/jd,scale:jd,isEditing:da,onChange:Oe,onBlur:ua,fontStyle:hd?"italic":"normal",fontWeight:Bd,pointerEvents:!!md}),(0,Pl.jsx)(zl,{opacity:n?.2:xc,children:(0,Pl.jsxs)("g",{transform:`translate(${Ga}, ${Ma})`,children:[(0,Pl.jsx)("polygon",{className:N||!Wb?"tl-hitarea-fill":"tl-hitarea-stroke",points:bd}),(0,Pl.jsx)("polygon",{points:bd,stroke:rf(fb,"stroke"),fill:Wb?"none":rf(vb,"background"),strokeWidth:oc,rx:2,ry:2,strokeLinejoin:"round",strokeDasharray:"dashed"===Uc?
"8 2":void 0})]})})]}))}));xb(this,"setScaleLevel",c=>Zh(this,null,function*(){this.update({scaleLevel:c,fontSize:Ux[null!=c?c:"md"],strokeWidth:Ux[null!=c?c:"md"]/10});this.onResetBounds()}));xb(this,"ReactIndicator",ue(()=>{const {offset:[c,n],props:{strokeWidth:N,isLocked:da}}=this;return(0,Pl.jsx)("g",{children:(0,Pl.jsx)("polygon",{transform:`translate(${c}, ${n})`,points:this.getVertices(N/2).join(),strokeDasharray:da?"8 2":"undefined"})})}));xb(this,"validateProps",c=>{void 0!==c.sides&&(c.sides=
Math.max(c.sides,3));return Vk(this,c)})}get scaleLevel(){var c;return null!=(c=this.props.scaleLevel)?c:"md"}getShapeSVGJsx(c){const {offset:[n,N],props:{stroke:da,fill:ua,noFill:Ga,strokeWidth:Ma,opacity:fb,strokeType:vb}}=this;c=this.getVertices(Ma/2).join();return(0,Pl.jsxs)("g",{transform:`translate(${n}, ${N})`,opacity:fb,children:[(0,Pl.jsx)("polygon",{className:Ga?"tl-hitarea-stroke":"tl-hitarea-fill",points:c}),(0,Pl.jsx)("polygon",{points:c,stroke:rf(da,"stroke"),fill:Ga?"none":rf(ua,"background"),
strokeWidth:Ma,rx:2,ry:2,strokeLinejoin:"round",strokeDasharray:"dashed"===vb?"8 2":void 0})]})}};xb(Hp,"id","polygon");xb(Hp,"defaultProps",{id:"polygon",parentId:"page",type:"polygon",point:[0,0],size:[100,100],sides:3,ratio:1,isFlippedY:!1,stroke:"",fill:"",fontWeight:400,fontSize:20,italic:!1,noFill:!1,strokeType:"line",strokeWidth:2,opacity:1,label:""});re([Zg],Hp.prototype,"scaleLevel",1);re([Cg],Hp.prototype,"setScaleLevel",2);var mm=Lf(Z(69)),xn=Z(288),dD={xs:10,sm:16,md:20,lg:32,xl:48,xxl:60},
Ip=class extends et{constructor(){super(...arguments);xb(this,"ReactComponent",ue(({events:c,isErasing:n,isEditing:N,onEditingEnd:da})=>{const {props:{opacity:ua,fontFamily:Ga,fontSize:Ma,fontWeight:fb,italic:vb,lineHeight:Wb,text:oc,stroke:xc,padding:Uc}}=this,md=mm.useRef(null),hd=mm.useRef(!1),Bd=mm.useRef(null),Ld=mm.useCallback(Dd=>{const {isSizeLocked:Oe}=this.props;Dd=sp.normalizeText(Dd.currentTarget.value);Oe?this.update({text:Dd,size:this.getAutoSizedBoundingBox({text:Dd})}):this.update({text:Dd})},
[]),bd=mm.useCallback(Dd=>{if("Escape"!==Dd.key)if("Tab"===Dd.key&&0===oc.length)Dd.preventDefault();else{if("Meta"!==Dd.key&&!Dd.metaKey)Dd.stopPropagation();else if("z"===Dd.key&&Dd.metaKey){Dd.shiftKey?document.execCommand("redo",!1):document.execCommand("undo",!1);Dd.stopPropagation();Dd.preventDefault();return}"Tab"===Dd.key&&(Dd.preventDefault(),Dd.shiftKey?bl.unindent(Dd.currentTarget):bl.indent(Dd.currentTarget),this.update({text:sp.normalizeText(Dd.currentTarget.value)}))}},[]),jd=mm.useCallback(Dd=>
{N&&(null==da?void 0:da())},[da]),rd=mm.useCallback(Dd=>{N&&hd.current&&document.activeElement===Dd.currentTarget&&Dd.currentTarget.select()},[N]),Md=mm.useCallback(Dd=>{N&&Dd.stopPropagation()},[N]);mm.useEffect(()=>{N&&requestAnimationFrame(()=>{hd.current=!0;const Dd=md.current;Dd&&(Dd.focus(),Dd.select())})},[N,da]);mm.useLayoutEffect(()=>{if(0===this.props.size[0]||0===this.props.size[1])this.onResetBounds()},[]);return(0,xn.jsx)($k,kg(Af({},c),{opacity:n?.2:ua,children:(0,xn.jsx)("div",{ref:Bd,
className:"tl-text-shape-wrapper","data-hastext":!!oc,"data-isediting":N,style:{fontFamily:Ga,fontStyle:vb?"italic":"normal",fontSize:Ma,fontWeight:fb,padding:Uc,lineHeight:Wb,color:rf(xc,"text")},children:N?(0,xn.jsx)("textarea",{ref:md,className:"tl-text-shape-input",name:"text",tabIndex:-1,autoComplete:"false",autoCapitalize:"false",autoCorrect:"false",autoSave:"false",placeholder:"",spellCheck:"true",wrap:"off",dir:"auto",datatype:"wysiwyg",defaultValue:oc,onFocus:rd,onChange:Ld,onKeyDown:bd,
onBlur:jd,onPointerDown:Md}):(0,xn.jsxs)(xn.Fragment,{children:[oc,""]})})}))}));xb(this,"setScaleLevel",c=>Zh(this,null,function*(){this.update({scaleLevel:c,fontSize:dD[null!=c?c:"md"]});this.onResetBounds()}));xb(this,"ReactIndicator",ue(({isEditing:c})=>{const {props:{borderRadius:n,isLocked:N},bounds:da}=this;return c?null:(0,xn.jsx)("rect",{width:da.width,height:da.height,rx:n,ry:n,fill:"transparent",strokeDasharray:N?"8 2":"undefined"})}));xb(this,"validateProps",c=>Vk(this,c));xb(this,"getBounds",
()=>{const [c,n]=this.props.point,[N,da]=this.props.size;return{minX:c,minY:n,maxX:c+N,maxY:n+da,width:N,height:da}});xb(this,"onResizeStart",({isSingle:c})=>{var n;if(!c)return this;this.scale=[...(null!=(n=this.props.scale)?n:[1,1])];return this.update({isSizeLocked:!1})});xb(this,"onResetBounds",()=>{this.update({size:this.getAutoSizedBoundingBox(),isSizeLocked:!0});return this})}get scaleLevel(){var c;return null!=(c=this.props.scaleLevel)?c:"md"}getAutoSizedBoundingBox(c={}){const {text:n=this.props.text,
fontFamily:N=this.props.fontFamily,fontSize:da=this.props.fontSize,fontWeight:ua=this.props.fontWeight,lineHeight:Ga=this.props.lineHeight,padding:Ma=this.props.padding}=c,[fb,vb]=eg(n,{fontFamily:N,fontSize:da,lineHeight:Ga,fontWeight:ua},Ma);return[fb,vb]}getShapeSVGJsx(){var c=window.navigator.userAgent.toLowerCase();if(c.includes("webkit")&&!c.includes("chrome"))return super.getShapeSVGJsx(null);const {props:{text:n,stroke:N,fontSize:da,fontFamily:ua}}=this;c=this.getBounds();return(0,xn.jsx)("foreignObject",
{width:c.width,height:c.height,children:(0,xn.jsx)("div",{style:{color:rf(N,"text"),fontSize:da,fontFamily:ua,display:"contents"},children:n})})}};xb(Ip,"id","text");xb(Ip,"defaultProps",{id:"box",parentId:"page",type:"text",point:[0,0],size:[0,0],isSizeLocked:!0,text:"",lineHeight:1.2,fontSize:20,fontWeight:400,italic:!1,padding:4,fontFamily:"var(--ls-font-family)",borderRadius:0,stroke:"",fill:"",noFill:!0,strokeType:"line",strokeWidth:2,opacity:1});re([Zg],Ip.prototype,"scaleLevel",1);re([Cg],
Ip.prototype,"setScaleLevel",2);var Vx=Lf(Z(69)),gs=Z(288),hs=class extends xk{constructor(){super(...arguments);xb(this,"canFlip",!1);xb(this,"canEdit",!0);xb(this,"canChangeAspectRatio",!1);xb(this,"ReactComponent",ue(({events:c,isErasing:n,asset:N,isEditing:da})=>{const {props:{opacity:ua}}=this,Ga=Sm();var Ma=Te();const fb=Ma.selectedIds.has(this.id),vb=Ga||fb&&!da||"select"!==Ma.selectedTool.id;Ma=Vx.useCallback(oc=>{vb||oc.stopPropagation()},[vb]);const {handlers:Wb}=Vx.useContext(vi);return(0,gs.jsx)($k,
kg(Af({style:{overflow:"hidden",pointerEvents:"all",opacity:n?.2:ua}},c),{children:(0,gs.jsx)("div",{onWheelCapture:Ma,onPointerDown:Ma,onPointerUp:Ma,className:"tl-video-container",style:{pointerEvents:Ga||!da&&!fb?"none":"all",overflow:da?"auto":"hidden"},children:N&&(0,gs.jsx)("video",{controls:!0,src:Wb?Wb.makeAssetUrl(N.src):N.src})})}))}));xb(this,"ReactIndicator",ue(()=>{const {props:{size:[c,n],isLocked:N}}=this;return(0,gs.jsx)("rect",{width:c,height:n,fill:"transparent",strokeDasharray:N?
"8 2":"undefined"})}))}};xb(hs,"id","video");xb(hs,"defaultProps",{id:"video1",parentId:"page",type:"video",point:[0,0],size:[100,100],opacity:1,assetId:"",clipping:0,isAspectRatioLocked:!0});var mk=Z(288),Wx=/^(?:https?:\/\/)?(?:www\.)?(?:youtu\.be\/|youtube\.com\/(?:embed\/|v\/|watch\?v=|watch\?.+&v=))((\w|-){11})(?:\S+)?$/,Xx=class extends xk{constructor(){super(...arguments);xb(this,"aspectRatio",480/853);xb(this,"canChangeAspectRatio",!1);xb(this,"canFlip",!1);xb(this,"canEdit",!0);xb(this,"onYoutubeLinkChange",
c=>{this.update({url:c,size:Xx.defaultProps.size})});xb(this,"ReactComponent",ue(({events:c,isErasing:n,isEditing:N})=>{const da=Te();return(0,mk.jsx)($k,kg(Af({style:{overflow:"hidden",pointerEvents:"all",opacity:n?.2:1}},c),{children:(0,mk.jsx)("div",{className:"rounded-lg w-full h-full relative overflow-hidden shadow-xl tl-youtube-container",style:{pointerEvents:N||da.readOnly?"all":"none",userSelect:"none",background:`url('https://img.youtube.com/vi/${this.embedId}/mqdefault.jpg') no-repeat center/cover`},
children:this.embedId?(0,mk.jsx)("div",{style:{overflow:"hidden",position:"relative",height:"100%"},children:(0,mk.jsx)("iframe",{className:"absolute inset-0 w-full h-full m-0",width:"853",height:"480",src:`https://www.youtube.com/embed/${this.embedId}`,frameBorder:"0",allow:"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture",allowFullScreen:!0,title:"Embedded youtube"})}):(0,mk.jsx)("div",{className:"w-full h-full flex items-center justify-center p-4",style:{backgroundColor:"var(--ls-primary-background-color)"},
children:(0,mk.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 502 210.649",height:"210.65",width:"128",children:(0,mk.jsxs)("g",{children:[(0,mk.jsx)("path",{d:"M498.333 45.7s-2.91-20.443-11.846-29.447C475.157 4.44 462.452 4.38 456.627 3.687c-41.7-3-104.25-3-104.25-3h-.13s-62.555 0-104.255 3c-5.826.693-18.523.753-29.86 12.566-8.933 9.004-11.84 29.447-11.84 29.447s-2.983 24.003-2.983 48.009v22.507c0 24.006 2.983 48.013 2.983 48.013s2.907 20.44 11.84 29.446c11.337 11.817 26.23 11.44 32.86 12.677 23.84 2.28 101.315 2.983 101.315 2.983s62.62-.094 104.32-3.093c5.824-.694 18.527-.75 29.857-12.567 8.936-9.006 11.846-29.446 11.846-29.446s2.98-24.007 2.98-48.013V93.709c0-24.006-2.98-48.01-2.98-48.01",
fill:"#cd201f"}),(0,mk.jsx)("g",{children:(0,mk.jsx)("path",{d:"M187.934 169.537h-18.96V158.56c-7.19 8.24-13.284 12.4-19.927 12.4-5.826 0-9.876-2.747-11.9-7.717-1.23-3.02-2.103-7.736-2.103-14.663V68.744h18.957v81.833c.443 2.796 1.636 3.823 4.043 3.823 3.63 0 6.913-3.153 10.93-8.817V68.744h18.96v100.793zM102.109 139.597c.996 9.98-2.1 14.93-7.987 14.93s-8.98-4.95-7.98-14.93v-39.92c-1-9.98 2.093-14.657 7.98-14.657 5.89 0 8.993 4.677 7.996 14.657l-.01 39.92zm18.96-37.923c0-10.77-2.164-18.86-5.987-23.95-5.054-6.897-12.973-9.72-20.96-9.72-9.033 0-15.913 2.823-20.957 9.72-3.886 5.09-5.97 13.266-5.97 24.036l-.016 35.84c0 10.71 1.853 18.11 5.736 23.153 5.047 6.873 13.227 10.513 21.207 10.513 7.986 0 16.306-3.64 21.36-10.513 3.823-5.043 5.586-12.443 5.586-23.153v-35.926zM46.223 114.647v54.889h-19.96v-54.89S5.582 47.358 1.314 34.815H22.27L36.277 87.38l13.936-52.566H71.17l-24.947 79.833z"})}),
(0,mk.jsxs)("g",{fill:"#fff",children:[(0,mk.jsx)("path",{d:"M440.413 96.647c0-9.33 2.557-11.874 8.59-11.874 5.99 0 8.374 2.777 8.374 11.997v10.893l-16.964.02V96.647zm35.96 25.986l-.003-20.4c0-10.656-2.1-18.456-5.88-23.5-5.06-6.823-12.253-10.436-21.317-10.436-9.226 0-16.42 3.613-21.643 10.436-3.84 5.044-6.076 13.28-6.076 23.943v34.927c0 10.596 2.46 18.013 6.296 23.003 5.227 6.813 12.42 10.216 21.87 10.216 9.44 0 16.853-3.566 21.85-10.81 2.2-3.196 3.616-6.82 4.226-10.823.164-1.81.64-5.933.64-11.753v-2.827h-18.96c0 7.247.037 11.557-.133 12.54-1.033 4.834-3.623 7.25-8.07 7.25-6.203 0-8.826-4.636-8.76-13.843v-17.923h35.96zM390.513 140.597c0 9.98-2.353 13.806-7.563 13.806-2.973 0-6.4-1.53-9.423-4.553l.02-60.523c3.02-2.98 6.43-4.55 9.403-4.55 5.21 0 7.563 2.93 7.563 12.91v42.91zm2.104-72.453c-6.647 0-13.253 4.087-19.09 11.27l.02-43.603h-17.963V169.54h17.963l.027-10.05c6.036 7.47 12.62 11.333 19.043 11.333 7.193 0 12.45-3.85 14.863-11.267 1.203-4.226 1.993-10.733 1.993-19.956V99.684c0-9.447-1.21-15.907-2.416-19.917-2.41-7.466-7.247-11.623-14.44-11.623M340.618 169.537h-18.956V158.56c-7.193 8.24-13.283 12.4-19.926 12.4-5.827 0-9.877-2.747-11.9-7.717-1.234-3.02-2.107-7.736-2.107-14.663V69.744h18.96v80.833c.443 2.796 1.633 3.823 4.043 3.823 3.63 0 6.913-3.153 10.93-8.817V69.744h18.957v99.793z"}),
(0,mk.jsx)("path",{d:"M268.763 169.537h-19.956V54.77h-20.956V35.835l62.869-.024v18.96h-21.957v114.766z"})]})]})})})})}))}));xb(this,"ReactIndicator",ue(()=>{const {props:{size:[c,n],isLocked:N}}=this;return(0,mk.jsx)("rect",{width:c,height:n,fill:"transparent",rx:8,ry:8,strokeDasharray:N?"8 2":"undefined"})}));xb(this,"validateProps",c=>{void 0!==c.size&&(c.size[0]=Math.max(c.size[0],1),c.size[1]=Math.max(c.size[0]*this.aspectRatio,1));return Vk(this,c)})}get embedId(){var c,n;const N=this.props.url,
da=N.match(Wx);return null!=(n=null!=(c=null==da?void 0:da[1])?c:N)?n:""}getShapeSVGJsx(){const c=this.getBounds(),n=this.embedId;return n?(0,mk.jsxs)("g",{children:[(0,mk.jsx)("image",{width:c.width,height:c.height,href:`https://img.youtube.com/vi/${n}/mqdefault.jpg`,className:"grayscale-[50%]"}),(0,mk.jsx)("svg",{x:c.width/4,y:c.height/4,width:c.width/2,height:c.height/2,viewBox:"0 0 15 15",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:(0,mk.jsx)("path",{d:"M4.76447 3.12199C5.63151 3.04859 6.56082 3 7.5 3C8.43918 3 9.36849 3.04859 10.2355 3.12199C11.2796 3.21037 11.9553 3.27008 12.472 3.39203C12.9425 3.50304 13.2048 3.64976 13.4306 3.88086C13.4553 3.90618 13.4902 3.94414 13.5133 3.97092C13.7126 4.20149 13.8435 4.4887 13.918 5.03283C13.9978 5.6156 14 6.37644 14 7.52493C14 8.66026 13.9978 9.41019 13.9181 9.98538C13.8439 10.5206 13.7137 10.8061 13.5125 11.0387C13.4896 11.0651 13.4541 11.1038 13.4296 11.1287C13.2009 11.3625 12.9406 11.5076 12.4818 11.6164C11.9752 11.7365 11.3143 11.7942 10.2878 11.8797C9.41948 11.9521 8.47566 12 7.5 12C6.52434 12 5.58052 11.9521 4.7122 11.8797C3.68572 11.7942 3.02477 11.7365 2.51816 11.6164C2.05936 11.5076 1.7991 11.3625 1.57037 11.1287C1.54593 11.1038 1.51035 11.0651 1.48748 11.0387C1.28628 10.8061 1.15612 10.5206 1.08193 9.98538C1.00221 9.41019 1 8.66026 1 7.52493C1 6.37644 1.00216 5.6156 1.082 5.03283C1.15654 4.4887 1.28744 4.20149 1.48666 3.97092C1.5098 3.94414 1.54468 3.90618 1.56942 3.88086C1.7952 3.64976 2.05752 3.50304 2.52796 3.39203C3.04473 3.27008 3.7204 3.21037 4.76447 3.12199ZM0 7.52493C0 5.28296 0 4.16198 0.729985 3.31713C0.766457 3.27491 0.815139 3.22194 0.854123 3.18204C1.63439 2.38339 2.64963 2.29744 4.68012 2.12555C5.56923 2.05028 6.52724 2 7.5 2C8.47276 2 9.43077 2.05028 10.3199 2.12555C12.3504 2.29744 13.3656 2.38339 14.1459 3.18204C14.1849 3.22194 14.2335 3.27491 14.27 3.31713C15 4.16198 15 5.28296 15 7.52493C15 9.74012 15 10.8477 14.2688 11.6929C14.2326 11.7348 14.1832 11.7885 14.1444 11.8281C13.3629 12.6269 12.3655 12.71 10.3709 12.8763C9.47971 12.9505 8.50782 13 7.5 13C6.49218 13 5.52028 12.9505 4.62915 12.8763C2.63446 12.71 1.63712 12.6269 0.855558 11.8281C0.816844 11.7885 0.767442 11.7348 0.731221 11.6929C0 10.8477 0 9.74012 0 7.52493ZM5.25 5.38264C5.25 5.20225 5.43522 5.08124 5.60041 5.15369L10.428 7.27105C10.6274 7.35853 10.6274 7.64147 10.428 7.72895L5.60041 9.84631C5.43522 9.91876 5.25 9.79775 5.25 9.61736V5.38264Z",
fill:"#D10014",fillRule:"evenodd",clipRule:"evenodd"})})]}):super.getShapeSVGJsx({})}},Bo=Xx;xb(Bo,"id","youtube");xb(Bo,"defaultProps",{id:"youtube",type:"youtube",parentId:"page",point:[0,0],size:[853,480],url:""});re([Zg],Bo.prototype,"embedId",1);re([Cg],Bo.prototype,"onYoutubeLinkChange",2);var Jp=Lf(Z(69)),Hm=Z(288),Yx=/https?:\/\/(x|twitter).com\/[0-9a-zA-Z_]{1,20}\/status\/([0-9]*)/,Zx=class extends xk{constructor(){super(...arguments);xb(this,"canFlip",!1);xb(this,"canEdit",!0);xb(this,"initialHeightCalculated",
!0);xb(this,"getInnerHeight",null);xb(this,"onTwitterLinkChange",c=>{this.update({url:c,size:Zx.defaultProps.size})});xb(this,"ReactComponent",ue(({events:c,isErasing:n,isEditing:N})=>{const {renderers:{Tweet:da}}=Jp.useContext(vi),ua=Te(),Ga=Jp.useRef(null),[,Ma]=this.useComponentSize(Ga);Jp.useEffect(()=>{var fb,vb;const Wb=null!=(vb=null==(fb=this.getInnerHeight)?void 0:fb.call(this))?vb:Ma;Ma&&1<Math.abs(Wb-this.props.size[1])&&(this.update({size:[this.props.size[0],Wb]}),ua.persist({replace:!0}))},
[Ma]);Jp.useEffect(()=>{this.initialHeightCalculated||setTimeout(()=>{this.onResetBounds();ua.persist({replace:!0})})},[this.initialHeightCalculated]);return(0,Hm.jsx)($k,kg(Af({style:{overflow:"hidden",pointerEvents:"all",opacity:n?.2:1}},c),{children:(0,Hm.jsx)("div",{className:"rounded-xl w-full h-full relative shadow-xl tl-tweet-container",style:{pointerEvents:N||ua.readOnly?"all":"none",userSelect:"none"},children:this.embedId?(0,Hm.jsx)("div",{ref:Ga,children:(0,Hm.jsx)(da,{tweetId:this.embedId})}):
null})}))}));xb(this,"ReactIndicator",ue(()=>{const {props:{size:[c,n],isLocked:N}}=this;return(0,Hm.jsx)("rect",{width:c,height:n,fill:"transparent",rx:8,ry:8,strokeDasharray:N?"8 2":"undefined"})}));xb(this,"onResetBounds",c=>{c=this.getAutoResizeHeight();null!==c&&1<Math.abs(c-this.props.size[1])&&(this.update({size:[this.props.size[0],c]}),this.initialHeightCalculated=!0);return this});xb(this,"onResize",(c,n)=>{var N;const {bounds:da,rotation:ua,scale:[Ga,Ma]}=n;c=[...this.scale];0>Ga&&(c[0]*=
-1);0>Ma&&(c[1]*=-1);n=null!=(N=this.getAutoResizeHeight())?N:da.height;return this.update({point:[da.minX,da.minY],size:[Math.max(1,da.width),Math.max(1,n)],scale:c,rotation:ua})});xb(this,"validateProps",c=>{void 0!==c.size&&(c.size[0]=Math.min(Math.max(c.size[0],300),550),c.size[1]=Math.max(c.size[1],1));return Vk(this,c)})}get embedId(){var c,n;const N=this.props.url,da=N.match(Yx);return null!=(n=null!=(c=null==da?void 0:da[1])?c:N)?n:""}useComponentSize(c,n=""){const [N,da]=Jp.useState([0,0]),
ua=Te();Jp.useEffect(()=>{if(null==c?0:c.current){const Ga=n?c.current.querySelector(n):c.current;if(Ga){const Ma=()=>{const {width:vb,height:Wb}=Ga.getBoundingClientRect(),oc=pe.div([vb,Wb],ua.viewport.camera.zoom);da(oc);return oc};Ma();this.getInnerHeight=()=>Ma()[1];const fb=new ResizeObserver(()=>{Ma()});fb.observe(Ga);return()=>{fb.disconnect()}}}return()=>{}},[c,n]);return N}getAutoResizeHeight(){return this.getInnerHeight?this.getInnerHeight():null}getShapeSVGJsx(){const c=this.getBounds();
return this.embedId?(0,Hm.jsxs)("g",{children:[(0,Hm.jsx)("rect",{width:c.width,height:c.height,fill:"#15202b",rx:8,ry:8}),(0,Hm.jsx)("svg",{x:c.width/4,y:c.height/4,width:c.width/2,height:c.height/2,viewBox:"0 0 15 15",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:(0,Hm.jsx)("path",{d:"m13.464 4.4401c0.0091 0.13224 0.0091 0.26447 0.0091 0.39793 0 4.0664-3.0957 8.7562-8.7562 8.7562v-0.0024c-1.6721 0.0024-3.3095-0.47658-4.7172-1.3797 0.24314 0.02925 0.48751 0.04387 0.73248 0.04448 1.3857 0.0013 2.7319-0.46374 3.8221-1.3199-1.3169-0.024981-2.4717-0.8836-2.8751-2.1371 0.4613 0.08897 0.93662 0.070688 1.3894-0.053016-1.4357-0.29007-2.4686-1.5515-2.4686-3.0165v-0.039001c0.42779 0.23827 0.90676 0.37051 1.3967 0.38513-1.3522-0.90372-1.769-2.7026-0.95247-4.1091 1.5625 1.9226 3.8678 3.0914 6.3425 3.2151-0.24802-1.0689 0.090798-2.1889 0.89031-2.9403 1.2395-1.1651 3.1889-1.1054 4.3541 0.13346 0.68921-0.13589 1.3498-0.38879 1.9543-0.74711-0.22974 0.71237-0.71054 1.3175-1.3528 1.702 0.60999-0.071907 1.206-0.23522 1.7672-0.48446-0.41316 0.61913-0.93358 1.1584-1.5356 1.5942z",
fill:"#1d9bf0",fillRule:"evenodd",clipRule:"evenodd"})})]}):super.getShapeSVGJsx({})}},Kp=Zx;xb(Kp,"id","tweet");xb(Kp,"defaultProps",{id:"tweet",type:"tweet",parentId:"page",point:[0,0],size:[331,290],url:""});re([Zg],Kp.prototype,"embedId",1);re([Cg],Kp.prototype,"onTwitterLinkChange",2);var bu=Lf(Z(69)),cu=Z(288),Wq=class extends xk{constructor(){super(...arguments);xb(this,"frameRef",bu.createRef());xb(this,"canChangeAspectRatio",!0);xb(this,"canFlip",!0);xb(this,"canEdit",!0);xb(this,"ReactComponent",
ue(({events:c,asset:n,isErasing:N,isEditing:da})=>{bu.useRef(null);const {handlers:ua}=bu.useContext(vi);Te();const Ga=Sm();return(0,cu.jsx)($k,kg(Af({style:{overflow:"hidden",pointerEvents:"all",opacity:N?.2:1}},c),{children:n?(0,cu.jsx)("embed",{src:ua?ua.inflateAsset(n.src).url:n.src,className:"relative tl-pdf-container",onWheelCapture:stop,onPointerDown:stop,onPointerUp:stop,style:{width:"100%",height:"100%",pointerEvents:!Ga&&da?"all":"none"}}):null}))}));xb(this,"ReactIndicator",ue(()=>{const {props:{size:[c,
n],isLocked:N}}=this;return(0,cu.jsx)("rect",{width:c,height:n,fill:"transparent",rx:8,ry:8,strokeDasharray:N?"8 2":"undefined"})}))}};xb(Wq,"id","pdf");xb(Wq,"defaultProps",{id:"pdf",type:"pdf",parentId:"page",point:[0,0],size:[595,842],assetId:""});Z(288);var $x=[Bp,Cp,yo,es,hs,Fp,Ao,Hp,Ip,Bo,Kp,zo,wn,Wq,Gj,Wt],du=class extends Em{constructor(){super(...arguments);xb(this,"Shape",Bp)}};xb(du,"id","box");xb(du,"shortcut","whiteboard/rectangle");var eu=class extends Em{constructor(){super(...arguments);
xb(this,"Shape",Cp)}};xb(eu,"id","ellipse");xb(eu,"shortcut","whiteboard/ellipse");var fu=class extends Gr{};xb(fu,"id","erase");xb(fu,"shortcut","whiteboard/eraser");var gu=class extends Gq{constructor(){super(...arguments);xb(this,"Shape",yo);xb(this,"simplify",!0);xb(this,"simplifyTolerance",.618)}};xb(gu,"id","highlighter");xb(gu,"shortcut","whiteboard/highlighter");var cl=class extends Hr{constructor(){super(...arguments);xb(this,"Shape",Fp)}};xb(cl,"id","line");xb(cl,"shortcut","whiteboard/connector");
var hu=class extends Gq{constructor(){super(...arguments);xb(this,"Shape",Ao);xb(this,"simplify",!1)}};xb(hu,"id","pencil");xb(hu,"shortcut","whiteboard/pencil");var ay=class extends Em{constructor(){super(...arguments);xb(this,"Shape",Hp)}};xb(ay,"id","polygon");var iu=class extends Ir{constructor(){super(...arguments);xb(this,"Shape",Ip)}};xb(iu,"id","text");xb(iu,"shortcut","whiteboard/text");var ju=class extends Em{constructor(){super(...arguments);xb(this,"Shape",Bo)}};xb(ju,"id","youtube");
var qk=class extends gi{constructor(){super(...arguments);xb(this,"creatingShape");xb(this,"offset",[0,0]);xb(this,"onEnter",()=>{this.app.history.pause();pc(()=>{var c=pe.sub(this.app.inputs.originPoint,this.offset);this.app.settings.snapToGrid&&(c=pe.snap(c,8));this.creatingShape=c=new Gj({id:Me(),parentId:this.app.currentPage.id,point:c,size:Gj.defaultProps.size,fill:this.app.settings.color,stroke:this.app.settings.color});this.app.currentPage.addShapes(c);this.app.setEditingShape(c);this.app.setSelectedShapes([c])})});
xb(this,"onPointerDown",c=>{switch(c.type){case "shape":if(c.shape===this.creatingShape)break;this.app.selectTool("select");break;case "canvas":c.order||this.app.selectTool("select")}});xb(this,"onExit",()=>{var c;this.creatingShape&&(this.app.history.resume(),(null==(c=this.creatingShape)?0:c.props.pageId)?this.app.setSelectedShapes([this.creatingShape.id]):(this.app.deleteShapes([this.creatingShape.id]),this.app.setEditingShape()),this.creatingShape=void 0)})}};xb(qk,"id","creating");var Ok=class extends gi{constructor(){super(...arguments);
xb(this,"cursor","crosshair");xb(this,"onPointerDown",c=>{this.tool.transition("creating")})}};xb(Ok,"id","idle");var Pn=class extends mn{constructor(){super(...arguments);xb(this,"Shape",Gj);xb(this,"onPinch",c=>{this.app.viewport.pinchZoom(c.point,c.delta,c.delta[2])})}};xb(Pn,"id","logseq-portal");xb(Pn,"shortcut","whiteboard/portal");xb(Pn,"states",[Ok,qk]);xb(Pn,"initial","idle");var iv=class extends Em{constructor(){super(...arguments);xb(this,"Shape",wn)}};xb(iv,"id","youtube");var jv=class extends Em{constructor(){super(...arguments);
xb(this,"Shape",zo)}};xb(jv,"id","iframe");var kv=Lf(Z(631)),sl=Z(288),Mo=new Map($x.map(c=>[c.id,c])),tq=class{constructor(c){xb(this,"shapes");xb(this,"pageId");xb(this,"assets");c&&this.load(c)}load(c){var n;const N=null==(n=null==c?void 0:c.pages)?void 0:n[0];this.pageId=null==N?void 0:N.id;this.assets=c.assets;this.shapes=null==N?void 0:N.shapes.map(da=>{var ua=da.type;if(!ua)throw Error("No shape type provided.");const Ga=Mo.get(ua);if(!Ga)throw Error(`Could not find shape class for ${ua}`);
return new Ga(da)}).filter(da=>"group"!==da.type)}generatePreviewJsx(c,n){var N,da;const ua=[...(null!=(N=this.shapes)?N:[]).map(Wb=>Wb.getRotatedBounds())];(N=null==c?void 0:c.currentView)&&ua.push(N);let Ga=Je.getCommonBounds(ua);if(!Ga)return null;Ga=Je.expandBounds(Ga,16);Ga=n?Je.ensureRatio(Ga,n):Ga;const Ma=Wb=>[(Wb[0]-Ga.minX).toFixed(2),(Wb[1]-Ga.minY).toFixed(2)],[fb,vb]=N?Ma([N.minX,N.minY]):[0,0];return Ga&&(0,sl.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg","data-common-bound-x":Ga.minX.toFixed(2),
"data-common-bound-y":Ga.minY.toFixed(2),"data-common-bound-width":Ga.width.toFixed(2),"data-common-bound-height":Ga.height.toFixed(2),viewBox:[0,0,Ga.width,Ga.height].join(" "),children:[(0,sl.jsx)("defs",{children:N&&(0,sl.jsxs)(sl.Fragment,{children:[(0,sl.jsx)("rect",{id:this.pageId+"-camera-rect",transform:`translate(${fb}, ${vb})`,width:N.width,height:N.height}),(0,sl.jsxs)("mask",{id:this.pageId+"-camera-mask",children:[(0,sl.jsx)("rect",{width:Ga.width,height:Ga.height,fill:"white"}),(0,sl.jsx)("use",
{href:`#${this.pageId}-camera-rect`,fill:"black"})]})]})}),(0,sl.jsx)("g",{id:this.pageId+"-preview-shapes",children:null==(da=this.shapes)?void 0:da.map(Wb=>{var oc,xc;const {bounds:Uc,props:{rotation:md}}=Wb,[hd,Bd]=Ma([Uc.minX,Uc.minY]),Ld=+(180*((null!=md?md:0)+(null!=(oc=Uc.rotation)?oc:0))/Math.PI).toFixed(2),[bd,jd]=[(Uc.width/2).toFixed(2),(Uc.height/2).toFixed(2)];return(0,sl.jsx)("g",{transform:[`translate(${hd}, ${Bd})`,`rotate(${Ld}, ${bd}, ${jd})`].join(" "),children:Wb.getShapeSVGJsx({assets:null!=
(xc=this.assets)?xc:[]})},Wb.id)})}),(0,sl.jsx)("rect",{mask:N?`url(#${this.pageId}-camera-mask)`:"",width:Ga.width,height:Ga.height,fill:"transparent"}),N&&(0,sl.jsx)("use",{id:"minimap-camera-rect","data-x":fb,"data-y":vb,"data-width":N.width,"data-height":N.height,href:`#${this.pageId}-camera-rect`,fill:"transparent",stroke:"red",strokeWidth:4/c.camera.zoom})]})}exportAsSVG(c){return(c=this.generatePreviewJsx(void 0,c))?kv.default.renderToString(c):""}},eD=Lf(Z(69)),Xq=Z(288),Yq=eD.forwardRef((c,
n)=>{var {value:N,className:da}=c;c=Zi(c,["autoResize","value","className"]);return(0,Xq.jsx)("div",{className:"tl-input"+(da?" "+da:""),children:(0,Xq.jsxs)("div",{className:"tl-input-sizer",children:[(0,Xq.jsx)("div",{className:"tl-input-hidden",children:N}),(0,Xq.jsx)("input",Af({ref:n,value:N,className:"tl-text-input",type:"text"},c))]})})}),bi=Z(288),Im=({type:c,active:n})=>(0,bi.jsx)("span",{className:"tl-type-tag","data-active":n,children:(0,bi.jsx)("i",{className:`tie tie-${({B:"block",P:"page",
WP:"whiteboard",BA:"new-block",PA:"new-page",WA:"new-whiteboard",BS:"block-search",PS:"page-search"})[c]}`})}),lv=(c,n)=>(0,bi.jsx)("span",{children:c.split(new RegExp(`(${n.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$\x26")})`,"gi")).map((N,da)=>1===da%2?(0,bi.jsx)("mark",{className:"tl-highlighted",children:N}):N).map((N,da)=>(0,bi.jsx)(lk.default.Fragment,{children:N},da))}),tr=(c,n)=>{const {handlers:N}=lk.default.useContext(vi),[da,ua]=lk.default.useState(null),Ga=ae(c,200);lk.default.useEffect(()=>
{let Ma=!1;if(0<Ga.length){const fb={"pages?":!0,"blocks?":!0,"files?":!1};"B"===n?fb["pages?"]=!1:"P"===n&&(fb["blocks?"]=!1);N.search(Ga,fb).then(vb=>{Ma||ua(vb)})}else ua(null);return()=>{Ma=!0}},[Ga,null==N?void 0:N.search]);return da},Vs=ue(({className:c,style:n,placeholder:N,onChange:da,onBlur:ua,onAddBlock:Ga})=>{const [Ma,fb]=lk.default.useState(Gj.defaultSearchQuery),[vb,Wb]=lk.default.useState(Gj.defaultSearchFilter),oc=lk.default.useRef(null),{handlers:xc,renderers:Uc}=lk.default.useContext(vi),
md=xc.t,hd=lk.default.useCallback((cf,Of)=>{var Hg;console.log({id:cf,isPage:Of});setTimeout(()=>da(cf,Of));null==(Hg=oc.current)?void 0:Hg.blur();cf&&(Gj.defaultSearchQuery="",Gj.defaultSearchFilter=null)},[]),Bd=lk.default.useCallback(cf=>Zh(void 0,null,function*(){const Of=yield null==xc?void 0:xc.addNewBlock(cf);Of&&(hd(Of),null==Ga?void 0:Ga(Of));return Of}),[Ga]),Ld=lk.default.useRef(null),[bd,jd]=lk.default.useState(0),rd=tr(Ma,vb),[Md,Dd]=lk.default.useState("circle-plus"),[Oe,Pe]=lk.default.useState(!1);
lk.default.useEffect(()=>{setTimeout(()=>{var cf;null==(cf=oc.current)?void 0:cf.focus()})},[vb]);lk.default.useEffect(()=>{Gj.defaultSearchQuery=Ma;Gj.defaultSearchFilter=vb},[Ma,vb]);const cg=lk.default.useMemo(()=>{var cf;const Of=[];if(null==Uc||!Uc.Breadcrumb||!xc)return[];Ga&&Of.push({actionIcon:"circle-plus",onChosen:()=>!!Bd(Ma),element:(0,bi.jsxs)("div",{className:"tl-quick-search-option-row",children:[(0,bi.jsx)(Im,{active:!0,type:"BA"}),0<Ma.length?(0,bi.jsxs)(bi.Fragment,{children:[(0,bi.jsx)("strong",
{children:md("whiteboard/new-block")}),Ma]}):(0,bi.jsx)("strong",{children:md("whiteboard/new-block-no-colon")})]})});(null==(cf=null==rd?void 0:rd.pages)?0:cf.some(Hg=>Hg.title.toLowerCase()===Ma.toLowerCase()))||!Ma||Of.push({actionIcon:"circle-plus",onChosen:()=>Zh(void 0,null,function*(){let Hg=yield null==xc?void 0:xc.addNewPage(Ma);hd(Hg,!0);return!0}),element:(0,bi.jsxs)("div",{className:"tl-quick-search-option-row",children:[(0,bi.jsx)(Im,{active:!0,type:"PA"}),(0,bi.jsx)("strong",{children:md("whiteboard/new-page")}),
Ma]})},{actionIcon:"circle-plus",onChosen:()=>Zh(void 0,null,function*(){let Hg=yield null==xc?void 0:xc.addNewWhiteboard(Ma);hd(Hg,!0);return!0}),element:(0,bi.jsxs)("div",{className:"tl-quick-search-option-row",children:[(0,bi.jsx)(Im,{active:!0,type:"WA"}),(0,bi.jsx)("strong",{children:md("whiteboard/new-whiteboard")}),Ma]})});0===Ma.length&&null===vb&&Of.push({actionIcon:"search",onChosen:()=>{Wb("B");return!0},element:(0,bi.jsxs)("div",{className:"tl-quick-search-option-row",children:[(0,bi.jsx)(Im,
{type:"BS"}),md("whiteboard/search-only-blocks")]})},{actionIcon:"search",onChosen:()=>{Wb("P");return!0},element:(0,bi.jsxs)("div",{className:"tl-quick-search-option-row",children:[(0,bi.jsx)(Im,{type:"PS"}),md("whiteboard/search-only-pages")]})});vb&&"P"!==vb||!rd||!rd.pages||Of.push(...rd.pages.map(Hg=>({actionIcon:"search",onChosen:()=>{hd(Hg.id,!0);return!0},element:(0,bi.jsxs)("div",{className:"tl-quick-search-option-row",children:[(0,bi.jsx)(Im,{type:xc.isWhiteboardPage(Hg.id)?"WP":"P"}),lv(Hg.title,
Ma)]})})));vb&&"B"!==vb||!rd||!rd.blocks||Of.push(...rd.blocks.filter(Hg=>Hg.title&&Hg.uuid).map(({title:Hg,uuid:ah})=>{const Eg=xc.queryBlockByUUID(ah);return{actionIcon:"search",onChosen:()=>{var bh,vf,Ef;return Eg?(hd(ah),null==(Ef=null==(vf=null==(bh=window.logseq)?void 0:bh.api)?void 0:vf.set_blocks_id)?void 0:Ef.call(vf,[ah]),!0):!1},element:(0,bi.jsx)(bi.Fragment,{children:(0,bi.jsxs)("div",{className:"tl-quick-search-option-row",children:[(0,bi.jsx)(Im,{type:"B"}),lv(Hg,Ma)]})})}}));return Of},
[Ma,vb,rd,null==Uc?void 0:Uc.Breadcrumb,xc]);lk.default.useEffect(()=>{const cf=Of=>{var Hg,ah;let Eg=bd;"ArrowDown"===Of.key?Eg=Math.min(cg.length-1,bd+1):"ArrowUp"===Of.key?Eg=Math.max(0,bd-1):"Enter"===Of.key?(null==(Hg=cg[bd])?void 0:Hg.onChosen(),Of.stopPropagation(),Of.preventDefault()):"Backspace"===Of.key&&0===Ma.length?Wb(null):"Escape"===Of.key&&hd("");Eg!==bd&&(Hg=cg[Eg],jd(Eg),Dd(Hg.actionIcon),Of.stopPropagation(),Of.preventDefault(),(Of=null==(ah=Ld.current)?void 0:ah.querySelector(".tl-quick-search-option:nth-child("+
(Eg+1)+")"))&&(null==Of?void 0:Of.scrollIntoViewIfNeeded(!1)))};document.addEventListener("keydown",cf,!0);return()=>{document.removeEventListener("keydown",cf,!0)}},[cg,bd,Ma]);return(0,bi.jsxs)("div",{className:"tl-quick-search "+(null!=c?c:""),style:n,children:[(0,bi.jsx)(qB,{icon:Md,onClick:()=>{var cf;null==(cf=cg[bd])?void 0:cf.onChosen()}}),(0,bi.jsxs)("div",{className:"tl-quick-search-input-container",children:[vb&&(0,bi.jsxs)("div",{className:"tl-quick-search-input-filter",children:[(0,bi.jsx)(Im,
{type:vb}),"B"===vb?"Search blocks":"Search pages",(0,bi.jsx)("div",{className:"tl-quick-search-input-filter-remove",onClick:()=>Wb(null),children:(0,bi.jsx)(eh,{name:"x"})})]}),(0,bi.jsx)(Yq,{ref:oc,type:"text",value:Ma,className:"tl-quick-search-input",placeholder:null!=N?N:"Create or search your graph...",onChange:cf=>fb(cf.target.value),onKeyDown:cf=>{"Enter"===cf.key&&hd(Ma);cf.stopPropagation()},onFocus:()=>{Pe(!0)},onBlur:()=>{Pe(!1);null==ua?void 0:ua()}})]}),0<cg.length&&(0,bi.jsx)("div",
{onWheelCapture:cf=>cf.stopPropagation(),className:"tl-quick-search-options",ref:Ld,style:{visibility:Oe?"visible":"hidden",pointerEvents:Oe?"all":"none"},children:(0,bi.jsx)(oC,{style:{height:40*Math.min(Math.max(1,cg.length),12)},totalCount:cg.length,itemContent:cf=>{const {actionIcon:Of,onChosen:Hg,element:ah}=cg[cf];return(0,bi.jsx)("div",{"data-focused":cf===bd,className:"tl-quick-search-option",tabIndex:0,onMouseEnter:()=>{Dd(Of);jd(cf)},onPointerDownCapture:Eg=>{Hg()&&(Eg.stopPropagation(),
Eg.preventDefault())},children:ah},cf)}})})]})}),Xi=Z(288),fD=ue(function(c){var {pageId:n,portalType:N,refs:da,side:ua,onRefsChange:Ga}=c;c=Zi(c,"pageId portalType shapeType refs side onRefsChange".split(" "));const {handlers:{t:Ma}}=xx.default.useContext(vi),fb=da.length+(n?1:0),vb=0===da.length,Wb=xc=>{xc&&!da.includes(xc)&&vb&&Ga([...da,xc])},oc=!(!n||!N);return(0,Xi.jsx)(ij,kg(Af({},c),{side:ua,align:"start",alignOffset:-6,label:(0,Xi.jsx)(Tg,{content:Ma("whiteboard/link"),sideOffset:14,children:(0,Xi.jsxs)("div",
{className:"flex gap-1 relative items-center justify-center px-1",children:[(0,Xi.jsx)(eh,{name:0<fb?"link":"add-link"}),0<fb&&(0,Xi.jsx)("div",{className:"tl-shape-links-count",children:fb})]})}),children:(0,Xi.jsxs)("div",{className:"color-level rounded-lg","data-show-reference-panel":oc,children:[oc&&(0,Xi.jsxs)("div",{className:"tl-shape-links-reference-panel",children:[(0,Xi.jsxs)("div",{className:"text-base inline-flex gap-1 items-center",children:[(0,Xi.jsx)(eh,{className:"opacity-50",name:"internal-link"}),
Ma("whiteboard/references")]}),(0,Xi.jsx)(vl,{type:N,id:n})]}),(0,Xi.jsxs)("div",{className:"tl-shape-links-panel color-level",children:[(0,Xi.jsxs)("div",{className:"text-base inline-flex gap-1 items-center",children:[(0,Xi.jsx)(eh,{className:"opacity-50",name:"add-link"}),Ma("whiteboard/link-to-any-page-or-block")]}),vb&&(0,Xi.jsx)(Vs,{style:{width:"calc(100% - 46px)",marginLeft:"46px"},placeholder:Ma("whiteboard/start-typing-to-search"),onChange:Wb}),0<da.length&&(0,Xi.jsx)("div",{className:"flex flex-col items-stretch gap-2",
children:da.map((xc,Uc)=>(0,Xi.jsx)(vl,{id:xc,type:og(xc)?"B":"P",onRemove:()=>{Ga(da.filter((md,hd)=>Uc!==hd))},showContent:!0},xc))})]})]})}))}),yn=Z(288),is=window.LSUI,pi=Z(288),js="EditPdf LogseqPortalViewMode Geometry AutoResizing Swatch NoFill StrokeType ScaleLevel TextStyle YoutubeLink TwitterLink IFrameSource ArrowMode Links".split(" "),nj=["YoutubeLink","TwitterLink","IFrameSource","Links","EditPdf"],oj=new Map,rj={"logseq-portal":["Swatch","LogseqPortalViewMode","ScaleLevel","AutoResizing",
"Links"],youtube:["YoutubeLink","Links"],tweet:["TwitterLink","Links"],iframe:["IFrameSource","Links"],box:"Geometry TextStyle Swatch ScaleLevel NoFill StrokeType Links".split(" "),ellipse:"Geometry TextStyle Swatch ScaleLevel NoFill StrokeType Links".split(" "),polygon:"Geometry TextStyle Swatch ScaleLevel NoFill StrokeType Links".split(" "),line:["TextStyle","Swatch","ScaleLevel","ArrowMode","Links"],pencil:["Swatch","Links","ScaleLevel"],highlighter:["Swatch","Links","ScaleLevel"],text:["TextStyle",
"Swatch","ScaleLevel","AutoResizing","Links"],html:["ScaleLevel","AutoResizing","Links"],image:["Links"],video:["Links"],pdf:["EditPdf","Links"]},Co=Object.entries(rj).filter(([,c])=>c.includes("NoFill")&&c.includes("Swatch")).map(([c])=>c),nk=ue(()=>{const c=Te(),{handlers:{t:n}}=ck.default.useContext(vi),N=tk("AutoResizing"),da=N.every(ua=>ua.props.isAutoResizing);return(0,pi.jsx)(xg,{tooltip:n("whiteboard/auto-resize"),toggle:N.every(ua=>"logseq-portal"===ua.props.type),className:"tl-button",pressed:da,
onPressedChange:ua=>{N.forEach(Ga=>{if("logseq-portal"===Ga.props.type)Ga.update({isAutoResizing:ua});else Ga.onResetBounds({zoom:c.viewport.camera.zoom})});c.persist()},children:(0,pi.jsx)(eh,{name:"dimensions"})})}),dl=ue(()=>{const c=Te();var {handlers:{t:n}}=ck.default.useContext(vi);const N=tk("LogseqPortalViewMode"),da=N.every(ua=>ua.collapsed);if(!da&&!N.every(ua=>!ua.collapsed))return null;n=(0,pi.jsxs)("div",{className:"flex",children:[da?n("whiteboard/expand"):n("whiteboard/collapse"),(0,pi.jsx)(ak,
{action:da?"editor/expand-block-children":"editor/collapse-block-children"})]});return(0,pi.jsx)(xg,{tooltip:n,toggle:N.every(ua=>"logseq-portal"===ua.props.type),className:"tl-button",pressed:da,onPressedChange:()=>c.api.setCollapsed(!da),children:(0,pi.jsx)(eh,{name:da?"object-expanded":"object-compact"})})}),wi=ue(()=>{const {handlers:{isMobile:c}}=ck.default.useContext(vi);var n=tk("ScaleLevel");n=1<(new Set(n.map(N=>N.scaleLevel))).size?"":n[0].scaleLevel;return(0,pi.jsx)(Si,{scaleLevel:n,compact:c()})}),
by=ue(()=>{const c=Te(),{handlers:{t:n}}=ck.default.useContext(vi),N=tk("IFrameSource")[0],da=ck.default.useCallback(Ga=>{N.onIFrameSourceChange(Ga.target.value.trim().toLowerCase());c.persist()},[]),ua=ck.default.useCallback(()=>{N.reload()},[]);return(0,pi.jsxs)("span",{className:"flex gap-3",children:[(0,pi.jsx)(kh,{tooltip:n("whiteboard/reload"),type:"button",onClick:ua,children:(0,pi.jsx)(eh,{name:"refresh"})}),(0,pi.jsx)(Yq,{title:n("whiteboard/website-url"),className:"tl-iframe-src",value:`${N.props.url}`,
onChange:da}),(0,pi.jsx)(kh,{tooltip:n("whiteboard/open-website-url"),type:"button",onClick:()=>window.open(N.props.url),children:(0,pi.jsx)(eh,{name:"external-link"})})]})}),ks=ue(()=>{const c=Te(),{handlers:{t:n}}=ck.default.useContext(vi),N=tk("YoutubeLink")[0],da=ck.default.useCallback(ua=>{N.onYoutubeLinkChange(ua.target.value);c.persist()},[]);return(0,pi.jsxs)("span",{className:"flex gap-3",children:[(0,pi.jsx)(Yq,{title:n("whiteboard/youtube-url"),className:"tl-youtube-link",value:`${N.props.url}`,
onChange:da}),(0,pi.jsx)(kh,{tooltip:n("whiteboard/open-youtube-url"),type:"button",onClick:()=>{var ua,Ga,Ma;return null==(Ma=null==(Ga=null==(ua=window.logseq)?void 0:ua.api)?void 0:Ga.open_external_link)?void 0:Ma.call(Ga,N.props.url)},children:(0,pi.jsx)(eh,{name:"external-link"})})]})}),ls=ue(()=>{const c=Te(),{handlers:{t:n}}=ck.default.useContext(vi),N=tk("TwitterLink")[0],da=ck.default.useCallback(ua=>{N.onTwitterLinkChange(ua.target.value);c.persist()},[]);return(0,pi.jsxs)("span",{className:"flex gap-3",
children:[(0,pi.jsx)(Yq,{title:n("whiteboard/twitter-url"),className:"tl-twitter-link",value:`${N.props.url}`,onChange:da}),(0,pi.jsx)(kh,{tooltip:n("whiteboard/open-twitter-url"),type:"button",onClick:()=>{var ua,Ga,Ma;return null==(Ma=null==(Ga=null==(ua=window.logseq)?void 0:ua.api)?void 0:Ga.open_external_link)?void 0:Ma.call(Ga,N.props.url)},children:(0,pi.jsx)(eh,{name:"external-link"})})]})}),ku=ue(()=>{const c=Te(),{handlers:{t:n,setCurrentPdf:N}}=ck.default.useContext(vi),da=c.selectedShapesArray[0];
return(0,pi.jsx)(kh,{tooltip:n("whiteboard/edit-pdf"),type:"button",onClick:()=>N(c.assets[da.props.assetId].src),children:(0,pi.jsx)(eh,{name:"edit"})})}),cy=ue(()=>{const c=Te(),{handlers:{t:n}}=ck.default.useContext(vi);var N=tk("NoFill");const da=ck.default.useCallback(ua=>{c.selectedShapesArray.forEach(Ga=>Ga.update({noFill:ua}));c.persist()},[]);N=N.every(ua=>ua.props.noFill);return(0,pi.jsx)(xg,{tooltip:n("whiteboard/fill"),className:"tl-button",pressed:N,onPressedChange:da,children:(0,pi.jsx)(eh,
{name:N?"droplet-off":"droplet"})})}),lu=ue(()=>{const c=Te(),n=tk("Swatch"),N=ck.default.useCallback(ua=>{c.selectedShapesArray.forEach(Ga=>{Ga.update({fill:ua,stroke:ua})});c.persist()},[]),da=ck.default.useCallback(ua=>{c.selectedShapesArray.forEach(Ga=>{Ga.update({opacity:ua})});c.persist()},[]);return(0,pi.jsx)(qf,{popoverSide:"top",color:n[0].props.noFill?n[0].props.stroke:n[0].props.fill,opacity:n[0].props.opacity,setOpacity:da,setColor:N})}),xi=ue(()=>{const c=Te(),n=ck.default.useCallback(N=>
{c.api.convertShapes(N.currentTarget.dataset.tool)},[]);return(0,pi.jsx)(ux,{popoverSide:"top",chevron:!1,setGeometry:n})}),mu=ue(()=>{const c=Te(),{handlers:{t:n}}=ck.default.useContext(vi),N=tk("StrokeType"),da=N.every(ua=>"dashed"===ua.props.strokeType)?"dashed":N.every(ua=>"line"===ua.props.strokeType)?"line":"mixed";return(0,pi.jsx)(Bk,{title:n("whiteboard/stroke-type"),options:[{value:"line",icon:"circle",tooltip:"Solid"},{value:"dashed",icon:"circle-dashed",tooltip:"Dashed"}],value:da,onValueChange:ua=>
{N.forEach(Ga=>{Ga.update({strokeType:ua})});c.persist()}})}),nu=ue(()=>{const c=Te(),{handlers:{t:n}}=ck.default.useContext(vi),N=tk("ArrowMode");var da=N.every(Ga=>{var Ma;return"arrow"===(null==(Ma=Ga.props.decorations)?void 0:Ma.start)});const ua=N.every(Ga=>{var Ma;return"arrow"===(null==(Ma=Ga.props.decorations)?void 0:Ma.end)});da=[da?"start":null,ua?"end":null].filter(Kc);return(0,pi.jsx)(ui,{title:n("whiteboard/arrow-head"),options:[{value:"start",icon:"arrow-narrow-left"},{value:"end",icon:"arrow-narrow-right"}],
value:da,onValueChange:Ga=>{N.forEach(Ma=>{var fb=Ma.update;var vb={start:Ga.includes("start")?"arrow":null,end:Ga.includes("end")?"arrow":null};fb.call(Ma,{decorations:vb})});c.persist()}})}),ou=ue(()=>{const c=Te(),{handlers:{t:n}}=ck.default.useContext(vi),N=tk("TextStyle"),da=N.every(Ga=>500<Ga.props.fontWeight),ua=N.every(Ga=>Ga.props.italic);return(0,pi.jsxs)("span",{className:"flex gap-1",children:[(0,pi.jsx)(xg,{tooltip:n("whiteboard/bold"),className:"tl-button",pressed:da,onPressedChange:Ga=>
{N.forEach(Ma=>{Ma.update({fontWeight:Ga?700:400});Ma.onResetBounds()});c.persist()},children:(0,pi.jsx)(eh,{name:"bold"})}),(0,pi.jsx)(xg,{tooltip:n("whiteboard/italic"),className:"tl-button",pressed:ua,onPressedChange:Ga=>{N.forEach(Ma=>{Ma.update({italic:Ga});Ma.onResetBounds()});c.persist()},children:(0,pi.jsx)(eh,{name:"italic"})})]})}),Lp=ue(()=>{var c;const n=Te(),N=n.selectedShapesArray[0];return(0,pi.jsx)(fD,{onRefsChange:da=>{N.update({refs:da});n.persist()},refs:null!=(c=N.props.refs)?
c:[],shapeType:N.props.type,side:"right",pageId:"logseq-portal"===N.props.type?N.props.pageId:void 0,portalType:"logseq-portal"===N.props.type?N.props.blockType:void 0})});oj.set("Geometry",xi);oj.set("AutoResizing",nk);oj.set("LogseqPortalViewMode",dl);oj.set("ScaleLevel",wi);oj.set("YoutubeLink",ks);oj.set("TwitterLink",ls);oj.set("IFrameSource",by);oj.set("NoFill",cy);oj.set("Swatch",lu);oj.set("StrokeType",mu);oj.set("ArrowMode",nu);oj.set("TextStyle",ou);oj.set("Links",Lp);oj.set("EditPdf",ku);
var pu=c=>{var n;return(null!=(n=rj[c])?n:[]).filter(Kc)},Do=c=>{const n=c.map(da=>da.props.type),N=new Set(0<c.length?pu(n[0]):[]);for(let da=1;da<n.length&&0<N.size;da++){const ua=pu(n[da]);N.forEach(Ga=>{ua.includes(Ga)||N.delete(Ga)})}1<c.length&&nj.forEach(da=>{N.has(da)&&N.delete(da)});return Array.from(N).sort((da,ua)=>js.indexOf(da)-js.indexOf(ua)).map(da=>oj.get(da))},Zq=Z(288),ms=window.LSUI,ns=ue(({shapes:c,offsets:n,hidden:N})=>{const da=Te(),ua=Oq.useRef(null),Ga=Oq.useRef(null);Oq.useLayoutEffect(()=>
{setTimeout(()=>{const fb=Ga.current;if(fb){var {offsetWidth:vb,offsetHeight:Wb}=fb;ua.current=[vb,Wb]}})});Oq.useLayoutEffect(()=>{var fb;const vb=Ga.current;if(vb){var Wb=null!=(fb=ua.current)?fb:[0,0];fb=0;if(116>n.top){var oc=n.height/2+40;140>n.bottom&&(oc+=n.bottom-140)}else oc=-(n.height/2+40);16>n.left+n.width/2-Wb[0]/2?fb+=-(n.left+n.width/2-Wb[0]/2-16):16>n.right+n.width/2-Wb[0]/2&&(fb+=n.right+n.width/2-Wb[0]/2-16);var [xc,Uc]=[fb,oc];vb.style.transform=`translateX(${xc}px) translateY(${Uc}px)`}},
[n]);if(!da)return null;const Ma=Do(c);return(0,Zq.jsx)($k,{centered:!0,children:0<Ma.length&&(0,Zq.jsx)("div",{ref:Ga,className:"tl-toolbar tl-context-bar",style:{visibility:N?"hidden":"visible",pointerEvents:N?"none":"all"},children:Ma.map((fb,vb)=>(0,Zq.jsxs)(Oq.Fragment,{children:[(0,Zq.jsx)(fb,{}),vb<Ma.length-1&&(0,Zq.jsx)(ms.Separator,{orientation:"vertical"})]},vb))})})}),$q=Lf(Z(69)),Mf=Z(288),si=window.LSUI,ar=ue(function({children:c,collisionRef:n}){var N,da,ua,Ga,Ma,fb,vb,Wb,oc,xc,Uc,
md,hd,Bd,Ld,bd,jd;const rd=Te(),{handlers:Md}=$q.useContext(vi),Dd=Md.t,Oe=$q.useRef(null),Pe=cf=>{cf();rd.transition("select")},cg=$q.useMemo(()=>fc(),[]);return(0,Mf.jsxs)(si.ContextMenu,{onOpenChange:cf=>{cf&&!rd.isIn("select.contextMenu")?rd.transition("select").selectedTool.transition("contextMenu"):!cf&&rd.isIn("select.contextMenu")&&rd.selectedTool.transition("idle")},children:[(0,Mf.jsx)(si.ContextMenuTrigger,{disabled:rd.editingShape&&0!==Object.keys(rd.editingShape).length,children:c}),
(0,Mf.jsx)(si.ContextMenuContent,{className:"tl-menu tl-context-menu",ref:Oe,onEscapeKeyDown:()=>rd.transition("select"),collisionBoundary:n.current,asChild:!0,tabIndex:-1,children:(0,Mf.jsxs)("div",{children:[1<(null==(N=rd.selectedShapes)?void 0:N.size)&&!rd.readOnly&&(null==(da=rd.selectedShapesArray)?void 0:da.some(cf=>!cf.props.isLocked))&&(0,Mf.jsxs)(Mf.Fragment,{children:[(0,Mf.jsxs)(si.ContextMenuItem,{className:"tl-menu-button-row-wrap",children:[(0,Mf.jsxs)("div",{className:"tl-menu-button-row pb-0",
children:[(0,Mf.jsx)(kh,{tooltip:Dd("whiteboard/align-left"),onClick:()=>Pe(()=>rd.align("left")),children:(0,Mf.jsx)(eh,{name:"layout-align-left"})}),(0,Mf.jsx)(kh,{tooltip:Dd("whiteboard/align-center-horizontally"),onClick:()=>Pe(()=>rd.align("centerHorizontal")),children:(0,Mf.jsx)(eh,{name:"layout-align-center"})}),(0,Mf.jsx)(kh,{tooltip:Dd("whiteboard/align-right"),onClick:()=>Pe(()=>rd.align("right")),children:(0,Mf.jsx)(eh,{name:"layout-align-right"})}),(0,Mf.jsx)(si.Separator,{className:"tl-toolbar-separator",
orientation:"vertical"}),(0,Mf.jsx)(kh,{tooltip:Dd("whiteboard/distribute-horizontally"),onClick:()=>Pe(()=>rd.distribute("horizontal")),children:(0,Mf.jsx)(eh,{name:"layout-distribute-vertical"})})]}),(0,Mf.jsxs)("div",{className:"tl-menu-button-row pt-0",children:[(0,Mf.jsx)(kh,{tooltip:Dd("whiteboard/align-top"),onClick:()=>Pe(()=>rd.align("top")),children:(0,Mf.jsx)(eh,{name:"layout-align-top"})}),(0,Mf.jsx)(kh,{tooltip:Dd("whiteboard/align-center-vertically"),onClick:()=>Pe(()=>rd.align("centerVertical")),
children:(0,Mf.jsx)(eh,{name:"layout-align-middle"})}),(0,Mf.jsx)(kh,{tooltip:Dd("whiteboard/align-bottom"),onClick:()=>Pe(()=>rd.align("bottom")),children:(0,Mf.jsx)(eh,{name:"layout-align-bottom"})}),(0,Mf.jsx)(si.Separator,{className:"tl-toolbar-separator",orientation:"vertical"}),(0,Mf.jsx)(kh,{tooltip:Dd("whiteboard/distribute-vertically"),onClick:()=>Pe(()=>rd.distribute("vertical")),children:(0,Mf.jsx)(eh,{name:"layout-distribute-horizontal"})})]})]}),(0,Mf.jsx)(si.ContextMenuSeparator,{className:"menu-separator"}),
(0,Mf.jsxs)(si.ContextMenuItem,{className:"tl-menu-item",onClick:()=>Pe(rd.packIntoRectangle),children:[(0,Mf.jsx)(eh,{className:"tl-menu-icon",name:"layout-grid"}),Dd("whiteboard/pack-into-rectangle")]}),(0,Mf.jsx)(si.ContextMenuSeparator,{className:"menu-separator"})]}),0<(null==(ua=rd.selectedShapes)?void 0:ua.size)&&(0,Mf.jsxs)(Mf.Fragment,{children:[(0,Mf.jsxs)(si.ContextMenuItem,{className:"tl-menu-item",onClick:()=>Pe(rd.api.zoomToSelection),children:[(0,Mf.jsx)(eh,{className:"tl-menu-icon",
name:"circle-dotted"}),Dd("whiteboard/zoom-to-fit"),(0,Mf.jsx)(ak,{action:"whiteboard/zoom-to-fit"})]}),(0,Mf.jsx)(si.ContextMenuSeparator,{className:"menu-separator"})]}),(rd.selectedShapesArray.some(cf=>"group"===cf.type||rd.getParentGroup(cf))||1<rd.selectedShapesArray.length)&&(null==(Ga=rd.selectedShapesArray)?void 0:Ga.some(cf=>!cf.props.isLocked))&&!rd.readOnly&&(0,Mf.jsxs)(Mf.Fragment,{children:[rd.selectedShapesArray.some(cf=>"group"===cf.type||rd.getParentGroup(cf))&&(0,Mf.jsxs)(si.ContextMenuItem,
{className:"tl-menu-item",onClick:()=>Pe(rd.api.unGroup),children:[(0,Mf.jsx)(eh,{className:"tl-menu-icon",name:"ungroup"}),Dd("whiteboard/ungroup"),(0,Mf.jsx)(ak,{action:"whiteboard/ungroup"})]}),1<rd.selectedShapesArray.length&&(null==(Ma=rd.selectedShapesArray)?void 0:Ma.some(cf=>!cf.props.isLocked))&&(0,Mf.jsxs)(si.ContextMenuItem,{className:"tl-menu-item",onClick:()=>Pe(rd.api.doGroup),children:[(0,Mf.jsx)(eh,{className:"tl-menu-icon",name:"group"}),Dd("whiteboard/group"),(0,Mf.jsx)(ak,{action:"whiteboard/group"})]}),
(0,Mf.jsx)(si.ContextMenuSeparator,{className:"menu-separator"})]}),0<(null==(fb=rd.selectedShapes)?void 0:fb.size)&&(null==(vb=rd.selectedShapesArray)?void 0:vb.some(cf=>!cf.props.isLocked))&&(0,Mf.jsxs)(Mf.Fragment,{children:[!rd.readOnly&&(0,Mf.jsxs)(si.ContextMenuItem,{className:"tl-menu-item",onClick:()=>Pe(rd.cut),children:[(0,Mf.jsx)(eh,{className:"tl-menu-icon",name:"cut"}),Dd("whiteboard/cut")]}),(0,Mf.jsxs)(si.ContextMenuItem,{className:"tl-menu-item",onClick:()=>Pe(rd.copy),children:[(0,Mf.jsx)(eh,
{className:"tl-menu-icon",name:"copy"}),Dd("whiteboard/copy"),(0,Mf.jsx)(ak,{action:"editor/copy"})]})]}),!rd.readOnly&&(0,Mf.jsxs)(si.ContextMenuItem,{className:"tl-menu-item",onClick:()=>Pe(rd.paste),children:[(0,Mf.jsx)(eh,{className:"tl-menu-icon",name:"clipboard"}),Dd("whiteboard/paste"),(0,Mf.jsx)(ak,{shortcut:`${vw}+v`})]}),1===(null==(Wb=rd.selectedShapes)?void 0:Wb.size)&&!rd.readOnly&&(0,Mf.jsxs)(si.ContextMenuItem,{className:"tl-menu-item",onClick:()=>Pe(()=>rd.paste(void 0,!0)),children:[(0,Mf.jsx)(eh,
{className:"tl-menu-icon",name:"circle-dotted"}),Dd("whiteboard/paste-as-link"),(0,Mf.jsx)(ak,{shortcut:`${vw}+\u21E7+v`})]}),0<(null==(oc=rd.selectedShapes)?void 0:oc.size)&&(0,Mf.jsxs)(Mf.Fragment,{children:[(0,Mf.jsx)(si.ContextMenuSeparator,{className:"menu-separator"}),(0,Mf.jsxs)(si.ContextMenuItem,{className:"tl-menu-item",onClick:()=>Pe(()=>{var cf,Of;return Md.exportToImage(rd.currentPageId,{x:rd.selectionBounds.minX+rd.viewport.camera.point[0]-8,y:rd.selectionBounds.minY+rd.viewport.camera.point[1]-
8,width:(null==(cf=rd.selectionBounds)?void 0:cf.width)+16,height:(null==(Of=rd.selectionBounds)?void 0:Of.height)+16,zoom:rd.viewport.camera.zoom})}),children:[(0,Mf.jsx)(eh,{className:"tl-menu-icon",name:"file-export"}),Dd("whiteboard/export"),(0,Mf.jsx)("div",{className:"tl-menu-right-slot",children:(0,Mf.jsx)("span",{className:"keyboard-shortcut"})})]})]}),(0,Mf.jsx)(si.ContextMenuSeparator,{className:"menu-separator"}),(0,Mf.jsxs)(si.ContextMenuItem,{className:"tl-menu-item",onClick:()=>Pe(rd.api.selectAll),
children:[(0,Mf.jsx)(eh,{className:"tl-menu-icon",name:"circle-dotted"}),Dd("whiteboard/select-all"),(0,Mf.jsx)(ak,{action:"editor/select-parent"})]}),1<(null==(xc=rd.selectedShapes)?void 0:xc.size)&&(0,Mf.jsxs)(si.ContextMenuItem,{className:"tl-menu-item",onClick:()=>Pe(rd.api.deselectAll),children:[(0,Mf.jsx)(eh,{className:"tl-menu-icon",name:"circle-dotted"}),Dd("whiteboard/deselect-all")]}),!rd.readOnly&&0<(null==(Uc=rd.selectedShapes)?void 0:Uc.size)&&(null==(md=rd.selectedShapesArray)?void 0:
md.some(cf=>!cf.props.isLocked))&&(0,Mf.jsxs)(si.ContextMenuItem,{className:"tl-menu-item",onClick:()=>Pe(()=>rd.setLocked(!0)),children:[(0,Mf.jsx)(eh,{className:"tl-menu-icon",name:"lock"}),Dd("whiteboard/lock"),(0,Mf.jsx)(ak,{action:"whiteboard/lock"})]}),!rd.readOnly&&0<(null==(hd=rd.selectedShapes)?void 0:hd.size)&&(null==(Bd=rd.selectedShapesArray)?void 0:Bd.some(cf=>cf.props.isLocked))&&(0,Mf.jsxs)(si.ContextMenuItem,{className:"tl-menu-item",onClick:()=>Pe(()=>rd.setLocked(!1)),children:[(0,Mf.jsx)(eh,
{className:"tl-menu-icon",name:"lock-open"}),Dd("whiteboard/unlock"),(0,Mf.jsx)(ak,{action:"whiteboard/unlock"})]}),0<(null==(Ld=rd.selectedShapes)?void 0:Ld.size)&&!rd.readOnly&&(null==(bd=rd.selectedShapesArray)?void 0:bd.some(cf=>!cf.props.isLocked))&&(0,Mf.jsxs)(Mf.Fragment,{children:[(0,Mf.jsxs)(si.ContextMenuItem,{className:"tl-menu-item",onClick:()=>Pe(rd.api.deleteShapes),children:[(0,Mf.jsx)(eh,{className:"tl-menu-icon",name:"backspace"}),Dd("whiteboard/delete"),(0,Mf.jsx)(ak,{action:"editor/delete"})]}),
1<(null==(jd=rd.selectedShapes)?void 0:jd.size)&&!rd.readOnly&&(0,Mf.jsxs)(Mf.Fragment,{children:[(0,Mf.jsx)(si.ContextMenuSeparator,{className:"menu-separator"}),(0,Mf.jsxs)(si.ContextMenuItem,{className:"tl-menu-item",onClick:()=>Pe(rd.flipHorizontal),children:[(0,Mf.jsx)(eh,{className:"tl-menu-icon",name:"flip-horizontal"}),Dd("whiteboard/flip-horizontally")]}),(0,Mf.jsxs)(si.ContextMenuItem,{className:"tl-menu-item",onClick:()=>Pe(rd.flipVertical),children:[(0,Mf.jsx)(eh,{className:"tl-menu-icon",
name:"flip-vertical"}),Dd("whiteboard/flip-vertically")]})]}),!rd.readOnly&&(0,Mf.jsxs)(Mf.Fragment,{children:[(0,Mf.jsx)(si.ContextMenuSeparator,{className:"menu-separator"}),(0,Mf.jsxs)(si.ContextMenuItem,{className:"tl-menu-item",onClick:()=>Pe(rd.bringToFront),children:[(0,Mf.jsx)(eh,{className:"tl-menu-icon",name:"circle-dotted"}),Dd("whiteboard/move-to-front"),(0,Mf.jsx)(ak,{action:"whiteboard/bring-to-front"})]}),(0,Mf.jsxs)(si.ContextMenuItem,{className:"tl-menu-item",onClick:()=>Pe(rd.sendToBack),
children:[(0,Mf.jsx)(eh,{className:"tl-menu-icon",name:"circle-dotted"}),Dd("whiteboard/move-to-back"),(0,Mf.jsx)(ak,{action:"whiteboard/send-to-back"})]})]}),cg&&(0,Mf.jsx)(si.ContextMenuItem,{className:"tl-menu-item",onClick:()=>{1===rd.selectedShapesArray.length?console.log(Bb(rd.selectedShapesArray[0].serialized)):console.log(rd.selectedShapesArray.map(cf=>Bb(cf.serialized)))},children:Dd("whiteboard/dev-print-shape-props")})]})]})})]})}),qu=Lf(Z(69)),os=Z(288),gD=ue(({shape:c})=>{const n=Te();
var {handlers:N}=qu.default.useContext(vi);N=N.t;const da=qu.default.useMemo(()=>{var ua;const Ga=[...(null!=(ua=c.props.refs)?ua:[])].map(Ma=>[Ma,!0]);"logseq-portal"===c.props.type&&c.props.pageId&&Ga.unshift([c.props.pageId,!1]);return Ga.filter(Ma=>Ma[0].toLowerCase()!==n.currentPage.id&&Ma[0]!==c.props.pageId)},[c.props.id,c.props.type,c.props.parentId,c.props.refs]);return 0===da.length?null:(0,os.jsx)("div",{className:"tl-quick-links",title:N("whiteboard/shape-quick-links"),children:da.map(([ua,
Ga])=>(0,os.jsx)("div",{className:"tl-quick-links-row",children:(0,os.jsx)(yx,{id:ua,showReferenceContent:Ga})},ua))})}),Mp=Lf(Z(69)),Np=Lf(Z(69)),ps={image:[".png",".svg",".jpg",".jpeg",".gif"],video:[".mp4",".webm",".ogg"],pdf:[".pdf"]},qs=(c,n,N)=>Zh(void 0,[c,n,N],function*(da,{point:ua,shiftKey:Ga,dataTransfer:Ma,fromDrop:fb},vb){function Wb(xf,Vf){return Zh(this,null,function*(){const ch=Object.values(da.assets).find(Fh=>Fh.src===xf);return ch?ch:{id:Me(),type:Vf,src:xf,size:yield ci(vb.makeAssetUrl(xf),
Vf)}})}function oc(xf){return Zh(this,null,function*(){const Vf=xf.filter(ch=>"unknown"!==wq(ch.name)).map(ch=>Zh(this,null,function*(){try{const Fh=yield vb.saveAsset(ch);return yield Wb(Fh,wq(ch.name))}catch(Fh){console.error(Fh)}return null}));return(yield Promise.all(Vf)).filter(Kc)})}function xc(xf){return[kg(Af({},wn.defaultProps),{html:xf,point:[ua[0],ua[1]]})]}function Uc(xf){return Zh(this,null,function*(){return Xk(hd,Bd,jd,bd,rd,Ld,cg)(xf)})}function md(){return Zh(this,null,function*(){const xf=
yield navigator.clipboard.read(),Vf=Xk(rd,Ld,cg);return(yield Promise.all(xf.map(ch=>Vf(ch)))).flat().filter(Kc)})}function hd(xf){return Zh(this,null,function*(){var Vf=xf.getData("file");if(!Vf)return null;const ch=yield Wb(Vf,"pdf");da.addAssets([ch]);Vf=kg(Af({},Wq.defaultProps),{id:Me(),assetId:ch.id,url:Vf,opacity:1});ch.size&&Object.assign(Vf,{point:[ua[0]-ch.size[0]/4+16,ua[1]-ch.size[1]/4+16],size:pe.div(ch.size,2)});return[Vf]})}function Bd(xf){return Zh(this,null,function*(){var Vf=Array.from(xf.files);
return 0<Vf.length?(Hg=Vf=yield oc(Vf),Vf.map((ch,Fh)=>{switch(ch.type){case "video":var Vi=hs.defaultProps;break;case "image":Vi=es.defaultProps;break;case "pdf":Vi=Wq.defaultProps;break;default:return null}Vi=kg(Af({},Vi),{id:Me(),assetId:ch.id,opacity:1});ch.size&&Object.assign(Vi,{point:[ua[0]-ch.size[0]/4+16*Fh,ua[1]-ch.size[1]/4+16*Fh],size:pe.div(ch.size,2)});return Vi})):null})}function Ld(xf){return Zh(this,null,function*(){if(xf.types.includes("text/plain")&&(Ga||fb))return null;const Vf=
yield Bm(xf,"text/html");return Vf?Xk(Md,xc)(Vf):null})}function bd(xf){return Zh(this,null,function*(){var Vf,ch,Fh,Vi,hi,Wg,Ki=xf.getData("block-uuid");if(Ki){Ki=Ki.trim();const Ni=null==(Fh=null==(ch=null==(Vf=window.logseq)?void 0:Vf.api)?void 0:ch.get_selected_blocks)?void 0:Fh.call(ch);Vf=Ni&&1<(null==Ni?void 0:Ni.length)?Ni.map(cj=>cj.uuid):[Ki];null==(Wg=null==(hi=null==(Vi=window.logseq)?void 0:Vi.api)?void 0:hi.set_blocks_id)?void 0:Wg.call(hi,Vf);Vi=Vf.map(cj=>Pe(`((${cj}))`));return(yield Promise.all(Vi)).flat().filter(Kc).map((cj,
Pk)=>kg(Af({},cj),{point:[ua[0]+(Gj.defaultProps.size[0]+16)*Pk,ua[1]]}))}return null})}function jd(xf){return Zh(this,null,function*(){var Vf=xf.getData("page-name");return Vf?(Vf=Vf.trim(),Pe(`[[${Vf}]]`)):null})}function rd(xf){return Zh(this,null,function*(){var Vf=yield Bm(xf,"text/plain");return Vf?(Vf=Vf.trim(),Xk(Dd,Oe)(Vf)):null})}function Md(xf){if(xf=da.api.getClonedShapesFromTldrString(decodeURIComponent(xf),ua)){const {shapes:Vf,assets:ch,bindings:Fh}=xf;ah.push(...ch);Eg.push(...Fh);
return Vf}return null}function Dd(xf){return Zh(this,null,function*(){try{const ch=new URL(xf);var Vf=ch.host&&["http:","https:"].includes(ch.protocol)}catch(ch){Vf=!1}return Vf&&!Ga?Wx.test(xf)?[kg(Af({},Bo.defaultProps),{url:xf,point:[ua[0],ua[1]]})]:Yx.test(xf)?[kg(Af({},Kp.defaultProps),{url:xf,point:[ua[0],ua[1]]})]:[kg(Af({},zo.defaultProps),{url:xf,point:[ua[0],ua[1]]})]:null})}function Oe(xf){return xf.startsWith("\x3ciframe")?[kg(Af({},wn.defaultProps),{html:xf,point:[ua[0],ua[1]]})]:null}
function Pe(xf){return Zh(this,null,function*(){if(/^\(\(.*\)\)$/.test(xf)&&40===xf.length){var Vf=xf.slice(2,-2);if(og(Vf))return[kg(Af({},Gj.defaultProps),{point:[ua[0],ua[1]],size:[400,0],pageId:Vf,fill:da.settings.color,stroke:da.settings.color,scaleLevel:da.settings.scaleLevel,blockType:"B"})]}else if(/^\[\[.*\]\]$/.test(xf))return Vf=xf.slice(2,-2),[kg(Af({},Gj.defaultProps),{point:[ua[0],ua[1]],size:[400,0],pageId:Vf,fill:da.settings.color,stroke:da.settings.color,scaleLevel:da.settings.scaleLevel,
blockType:"P"})];return null})}function cg(xf){return Zh(this,null,function*(){var Vf=yield Bm(xf,"text/plain");return Vf&&(Vf=Vf.trim(),Vf=yield null==vb?void 0:vb.addNewBlock(Vf))?[kg(Af({},Gj.defaultProps),{size:[400,0],point:[ua[0],ua[1]],pageId:Vf,fill:da.settings.color,stroke:da.settings.color,scaleLevel:da.settings.scaleLevel,blockType:"B",compact:!0})]:null})}var cf,Of;let Hg=[],ah=[];const Eg=[];da.cursors.setCursor("progress");let bh=[];try{Ma?bh.push(...(null!=(cf=yield Uc(Ma))?cf:[])):
bh.push(...(null!=(Of=yield md())?Of:[]))}catch(xf){console.error(xf)}const vf=bh.map(xf=>kg(Af({},xf),{parentId:da.currentPageId,isLocked:!1,id:og(xf.id)?xf.id:Me()})),Ef=null==Ma?void 0:Ma.types.every(xf=>"Files"===xf);da.wrapUpdate(()=>{var xf=[...Hg,...ah];0<xf.length&&da.createAssets(xf);0<vf.length&&da.createShapes(vf);da.currentPage.updateBindings(Object.fromEntries(Eg.map(Vf=>[Vf.id,Vf])));if(1===da.selectedShapesArray.length&&1===vf.length&&fb){xf=da.selectedShapesArray[0];const Vf=da.getShapeById(vf[0].id);
da.createNewLineBinding(xf,Vf)}da.setSelectedShapes(vf.map(Vf=>Vf.id));da.selectedTool.transition("idle");da.cursors.setCursor("default");(fb||Ef)&&da.packIntoRectangle()})}),ru=Lf(Z(69)),rs=Lf(Z(69)),Jm=Z(288),su=[du,eu,ay,fu,gu,cl,hu,iu,ju,jv,iv,Pn],hD=c=>{const {renderers:n}=vp.useContext(vi);return(0,Jm.jsx)(n.BacklinksCount,kg(Af({},c),{options:{"portal?":!1}}))},dy=()=>{const c=vp.useRef(null),n=Te(),N=vp.useMemo(()=>({ContextBar:ns,BacklinksCount:hD,QuickLinks:gD}),[]);return(0,Jm.jsx)(ar,
{collisionRef:c,children:(0,Jm.jsx)("div",{ref:c,className:"logseq-tldraw logseq-tldraw-wrapper","data-tlapp":n.uuid,children:(0,Jm.jsx)(nB,{components:N,children:(0,Jm.jsx)(GB,{})})})})},iD=c=>{var {onPersist:n,readOnly:N,model:da}=c;c=Zi(c,["onPersist","readOnly","model"]);const ua=uk(),Ga=vr(),Ma=wr(),fb=N?null:xr(),vb=vp.useCallback((Wb,oc)=>{null==n?void 0:n(Wb,oc)},[da]);return(0,Jm.jsx)(jB,kg(Af({Shapes:$x,Tools:su,onDrop:ua,onPaste:Ga,onCopy:Ma,readOnly:N,onCanvasDBClick:fb,onPersist:vb,model:da},
c),{children:(0,Jm.jsx)(dy,{})}))},br=function(c){var {renderers:n,handlers:N}=c;c=Zi(c,["renderers","handlers"]);const da={renderers:vp.useMemo(()=>Object.fromEntries(Object.entries(n).map(([ua,Ga])=>[ua,vp.memo(Ga)])),[]),handlers:N};return(0,Jm.jsx)(vi.Provider,{value:da,children:(0,Jm.jsx)(iD,Af({},c))})}};
'use strict';var Lze=function(a,b){var c=$APP.dM.A(a),d=c?$APP.zz:$APP.My;a=$APP.pM.A(b);return $APP.xn.C(function(e){var f=$APP.Se(e);e=$APP.I.C(f,$APP.ux);f=c?$APP.I.C(f,d):$APP.I.C($APP.nx.A(f),d);return $APP.m(f)?new $APP.l(null,2,[$APP.Ms,$APP.q.A(e),$APP.uDd,$APP.uDd.A(f)],null):null},$APP.aYa.A(a))},Mze=function(a){return $APP.wq.G(a,$APP.D([$APP.xq,!0]))},Nze=function(a,b,c,d){c=new $APP.l(null,5,[$APP.Ms,$APP.ua(c,"id"),$APP.Il,$APP.ua(c,"name"),$APP.Mu,Mze($APP.ua(c,"bindings")),$APP.uDd,
$APP.ua(c,"nonce"),$APP.xEc,Mze(d)],null);d=$APP.Eq.I?$APP.Eq.I():$APP.Eq.call(null);var e=$APP.Iq.A(a);e=$APP.m(e)?e:$APP.Eq.I?$APP.Eq.I():$APP.Eq.call(null);return $APP.jg([$APP.Hq,$APP.Iq,$APP.KF,$APP.iz,$APP.yz,$APP.Aw,$APP.Xw,$APP.jl,$APP.Yx],[d,e,c,$APP.vbb,$APP.Ot,$APP.Iw,b,$APP.jl.A(a),$APP.yq.A?$APP.yq.A(b):$APP.yq.call(null,b)])},Oze=function(a,b,c,d){var e=$APP.yq.A?$APP.yq.A(b):$APP.yq.call(null,b);c=$APP.Qe([$APP.SM($APP.iz),$APP.vbb,$APP.SM($APP.KF),new $APP.l(null,5,[$APP.Ms,$APP.ua(c,
"id"),$APP.Il,$APP.ua(c,"name"),$APP.Mu,Mze($APP.ua(c,"bindings")),$APP.uDd,$APP.ua(c,"nonce"),$APP.xEc,Mze(d)],null)]);d=$APP.Eq.I?$APP.Eq.I():$APP.Eq.call(null);a=$APP.Iq.A(a);a=$APP.m(a)?a:$APP.Eq.I?$APP.Eq.I():$APP.Eq.call(null);return new $APP.l(null,6,[$APP.Xw,b,$APP.Yx,e,$APP.zw,"whiteboard",$APP.nx,c,$APP.Hq,d,$APP.Iq,a],null)},Pze=function(a,b,c,d){var e=$APP.dM.A($APP.MK())?Nze:Oze;return e.K?e.K(a,b,c,d):e.call(null,a,b,c,d)},Qze=function(a,b,c,d,e,f){var g=$APP.DM.A?$APP.DM.A(e):$APP.DM.call(null,
e);a=Mze(a.getCleanUpAssets());var h=$APP.Eg($APP.Zg.C(function(y){y=$APP.Se(y);y=$APP.I.C(y,$APP.Ms);return Mze(b.getShapeById(y).serialized)},$APP.Kj.C(c,d)));d=$APP.Eg($APP.Zg.C($APP.Ms,d));var n=$APP.Eg($APP.Zg.C($APP.Ms,c)),p=$APP.Eg($APP.Cj.C($APP.ni,$APP.Kj.C(n,d)));c=$APP.x(p)?function(){var y=$APP.Bc($APP.Rh.A($APP.Zg.C($APP.rx,$APP.aYa.A(g))));return $APP.lVa($APP.qc(p),y,null)}():null;var r=$APP.x(p)?$APP.Hg(p,c):null;c=$APP.Eg($APP.yf.C(function(y){y=$APP.Ms.A(y);return p.A?p.A(y):p.call(null,
y)},h));var t=$APP.Cj.C($APP.ni,$APP.Kj.C(d,n)),v=$APP.MK();d=$APP.x(t)?$APP.Cj.C($APP.eb,$APP.Xk.C(function(y){return $APP.RM(y,$APP.zz)},function(){var y=new $APP.M(null,1,5,$APP.O,[$APP.Zl],null),B=$APP.Xk.C(function(F){return new $APP.M(null,2,5,$APP.O,[$APP.ux,$APP.xh(F)],null)},t);return $APP.nM?$APP.nM(v,y,B):$APP.ZZb.call(null,v,y,B)}())):null;n=$APP.Xk.C(function(y){return new $APP.M(null,2,5,$APP.O,[$APP.wx,new $APP.M(null,2,5,$APP.O,[$APP.ux,$APP.xh(y)],null)],null)},t);h=$APP.Zg.C(function(y){var B=
$APP.m(r)?$APP.I.C(r,$APP.q.A($APP.ux.A(y))):null;return $APP.m(B)?$APP.T.F(y,$APP.rx,B):y},$APP.Zg.C($APP.Jq,$APP.Zg.C(function(y){var B=$APP.jl.A(g),F=$APP.MK();return $APP.E1a(F,y,B)},h)));var w=function(){var y=$APP.Xw.A(g);return $APP.m(y)?y:$APP.q.A(e)}();a=Pze(g,w,b,a);return $APP.x(h)||$APP.x(n)||$APP.tg.C($APP.nx.A(a),$APP.nx.A(g))?new $APP.l(null,6,[$APP.Nxc,a,$APP.bMd,h,$APP.qC,n,$APP.HUd,d,$APP.Sdd,c,$APP.j6a,new $APP.l(null,2,[$APP.cgb,!0,$APP.hD,f],null)],null):null},Rze=function(a){return $APP.xh(a.id)},
Sze=function(a,b){var c=$APP.Iu.A(b),d=$APP.AEc.A(b);d=$APP.Xk.C(Rze,d);switch(c){case "sendToBack":c=function(){var f=Rze($APP.XIb.A(b));if($APP.m(f)){var g=$APP.rx.A;f=new $APP.M(null,2,5,$APP.O,[$APP.ux,f],null);f=$APP.pM.A?$APP.pM.A(f):$APP.pM.call(null,f);g=g.call($APP.rx,f)}else g=null;return g}();var e=$APP.lVa($APP.qc(d),null,c);return a=$APP.ie.C($APP.Jo.C(function(f,g){return new $APP.l(null,2,[$APP.ux,g,$APP.rx,$APP.C.C(e,f)],null)},d),$APP.rz(new $APP.l(null,1,[$APP.jl,$APP.jl.A(a)],null)));
case "bringToFront":return c=function(){var f=Rze($APP.gM.A(b));if($APP.m(f)){var g=$APP.rx.A;f=new $APP.M(null,2,5,$APP.O,[$APP.ux,f],null);f=$APP.pM.A?$APP.pM.A(f):$APP.pM.call(null,f);g=g.call($APP.rx,f)}else g=null;return g}(),e=$APP.lVa($APP.qc(d),c,null),a=$APP.ie.C($APP.Cj.C($APP.eb,$APP.Jo.C(function(f,g){var h=new $APP.M(null,2,5,$APP.O,[$APP.ux,g],null);h=$APP.pM.A?$APP.pM.A(h):$APP.pM.call(null,h);return $APP.m(h)?new $APP.l(null,2,[$APP.ux,g,$APP.rx,$APP.C.C(e,f)],null):null},d)),$APP.rz(new $APP.l(null,
1,[$APP.jl,$APP.jl.A(a)],null)));default:throw Error(["No matching clause: ",$APP.q.A(c)].join(""));}},Tze=function(a,b,c){c=$APP.yj(c);var d=$APP.f7b.A(c),e=$APP.wc($APP.z(b.pages)),f=$APP.DM(a),g=$APP.ud(new $APP.xg(null,new $APP.l(null,2,["sendToBack",null,"bringToFront",null],null),null),$APP.Iu.A(c))?Sze(f,c):null;c=$APP.Eg($APP.Jo.C(function(v,w){v=w.id;w=w.nonce;w=$APP.m(w)?w:Date.now();return new $APP.l(null,2,[$APP.Ms,v,$APP.uDd,w],null)},e.shapes));var h=$APP.MK(),n=function(){var v=$APP.ln.C($APP.u($APP.Ffe),
new $APP.M(null,2,5,$APP.O,[h,a],null));return $APP.m(v)?v:$APP.Eg($APP.Zg.C(function(w){return $APP.Hk.F(w,$APP.Ms,$APP.q)},Lze(h,$APP.jl.A(f))))}();b=Qze(b,e,c,n,a,d);e=$APP.Se(b);n=$APP.I.C(e,$APP.Nxc);b=$APP.I.C(e,$APP.Sdd);var p=$APP.I.C(e,$APP.HUd),r=$APP.I.C(e,$APP.bMd),t=$APP.I.C(e,$APP.qC);d=$APP.I.C(e,$APP.j6a);if($APP.x(e)||$APP.x(g)){g=$APP.kl.G(t,new $APP.M(null,1,5,$APP.O,[n],null),$APP.D([r,g]));b=$APP.m($APP.bf(function(v){return $APP.A.C("group",$APP.Ji.A(v))},b))?$APP.T.F(d,$APP.oD,
$APP.MC):$APP.m(function(){var v=$APP.Te(p);return $APP.m(v)?$APP.$e(function(w){return $APP.A.C("group",$APP.Ji.A(w))},p):v}())?$APP.T.F(d,$APP.oD,$APP.Owd):$APP.m($APP.bf(function(v){return $APP.A.C("line",$APP.Ji.A(v))&&$APP.A.C("arrow ",$APP.so.A($APP.vud.A(v)))},b))?$APP.T.F(d,$APP.oD,$APP.kId):$APP.T.F(d,$APP.oD,$APP.qod);$APP.jh.K($APP.Ffe,$APP.fl,new $APP.M(null,2,5,$APP.O,[h,a],null),c);if($APP.ud(new $APP.xg(null,new $APP.l(null,1,[$APP.kId,null],null),null),$APP.oD.A(b)))return $APP.OK($APP.c2d,
new $APP.l(null,2,[$APP.hl,g,$APP.j6a,b],null));c=$APP.c2d.A($APP.u($APP.KK));g=$APP.kl.C($APP.hl.A(c),g);c=$APP.jj.G($APP.D([b,$APP.j6a.A(c)]));$APP.OK($APP.c2d,$APP.Re);return $APP.LM(h,g,c)}return null},Uze=function(a,b){var c=$APP.dM.A($APP.MK()),d=new $APP.l(null,6,[$APP.Ms,$APP.q.A(b),$APP.Il,a,$APP.WZa,$APP.vbb,$APP.Mu,$APP.Re,$APP.uDd,1,$APP.xEc,$APP.Cf],null);d=$APP.Qe([$APP.SM($APP.iz),$APP.vbb,$APP.SM($APP.KF),d]);a=new $APP.l(null,7,[$APP.ux,b,$APP.Yx,$APP.yq.A?$APP.yq.A(a):$APP.yq.call(null,
a),$APP.Xw,a,$APP.zw,"whiteboard",$APP.yz,$APP.Ot,$APP.Hq,$APP.Eq.I?$APP.Eq.I():$APP.Eq.call(null),$APP.Iq,$APP.Eq.I?$APP.Eq.I():$APP.Eq.call(null)],null);c=c?$APP.jj.G($APP.D([a,d])):$APP.T.F(a,$APP.nx,d);return new $APP.M(null,1,5,$APP.O,[c],null)},Vze=function(a){return $APP.Y($APP.V(null),function(){return $APP.Y($APP.V(function(){var b=$APP.m(a)?$APP.$h(a):a;return $APP.m(b)?b:$APP.Rj?$APP.Rj():$APP.Tj.call(null)}()),function(b){return $APP.Y($APP.V($APP.m(a)?a:$APP.q.A(b)),function(c){return $APP.Y($APP.V($APP.LM($APP.MK(),
Uze(c,b),new $APP.l(null,1,[$APP.oD,$APP.m9a],null))),function(){return $APP.V(b)})})})})},Wze=function(a,b){return $APP.Y($APP.V(null),function(){return $APP.Y($APP.V($APP.MK()),function(c){return $APP.Y($APP.V($APP.py.I?$APP.py.I():$APP.py.call(null)),function(d){return $APP.Y($APP.V($APP.DM(a)),function(e){return $APP.Y($APP.V(function(){var f=new $APP.l(null,5,[$APP.ux,d,$APP.Xw,$APP.m(b)?b:"",$APP.yz,$APP.Ot,$APP.gy,$APP.jl.A(e),$APP.dy,$APP.jl.A(e)],null);return $APP.Jq.A?$APP.Jq.A(f):$APP.Jq.call(null,
f)}()),function(f){return $APP.Y($APP.V($APP.LM(c,new $APP.M(null,1,5,$APP.O,[f],null),new $APP.l(null,2,[$APP.oD,$APP.zF,$APP.cgb,!0],null))),function(){return $APP.V(d)})})})})})})},Xze=function(){return $APP.Y($APP.V(null),function(){return $APP.Y($APP.V(fetch("./whiteboard/onboarding.edn")),function(a){return $APP.Y($APP.V(a.text()),function(b){return $APP.Y($APP.V($APP.wCb(b)),function(c){return $APP.V(c)})})})})},Yze=function(a,b){var c=$APP.Se(a);a=$APP.I.C(c,$APP.ny);c=$APP.I.C(c,$APP.dA);
var d=$APP.z(a);a=$APP.wEc(c);d=$APP.RM(d,$APP.KF);c=$APP.xEc.A(d);d=$APP.Mu.A(d);return b.cloneShapesIntoCurrentPage($APP.zj(new $APP.l(null,3,[$APP.AEc,a,$APP.xEc,c,$APP.Mu,d],null)))},Zze=function(a){var b=$APP.B0b();return($APP.Kc(b)||$APP.A.C(1,$APP.qc(b))&&$APP.A.C($APP.q.A(a),$APP.q.A($APP.ux.A($APP.z(b)))))&&$APP.hb($APP.ln.C($APP.u($APP.KK),new $APP.M(null,1,5,$APP.O,[$APP.gYb],null)))},$ze=function(a){var b=$APP.CL();$APP.m(b)&&$APP.df.C(b.api.updateShapes,$APP.Aj(a))},aAe=function(a){var b=
$APP.CL();if($APP.m(b)&&(b=$APP.wc($APP.z(b.pages)),$APP.m(b))){var c=$APP.DM.A?$APP.DM.A(a):$APP.DM.call(null,a);if($APP.m(c)){a=$APP.Zg;var d=a.C,e=$APP.ol.C($APP.q,$APP.ux);c=$APP.aYa.A(c);c=$APP.fy.A?$APP.fy.A(c):$APP.fy.call(null,c);a=d.call(a,e,c);$APP.x(a)&&b.updateShapesIndex($APP.Aj(a))}}},bAe=function(a){return null!=a?$APP.Un($APP.Y($APP.V(null),function(){return $APP.Y($APP.V(Xze()),function(b){return $APP.Y($APP.V(Yze(b,a)),function(){return $APP.V($APP.iYb())})})}),function(b){return console.warn("Failed to populate onboarding whiteboard",
b)}):null},cAe=function(a){a.cleanup($APP.Zg.C(function(b){return b.id},a.shapes))},dAe=function(a,b){b=$APP.wq.G(b,$APP.D([new $APP.l(null,1,[$APP.xq,!0],null)]));b=$APP.Se(b);var c=$APP.I.C(b,$APP.CP),d=$APP.MK();return $APP.Y($APP.V(null),function(){return $APP.Y($APP.V($APP.m(c)?$APP.hhc(d,a,new $APP.l(null,1,[$APP.Hl,100],null)):null),function(e){return $APP.Y($APP.V($APP.Zg.C(function(f){return $APP.Hk.F($APP.Hk.F(f,$APP.ux,$APP.q),$APP.Xw,function(g){return $APP.df.C($APP.q,$APP.NZb(g))})},
e)),function(f){return $APP.V($APP.zj(new $APP.l(null,1,[$APP.dA,f],null)))})})})},eAe=function(a){return $APP.Rn.C($APP.Asc($APP.MK(),new $APP.M(null,1,5,$APP.O,[$APP.wq.A(a)],null)),function(b){var c=(c=$APP.x(b))?$APP.z(b):c;return $APP.m(c)?(b=$APP.C.F(c,0,null),$APP.C.F(c,1,null),c=$APP.C.F(c,2,null),$APP.Dsc($APP.m(c)?c:b)):null})},fAe=function(){return $APP.pfe.A?$APP.pfe.A(null):$APP.pfe.call(null,null)},gAe=function(){return $APP.rfe.A?$APP.rfe.A(null):$APP.rfe.call(null,null)},yAe=function(a){return $APP.jg([hAe,
iAe,jAe,kAe,lAe,mAe,nAe,oAe,pAe,$APP.mF,qAe,rAe,sAe,tAe,$APP.Qv,uAe,vAe,wAe,xAe],[function(b){return $APP.m($APP.Cq.A?$APP.Cq.A(b):$APP.Cq.call(null,b))?$APP.q.A($APP.ux.A($APP.a0b($APP.MK(),$APP.$h(b)))):$APP.q.A($APP.ux.A($APP.DM.A?$APP.DM.A(b):$APP.DM.call(null,b)))},function(b){return $APP.zj($APP.tNc(b))},function(b){return $APP.j0b(b)},function(b){return $APP.Y($APP.V(null),function(){return $APP.Y($APP.V(function(){var c=new $APP.l(null,1,[$APP.FQ,!1],null);return $APP.DQ?$APP.DQ(b,c):$APP.EQ.call(null,
b,c)}()),function(c){return $APP.V($APP.q.A($APP.ux.A(c)))})})},function(b){return $APP.sYb($APP.m(b)?$APP.tNc(b):null)},function(b){return $APP.Y($APP.V(null),function(){return $APP.Y($APP.V(Vze(b)),function(c){return $APP.V($APP.q.A(c))})})},$APP.YI,function(b){return $APP.vrc(b)},function(b){b=$APP.DM.A?$APP.DM.A(b):$APP.DM.call(null,b);return $APP.m(b)?$APP.FM(b):null},dAe,eAe,$APP.Jcc,function(b,c){return $APP.tKb(b,$APP.D([$APP.bB,c]))},function(b){return $APP.Y($APP.V(null),function(){return $APP.Y($APP.V(Wze(a,
b)),function(c){return $APP.V($APP.q.A(c))})})},function(b){return $APP.tN.G($APP.D([$APP.$g.A(b)]))},function(b,c){function d(){return(0,$APP.uZc)($APP.xh(b),$APP.jj.G($APP.D([$APP.wq.G(c,$APP.D([$APP.xq,!0])),new $APP.l(null,1,[$APP.IA,!0],null)])))}return $APP.tK.A?$APP.tK.A(d):$APP.tK.call(null,d)},function(b,c){return $APP.EL($APP.MK(),$APP.jl.A($APP.DM(b)),$APP.$g.A(c))},function(b){return $APP.m(b)?$APP.Y($APP.V(null),function(){return $APP.Y($APP.V($APP.$h(b)),function(c){return $APP.Y($APP.V($APP.m(c)?
$APP.RO($APP.MK(),c):null),function(){return $APP.Y($APP.V(function(){var d=$APP.m(c)?$APP.a0b($APP.MK(),c):null;return $APP.m(d)?d:$APP.DM.A?$APP.DM.A(b):$APP.DM.call(null,b)}()),function(d){return $APP.Y($APP.V($APP.FM(d)),function(e){return $APP.V($APP.Y($APP.V(null),function(){return $APP.Y($APP.V(null==d?function(){var f=new $APP.l(null,1,[$APP.FQ,!1],null);return $APP.DQ?$APP.DQ(b,f):$APP.EQ.call(null,b,f)}():null),function(f){return $APP.Y($APP.V($APP.m(f)?f:d),function(g){return $APP.V($APP.GQ.C($APP.m(e)?
$APP.ux.A(g):$APP.j0b($APP.ux.A(g)),$APP.m($APP.m(c)?$APP.tg.C(c,$APP.ux.A(g)):c)?new $APP.l(null,1,[$APP.iC,c],null):null))})})}))})})})})}):null},function(b){return $APP.zj($APP.w_b(b))}])},AAe=function(a,b,c){return $APP.Un($APP.Y($APP.V(null),function(){return $APP.Y($APP.V($APP.u(zAe)),function(){return $APP.Y($APP.V($APP.Y($APP.V(null),function(){return $APP.Y($APP.V($APP.OK(new $APP.M(null,2,5,$APP.O,[$APP.TSd,$APP.MK()],null),$APP.Eq.I?$APP.Eq.I():$APP.Eq.call(null))),function(){return $APP.V(Tze(a,
b,c))})})),function(d){return $APP.V($APP.jf(zAe,d))})})}),function(d){console.error(d);return $APP.QG.A(new $APP.M(null,2,5,$APP.O,[$APP.uE,["Save whiteboard failed, error:",$APP.q.A(d.cause)].join("")],null))})},kAe=new $APP.J(null,"addNewPage","addNewPage",1998524678),xAe=new $APP.J(null,"queryBlockByUUID","queryBlockByUUID",2091812895),uAe=new $APP.J(null,"exportToImage","exportToImage",-154356643),tAe=new $APP.J(null,"addNewBlock","addNewBlock",1426762680),BAe=new $APP.J(null,"KeyboardShortcut",
"KeyboardShortcut",1250004264),hAe=new $APP.J(null,"getBlockPageName","getBlockPageName",-1656908032),CAe=new $APP.J(null,"renderers","renderers",-1460292282),DAe=new $APP.J(null,"model","model",331153215),jAe=new $APP.J(null,"getRedirectPageName","getRedirectPageName",-1858136925),nAe=new $APP.J(null,"isMobile","isMobile",-2043133877),lAe=new $APP.J(null,"setCurrentPdf","setCurrentPdf",-63289336),EAe=new $APP.J(null,"onMount","onMount",-876858467),oAe=new $APP.J(null,"insertFirstPageBlock","insertFirstPageBlock",
-1676658548),rAe=new $APP.J(null,"makeAssetUrl","makeAssetUrl",217779988),FAe=new $APP.J(null,"onPersist","onPersist",-1848738852),GAe=new $APP.J(null,"Breadcrumb","Breadcrumb",-1351298906),sAe=new $APP.J(null,"copyToClipboard","copyToClipboard",1092115063),wAe=new $APP.J(null,"redirectToPage","redirectToPage",87147838),mAe=new $APP.J(null,"addNewWhiteboard","addNewWhiteboard",554297706),qAe=new $APP.J(null,"saveAsset","saveAsset",-668047853),HAe=new $APP.J(null,"BacklinksCount","BacklinksCount",
364670631),IAe=new $APP.J(null,"Block","Block",-1959785792),vAe=new $APP.J(null,"sidebarAddBlock","sidebarAddBlock",-1204903203),JAe=new $APP.J(null,"Page","Page",-1267059506),KAe=new $APP.J(null,"PageName","PageName",-164991013),LAe=new $APP.J(null,"Tweet","Tweet",-452258680),pAe=new $APP.J(null,"isWhiteboardPage","isWhiteboardPage",-134150579),MAe=new $APP.J(null,"BlockReference","BlockReference",-120254741),iAe=new $APP.J(null,"inflateAsset","inflateAsset",-1449040639);$APP.Cvb("tldraw");var NAe=$APP.sj(632);var OAe,PAe,zAe,QAe,RAe;$APP.uoe={};OAe=$APP.VJ($APP.ua(NAe,"App"));$APP.xoe=$APP.ua(NAe,"generateJSXFromModel");
PAe=new $APP.l(null,8,[JAe,$APP.DH($APP.GH,function(a){return(0,$APP.aad)(new $APP.l(null,2,[$APP.yB,$APP.ua(a,"pageName"),$APP.IA,!0],null))},null,"frontend.extensions.tldraw/page-cp"),IAe,$APP.DH($APP.GH,function(a){a=$APP.xh($APP.ua(a,"blockId"));var b=new $APP.l(null,2,[$APP.Ms,$APP.q.A(a),$APP.IA,!0],null),c=$APP.IL($APP.gad);a=c.C?c.C(b,a):c.call(null,b,a);return $APP.xH(a)},null,"frontend.extensions.tldraw/block-cp"),GAe,$APP.DH($APP.GH,function(a){return(0,$APP.xW)(new $APP.l(null,1,[$APP.FX,
!0],null),$APP.MK(),$APP.xh($APP.ua(a,"blockId")),new $APP.l(null,2,[$APP.Agd,$APP.ua(a,"endSeparator"),$APP.Qbd,$APP.ua(a,"levelLimit",3)],null))},null,"frontend.extensions.tldraw/breadcrumb"),LAe,$APP.DH($APP.GH,function(a){return(0,$APP.BWc)($APP.ua(a,"tweetId"))},null,"frontend.extensions.tldraw/tweet"),KAe,$APP.DH($APP.GH,function(a){a=$APP.ua(a,"pageName");$APP.m(a)?(a=$APP.DM.A?$APP.DM.A(a):$APP.DM.call(null,a),a=$APP.m(a)?(0,$APP.ZS)(new $APP.l(null,1,[$APP.FX,!0],null),a):null):a=null;return $APP.xH(a)},
null,"frontend.extensions.tldraw/page-name-link"),HAe,function(a){return $APP.df.C($APP.yoe,$APP.Zg.C(function(b){return $APP.wq.G($APP.ua(a,b),$APP.D([new $APP.l(null,1,[$APP.xq,!0],null)]))},new $APP.M(null,3,5,$APP.O,["id","className","options"],null)))},MAe,$APP.DH($APP.GH,function(a){return(0,$APP.WS)($APP.Re,$APP.ua(a,"blockId"),null)},null,"frontend.extensions.tldraw/block-reference"),BAe,$APP.DH($APP.GH,function(a){return $APP.xH(function(){var b=$APP.yj(a);if($APP.m(b)){var c=$APP.Se(b);
b=$APP.I.C(c,$APP.JF);var d=$APP.I.C(c,$APP.vR);c=$APP.I.C(c,$APP.DD);b="string"===typeof b?$APP.CR($APP.$g.A(b)):d;var e=$APP.jj.G($APP.D([new $APP.l(null,1,[$APP.m4,!1],null),c]));return"string"===typeof b?$APP.pGc(b,$APP.D([e])):$APP.Ii.C(" | ",$APP.Zg.C(function(f){return $APP.pGc(f,$APP.D([e]))},b))}return null}())},null,"frontend.extensions.tldraw/keyboard-shortcut")],null);zAe=$APP.ih.A(null);
QAe=$APP.DH($APP.GH,function(a,b,c,d,e){return $APP.Z("div",{style:{overscrollBehavior:"none"},onBlur:function(f){f=$APP.ua(f,"target").tagName;var g=new $APP.xg(null,new $APP.l(null,2,["INPUT",null,"TEXTAREA",null],null),null);f=g.A?g.A(f):g.call(null,f);return $APP.m(f)?$APP.vL():null},onWheel:$APP.JI,className:"draw tldraw whiteboard relative w-full h-full"},[$APP.m($APP.m(c)?$APP.hb(d):c)?$APP.Z("div",{style:{zIndex:200},className:"absolute inset-0 flex items-center justify-center"},[$APP.xH($APP.DR("Loading onboarding whiteboard ..."))]):
null,$APP.xH(function(){var f=new $APP.l(null,6,[CAe,PAe,$APP.Px,yAe(a),EAe,e,$APP.sQd,!0,FAe,function(g,h){return AAe(a,g,h)},DAe,b],null);return OAe.A?OAe.A(f):OAe.call(null,f)}())])},new $APP.M(null,2,5,$APP.O,[$APP.FH,new $APP.l(null,1,[$APP.dFb,function(a,b){var c=$APP.z($APP.EH.A(a)),d=$APP.C.C($APP.EH.A(a),1),e=$APP.C.C($APP.EH.A(b),1),f=function(){var g=function(){var h=$APP.ua(d,"pages");h=null==h?null:$APP.z(h);return null==h?null:$APP.ua(h,"shapes")}();return $APP.Hg($APP.Zg.C(function(h){return $APP.ua(h,
"id")},g),g)}();a=function(){var g=$APP.ua(e,"pages");g=null==g?null:$APP.z(g);return null==g?null:$APP.ua(g,"shapes")}();a=$APP.yf.C(function(g){var h=$APP.I.C(f,$APP.ua(g,"id"));return $APP.m(h)?$APP.tg.C($APP.ua(g,"type"),$APP.ua(h,"type")):null},a);$APP.x(a)&&$ze(a);aAe(c);return b}],null)],null),"frontend.extensions.tldraw/tldraw-inner");
RAe=$APP.DH($APP.GH,function(a,b,c,d){function e(h){if($APP.m(h)){h.appUndo=fAe;h.appRedo=gAe;var n=$APP.ua(h,"api");return $APP.m(n)?$APP.Rn.C(f?bAe(n):null,function(){cAe(h.currentPage);$APP.tYb(h,b);return d.A?d.A(h):d.call(null,h)}):null}return null}if($APP.m($APP.yYb($APP.q.A(a))))return null;var f=Zze(a),g=$APP.IEc(a);return $APP.m(g)?QAe(a,g,f,c,e):null},new $APP.M(null,2,5,$APP.O,[$APP.a8,new $APP.l(null,1,[$APP.Ou,function(a){var b=$APP.z($APP.EH.A(a));$APP.RO($APP.MK(),b);return a}],null)],
null),"frontend.extensions.tldraw/tldraw-app-inner");$APP.voe=$APP.DH($APP.GH,function(a,b){a=$APP.q.A(a);var c=$APP.LH(null),d=$APP.C.F(c,0,null);c=$APP.C.F(c,1,null);$APP.UJ(function(){$APP.m($APP.m(d)?b:d)&&$APP.tYb(d,b);return function(){return $APP.ac}},new $APP.M(null,2,5,$APP.O,[b,d],null));return RAe(a,b,d,c)},null,"frontend.extensions.tldraw/tldraw-app");$APP.jA.Gi();
}).call(this);
//# sourceMappingURL=tldraw.js.map
